{"config":{"lang":["es"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"M\u00f3dulo de Implantaci\u00f3n de Sistemas Operativos","text":""},{"location":"#informacion-del-modulo-iso","title":"INFORMACI\u00d3N DEL M\u00d3DULO (ISO)","text":"<p>El m\u00f3dulo con el c\u00f3digo 0369 tiene 233 horas anuales y 7 semanales. En la modalidad semipresencial en el horario ten\u00e9is horas telem\u00e1ticas y horas presenciales.</p>"},{"location":"#que-vamos-a-ver-en-este-modulo","title":"\u00bfQu\u00e9 vamos a ver en este m\u00f3dulo?","text":"<p>A grandes rasgos veremos:</p> <ul> <li>Sistemas operativos (SO)</li> <li>Linux</li> <li>Windows 10</li> <li>Instalaci\u00f3n de software libre y propietario</li> <li>Consideraciones previas a la instalaci\u00f3n de sistemas operativos libres y propietarios</li> <li>Administraci\u00f3n de software de base</li> <li>Administraci\u00f3n y aseguramiento de la informaci\u00f3n</li> <li>Administraci\u00f3n de dominios</li> <li>Administraci\u00f3n del acceso al dominio</li> <li>Supervisi\u00f3n del rendimiento del sistema</li> <li>Directivas de seguridad y auditor\u00edas</li> <li>Resoluci\u00f3n de incidencias y asistencia t\u00e9cnica.</li> </ul>"},{"location":"#resultados-de-aprendizaje","title":"Resultados de aprendizaje","text":"<p>Un Resultado de Aprendizaje \"es una declaraci\u00f3n de lo que el estudiante se espera que conozca, comprenda y sea capaz de hacer al finalizar un periodo de aprendizaje\".</p> <ul> <li>RA1. Instala sistemas operativos, analizando sus caracter\u00edsticas e interpretando la documentaci\u00f3n t\u00e9cnica.</li> <li>RA2. Configura el software de base, analizando las necesidades de explotaci\u00f3n del sistema inform\u00e1tico.</li> <li>RA3. Asegura la informaci\u00f3n del sistema, describiendo los procedimientos y utilizando copias de seguridad y sistemas tolerantes a fallos.</li> <li>RA4. Centraliza la informaci\u00f3n en servidores administrando estructuras de dominios y analizando sus ventajas.</li> <li>RA5. Administra el acceso a dominios analizando y respetando requerimientos de seguridad.</li> <li>RA6. Detecta problemas de rendimiento, monitorizando el sistema con las herramientas adecuadas y documentando el procedimiento.</li> <li>RA7. Audita la utilizaci\u00f3n y acceso a recursos, identificando y respetando las necesidades de seguridad del sistema.</li> <li>RA8. Implanta software espec\u00edfico con estructura cliente/servidor dando respuesta a los requisitos funcionales.</li> </ul>"},{"location":"#unidades-didacticas-temporalizacion","title":"Unidades did\u00e1cticas / Temporalizaci\u00f3n","text":"<p>A continuaci\u00f3n se muestran las unidades did\u00e1cticas y una estimaci\u00f3n temporal de cada una de ellas, repartidas en cada evaluaci\u00f3n. Las unidades de trabajo (UT) se han planificado seg\u00fan el calendario escolar 2025/2026, siguiendo la distribuci\u00f3n en quincenas para las UTs indicada en la ORDEN 30/2022 (https://dogv.gva.es/datos/2022/05/18/pdf/2022_4219.pdf), de 12 de mayo.</p>"},{"location":"#1er-trimestre","title":"1er Trimestre","text":"<ul> <li>UD1.Sistemas operativos.Virtualizaci\u00f3n. (16 horas)</li> <li>UD2.Configuraci\u00f3n de sistemas operativos.(16 horas)</li> <li>UD3.Administraci\u00f3n de software base y aplicaciones.(16 horas)</li> <li>UD4.Instalaci\u00f3n de servicios de directorio. (16 horas)</li> </ul>"},{"location":"#2o-trimestre","title":"2\u00ba Trimestre","text":"<ul> <li>UD5.Configuraci\u00f3n de servicios de directorio (16 horas)</li> <li>UD6.Administraci\u00f3n de usuarios locales y de red.(16 horas)</li> <li>UD7.Administraci\u00f3n de objetos y pol\u00edticas de grupo.(16 horas)</li> <li>UD8.Administraci\u00f3n de recursos y permisos de acceso.(16 horas)</li> <li>UD9.Introducci\u00f3n a Shell Script en GNU/Linux (16 horas)</li> <li>UD10 Introducci\u00f3n a PowerShell en Microsoft Windows.(16 horas)</li> </ul>"},{"location":"#3er-trimestre","title":"3er Trimestre","text":"<ul> <li>UD11. Integridad y seguridad de la informaci\u00f3n. (16 horas)</li> <li>UD12. Respaldo de la informaci\u00f3n y del sistema operativo.(16 horas)</li> <li>UD13. Asistencia Remota al usuario y resoluci\u00f3n de incidencias(16 horas)</li> </ul>"},{"location":"#evaluacion","title":"Evaluaci\u00f3n","text":"<p>La evaluaci\u00f3n es un proceso continuo y formativo basado en la calificaci\u00f3n de competencias a trav\u00e9s de los resultados de aprendizaje. Para obtener la calificaci\u00f3n se tienen en cuenta las siguientes premisas:</p> <p>Warning</p> <p>Por lo tanto LA CALIFICACI\u00d3N FINAL DEL M\u00d3DULO se obtendr\u00e1 de la media ponderada de las calificaciones de cada RA. Todos los RA no tienen el mismo peso y todos ellos TIENEN QUE ESTAR APROBADOS. Y Tener en cuenta que aunque haya actividades que no se puntuen son muy importantes para la consecuci\u00f3n del RA en cara al examen. </p>"},{"location":"#procedimientos-de-evaluacion","title":"Procedimientos de Evaluaci\u00f3n","text":"<p>La calificaci\u00f3n de cada RA se obtendr\u00e1 de la media ponderada de las actividades formativas trabajadas. Para ello se utilizan los siguientes procedimientos de evaluaci\u00f3n:</p> <p>Instrumentos de Evaluaci\u00f3n:</p> <ul> <li>IE1. Actividades de la Unidad (UA): Actividades de diferentes tipos, se eval\u00faan con IC1</li> <li>IE2. Prueba espec\u00edfica : Actividades que hacen referencias al m\u00f3dulo. Puede ser evaluada con IC2 o IC3 o ambas</li> </ul> <p>Instrumento de Calificaci\u00f3n:</p> <ul> <li> <p>IC1: Escala de valores:</p> <ul> <li>0: No entregada</li> <li>1: Entregada con soluci\u00f3n err\u00f3nea o incompleta</li> <li>2: Entregada y soluci\u00f3n aceptable, aunque tiene alg\u00fan apartado incorrecto</li> </ul> </li> <li> <p>IC2: R\u00fabrica pr\u00e1ctica</p> </li> <li>IC3: Escala para test, No habr\u00e1 resta en las preguntas test. Pero se tendr\u00e1 que realizar en el tiempo determinado.</li> </ul>"},{"location":"#evaluaciones-trimestrales","title":"Evaluaciones Trimestrales","text":"<p>Las evaluaciones de los trimestres ser\u00e1 calculada con la media ponderada de los RA que se hayan evaluado en ese momento. Es decir que si hay alg\u00fan RA que no se ha evaluado con ninguna actividad o prueba espec\u00edfica no ser\u00e1 seleccionado para realizar la media ponderada.</p>"},{"location":"#evaluaciones-ordinaria-y-extraordinaria","title":"Evaluaciones Ordinaria y Extraordinaria\u00b6","text":"<p>En el caso de no superar alg\u00fan resultado de aprendizaje durante la evaluaci\u00f3n continua:</p> <p>Warning</p> <p>En primera instancia se recupera el RA en el examen de convocatoria final Ordinaria. En segunda instancia si todav\u00eda no se ha superado el RA en la Ordinaria se debe aprobar en examen final de la convocatoria Extraordinaria.</p>"},{"location":"Examenes/Examen1EVA/examen/","title":"Examen de la Primera Evaluaci\u00f3n","text":"<p>Tienes que generar un fichero PDF por cada uno de los ejercicios que tienes y a continuaci\u00f3n subirlo a \"Aules\" en la tarea correspondiente. Describiendo detalladamente con capturas de pantalla y explicaciones de cada uno de los pasos.</p>"},{"location":"Examenes/Examen1EVA/examen/#ejercicio-1-30-del-ra1","title":"Ejercicio 1 (30% del RA1)","text":"<p>A\u00f1ade un disco duro a la m\u00e1quina virtual en el mismo controlador SATA de 20G. Adem\u00e1s, amplia a tres los n\u00facleos de la CPU disponibles para tu m\u00e1quina.</p>"},{"location":"Examenes/Examen1EVA/examen/#ejercicio-2-50-del-ra2","title":"Ejercicio 2 (50% del RA2)","text":"<ol> <li>Introduce un comando para mostrar SOLO el PID y nombre de todos los procesos de tu usuario, en todo el sistema.</li> <li>Busca todos los correos-e que hay en todo el sistema de ficheros.(Crea un fichero con un correo-e)</li> <li>Introduzca un comando para contar el n\u00famero de ficheros del sistema que pertenezcan a tu usuario, sean mayores de 200KB y que tengas t\u00fa permiso de escritura. El resultado debe almacenarse en el fichero res3, es decir el n\u00famero de fichero que hay, y los errores en el fichero err3.</li> </ol>"},{"location":"Examenes/Examen1EVA/examen/#ejercicio-3-50-del-ra3","title":"Ejercicio 3 (50% del RA3)","text":"<ol> <li>Crea una tarea con systemd.timer, que se lance el 10 de diciembre de 2024, consistente en contar el n\u00famero de ficheros mayores de 2MB, del usuario root. El resultado de este comando debe almacenarse en el fichero <code>~/ej1</code></li> <li>Configurar el sistema para montar en el arranque, la partici\u00f3n <code>/dev/sdb</code> en el directorio <code>~/D2</code>,sobre el disco duro anteriormente montado, en modo lectura y escritura de forma que no se permita la ejecuci\u00f3n de programas de dicha partici\u00f3n. Adem\u00e1s debe chequearse peri\u00f3dicamente la partici\u00f3n en el arranque del sistema.\u00bfC\u00f3mo vemos todos los elementos que tenemos montados?</li> <li>Para el servicio SSH y aseg\u00farate de que no se ejecuta durante el inicio del sistema.(reinicia la m\u00e1quina). Vuelve a activarlo.(primero tendr\u00e1s que verificar que tengas ese servicio y si no lo tendr\u00e1s que instalar en la m\u00e1quina)</li> </ol>"},{"location":"Examenes/Examen2EVA/examen/","title":"Examen de la Segunda Evaluaci\u00f3n","text":""},{"location":"Examenes/Examen2EVA/examen/#ejercicio-1","title":"Ejercicio 1","text":"<p>Genera un script con el nombre <code>script1.sh</code> de tal manera que cuando lo ejecutes salgo el siguiente men\u00fa:</p> <pre><code> a. Espacio en disco libre (comando df).\n b. Espacio de memoria RAM libre (comando free).\n c. Apagar el sistemas.\n d. Salir.\n</code></pre> <p>La opci\u00f3n a. debe mostrar el porcentaje de disco en uso donde se encuentra instalado el sistema operativo (/). S\u00f3lo el porcentaje. (4pts)</p> <p>La opci\u00f3n b. debe mostrar la memoria RAM disponible (free). \u00danicamente la memoria ram, no la de intercambio (swap).(4pts)</p> <p>La opci\u00f3n c. debe apagar el sistema.(1 pts)</p> <p>La opci\u00f3n d. sale del script. Si no se selecciona la opci\u00f3n correcta mostrar\u00e1 un error de opci\u00f3n incorrecta y volver\u00e1 a solicitar una opci\u00f3n mostrando de nuevo el men\u00fa. (1pts)</p> <p>Note</p> <p>El men\u00fa debe repetirse indefinidamente aunque se escoja una opci\u00f3n correcta. S\u00f3lo se debe salir del script al seleccionar la opci\u00f3n \u201cd\u201d. Si no se produce esta condici\u00f3n no se continua corrigiendo</p>"},{"location":"Examenes/Examen2EVA/examen/#ejercicio-2","title":"Ejercicio 2","text":"<p>Genera un script con el nombre <code>script2.sh</code> que:</p> <ul> <li>Espere dos argumentos, el primero de ellos ser\u00e1 un directorio y el segundo un fichero. Se debe comprobar que se han pasado exactamente 2 argumentos y que el primero de ellos es   un directorio y el segundo un fichero.Condici\u00f3n para corregir el ejercicio.(2pts)</li> <li> <p>El fichero contendr\u00e1 la siguiente estructura o similar.</p> <pre><code>    dir alumnos\n    fic notas\n    dir profesor\n    dir equipos\n    fic hola\n</code></pre> </li> <li> <p>Acto seguido el script debe acceder al directorio pasado como primer argumento y recorrer el fichero pasado como segundo argumento. Por cada l\u00ednea con dir debe crear un directorio   con el nombre correspondiente, por cada l\u00ednea con fic debe crear un fichero con el nombre correspondiente. (4pts)</p> </li> <li>Al finalizar el script debe de indicar el n\u00famero de ficheros/directorios creados. Por un lado debe indicar los ficheros creados y por otro los directorios, NO LA SUMA DE AMBOS. Por   ejemplo Ficheros creados: 2 Directorios creados: 2 (4pts)</li> </ul>"},{"location":"Examenes/Examen3EVA/examen/","title":"Examen de la Tercera Evaluaci\u00f3n (DIF\u00cdCIL)","text":""},{"location":"Examenes/Examen3EVA/examen/#ejercicio","title":"Ejercicio","text":"<p>Crea un script en powershell que haga un backup de una carpeta que se le pase por par\u00e1metro . Se har\u00e1 copia de toda la carpeta, de nuevo de tal manera que sea comprimida.</p> Uso y salida<pre><code>.\\BackupScript.ps1 -FolderPath\"C:\\Ruta\\De\\La\\Carpeta\"\nBackup realizado: C:\\Backup\\Backup_20240513_124130.zip\n</code></pre> <p>Note</p> <p>Comandos que se utilizar\u00e1n:</p> <pre><code>- `New-Object System.IO.FileSystemWatcher` --&gt; Sucripci\u00f3n a diferentes tipos de eventos sobre una carpeta (Changed,create,delete)\n- `Compress-Archive` --&gt; Compresi\u00f3n de la carpeta\n- Ten en cuenta que cada vez que hagas un archivo comprimido el nombre tiene que variar con la fecha (`Get-Date -Format 'yyyyMMdd_HHmmss'`)\n-  $watcher.WaitForChanged($ChangeTypes, $Timeout) Se utiliza para que sincronicamente cuando se produzca un cambio del tipo especificado en la variable $ChangeTypes con $timeout que que es a el tiempo m\u00e1ximo (en milisegundos) que el m\u00e9todo esperar\u00e1 a que se produzca un cambio antes de devolver el control.\n</code></pre>"},{"location":"Examenes/Examen3EVA/examenbis/","title":"Examen de la Tercera Evaluaci\u00f3n","text":""},{"location":"Examenes/Examen3EVA/examenbis/#ejercicio","title":"Ejercicio","text":"<p>Dado el siguiente script :</p> ScriptCopiaSeguridad<pre><code>$FolderPath = \"C:\\Users\\Administrador.WIN-OT4FJF7Q1AT\\temp\"\n\n        $ChangeTypes = [System.IO.WatcherChangeTypes]::Created, [System.IO.WatcherChangeTypes]::Deleted, [System.IO.WatcherChangeTypes]::Changed,[System.IO.WatcherChangeTypes]::Renamed\nWrite-Host $FolderPath\n$watcher = New-Object System.IO.FileSystemWatcher\n$watcher.Path = $FolderPath\n$watcher.Filter='\\*'\n$watcher.IncludeSubdirectories = $true\n$watcher.EnableRaisingEvents = $true\n$watcher.NotifyFilter=$ChangeTypes\n$Timeout=1000\n\nfunction Backup-Folder {\n    $backupFolder = \"C:\\Backup\"  # Carpeta donde se almacenar\u00e1n los respaldos\n\n    # Crear la carpeta de respaldo si no existe\n    if (-not (Test-Path -Path $backupFolder)) {\n        New-Item -ItemType Directory -Path $backupFolder\n    }\u00ba\n\n    # Nombre del archivo de respaldo\n    $backupFileName = \"Backup_$(Get-Date -Format 'yyyyMMdd_HHmmss').zip\"\n    $backupFilePath = Join-Path -Path $backupFolder -ChildPath $backupFileName\n\n    # Crear el archivo de respaldo\n    Compress-Archive -Path $FolderPath -DestinationPath $backupFilePath -Force\n\n    Write-Output \"Backup realizado: $backupFilePath\"\n}\n\ndo {\n\n    $result = $watcher.WaitForChanged($ChangeTypes, $Timeout)\n     if ($result.TimedOut) { continue }\n     Backup-Folder\n\n} while ($true)\n</code></pre>"},{"location":"Examenes/Examen3EVA/examenbis/#ejercicio-1","title":"Ejercicio 1","text":"<p>Analiza y describe con vuestras palabras (no copiar y pegar) y pormenorizadamnete, es decir todas sus instrucciones y concluye con la utilidad del mismo. Para ello tendr\u00e1s la ayuda que nos proporciona windows tanto online como offline.</p>"},{"location":"Examenes/Examen3EVA/examenbis/#ejercicio-2","title":"Ejercicio 2","text":"<p>Modifica el mismo para que sea obligatorio la introducci\u00f3n como par\u00e1metro del directorio en cuesti\u00f3n es decir:</p> <pre><code>.\\script -dir \"c:\\user\"\n</code></pre> <p>Note</p> <p>Me ten\u00e9is que entregar dos ficheros el primero con las explicaciones en formato pdf y el segundo .ps1.</p>"},{"location":"Examenes/Extraordinaria/ExamenExtra/","title":"Examen Extraordinario","text":""},{"location":"Examenes/Extraordinaria/ExamenExtra/#ejercicio-1-ra5-50","title":"Ejercicio 1 (RA5 --&gt; 50%)","text":"<p>Genera un script con el nombre <code>explore.sh</code> que:</p> <ul> <li>Espere dos argumentos, el primero de ellos ser\u00e1 un directorio y el segundo un fichero. Se debe comprobar que se han pasado exactamente 2 argumentos y que el primero de ellos es   un directorio y el segundo un fichero.Condici\u00f3n para corregir el ejercicio.(2pts)</li> <li> <p>El fichero contendr\u00e1 la siguiente estructura o similar.</p> <pre><code>    dir alumnos\n    fic notas\n    dir profesor\n    dir equipos\n    fic hola\n</code></pre> </li> <li> <p>Acto seguido el script debe acceder al directorio pasado como primer argumento y recorrer el fichero pasado como segundo argumento. Por cada l\u00ednea con dir debe crear un directorio   con el nombre correspondiente, por cada l\u00ednea con fic debe crear un fichero con el nombre correspondiente. (4pts)</p> </li> <li>Al finalizar el script debe de indicar el n\u00famero de ficheros/directorios creados. Por un lado debe indicar los ficheros creados y por otro los directorios, NO LA SUMA DE AMBOS. Por   ejemplo Ficheros creados: 2 Directorios creados: 2 (4pts)</li> </ul> <p>Ejercicio shellScript</p> <p>Me ten\u00e9is que entregar el fichero explore.sh</p>"},{"location":"Examenes/Extraordinaria/ExamenExtra/#ejercicio-2-ra5-30","title":"Ejercicio 2 (RA5 --&gt; 30%)","text":"<p>Dado el siguiente script :</p> ScriptCopiaSeguridad<pre><code>$FolderPath = \"C:\\Users\\Administrador.WIN-OT4FJF7Q1AT\\temp\"\n\n        $ChangeTypes = [System.IO.WatcherChangeTypes]::Created, [System.IO.WatcherChangeTypes]::Deleted, [System.IO.WatcherChangeTypes]::Changed,[System.IO.WatcherChangeTypes]::Renamed\nWrite-Host $FolderPath\n$watcher = New-Object System.IO.FileSystemWatcher\n$watcher.Path = $FolderPath\n$watcher.Filter='\\*'\n$watcher.IncludeSubdirectories = $true\n$watcher.EnableRaisingEvents = $true\n$watcher.NotifyFilter=$ChangeTypes\n$Timeout=1000\n\nfunction Backup-Folder {\n    $backupFolder = \"C:\\Backup\"  # Carpeta donde se almacenar\u00e1n los respaldos\n\n    # Crear la carpeta de respaldo si no existe\n    if (-not (Test-Path -Path $backupFolder)) {\n        New-Item -ItemType Directory -Path $backupFolder\n    }\u00ba\n\n    # Nombre del archivo de respaldo\n    $backupFileName = \"Backup_$(Get-Date -Format 'yyyyMMdd_HHmmss').zip\"\n    $backupFilePath = Join-Path -Path $backupFolder -ChildPath $backupFileName\n\n    # Crear el archivo de respaldo\n    Compress-Archive -Path $FolderPath -DestinationPath $backupFilePath -Force\n\n    Write-Output \"Backup realizado: $backupFilePath\"\n}\n\ndo {\n\n    $result = $watcher.WaitForChanged($ChangeTypes, $Timeout)\n     if ($result.TimedOut) { continue }\n     Backup-Folder\n\n} while ($true)\n</code></pre>"},{"location":"Examenes/Extraordinaria/ExamenExtra/#ejercicio-1-60","title":"Ejercicio 1 (60%)","text":"<p>Analiza y describe con vuestras palabras (no copiar y pegar) y pormenorizadamnete, es decir todas sus instrucciones y concluye con la utilidad del mismo. Para ello tendr\u00e1s la ayuda que nos proporciona windows tanto online como offline.</p>"},{"location":"Examenes/Extraordinaria/ExamenExtra/#ejercicio-2-40","title":"Ejercicio 2 (40%)","text":"<p>Modifica el mismo para que sea obligatorio la introducci\u00f3n como par\u00e1metro del directorio en cuesti\u00f3n es decir:</p> <pre><code>.\\script -dir \"c:\\user\"\n</code></pre> <p>Ejercicio Powershell</p> <p>Me ten\u00e9is que entregar dos ficheros el primero con las explicaciones en formato pdf y el segundo .ps1.</p> <p>Porcentaje de las notas</p> <p>Para este RA los porcentajes son las siguietentes: - Ejercicio 1 examen 50% - Ejercicio 2 examen 30% - Actividades 20%</p>"},{"location":"Examenes/Extraordinaria/Requisitos/","title":"Final Ordinaria","text":""},{"location":"Examenes/Extraordinaria/Requisitos/#requisitos","title":"Requisitos","text":"<p>A continuaci\u00f3n, se detallan las actividades que me ten\u00e9is que entregar asociadas a cada uno de los resultados de aprendizaje (RA) en cuesti\u00f3n. Con el objetivo de superar todos los RA.</p> <p>Warning</p> <p>Si ten\u00e9is ten\u00e9is ese RA aprobado no ten\u00e9is que entregarme las actividades pertenecientes a ese RA.</p> <p>Actividades Obligatorias que ten\u00e9is que superar y entregar:</p> Actividades RA Actividad 4.1 1 Actividad 3.2 2 RELACI\u00d3N 2-II 2 Actividad 2.3 3 RELACI\u00d3N 3-I 3 RELACI\u00d3N 3-III 3 RELACI\u00d3N 3-II 3 A\u00f1adir ubuntu a Active directory 4 Actividad 2.7 5 Actividad 2.8 5 Actividad 2.11 6 <p>Estas actividades ser\u00e1n entregadas en pdf o tendr\u00e1s que realizar los cuestionarios. Estos \u00faltimos son obligatorios.</p> <p>Descripci\u00f3n del examen (Si y solo si ten\u00e9is el RA5 suspendido):</p> <p>Estar\u00e1 compuesto por dos ejercicios: un script sobre Linux y otro de Powershell. Todos ellos pertenecientes al RA5.</p> <p>Ejemplo</p> <p>Un alumno tiene s\u00f3lo suspendido el RA5 se tendr\u00e1 que presentar al examen y entregarme las actividades   Actividad 2.7, Actividad 2.8 en Aules en la secci\u00f3n Extraordinaria.</p>"},{"location":"Examenes/Ordinaria/ExamenOrd/","title":"Examen Ordinario.","text":""},{"location":"Examenes/Ordinaria/ExamenOrd/#ejercicio-1-ra5-50","title":"Ejercicio 1 (RA5 --&gt; 50%)","text":"<p>Genera un script con el nombre <code>expore.sh</code> que:</p> <ul> <li>Espere dos argumentos, el primero de ellos ser\u00e1 un directorio y el segundo un fichero. Se debe comprobar que se han pasado exactamente 2 argumentos y que el primero de ellos es   un directorio y el segundo un fichero.Condici\u00f3n para corregir el ejercicio.(2pts)</li> <li> <p>El fichero contendr\u00e1 la siguiente estructura o similar.</p> <pre><code>    dir alumnos\n    fic notas\n    dir profesor\n    dir equipos\n    fic hola\n</code></pre> </li> <li> <p>Acto seguido el script debe acceder al directorio pasado como primer argumento y recorrer el fichero pasado como segundo argumento. Por cada l\u00ednea con dir debe crear un directorio   con el nombre correspondiente, por cada l\u00ednea con fic debe crear un fichero con el nombre correspondiente. (4pts)</p> </li> <li>Al finalizar el script debe de indicar el n\u00famero de ficheros/directorios creados. Por un lado debe indicar los ficheros creados y por otro los directorios, NO LA SUMA DE AMBOS. Por   ejemplo Ficheros creados: 2 Directorios creados: 2 (4pts)</li> </ul> <p>Ejercicio shellScript</p> <p>Me ten\u00e9is que entregar el fichero explore.sh</p>"},{"location":"Examenes/Ordinaria/ExamenOrd/#ejercicio-2-ra5-30","title":"Ejercicio 2 (RA5 --&gt; 30%)","text":"<p>Dado el siguiente script :</p> ScriptCopiaSeguridad<pre><code>$FolderPath = \"C:\\Users\\Administrador.WIN-OT4FJF7Q1AT\\temp\"\n\n        $ChangeTypes = [System.IO.WatcherChangeTypes]::Created, [System.IO.WatcherChangeTypes]::Deleted, [System.IO.WatcherChangeTypes]::Changed,[System.IO.WatcherChangeTypes]::Renamed\nWrite-Host $FolderPath\n$watcher = New-Object System.IO.FileSystemWatcher\n$watcher.Path = $FolderPath\n$watcher.Filter='\\*'\n$watcher.IncludeSubdirectories = $true\n$watcher.EnableRaisingEvents = $true\n$watcher.NotifyFilter=$ChangeTypes\n$Timeout=1000\n\nfunction Backup-Folder {\n    $backupFolder = \"C:\\Backup\"  # Carpeta donde se almacenar\u00e1n los respaldos\n\n    # Crear la carpeta de respaldo si no existe\n    if (-not (Test-Path -Path $backupFolder)) {\n        New-Item -ItemType Directory -Path $backupFolder\n    }\u00ba\n\n    # Nombre del archivo de respaldo\n    $backupFileName = \"Backup_$(Get-Date -Format 'yyyyMMdd_HHmmss').zip\"\n    $backupFilePath = Join-Path -Path $backupFolder -ChildPath $backupFileName\n\n    # Crear el archivo de respaldo\n    Compress-Archive -Path $FolderPath -DestinationPath $backupFilePath -Force\n\n    Write-Output \"Backup realizado: $backupFilePath\"\n}\n\ndo {\n\n    $result = $watcher.WaitForChanged($ChangeTypes, $Timeout)\n     if ($result.TimedOut) { continue }\n     Backup-Folder\n\n} while ($true)\n</code></pre>"},{"location":"Examenes/Ordinaria/ExamenOrd/#ejercicio-1-60","title":"Ejercicio 1 (60%)","text":"<p>Analiza y describe con vuestras palabras (no copiar y pegar) y pormenorizadamnete, es decir todas sus instrucciones y concluye con la utilidad del mismo. Para ello tendr\u00e1s la ayuda que nos proporciona windows tanto online como offline.</p>"},{"location":"Examenes/Ordinaria/ExamenOrd/#ejercicio-2-40","title":"Ejercicio 2 (40%)","text":"<p>Modifica el mismo para que sea obligatorio la introducci\u00f3n como par\u00e1metro del directorio en cuesti\u00f3n es decir:</p> <pre><code>.\\script -dir \"c:\\user\"\n</code></pre> <p>Ejercicio Powershell</p> <p>Me ten\u00e9is que entregar dos ficheros el primero con las explicaciones en formato pdf y el segundo .ps1.</p> <p>Porcentaje de las notas</p> <p>Para este RA los porcentajes son las siguietentes: - Ejercicio 1 examen 50% - Ejercicio 2 examen 30% - Actividades 20%</p>"},{"location":"Examenes/Ordinaria/Requisitos/","title":"Final Ordinaria","text":""},{"location":"Examenes/Ordinaria/Requisitos/#requisitos","title":"Requisitos","text":"<p>A continuaci\u00f3n, se detallan las actividades que me ten\u00e9is que entregar asociadas a cada uno de los resultados de aprendizaje (RA) en cuesti\u00f3n. Con el objetivo de superar todos los RA.</p> <p>Warning</p> <p>Si ten\u00e9is ten\u00e9is ese RA aprobado no ten\u00e9is que entregarme las actividades pertenecientes a ese RA.</p> <p>Actividades Obligatorias que ten\u00e9is que superar y entregar:</p> Actividades RA Actividad 4.1 1 Actividad 3.2 2 RELACI\u00d3N 2-II 2 Actividad 2.3 3 RELACI\u00d3N 3-I 3 RELACI\u00d3N 3-III 3 RELACI\u00d3N 3-II 3 A\u00f1adir ubuntu a Active directory 4 Actividad 2.7 5 Actividad 2.8 5 Actividad 2.11 6 <p>Estas actividades ser\u00e1n entregadas en pdf o tendr\u00e1s que realizar los cuestionarios.</p> <p>Descripci\u00f3n del examen (Si y solo si ten\u00e9is el RA5 suspendido):</p> <p>Estar\u00e1 compuesto por dos ejercicios: un script sobre Linux y otro de Powershell. Todos ellos pertenecientes al RA5.</p> <p>Ejemplo</p> <p>Un alumno tiene s\u00f3lo suspendido el RA5 se tendr\u00e1 que presentar al examen y entregarme las actividades   Actividad 2.7, Actividad 2.8 en Aules en la secci\u00f3n Ordinaria.</p>"},{"location":"UD1/Actividades/","title":"Actividades de la UD1","text":""},{"location":"UD1/Actividades/#actividad-1-introduccion","title":"Actividad 1. Introducci\u00f3n","text":"<p>Si bien para nosotros ya es algo com\u00fan, originalmente el concepto de PC (acr\u00f3nimo de las palabras inglesas Personal Computer, es decir, Computadora Personal) era algo impensado, consider\u00e1ndose de que los primeros ordenadores pod\u00edan inclusive ocupar habitaciones enteras. Este t\u00e9rmino, si bien actualmente es un gen\u00e9rico para todos los equipos sin importar su fabricante o sistema operativo, en un principio pertenec\u00eda exclusivamente al ordenador llamado IBM Personal Computer, desarrollado por la firma IBM y comercializado a principios de los a\u00f1os '80, contando con un procesador Intel 8088 a 4,77 MHz y una memoria ROM de 64 Kb, algo que l\u00f3gicamente est\u00e1 m\u00e1s que obsoleto hoy en d\u00eda. En cuanto a los ordenadores en s\u00ed, podemos contar con la clasificaci\u00f3n actual en estos tipos de equipo:</p> <ul> <li>Ordenadores de Sobremesa: Los cl\u00e1sicos, tambi\u00e9n llamados De Escritorio, con su torre, monitor y perif\u00e9ricos.</li> <li>Ordenadores Port\u00e1tiles: Comprende al grupo de las Laptops, Netbooks, Notebooks y dem\u00e1s variantes.</li> <li>Ordenadores Todo en Uno: En el monitor integran todos los componentes de Hardware Internos, teniendo generalmente una Pantalla T\u00e1ctil para su control.</li> </ul> <p>El objetivo de estos ejercicios es tener una visi\u00f3n de los niveles que existen dentro de nuestro PC para as\u00ed, ir profundizando en nuestro conocimiento sobre este dispositivo.</p> <p>Visualiza el siguiente v\u00eddeo y responde a las preguntas del cuestionario de Introducci\u00f3n que est\u00e1 en aules. Se recomienda leer cada cuesti\u00f3n antes de visualizarlo, parar el v\u00eddeo si algo no se entiende para volver a verlo.</p>"},{"location":"UD1/Actividades/#actividad-2-teoria-de-la-estructura","title":"Actividad 2. Teor\u00eda de la Estructura","text":"<p>Responde al cuestionario de la estructura y caracterizaci\u00f3n. Este cuestionario solo ten\u00e9is tres intentos. Os servir\u00e1 para estudiar el tema.</p>"},{"location":"UD1/Actividades/#actividad-3-bios","title":"Actividad 3. BIOS","text":"<p>El manejo de la BIOS puede resultar en la p\u00e9rdida de prestaciones del equipo, al menos temporalmente. Por ese motivo es posible hacer esta pr\u00e1ctica de dos formas:</p> <ul> <li> <p>trabajando sobre un emulador de BIOS:</p> <ul> <li>https://www.grs-software.de/sims/bios/phoenix/pages/</li> <li>https://geekprank.com/bios/</li> </ul> </li> </ul> <p>sobre la BIOS/UEFI de un equipo real (si usas esta opci\u00f3n tendr\u00e1s que hacer fotos con tu dispositivo m\u00f3vil de la pantalla). Tan s\u00f3lo localiza las opciones pero no apliques los cambios. De este modo evitaremos problemas.</p> <p>Hay que tener en cuenta que algunas de las preguntas no las podr\u00e1s contestar al no existir dicha opci\u00f3n en la simulaci\u00f3n, pero ser\u00e1 suficiente para hacerse una idea de su funcionamiento.</p> <ol> <li>Al arrancar el PC, la BIOS ejecuta inmediatamente una serie de test, muy r\u00e1pidos, sobre el funcionamiento de los componentes del sistema. Estos test consumen una parte del tiempo de arranque de PC, de forma que se pueden deshabilitar en la BIOS, aunque conviene ejecutarlos de vez en cuando.    Deshabilita estos test iniciales buscando una entrada en la BIOS con el t\u00edtulo \"Quick Boot\", \"Quick POST\" o \"Quick Power on SelfTest\" y habilit\u00e1ndola.</li> <li>Es normal que los equipos est\u00e9n configurados para arrancar desde CD/DVD u otro dispositivo de almacenamiento antes de arrancar desde el disco duro. Su utilidad es importante, ya que nos permite arrancar desde un medio alternativo si nuestro sistema operativo no responde. Pero lo cierto es que podemos desactivar esta opci\u00f3n, pidiendo al ordenador que solo arranque desde el disco duro, ya que en caso de problemas, siempre podremos restaurar el arranque desde otro medio. Comprueba la secuencia de arranque en la BIOS y config\u00farala para arrancar directamente desde el disco duro.</li> <li>Es posible evitar las modificaciones no deseadas, limitando el acceso a la configuraci\u00f3n de la BIOS a personas no autorizadas. Es posible a\u00f1adir una contrase\u00f1a para impedir el acceso al sistema operativo a personas no autorizadas. Asigna una contrase\u00f1a de acceso al sistema.</li> <li>Si queremos que el ordenador detenga su arranque cuando se da cualquier problema en la ejecuci\u00f3n del POST. \u00bfQu\u00e9 opci\u00f3n debemos habilitar en la BIOS?</li> <li>Tras realizar varios cambios en la BIOS, te das cuenta de que el sistema no est\u00e1 funcionando correctamente. \u00bfQu\u00e9 opci\u00f3n tenemos para restaurar los valores por defecto del sistema y solucionar el problema?</li> </ol>"},{"location":"UD1/Actividades/#actividad-4-virtualizacion-virtual-box","title":"Actividad 4. Virtualizaci\u00f3n. Virtual Box","text":"<ol> <li> <p>Crea una m\u00e1quina virtual para cada uno de los siguientes sistemas operativos. Antes de crearlas se ha de tener en cuenta los requisitos con los que dispone el sistema anfitri\u00f3n y que, en circunstancias normales, ser\u00e1n necesarias dos de estas m\u00e1quinas encendidas a la vez. Debes planificar bien el consumo de recursos:</p> <ul> <li>una m\u00e1quina para un cliente con Microsoft Windows 10 Professional.</li> <li>una m\u00e1quina para un cliente con Ubuntu Desktop.</li> <li>una m\u00e1quina para un servidor con Microsoft Windows Server.</li> <li>una m\u00e1quina para contener un servidor con Ubuntu Server.</li> </ul> </li> <li> <p>Crea una red virtual interna NAT para cada servidor e introduce en ella todas las m\u00e1quinas virtuales separadas por sistemas operativos; los de Microsoft en una red y los de GNU/Linux en otra. Aseg\u00farate que las direcciones MAC de las tarjetas de red no se repitan.</p> </li> <li> <p>En las m\u00e1quinas virtuales que contienen un sistema operativo de red, configura una segunda tarjeta de red e instala un nuevo controlador SAS. Agrega un nuevo disco duro de 300 GB de capacidad al nuevo controlador y con expansi\u00f3n din\u00e1mica.</p> </li> <li> <p>Descarga las im\u00e1genes de los sistemas operativos cliente e instala cada uno de ellos en la m\u00e1quina virtual correspondiente. Deber\u00e1s instalar Microsoft Windows 10 Professional y Ubuntu Desktop siguiendo estas indicaciones:</p> <ul> <li>deber\u00e1s usar todo el disco duro para la instalaci\u00f3n</li> <li>el nombre de la m\u00e1quina queda a tu discreci\u00f3n</li> <li>instala las Guest Additions en cada m\u00e1quina, esto facilitar\u00e1 el trabajo con ellas</li> </ul> </li> <li> <p>Instala los sistemas operativos de red en la m\u00e1quina virtual correspondiente. Deber\u00e1s instalar Microsoft Windows Server y Ubuntu Server siguiendo estas indicaciones:</p> <ul> <li>deber\u00e1s usar todo el disco duro para la instalaci\u00f3n del sistema operativo Microsoft Windows</li> <li>crea dos particiones, una de ellas ser\u00e1 swap, durante el proceso de instalaci\u00f3n de Ubuntu Server</li> <li>el nombre de la m\u00e1quina queda a tu discreci\u00f3n</li> <li>instala las Guest Additions en cada m\u00e1quina, esto facilitar\u00e1 el trabajo con ellas</li> </ul> </li> <li> <p>Crea una carpeta compartida en cada m\u00e1quina virtual que conecte el directorio /home de tu usuario a una carpeta en el escritorio del usuario administrador. Se podr\u00e1 escribir en ella en todos los casos.</p> </li> <li>Realiza el clonado de las m\u00e1quinas que disponen de un sistema operativo de red.</li> <li>Realiza una clonaci\u00f3n enlazada de cada uno de los clientes. Estas nuevas m\u00e1quinas ser\u00e1n utilizadas para la realizaci\u00f3n de las actividades. Las m\u00e1quinas originales se guardar\u00e1n como copia de seguridad en caso necesario.</li> </ol>"},{"location":"UD1/Actividades/#actividades-de-refuerzo","title":"Actividades. De refuerzo.","text":"<ol> <li> <p>A\u00f1ade un nuevo disco duro virtual a las m\u00e1quinas virtuales que contendr\u00e1n los sistemas operativos de red. Estos discos tendr\u00e1n una capacidad de 1 TB, SATA y de expansi\u00f3n din\u00e1mica. Para hacerlo, sigue estos pasos:</p> <ul> <li> <p>Selecciona la m\u00e1quina \u2192  Configuraci\u00f3n  \u2192 Almacenamiento  \u2192 Controlador: SATA , bot\u00f3n derecho y seleccionar la opci\u00f3n Agregar disco duro </p> </li> <li> <p>en la ventana que aparece elegiremos  nuevo disco </p> </li> <li>cuando aparezca una nueva ventana, dale un nombre, selecciona el tama\u00f1o, tipo VDI y Reservado din\u00e1micamente</li> </ul> </li> <li> <p>Crea una nueva m\u00e1quina virtual para contener una segunda instalaci\u00f3n de Microsoft Windows Server que usaremos en lo sucesivo.     Para ello sigue estos pasos:</p> <ul> <li>selecciona la m\u00e1quina \u2192 Configuraci\u00f3n \u2192 Almacenamiento \u2192 Controlador: IDE, y selecciona el dispositivo virtual disponible (debe aparecer con la palabra \u201cVac\u00edo\u201d)</li> <li>despliega el icono del disco azul que aparece a la derecha y elige la opci\u00f3n Seleccione archivo de disco \u00f3ptico virtual..., busca la imagen que has descargado en tu ordenador (ver\u00e1s que su nombre aparece donde antes lo hac\u00eda la palabra \u201cVac\u00edo\u201d)</li> <li>ahora ve a Configuraci\u00f3n \u2192 Sistema y comprueba que la unidad \u00f3ptica est\u00e1 delante del disco duro en la secuencia de arranque. Si no es as\u00ed, modifica el orden con las flechas que aparecen a la derecha</li> <li>inicia la m\u00e1quina y sigue el asistente de instalaci\u00f3n del sistema operativo.</li> </ul> </li> </ol>"},{"location":"UD1/Actividades/#actividad-de-ampliacion","title":"Actividad. De Ampliaci\u00f3n.","text":"<ol> <li>Investiga el modo de utilizaci\u00f3n de los modos de medios virtuales inmutable, compartible y multiconexi\u00f3n. Identifica sus diferencias y pon un ejemplo de uso en cada caso.</li> <li>Para las m\u00e1quinas virtuales con un sistema operativo de red, encripta el disco duro principal. Recuerda que para ello deber\u00e1s instalar las herramientas de VirtualBox Extension Pack. Redacta una breve gu\u00eda de como se realizan estos pasos y s\u00fabela al Moodle del m\u00f3dulo.</li> <li> <p>Crea una plataforma de virtualizaci\u00f3n de nivel 1 con el sistema operativo PROXMOX siguiendo los siguientes pasos:</p> <ul> <li>descarga la imagen de instalaci\u00f3n desde su p\u00e1gina [web] (https://www.proxmox.com/en/)</li> <li>crea una m\u00e1quina virtual para PROXMOX e instala este sistema operativo</li> <li>configura la red como adaptador s\u00f3lo-anfitri\u00f3n</li> <li>accede a PROXMOX a trav\u00e9s del navegador web de la m\u00e1quina anfitri\u00f3n (puerto 8006)</li> <li>crea una m\u00e1quina virtual para contener uno de los servidores</li> </ul> </li> </ol> <p>Manera de entrega de las actividades</p> <p>Redacta una gu\u00eda de los pasos a seguir para realizar esta actividad y s\u00fabela al Moodle del m\u00f3dulo.   De tal forma que en cada uno de los pasos incluya una imagen que verifique que se ha realizado aquello que se pide en cada uno de los ejercicios.</p> <p>Ejemplo: En el Ejercicio 4 de la Actividad 3 cuando se debe instalar el sistema operativo, por ejemplo se podr\u00eda hacer una captura de pantalla cuando se ponga el nombre se usuario ,cuando se haga dos particiones como te indica el ejercicio y as\u00ed sucesivamente con los objetivos que te he marcado en ese ejercicio. De esta manera, demuestras que es tu m\u00e1quina y que has realizado aquello que te he pedido. NO TIENES QUE HACER CAPTURAS DE TODOS LOS PASOS.</p> <p>Warning</p> <p>SOLO LAS ACTIVIDADES 1,2,3,4,5 SON OBLIGATORIAS.</p>"},{"location":"UD1/Estructura/","title":"Estructura","text":""},{"location":"UD1/Estructura/#estructura-de-un-sistema-informatico","title":"Estructura de un sistema inform\u00e1tico","text":"<p>Un sistema inform\u00e1tico es un conjunto de elementos hardware, software y humanos dise\u00f1ados para un prop\u00f3sito en concreto. Todos estos elementos se relacionan entre s\u00ed creando sinergias orientadas al prop\u00f3sito para el que fue dise\u00f1ado y construido. Un ordenador que ejecuta un programa de contabilidad conforma en s\u00ed mismo un sistema inform\u00e1tico, pero tambi\u00e9n se puede formar un sistema inform\u00e1tico formado por cientos de ordenadores conectados en red. Dentro del sistema inform\u00e1tico existen, al menos, tres subsistemas que lo componen:</p> <ul> <li>El subsistema f\u00edsico o hardware</li> <li>El subsistema l\u00f3gico o software</li> <li>El subsistema humano</li> </ul> <p></p> <p>El primer subsistema, el f\u00edsico, est\u00e1 compuesto por todos aquellos elementos tangibles. Entre ellos hay que destacar los ordenadores (cada componente del equipo es una pieza del sistema), los perif\u00e9ricos, los elementos de interconexi\u00f3n (cableado, routers, switches, puntos de acceso) y aquellos que dotan de seguridad al sistema (SAI, paneles de acceso, c\u00e1maras de video-vigilancia entre otros). Se trata pues del esqueleto de nuestro sistema y va a determinar tanto la potencia de c\u00e1lculo del sistema como la capacidad operativa del mismo.</p> <p>El segundo subsistema lo componen todos los programas que se encuentran instalados en los equipos, servidores, elementos de interconexi\u00f3n y seguridad. Su cometido es la de ofrecer las herramientas necesarias para desempe\u00f1ar la funci\u00f3n del sistema inform\u00e1tico en el que est\u00e1 inmerso. Es un subsistema cr\u00edtico y es necesario mantenerlo actualizado con las \u00faltimas revisiones de software, especialmente en lo que se refiere al sistema operativo, controladores y software de seguridad. Este subsistema tambi\u00e9n se divide dependiendo de la funci\u00f3n del programa:</p> <ul> <li>Aplicaciones inform\u00e1ticas, que son las encargadas de ofrecer herramientas al subsistema humano para desempe\u00f1ar sus tareas. Aplicaciones como procesadores de texto, hojas de c\u00e1lculo, dise\u00f1o asistido por ordenador, cartograf\u00eda, compresi\u00f3n de archivos y un vasto etc\u00e9tera.</li> <li>firmware, que se encuentra integrado directamente en un dispositivo de hardware y que ofrece la posibilidad de configurar este dispositivo de manera muy concreta. El sistema BIOS (Basic Input Output System) de las placas base, la interfaz de los routers y/o switches o el acceso a las c\u00e1maras de seguridad son algunos ejemplos de este tipo de software.</li> <li>controladores (drivers), que son los encargados de identificar el hardware e informar de las caracter\u00edsticas del mismo al sistema operativo. El uso inadecuado de un controlador puede ocasionar que la capacidad de nuestro software quede mermada o inutilizada por completo.</li> <li>sistema operativo, encargado de transformar el hardware en recursos para ofrec\u00e9rselos a las aplicaciones. En los siguientes puntos trataremos este elemento de forma pormenorizada.</li> </ul> <p></p> <p>El tercero y no menos importante, lo forman el conjunto de usuarios que utilizar\u00e1n las herramientas que est\u00e1n a su disposici\u00f3n. De suma importancia es el perfil de estos usuarios y las competencias inform\u00e1ticas de las que dispongan. Existen diferencias en plantear un sistema para una empresa de desarrollo de aplicaciones en donde a los usuarios se les presupone unos altos conocimientos en inform\u00e1tica, que para una oficina de correos, en donde presumiblemente no los tendr\u00e1n.</p> <p>Otro factor muy importante es la formaci\u00f3n y educaci\u00f3n de los usuarios. Saber que acciones pueden o no pueden desempe\u00f1ar, c\u00f3mo actuar ante una posible amenaza, aprender a resolver ciertos problemas o realizar actividades formativas para utilizar un determinado programa, son solo algunas de las caracter\u00edsticas que el t\u00e9cnico encargado del sistema deber\u00e1 afrontar.</p> <p>En definitiva, el objetivo final del sistema inform\u00e1tico determinar\u00e1 la composici\u00f3n de cada una de sus partes as\u00ed como la relaci\u00f3n existente entre ellas. Tanto requerimientos de hardware, software como humanos no ser\u00e1n los mismos si se dise\u00f1a un sistema para una peque\u00f1a gestora de contabilidad o un laboratorio de investigaci\u00f3n. Es trabajo del t\u00e9cnico dotar a cada subsistema de las caracter\u00edsticas necesarias para dar servida cuenta de los objetivos a desempe\u00f1ar.</p> <p>La elecci\u00f3n de cada uno de estos elementos no solo debe estar orientada a la consecuci\u00f3n de los objetivos, sino a la compatibilidad entre los diferentes subsistemas. El sistema operativo debe ir en consonancia con las capacidades de c\u00f3mputo del hardware. Los programas deben ser compatibles con la elecci\u00f3n del sistema operativo. Deben existir controladores espec\u00edficos para este sistema operativo o el hardware no rendir\u00e1 seg\u00fan lo esperado. En definitiva, no resulta sencilla la conjunci\u00f3n de todos los elementos para que todo sistema funcione orquestado y d\u00e9 respuesta a las expectativas de los usuarios.</p> <p>Para ello, tan importante es el dise\u00f1o como el mantenimiento, revisi\u00f3n y actualizaci\u00f3n del sistema inform\u00e1tico. Esta tarea recaer\u00e1 en los t\u00e9cnicos cuya misi\u00f3n es establecer un programa de mantenimiento y revisi\u00f3n que consistir\u00e1 revisi\u00f3n de las actualizaciones de software (especialmente el de seguridad), comprobaci\u00f3n y limpieza del hardware, an\u00e1lisis del sistema de comunicaci\u00f3n para identificar posibles fallos o cuellos de botella, la formaci\u00f3n constante del subsistema humano, sobre todo en funciones de seguridad, revisi\u00f3n de los registros diarios del sistema y visor de eventos entre otras tareas. Es necesario la creaci\u00f3n de un plan de mantenimiento para prevenir un mal funcionamiento del sistema.</p>"},{"location":"UD1/Estructura/#el-sistema-operativo","title":"El Sistema Operativo","text":"<p>El ordenador es un sistema programable formado por un conjunto de elementos hardware que necesitan instrucciones que le indiquen c\u00f3mo utilizar los recursos. El conjunto de instrucciones o programas es lo que conocemos como software. Un ordenador sin software que lo programe no posee utilidad alguna, salvo la meramente decorativa. Un sistema operativo es un conjunto de programas que, ordenadamente relacionados entre s\u00ed, contribuyen a que el ordenador lleve a efecto el trabajo encomendado. Para realizar esta tarea, transforma el hardware disponible en recursos que ofrece al resto de componentes software para que puedan desempe\u00f1ar sus tareas. Pero ya no solo es el encargado de dotar de esos recursos al subsistema software, sino tambi\u00e9n al humano. Para cualquier usuario ser\u00eda costoso acceder directamente a los recursos que ofrece el hardware de un ordenador e intentar trabajar con \u00e9l directamente. Adem\u00e1s de la dificultad, una instrucci\u00f3n mal escrita podr\u00eda producir serios problemas en el hardware, la p\u00e9rdida de informaci\u00f3n o incluso el deterioro de alguno de los componentes del ordenador. Una tarea sencilla como guardar las modificaciones de un fichero, puede convertirse en una verdadera pesadilla para cualquier tipo de usuario. Por lo tanto, los sistemas operativos deben dotar de dos caracter\u00edsticas fundamentales para facilitar el uso del hardware de un ordenador:</p> <ul> <li>seguridad, debe actuar contra cualquier manipulaci\u00f3n accidental o premeditada que pueda da\u00f1ar la informaci\u00f3n contenida en el hardware, da\u00f1ar el propio hardware o provocar un funcionamiento indeseado del sistema. Existen ciertas instrucciones que pueden parar la m\u00e1quina y otras que realizan operaciones directamente sobre el hardware. El sistema operativo evita que el hardware quede en manos de los programas (aplicaciones). Para ello proporcionan dos estados, llamados estado protegido (kernel), en el cual se ejecuta el sistema operativo, y estado no protegido (usuario), que es el destinado a la ejecuci\u00f3n de los programas de aplicaci\u00f3n. De esta manera se impide que los programas puedan tener contacto directo con el hardware, o puedan forzar un incorrecto funcionamiento del sistema.</li> <li>abstracci\u00f3n, debe ocultar los detalles de m\u00e1s bajo nivel intentando dar a los niveles superiores una visi\u00f3n m\u00e1s sencilla, global y abstracta. Dota al usuario de operaciones para manipular dichas estructuras ocultas, desconociendo por completo la gesti\u00f3n interna de las mismas. Gracias a la abstracci\u00f3n, los sistemas operativos enmascaran los recursos f\u00edsicos, permitiendo su manejo con funciones m\u00e1s generales que ocultan las b\u00e1sicas, constituyendo verdaderos recursos virtuales.</li> </ul> <p></p> <ul> <li>Desde el punto de vista del usuario, el sistema operativo proporciona servicios que no est\u00e1n presentes en la m\u00e1quina subyacente. Estos servicios incluyen las facilidades de carga y ejecuci\u00f3n de programas, interacci\u00f3n entre el usuario y los programas, permitiendo que se ejecuten varios al mismo tiempo, gesti\u00f3n de la comunicaci\u00f3n y almacenamiento de datos y programas, entre otros muchos.</li> </ul>"},{"location":"UD1/Estructura/#arquitectura-de-un-sistema-operativo","title":"Arquitectura de un sistema operativo","text":"<p>Estas dos funciones principales de los sistemas operativos, seguridad y abstracci\u00f3n, nos adelantan la estructura funcional de la mayor\u00eda de los sistemas operativos existentes. Al igual que el resto de \u00e1mbitos de la inform\u00e1tica, los sistemas operativos ha sufrido una evoluci\u00f3n dependiente, principalmente, del hardware en el que se asentaban. Cada nueva estructura de procesador deb\u00eda tener su propio sistema operativo para poder acceder a las funciones que dispon\u00eda.</p> <p>Este hecho, ligado a que la evoluci\u00f3n de los procesadores y sus arquitecturas se realizaba de forma profusa, daba con la presencia de numerosos sistemas operativos. Adem\u00e1s, estos primeros sistemas operativos no estaban dotados de una capa de abstracci\u00f3n tan desarrollada como los actuales, por los que la curva de aprendizaje de los mismos era lenta y tediosa. Afortunadamente la diversidad de arquitecturas de los procesadores, componente que determina el uso de un sistema operativo u otro, se ha reducido considerablemente. Adem\u00e1s, los desarrolladores de sistemas operativos publican versiones diferentes para cada una de estas arquitecturas. De esta forma podemos contar con la misma capa de abstracci\u00f3n en diferentes procesadores, hecho que reduce al m\u00ednimo la curva de aprendizaje.</p>"},{"location":"UD1/Estructura/#arquitectura-monolitica","title":"Arquitectura monol\u00edtica","text":"<p>Los sistemas monol\u00edticos son la estructura m\u00e1s simple para un sistema operativo. Esta arquitectura fue escrita para proporcionar una m\u00e1xima funcionalidad y se caracteriza porque no tienen una estructura definida. Sus rutinas y funcionalidades (sistemas de archivos, gesti\u00f3n de memoria principal, gesti\u00f3n de procesos, etc\u00e9tera), se encuentran agrupados en un s\u00f3lo programa. Se trata de un conjunto de procedimientos o rutinas entrelazadas de tal forma que cada una tiene la posibilidad de llamar a las otras rutinas cada vez que as\u00ed lo requiera. Adem\u00e1s, todo el sistema al no tener una estructura definida, se ejecuta en el mismo nivel del n\u00facleo (kernel) lo que lo hace altamente vulnerable. Es por esta raz\u00f3n que cuando falla una de estas rutinas se produce un error en todo el sistema.</p> <p>Otro problema inherente es que si se modifica el hardware, se hace necesario recompilar el kernel para poder disponer de las nuevas funcionalidades, con el consumo de recursos que esta compilaci\u00f3n conlleva. Cada vez que un desarrollador a\u00f1ade una nueva caracter\u00edstica o corrige un error, significa que se necesitar\u00e1 hacer una recompilaci\u00f3n del n\u00facleo entero.</p> <p>El hecho de que en el espacio del kernel est\u00e1n incluidos todos los servicios b\u00e1sicos, tiene tres grandes inconvenientes:</p> <ul> <li>el tama\u00f1o del n\u00facleo, necesita m\u00e1s recursos del sistema para poder ser manejado y a medida que las exigencias crecen, \u00e9ste se convierte en un problema para el rendimiento del equipo.</li> <li>la falta de sostenibilidad, si se desea incluir nuevas funcionalidades se ha de recompilar todo el kernel, con el consumo de recursos pertinente.</li> <li>el dif\u00edcil mantenimiento, al igual que en el punto anterior, si se quiere revisar un error o cambiar alguna funcionalidad, se ha de recompilar todo el c\u00f3digo del n\u00facleo.</li> </ul> <p></p> <p>Actualmente, y a pesar de sus limitaciones, se siguen utilizando esta arquitectura como en sistemas operativos ad-hoc para algunos procesos de mecanizaci\u00f3n industrial, o en algunas distribuciones GNU/Linux. Algunos de los sistemas operativos monol\u00edticos son Unix, DOS, MacOS hasta su versi\u00f3n 8.6, GNU/Linux y dentro de la familia de Microsoft; Microsoft Windows 95, Microsoft Windows 98, Windows 98 Second Edition y Windows Millenium Edition.</p>"},{"location":"UD1/Estructura/#la-arquitectura-de-micronucleo-o-microkernel","title":"La arquitectura de Micron\u00facleo o Microkernel","text":"<p>En este sistema las funciones vitales son manejadas por el n\u00facleo (kernel) y la interfaz de usuario es manejada por el entorno (shell). Ahora la diferenciaci\u00f3n entre n\u00facleo y shell se hace m\u00e1s patente ya que, en el modelo anterior, estas partes conviv\u00edan dentro del n\u00facleo. El Microkernel se encarga de todo el c\u00f3digo de un sistema, y de planificar los procesos e hilos (threads) con la finalidad de tener multitareas. Consiste en reducir el n\u00famero de partes del sistema operativo que se ejecutan en modo kernel, de esta forma el n\u00facleo del sistema operativo se hace m\u00e1s ligero.</p> <p>Dentro de esta estructura aparece el sistema cliente-servidor el cual hace la diferencia entre dos clases de procesos: los servidores (ubicados en el microkernel), cada uno de los cuales proporciona cierto servicio, y los clientes, que utilizan estos servicios.</p> <p>Esta arquitectura ofrece uniformidad de interfaces basada en el paso de mensajes. Es un modo de comunicaci\u00f3n para las solicitudes de los procesos. Si varios procesos deben solicitar al n\u00facleo alg\u00fan recurso, utilizar\u00e1n la misma forma de comunicaci\u00f3n por lo que ser\u00e1 m\u00e1s f\u00e1cil implementar nuevas funcionalidades.</p> <p>Adem\u00e1s, se reduce el n\u00facleo a instrucciones m\u00ednimas quedando la gesti\u00f3n de tareas casi todo en servidores. Para implementarlo en arquitecturas diferentes, s\u00f3lo hay que modificar el kernel reduciendo los costes de portabilidad. Tan s\u00f3lo es necesario modificar el peque\u00f1o n\u00facleo, dejando los servidores intactos. Esto tambi\u00e9n favorece la fiabilidad del sistema operativo, ya que es m\u00e1s f\u00e1cil corregir un sistema peque\u00f1o y se pueden realizar pruebas m\u00e1s rigurosas y r\u00e1pidas que en un sistema mucho m\u00e1s grande.</p> <p></p> <p>Algunos sistemas operativos que usan esta arquitectura son Minix de Andrew S. Tanenbaum y Symbian de Nokia.</p>"},{"location":"UD1/Estructura/#la-arquitectura-por-capas-o-jerarquica-estructura-por-niveles","title":"La arquitectura por capas o jer\u00e1rquica (estructura por niveles)","text":"<p>Esta estructura queda definido por divisiones en capas o niveles, cuya organizaci\u00f3n es una jerarqu\u00eda de capas donde cada una de ellas ofrece una interfaz (comunicaci\u00f3n) clara y bien definida. En esta arquitectura la capa superior s\u00f3lo utiliza los servicios y funciones que ofrece la capa inferior, es decir, la capa n \u00fanicamente se comunica con la capa n-1 . La capa m\u00e1s interna o inferior (capa 0) corresponde al hardware, mientras que la m\u00e1s alta o externa corresponde a la interfaz de usuario donde se ejecutan los programas. Cuando la capa se encuentra m\u00e1s cerca de la capa 0, \u00e9sta tiene m\u00e1s privilegios que la capa superior, siendo la capa con menos privilegios la capa 5. El primer sistema construido de esta manera fue el sistema THE (Technische Hogeschool Eindhoven), desarrollado en Holanda por E. W. Dijkstra (1968) y sus estudiantes. El sistema original consta de 6 capas:</p> <ul> <li>capa 5, se encuentra la interfaz de usuario.</li> <li>capa 4, aloja los programas de usuario.</li> <li>capa 3, controla los dispositivos entrada y salida.</li> <li>capa 2, administra la comunicaci\u00f3n entre procesos y terminal.</li> <li>capa 1, administraci\u00f3n de memoria y discos.</li> <li>capa 0, correspondiente al hardware, realizando asignaci\u00f3n del procesador, alterna entre procesos cuando ocurren interrupciones o han expirado y proporciona multiprogramaci\u00f3n b\u00e1sica de la CPU.</li> </ul> <p></p> <p>La facilidad de construcci\u00f3n viene dada por la existencia de esta divisi\u00f3n en capas, de esta forma se produce una abstracci\u00f3n del problema, centr\u00e1ndose s\u00f3lo en la funci\u00f3n que realiza el m\u00f3dulo correspondiente a una capa n. No es necesario saber detalles de implementaci\u00f3n de las capas inferiores, s\u00f3lo conocer el modo en que se comunican, es decir, su interface. Adem\u00e1s, resulta m\u00e1s sencillo detectar errores ya que estos quedan adscritos a una capa determinado, exonerando al resto.</p> <p>Otro aspecto positivo relacionado con la estructura por capas, es que cuando ocurre un error o fallo en una de las capas, no se compromete a todo el sistema, s\u00f3lo a la capa relacionada con dicho error. De esta forma el sistema operativo es m\u00e1s robusto.</p>"},{"location":"UD1/Estructura/#arquitectura-por-modulos","title":"Arquitectura por m\u00f3dulos","text":"<p>La mayor\u00eda de los sistemas operativos actuales implementan este enfoque. Lo que caracteriza este tipo de estructura es que el kernel se compone por m\u00f3dulos, y cada uno de estos m\u00f3dulos se encuentra separado de forma independiente. En caso de producirse un error, no afecta a los otros. Por ejemplo, si el m\u00f3dulo de software que se encarga del proceso del navegador se bloquea o es atacado, s\u00f3lo este proceso se ver\u00e1 afectado. El resto de las operaciones siguen sus funciones habituales. Los m\u00f3dulos se pueden cargar din\u00e1micamente en el n\u00facleo cuando se necesiten, bien en en tiempo de ejecuci\u00f3n (manual) o bien durante el arranque del sistema (autom\u00e1tico). El kernel dispone de los componentes fundamentales y se conectan directamente con los m\u00f3dulos.</p> <p>En general, esta estructura se parece bastante a la de capas, pero es mucho m\u00e1s flexible ya que cualquier m\u00f3dulo de esta estructura puede llamar a otro y no quedar limitado a sus capas adyacentes. El kernel de esta arquitectura tambi\u00e9n tiene las funciones esenciales, pero este es m\u00e1s eficiente ya que no necesita un mecanismo de paso de mensajes para comunicarse, s\u00f3lo interfaces conocidas y bien definidas. Todos los sistemas operativos utilizan esta arquitectura en mayor o menor medida, incluso aquellos que han apostado por una arquitectura diferente, han tomado aspectos de \u00e9sta para implementar sus funciones. GNU/Linux, por ejemplo, est\u00e1 basado y clasificado en la tecnolog\u00eda monol\u00edtica basado en un kernel potente y r\u00e1pido, pero tambi\u00e9n incluye caracter\u00edsticas cliente-servidor y modulares. Esto nos conduce, irremediablemente a la definici\u00f3n de una arquitectura que no es ninguna es s\u00ed misma, sino la uni\u00f3n de varias de ellas; la h\u00edbrida.</p>"},{"location":"UD1/Estructura/#hibridas","title":"H\u00edbridas","text":"<p>Actualmente no existen una arquitectura \u00fanica para implementar todas las funcionalidades de los sistemas operativos modernos. Se habla de una arquitectura h\u00edbrida basada en el uso de ciertas caracter\u00edsticas de varias de las existentes. El uso de unas u otras caracter\u00edsticas depender\u00e1 de los desarrolladores aunque en el grueso de los casos se trata del uso de la estructura cliente-servidor, jerarquizada y con un kernel modular. Buen ejemplo son los sistemas operativos de la familia de Microsoft. Desde Microsoft Windows XP lanzado en el a\u00f1o 2001 hasta Microsoft Windows 10 en 2015.</p>"},{"location":"UD1/Estructura/#evolucion-de-los-sistemas-operativos","title":"Evoluci\u00f3n de los sistemas operativos","text":"<p>Los sistemas operativos han estado estrechamente ligados con las sucesivas evoluciones del hardware. Por ese motivo al hablar de la evoluci\u00f3n del hardware en la inform\u00e1tica tambi\u00e9n se hace referencia a la evoluci\u00f3n de los sistemas operativos que lo acompa\u00f1aban. No hay unanimidad en cuanto al n\u00famero y duraci\u00f3n de las generaciones de sistemas operativos, a\u00fan as\u00ed la mayor\u00eda hablan de cinco generaciones:</p>"},{"location":"UD1/Estructura/#generacion-cero","title":"Generaci\u00f3n Cero","text":"<p>A finales de los a\u00f1os 40 aparece de la primera generaci\u00f3n de ordenadores. En ellos se acced\u00eda directamente a la consola desde la cual se actuaba sobre una serie de micro interruptores que permit\u00edan introducir directamente el programa en la memoria del ordenador. En realidad al existir tan pocas unidades de estos ordenadores, todos podr\u00edan considerarse prototipos y cada constructor lo hac\u00eda sin seguir ning\u00fan criterio predeterminado. En estos momentos no exist\u00edan los sistemas operativos, y los programadores deb\u00edan interactuar con el hardware del ordenador sin ayuda externa. Esto hac\u00eda que el tiempo de preparaci\u00f3n para realizar una tarea fuera considerable, con la intenci\u00f3n de tener el programa listo antes de llegar a introducirlo en la m\u00e1quina.</p> <p>Cuando a un usuario le llegaba su tiempo de m\u00e1quina, ten\u00eda que apresurarse a introducir en el ordenador todas las fichas perforadas que conformaban su programa, ejecutarlo en el ordenador, vigilar su funcionamiento y esperar a que todas las operaciones terminaran.</p> <p>Aparece la figura del \u201coperador del ordenador\u201d, personas especializadas en ejecutar las rutinas de carga y descarga, con el fin de mantener el sistema con la m\u00e1xima ocupaci\u00f3n posible. De esta forma, al recibir dichos trabajos, los reun\u00eda y ejecutaba de forma secuencial consumiendo \u00fanicamente el tiempo que realmente necesitasen y evitando, en gran medida, los tiempos de inactividad del procesador.</p> <p></p>"},{"location":"UD1/Estructura/#primera-generacion","title":"Primera Generaci\u00f3n","text":"<p>A principios de los a\u00f1os 50 con el objeto de facilitar la interacci\u00f3n entre persona y ordenador, es decir, a\u00f1adir una capa de abstracci\u00f3n para aislar al usuario de ciertas tareas del ordenador, los sistemas operativos hacen una aparici\u00f3n discreta y bastante simple. Se empieza a trabajar en conceptos tales como el monitor residente, el proceso por lotes y el almacenamiento temporal.</p> <ul> <li> <p>Monitor residente, su funcionamiento era bastante simple, se limitaba a cargar los programas en memoria, ley\u00e9ndolos de una cinta o de tarjetas perforadas, y ejecutarlos. El problema era encontrar una forma de optimizar el tiempo entre la retirada de un trabajo y el montaje del siguiente.</p> </li> <li> <p>Procesamiento por lotes, aparece como soluci\u00f3n para optimizar, en un mismo n\u00facleo de cinta o conjunto de tarjetas, la forma que se ejecutar\u00e1n uno a continuaci\u00f3n de otro sin perder apenas tiempo en la transici\u00f3n.</p> </li> <li>Almacenamiento temporal, cuyo objetivo era disminuir el tiempo de carga de los programas, haciendo simult\u00e1nea la carga del programa o la salida de datos con la ejecuci\u00f3n de la siguiente tarea. Para ello se utilizaban t\u00e9cnicas de buffering.</li> </ul> <p></p>"},{"location":"UD1/Estructura/#segunda-generacion","title":"Segunda Generaci\u00f3n","text":"<p>Iniciada la d\u00e9cada de los 60, aparece el circuito integrado que incrementa la capacidad de procesado de los ordenadores existentes. A la par, aparecen varias t\u00e9cnicas de computo para optimizar esa nueva potencia de la que se dispon\u00eda.</p> <p>Una de ellas era la multiprogramaci\u00f3n. En estos sistemas la memoria principal alberga a m\u00e1s de un programa de usuario y los va reproduciendo de forma secuencial. Cuando un programa accede al procesador, se le asigna de forma \u00fanica. Pero cada uno de estos programas no s\u00f3lo estaba compuesto de accesos al procesador, sino que hab\u00eda operaciones de E/S (entrada salida) en las que el procesador permanec\u00eda ociosa. En lugar de esperar a que termine la operaci\u00f3n de E/S, se pasa a ejecutar otro programa. Si \u00e9ste realiza, a su vez, otra operaci\u00f3n de E/S, se mandan las \u00f3rdenes oportunas al controlador, y pasa a ejecutarse otro. De esta forma es posible, teniendo almacenado un conjunto adecuado de tareas en cada momento, utilizar de manera \u00f3ptima los recursos disponibles.</p> <p>El multiprocesador y multihilado tambi\u00e9n son t\u00e9cnicas que aparecieron en esta generaci\u00f3n. La primera hace referencia al uso de m\u00e1s de un procesador de forma simultanea. La segunda en dividir el programa en varios subprogramas que se puedan ejecutar de forma simult\u00e1nea. </p>"},{"location":"UD1/Estructura/#tercera-generacion-anos-70-y-80","title":"Tercera Generaci\u00f3n (a\u00f1os 70 y 80)","text":"<p>Durante los a\u00f1os 70 y 80, y gracias al avance de la electr\u00f3nica se empezaron a crear circuitos con miles de transistores en un cent\u00edmetro cuadrado de silicio, lo que conducir\u00eda a producir los primeros sistemas integrados.</p> <p>Por lo que respecta a los sistemas operativos, se realiz\u00f3 un costoso trabajo para interponer una amplia capa de software entre el usuario y la m\u00e1quina, de forma que el primero no tuviese que conocer ning\u00fan detalle del hardware. Hasta entonces, el usuario deb\u00eda conocer un complejo lenguaje de control para realizar sus trabajos que depend\u00edan del la m\u00e1quina d\u00f3nde trabajara. Se empez\u00f3 decididamente a crear los primeros int\u00e9rpretes de comandos que facilitaban la tarea de controlar estas m\u00e1quinas. En definitiva, se empez\u00f3 a a\u00f1adir una capa de abstracci\u00f3n al hardware que reduc\u00eda la rapidez de las aplicaciones, pero se volv\u00edan m\u00e1s pr\u00e1cticos y simples para los usuarios.</p> <p>Otro avance importante que se estableci\u00f3 a mediados de la d\u00e9cada de 1980 fue el desarrollo de redes de computadoras personales que corr\u00edan sistemas operativos en red y sistemas operativos distribuidos.</p> <p>Esta d\u00e9cada se podr\u00eda definir como la de los sistemas de prop\u00f3sito general y en ella se desarrollan tecnolog\u00edas que se siguen utilizando en la actualidad. Es en esta generaci\u00f3n cuando se produce la proliferaci\u00f3n de los miniordenadores y la inform\u00e1tica se acerca al nivel de usuario. Surgen sistemas operativos tales como MULTICS (Multiplexed Information and Computing Service) y BDOS (Basic Disk Operating System), aunque fueron dos los que se usaban de forma mayoritaria. El primero fue MS-DOS (Microsoft Disk Operating System) que fue creado para IBM PC y el exitosos procesador 8088 de Intel. El segundo fue Unix que dominaba en los ordenadores que usaban el procesador Motorola 68000.</p> <p>IBM trat\u00f3, con su sistema operativo OS/2, de suceder a DOS como sistema operativo de los ordenadores. Se desarroll\u00f3 inicialmente de manera conjunta entre Microsoft e IBM, hasta que la primera decidi\u00f3 seguir su camino con su Windows e IBM se ocup\u00f3 en solitario de OS/2. Este sistema operativo ya no es comercializado por IBM, y su soporte se suspendi\u00f3 el 31 de diciembre de 2006. Se ha mantenido desde entonces con pocas novedades bajo el nombre eComStation.</p> <p>En 1984 se produjo el lanzamiento oficial del ordenador Macintosh, con un precio de 1.995 d\u00f3lares estadounidenses. Inclu\u00eda su sistema operativo Mac OS cuya caracter\u00edsticas novedosas era una GUI (Graphic User Interface), multitareas (usando la multiprogramaci\u00f3n) y rat\u00f3n (una novedad en la \u00e9poca). Provoc\u00f3 diversas reacciones entre los usuarios acostumbrados a la l\u00ednea de comandos ya que tan s\u00f3lo se conoc\u00eda este sistema para interactuar con el ordenador.</p> <p></p> <p>En definitiva, es en esta generaci\u00f3n cuando la inform\u00e1tica llega a los hogares gracias principalmente a un aumento de potencia de procesado y la creaci\u00f3n de una capa de abstracci\u00f3n que evitaba al usuario conocer la m\u00e1quina para darle instrucciones.</p>"},{"location":"UD1/Estructura/#cuarta-generacion","title":"Cuarta generaci\u00f3n","text":"<p>A partir de la d\u00e9cada de los 90, se incorporan con una mayor o menor eficiencia diferentes t\u00e9cnicas, algunas descritas en este apartado; multiproceso, multiusuario, multitarea, abstracci\u00f3n, seguridad, integraci\u00f3n con redes entre otras. Un hecho fundamental en este etapa es la creaci\u00f3n de un sistema operativo libre. Hasta la fecha la mayor\u00eda de sistemas operativos se creaban para una arquitectura de m\u00e1quina determinada y se vend\u00eda con el hardware, hecho que se mantiene hasta la actualidad, aunque est\u00e1n tomando forma otro tipo de distribuciones.</p> <p>Impulsada por Richard Stallman y motivado por esta idea comienza la construcci\u00f3n y desarrollo de las herramientas elementales que componen un sistema operativo, a esta parte del desarrollo se le conoce como proyecto GNU (GNU is Not Unix).</p> <p>Esta etapa cuenta con la colaboraci\u00f3n de miles de programadores a nivel mundial. En 1991 aparece la primera versi\u00f3n del n\u00facleo Linux que fue creado por Linus Torvalds y consegu\u00eda ensamblar todas las herramientas elementales creadas por el proyecto GNU de una manera eficiente. De esta forma el proyecto termina llam\u00e1ndose GNU/Linux, dando un 50% de importancia a ambas partes.</p> <p>Otro hito importante en este per\u00edodo fue la aparici\u00f3n de Windows 95 que se le puede considerar un sistema operativo real, ya que Windows 3.11 s\u00f3lo era una interfaz gr\u00e1fica del MS-DOS. Microsoft es hoy en d\u00eda la propietaria de los sistemas operativos m\u00e1s difundido en el \u00e1mbito dom\u00e9stico y profesional.</p> <p>En 2009 Google anuncia su propio sistema operativo, el cual es nombrado Google Chrome OS (o simplemente abreviado Chrome OS). Es un sistema operativo diferente a lo que se conoce com\u00fanmente como sistema operativo de escritorio, siendo el navegador Google Chrome el centro sobre el que gira su uso. Est\u00e1 dise\u00f1ado de tal forma que el usuario pueda conectarse a Internet en cuesti\u00f3n de segundos. Contar\u00e1 con soporte para procesadores x86 y ARM, y con el soporte de una gran lista de fabricantes de hardware y software. Adem\u00e1s, es de c\u00f3digo libre, es decir, el c\u00f3digo fuente se encuentra disponible para todos los usuarios (este concepto se tratar\u00e1 en la siguiente unidad).</p> <p>Una de las tendencias actuales es la creaci\u00f3n de sistemas operativos que integren todos los dispositivos que un usuario utiliza a diario. Con esta iniciativa nace Windows 10 en 2015 que, haciendo uso de Internet, es capaz de mantener sincronizados varios dispositivos con los mismos datos de usuario.</p>"},{"location":"UD1/Estructura/#funciones-de-los-sistemas-operativos","title":"Funciones de los sistemas operativos","text":"<p>Atendiendo a la definici\u00f3n de sistema operativo, ser\u00eda interminable enumerar sus funciones. No obstante, haciendo una labor de s\u00edntesis se pueden destacar las siguientes:</p>"},{"location":"UD1/Estructura/#gestion-de-procesos","title":"Gesti\u00f3n de procesos","text":"<p>Un proceso es un recurso necesario para que un programa haga la tarea que el usuario u otro programa le haya encomendado. Estos elementos deben estar contenidos en la memoria principal y contar con acceso al procesador. El sistema operativo, para encargarse de su buen funcionamiento, se dedica a crear y destruir procesos, pararlos y reanudarlos y ayudar con los mecanismos de comunicaci\u00f3n entre ellos.</p>"},{"location":"UD1/Estructura/#gestion-de-la-memoria-principal","title":"Gesti\u00f3n de la memoria principal","text":"<p>La memoria es un almac\u00e9n de datos vol\u00e1til compartido por el procesador y las aplicaciones. Toda aplicaci\u00f3n (proceso) que se est\u00e9 ejecutando debe estar contenida en la memoria principal. De este modo la comunicaci\u00f3n con el procesador se realiza de forma m\u00e1s r\u00e1pida. El sistema operativo se asegura de que parte de la memoria est\u00e1 siendo utilizada, decide d\u00f3nde se colocan los procesos cuando haya un hueco libre y asigna y reclama el espacio que sea necesario para que se optimice este recurso.</p>"},{"location":"UD1/Estructura/#gestion-de-la-memoria-secundaria","title":"Gesti\u00f3n de la memoria secundaria","text":"<p>Al igual que con la memoria principal, el sistema operativo se encarga de gestionar el espacio libre y asigna el orden de guardado. Utiliza el sistema de ficheros para gestionar el dispositivo de almacenamiento no vol\u00e1til (discos duros, lectores \u00f3pticos o almacenamiento en la nube). La informaci\u00f3n contenida en esta memoria, ha de ser transferida a la memoria principal para ser procesada. Esto es debido a la escasa velocidad de lectura y escritura que estos dispositivos poseen.</p>"},{"location":"UD1/Estructura/#gestion-de-dispositivos","title":"Gesti\u00f3n de dispositivos","text":"<p>Tiene como objetivo proporcionar una interfaz de alto nivel de los dispositivos de E/S sencilla de utilizar. En algunos sistemas operativos esta interfaz es semejante a la de los ficheros, como por ejemplo en GNU/Linux.</p>"},{"location":"UD1/Estructura/#clasificacion-de-los-sistemas-operativos","title":"Clasificaci\u00f3n de los sistemas operativos","text":"<p>Existen numerosas clasificaciones de los sistemas operativos atendiendo a muy diversos factores como la forma de ofrecer sus servicios, el n\u00famero de usuarios simult\u00e1neos, el n\u00famero de tareas que es capaz de ejecutar o su estructura interna.</p>"},{"location":"UD1/Estructura/#tipos-segun-su-estructura-interna","title":"Tipos seg\u00fan su estructura interna","text":"<p>Hacen referencia a la arquitectura que lo compone y, como ya se ha visto con anterioridad, consta de los siguientes elementos: monol\u00edticos, con microkernel, jerarquizados, modulares o h\u00edbridos. La mayor\u00eda de los sistemas operativos actuales se enmarcan dentro de este \u00faltimo apartado.</p>"},{"location":"UD1/Estructura/#tipos-en-funcion-del-manejo-de-recursos","title":"Tipos en funci\u00f3n del manejo de recursos","text":"<ul> <li>Centralizado, permite la administraci\u00f3n de los recursos de un solo ordenador. Pr\u00e1cticamente todos los sistemas operativos comerciales lo son de este tipo.</li> <li>Distribuido, permite la administraci\u00f3n de los recursos de m\u00e1s de un ordenador de forma simult\u00e1nea, es la uni\u00f3n l\u00f3gica de un grupo de sistemas operativos sobre una colecci\u00f3n de ordenadores independientes, conectados en red y f\u00edsicamente separados. Cada ordenador contiene de forma individual un subconjunto espec\u00edfico de los programas que componen el sistema operativo distribuido. Este tipo de sistemas es altamente complicado de gestionar e implementar por lo que su uso queda adscrito a tareas muy concretas. Los primeros sistemas distribuidos fueron el DYSEAC en 1954 y el Lincoln TX-2000.</li> </ul>"},{"location":"UD1/Estructura/#tipos-en-funcion-de-la-administracion-de-tareas-y-usuarios","title":"Tipos en funci\u00f3n de la administraci\u00f3n de tareas y usuarios","text":"<p>Es la clasificaci\u00f3n m\u00e1s com\u00fanmente usada y conocida desde el punto de vista del usuario. Seg\u00fan el n\u00famero de usuarios:</p> <ul> <li>monousuario, soportan a un usuario de forma simult\u00e1nea, sin importar el n\u00famero de procesadores que tenga el ordenador o el n\u00famero de procesos o tareas que el usuario pueda ejecutar en un mismo instante de tiempo.</li> <li>multiusuario, dan servicio a m\u00e1s de un usuario a la vez, ya sea por medio de varias terminales conectadas a el ordenador o por medio de sesiones remotas en una red de comunicaciones. No importa el n\u00famero de procesadores en la m\u00e1quina ni el n\u00famero de procesos que cada usuario puede ejecutar simult\u00e1neamente.</li> </ul> <p>Seg\u00fan el n\u00famero de procesos (tareas) realizados de forma simult\u00e1nea:</p> <ul> <li>monotarea, s\u00f3lo permiten una tarea de forma simult\u00e1nea (al margen de los procesos propios del sistema operativo). Si se quiere ejecutar otra tarea habr\u00e1 que esperar a finalizar la actual o interrumpirla. Todos los recursos del sistema son para esta tarea en el momento de su ejecuci\u00f3n. Resulta ineficaz ya que si esta tarea entra en bucle, es posible que el usuario nunca recupere el control del sistema.</li> <li>multitarea, permiten al usuario estar realizando varios procesos simult\u00e1neamente. Este tipo de sistemas operativos normalmente asigna los recursos disponibles de forma alternada a los procesos que los solicitan, de manera que el usuario percibe que todos funcionan de forma concurrente. Es com\u00fan encontrar en ellos interfaces gr\u00e1ficas orientadas al uso de men\u00fas y el rat\u00f3n, lo cual permite un r\u00e1pido intercambio entre las tareas para el usuario, mejorando su productividad.</li> </ul> <p>Seg\u00fan el n\u00famero de procesadores que es capaz de manejar:</p> <ul> <li>monoproceso, es capaz de manejar solamente un procesador, de manera que si el ordenador tuviese m\u00e1s de uno, le ser\u00eda in\u00fatil.</li> <li>multiproceso, puede de manejar m\u00e1s de un procesador en el sistema, distribuyendo la carga de trabajo entre todos los procesadores que existan en el sistema. Generalmente estos sistemas trabajan de dos formas:</li> <li>asim\u00e9tica, el sistema operativo selecciona a uno de los procesadores el cual jugar\u00e1 el papel de procesador maestro y servir\u00e1 como pivote para distribuir la carga a los dem\u00e1s procesadores, que reciben el nombre de esclavos o secundarios.</li> <li>sim\u00e9trica, los procesos son enviados indistintamente a cualquiera de los procesadores disponibles, teniendo, te\u00f3ricamente, una mejor distribuci\u00f3n y equilibrio en la carga de trabajo bajo este esquema.</li> </ul> <p>Un aspecto importante a considerar en estos sistemas es la forma de crear aplicaciones para aprovechar varios procesadores. Las aplicaciones programadas para correr en sistemas monoproceso no ofrecen ninguna ventaja a menos que el sistema operativo detecte secciones de c\u00f3digo paralelizable, los cuales son ejecutados al mismo tiempo en procesadores diferentes.</p> <p>Por otro lado, el programador puede modificar sus algoritmos y aprovechar por s\u00ed mismo esta facilidad. Esta opci\u00f3n, muy a menudo, es muy costosa y tediosa, obligando al programador a ocupar gran parte del tiempo de desarrollo a la paralelizaci\u00f3n.</p>"},{"location":"UD1/Estructura/#tipos-en-funcion-del-modo-de-ofrecer-sus-recursos","title":"Tipos en funci\u00f3n del modo de ofrecer sus recursos","text":"<p>Esta clasificaci\u00f3n est\u00e1 basada en la estructura de explotaci\u00f3n de sistemas cliente-servidor. En ella existen ordenadores en el sistema que ofrecen y administran recursos a otros equipos. Por otra parte tambi\u00e9n existen otros equipos que usan estos servicios para llevar a cabo sus tareas.</p> <p>Esta explotaci\u00f3n de sistemas empez\u00f3 a cobrar importancia con la proliferaci\u00f3n de las redes de ordenadores. Las ventajas de usar estas t\u00e9cnicas son evidentes, pero tambi\u00e9n exceden de las intenciones de este apartado:</p> <p>-sistemas operativos de red, permite la interconexi\u00f3n de ordenadores para poder acceder a los servicios y recursos, hardware y software, creando redes de computadoras. Estos sistemas operativos centralizan los recursos, administran el acceso a la informaci\u00f3n, protegen los datos y establecen pautas de seguridad que el resto de ordenadores de la red debe aceptar. Esta configuraci\u00f3n se denomina servicios de directorio y se abordar\u00e1 de forma profusa en lo sucesivo.</p> <p>-sistemas operativos cliente, permite al acceso a los recursos compartidos administrados por un sistema operativo de red.</p> <p>Frecuentemente son los denominados \u201cde escritorio\u201d y deben cumplir los requerimientos de la red en la que se encuentran inmersos.</p> <p>La relaci\u00f3n entre estos dos tipos de sistemas operativos es el objetivo fundamental de este m\u00f3dulo y se tratar\u00e1 de forma pormenorizada en las siguientes unidades.</p>"},{"location":"UD1/Estructura/#tipos-de-aplicaciones","title":"Tipos de aplicaciones","text":"<p>No resulta sencillo la clasificaci\u00f3n de todo el tipo de software que existe en la actualidad, ya que cada uno de estos programas responde a una necesidad espec\u00edfica, posee una arquitectura diferente o un dise\u00f1o tan personalizado que no encajar\u00eda en ninguna clasificaci\u00f3n posible. No obstante, s\u00ed es posible agrupar la mayor\u00eda del software, a grandes rasgos, dependiendo de la posici\u00f3n que ocupen con respecto al sistema operativo:</p> <ul> <li>software de sistemas, encargados de la gesti\u00f3n del hardware de forma directa o a la creaci\u00f3n de herramientas para el desarrollo de software, ya sea de sistemas o de aplicaci\u00f3n.</li> <li>sistemas operativos, como ya se ha visto, es el software encargado de la administraci\u00f3n de los recursos y la seguridad.</li> <li>firmware, software integrado en el propio hardware que controla. Se trata de una serie de instrucciones que ofrece al sistema operativo para que \u00e9ste pueda ser controlado.</li> <li>controladores, definen lo que un hardware es capar de hacer. Es preciso que el sistema operativo entienda lo que el controlador le comunica, por ese motivo existen diferentes versiones de controladores, casi una por sistema operativo.</li> <li>desarrollo de sistemas, es el software encargado de crear aplicaciones nuevas que resuelvan una tarea en concreto</li> <li>software de aplicaci\u00f3n, todo el software que permite realizar alguna tareas que no coincida con las descritas con anterioridad. Esta categor\u00eda representa casi el 90 % del software y es posible dividirlo en dos grandes grupos:</li> <li>aplicaciones de prop\u00f3sito general, elaborado para resolver problemas generales y que habitualmente es el usuario el que debe adaptarse al funcionamiento de este software. Actualmente ofrece innumerable opciones de configuraci\u00f3n y personalizaci\u00f3n capaces de adaptar casi cualquier comportamiento. Se trata de aplicaciones como procesadores de texto, editores de im\u00e1genes, video o audio, gesti\u00f3n de bases de datos y un largo etc\u00e9tera.</li> <li>software espec\u00edficos de aplicaci\u00f3n, o aplicaciones de prop\u00f3sito espec\u00edfico, son aquellas dise\u00f1adas para la resoluci\u00f3n de una tarea tan espec\u00edfica que las aplicaciones de prop\u00f3sito general no son capaces de dar servida cuenta. Procesos de automatizaci\u00f3n industrial, sistemas de gesti\u00f3n de una empresa o aplicaciones de rob\u00f3tica son aplicaciones tan espec\u00edficas que son necesarias crearlas desde cero para que se adapten a las necesidades que las demandan.</li> </ul> <p></p>"},{"location":"UD1/Estructura/#licencias-de-software","title":"Licencias de software","text":"<p>Como administradores de un sistema inform\u00e1tico, una de las tareas que se debe desempe\u00f1ar es la adquisici\u00f3n de software para los equipos. Elegir un software u otro depende de muchos factores, como su precio, su compatibilidad, su curva de aprendizaje, la formaci\u00f3n de los empleados y los costes de mantenimiento o ampliaci\u00f3n, entre otros. Existen otros factores que a menudo se obvian a la hora de adquirir el software: su licencia. Es un factor clave a la hora de seleccionar que aplicaciones ser\u00e1n las m\u00e1s indicadas para el sistema inform\u00e1tico.</p> <p>Esta elecci\u00f3n determina el radio de acci\u00f3n de los t\u00e9cnicos. Algunas licencias permiten la modificaci\u00f3n del software para adaptarse a las funciones del sistema inform\u00e1tico, otras la limitan, algunas no permiten corregir errores a pesar de contar con las herramientas y conocimientos necesarios, en otras no permiten acceder al c\u00f3digo fuente de la aplicaci\u00f3n. Es un factor a tener muy en cuenta a la hora de elegir como construiremos el subsistema software de nuestra infraestructura.</p> <p>Pero \u00bfqu\u00e9 es una licencia de software?. Una licencia de software es un conjunto de permisos que el propietario de los derechos de explotaci\u00f3n le otorga al usuario que lo adquiere. Estos derechos se centran en determinar las caracter\u00edsticas de uso y distribuci\u00f3n del mismo. Adem\u00e1s suelen definir tambi\u00e9n los plazos de duraci\u00f3n y el territorio donde se aplica la licencia, ya que la legislaci\u00f3n en este \u00e1mbito var\u00eda en cada pa\u00eds. Por lo tanto, es imprescindible comprobar que permite hacer la licencia del software que se vaya a adquirir. Esto limitar\u00e1, junto con el resto de caracter\u00edsticas del software, la idoneidad de uno u otro.</p>"},{"location":"UD1/Estructura/#clasificacion-de-licencias-de-software","title":"Clasificaci\u00f3n de licencias de software","text":"<p>Existen infinidad de licencias de software. Hay que tener en cuenta que es el propietario de la licencia el que establece las condiciones de uso, distribuci\u00f3n y mantenimiento de su software. En este sentido cualquier clasificaci\u00f3n resultar\u00eda interminable. A\u00fan as\u00ed, coexisten un abanico de ellas que los desarrolladores pueden escoger si sus exigencias encajan con sus caracter\u00edsticas. En funci\u00f3n de los derechos que cada propietario se reserva sobre su software, encontramos:</p> <ul> <li> <p>Licencias de software de c\u00f3digo abierto (software libre), en general, dotan al usuario de libertad para crear una obra derivada (modificar, adaptar el software a las necesidades del sistema inform\u00e1tico), redistribuir e incluso vender el programa sin el consentimiento expreso del propietario de los derechos. Este software se distribuye junto con el c\u00f3digo fuente para que el usuario pueda ejercer estos derechos. Existen numerosas variaciones de estos privilegios de usuario, lo que se traduce en una divisi\u00f3n de licencias:</p> </li> <li> <p>licencias permisivas, con las que se puede crear una obra derivada sin que el resultado est\u00e9 obligado a protecci\u00f3n alguna. Es decir, se puede generar un software nuevo basado en el c\u00f3digo del original y el resultado no tener la misma licencia. Una vez creada la obra derivada puede mantener su licencia original, puede ser m\u00e1s restrictiva o incluso menos</p> </li> <li> <p>licencias robustas (con copyleft), que aplican algunas restricciones a las obras derivadas, que a su vez se dividen en dos tipos:</p> <ul> <li>fuertes, contienen una cl\u00e1usula que obliga a que las obras derivadas o modificaciones que se realicen al software se deban licenciar bajo los mismos t\u00e9rminos y condiciones de la obra original.</li> <li>d\u00e9biles, contienen una cl\u00e1usula que obliga a que las modificaciones que se realicen al software se deban licenciar bajo los mismos t\u00e9rminos y condiciones de la obra original, pero que las obras derivadas puedan ser licenciadas bajo otros t\u00e9rminos y condiciones distintas</li> </ul> </li> <li> <p>Licencias de software de c\u00f3digo cerrado (software propietario o privativo), los propietarios de los derechos establecen los derechos de uso, redistribuci\u00f3n, copia, modificaci\u00f3n, cesi\u00f3n y cualquier otra consideraci\u00f3n que considere necesaria. Estas obras est\u00e1n protegidas por derechos de autor o Copyright, y eludir estas restricciones se encuentra tipificado como delito contra la propiedad intelectual.   No permiten acceso al c\u00f3digo fuente y por lo tanto, que el software sea modificado, desensamblado, copiado o distribuido de formas no especificadas en la propia licencia. Tambi\u00e9n regula el n\u00famero de copias que pueden ser instaladas e incluso los fines concretos para los cuales puede ser utilizado. Por lo general se ofrecen servicios de soporte t\u00e9cnico y actualizaciones para que el programa funcione de forma correcta. Existen licencias de c\u00f3digo cerrado como el shareware y freeware, que ofrecen al usuario la posibilidad de usar su software con ciertas limitaciones funcionales o temporales.</p> </li> <li> <p>software de dominio p\u00fablico, el cual permite su uso, copia, modificaci\u00f3n o redistribuci\u00f3n con o sin lucro. En realidad todo software contenido en esta categor\u00eda no posee licencia alguna y queda a elecci\u00f3n del usuario qu\u00e9 hacer con \u00e9l.   El dominio p\u00fablico contiene, en realidad, todas la obras que tras un determinado tiempo de explotaci\u00f3n, han perdido su licencia. En esencia, cuando una obra pasa a formar parte del dominio p\u00fablico, pierde todas las limitaciones que pose\u00eda.   La creaci\u00f3n de una obra, no solo de software sino de cualquier otra \u00edndole, es un proceso de conjunci\u00f3n. El autor la crea basado en sus experiencias, conocimientos e idiosincrasia y todos sus conocimientos han salido, de alguna u otra manera, del dominio p\u00fablico. Algunos autores han amasado inmersas fortunas aprovechando lo que el dominio p\u00fablico les ofrec\u00eda, dotando a sus obras derivadas, eso s\u00ed, de su propia personalidad.</p> </li> </ul>"},{"location":"UD1/Estructura/#sistemas-operativos-libres-y-propietarios","title":"Sistemas operativos libres y propietarios","text":"<p>Resulta evidente que un ordenador sin software que lo gestione, especialmente el sistema operativo, no es m\u00e1s que un objeto de decoraci\u00f3n medianamente caro. El sistema operativo nos permite usar las caracter\u00edsticas que el hardware pone a disposici\u00f3n del usuario, es por tanto, un binomio indisoluble. Siendo as\u00ed, se nos podr\u00eda plantear la inquietud de saber que est\u00e1 haciendo el sistema operativo con el hardware, como lo gestiona, la administraci\u00f3n de los recursos o incluso c\u00f3mo se comunica con \u00e9l. Esta idea puede llegar a ser preocupante si la trasladamos a la informaci\u00f3n que contiene el hardware. \u00bfC\u00f3mo guarda la informaci\u00f3n de mis archivos en el disco duro?, \u00bfqu\u00e9 medidas de seguridad toma para que mis fotos no se pierdan?, \u00bfhay alguien m\u00e1s escuchando mi colecci\u00f3n de m\u00fasica en mp3?, en definitiva \u00bfqu\u00e9 est\u00e1 haciendo el sistema operativo con la informaci\u00f3n del usuario?. Existen dos tendencias a la hora de trabajar con el software y m\u00e1s concretamente con los sistemas operativos; el software libre y el propietario. Como se ver\u00e1 a continuaci\u00f3n, ambas presentan sus ventajas e inconvenientes y ser\u00e1 el usuario quien decida qu\u00e9 enfoque quiera dar al tratamiento de su informaci\u00f3n.</p> <p>Unix ha sido uno de los sistemas operativos que m\u00e1s ha influenciado en la historia de la inform\u00e1tica y constituye los fundamentos t\u00e9cnicos y, en gran parte filos\u00f3ficos, sobre los cuales se desarroll\u00f3 el software libre a principios de la d\u00e9cada de los 80. En 1969, Ken Thompson y Dennis Ritchie, dos ingenieros de los laboratorios Bell de AT&amp;T, crearon la primera versi\u00f3n del sistema operativo Unix. Entre las caracter\u00edsticas que lo hac\u00edan un verdadero avance en su tiempo destacan la posibilidad de utilizarlo en diferentes plataformas de hardware y su capacidad multiusuario y multiproceso.</p> <p>Era un software que deb\u00eda ser mantenido por los propios usuarios. As\u00ed naci\u00f3 la primera comunidad que intentaba solucionar problemas fomentando el intercambio de informaci\u00f3n a trav\u00e9s de diferentes foros y debates. Adem\u00e1s, AT&amp;T tambi\u00e9n facilitaba una copia del c\u00f3digo fuente de Unix, inicialmente por muy poco dinero, lo que permiti\u00f3 que el sistema pudiera ser adaptado en las universidades.</p> <p>Una de las que fue pionera en la adopci\u00f3n y desarrollo de Unix fue la Universidad de Berkeley. En 1978, liber\u00f3 la primera versi\u00f3n del Unix BSD (Berkeley software Distribution) que inclu\u00eda varias herramientas dise\u00f1adas en la propia universidad y que mejoraba considerablemente la versi\u00f3n original. Esta revisi\u00f3n de Unix se distribu\u00eda de forma gratuita y acompa\u00f1ado del c\u00f3digo fuente. En 1979, AT&amp;T public\u00f3 la versi\u00f3n 7 de su Unix y empez\u00f3 a poner grandes trabas en la distribuci\u00f3n del c\u00f3digo fuente. Desde Berkeley siguieron innovando, desarrollando mejoras y ofreciendo versiones de Unix BSD de c\u00f3digo libre. La microinform\u00e1tica empez\u00f3 a llegar las empresas con la proliferaci\u00f3n de equipos de escasa capacidad de c\u00f3mputo pero independientes y sobre todo a un precio accesible. Todos esos equipos necesitaban un sistema operativo para funcionar y es aqu\u00ed donde se produce una bifurcaci\u00f3n en el camino que el software deb\u00eda recorrer; los que apostaron por ocultar el c\u00f3digo a sus competidores con el objetivo de posicionarse en un incipiente mercado, y los que siguieron ofreciendo el c\u00f3digo junto a su software por que pensaban que \u00e9ste era una herramienta necesaria y como tal, deb\u00eda ser libre y accesible a todos los usuarios. A pesar que parece que estos caminos se alejan a medida que pasa el tiempo, su relaci\u00f3n es muy estrecha y en muchas ocasiones dependiente.</p>"},{"location":"UD1/Estructura/#el-camino-de-la-transparencia-y-la-cooperacion-entre-hackers-el-software-libre","title":"El camino de la transparencia y la cooperaci\u00f3n entre hackers: el software libre","text":"<p>Muchos de los desarrolladores, preocupados ante la p\u00e9rdida de libertades que se estaba produciendo, decidieron defender las libertades que se consideraban esenciales para el usuario, ya que sin sistema operativo (y software en general), no existen un ordenador funcional. El 27 de septiembre de 1983 Richard Stallman, muy preocupado por esta p\u00e9rdida de libertades y que m\u00e1s tarde acu\u00f1ar\u00eda el t\u00e9rmino software libre, anunciaba en el foro Usenet net-unix.wizards, que empezaba a trabajar sobre una implementaci\u00f3n libre de un sistema inspirado en Unix que denominar\u00eda GNU y que estar\u00eda libre de c\u00f3digo de AT&amp;T. Se trat\u00f3 de una implementaci\u00f3n desde cero sin interferencias legales de AT&amp;T. En el mensaje, Stallman explicaba detalladamente su experiencia como desarrollador de sistemas y ped\u00eda la ayuda de todo el mundo que quisiera ofrecer parte de su tiempo, dinero o hardware. El 1984, Stallman cre\u00f3 la Free software Foundation (FSF) con el objetivo de gestionar todas las colaboraciones que obtuvo de aquel mensaje. Una de los motivos que arrastraron a los desarrolladores a colaborar con esta organizaci\u00f3n fue la definici\u00f3n que Richard Stallman realiz\u00f3 de software libre. \u00c9sta se cimienta en la cooperaci\u00f3n, la transparencia y garantiza las cuatro libertades b\u00e1sicas que cualquier programa considerado libre debe proporcionar:</p> <ul> <li>0: libertad para utilizar el programa para cualquier prop\u00f3sito.</li> <li>1: libertad para poder estudiar c\u00f3mo funciona el programa.</li> <li>2: libertad para redistribuir el programa.</li> <li>3: libertad para hacer modificaciones y distribuir las mejoras.</li> </ul> <p>Para dar servida cuenta de estas libertades, es preciso el acceso al c\u00f3digo fuente. Durante los 80 Richard Stallman continu\u00f3 con el desarrollo de las herramientas necesarias para crear un sistema operativo completamente libre. Desde sus inicios identific\u00f3 la necesidad de crear las protecciones jur\u00eddicas necesarias. Por lo que en 1989, public\u00f3 la versi\u00f3n 1.0 de la licencia GPL (General Public License). Fue una herramienta indispensable ya que era muy com\u00fan que algunos programadores cogieran c\u00f3digo que era software libre, realizaban modificaciones y no aportaban estas modificaciones a la comunidad.</p> <p>En 1991, un estudiante finland\u00e9s de 21 a\u00f1os llamado Linus Torvalds publicaba su propio n\u00facleo de sistema operativo inspirado en Unix que m\u00e1s tarde se denominar\u00eda Linux. R\u00e1pidamente, muchos hackers se sumaron en un esfuerzo colectivo para ayudarle a mejorar el n\u00facleo del sistema operativo. \u00c9ste era precisamente el armaz\u00f3n que le faltaba al sistema GNU de Richard Stallman. Los hackers de Linux fueron adaptando las herramientas de GNU a su n\u00facleo y crearon las primeras distribuciones GNU/Linux. Estas distribuciones inclu\u00edan Linux y todas las herramientas necesarias para que el usuario lo pudiera utilizar. Linux se ha convertido en el buque insignia del movimiento del software libre, ya que es un sistema operativo completamente libre que incluye todo tipo de herramientas para servidores y usuarios finales.</p> <p>El software libre ha tenido un papel fundamental en el crecimiento de Internet, ya que su infraestructura se basa en protocolos de comunicaci\u00f3n abiertos. La inmensa mayor\u00eda servidores web emplean Apache, otro gran n\u00famero usan SendMail para gestionar el env\u00edo de correo electr\u00f3nico y pr\u00e1cticamente la totalidad de los servidores de nombres (DNS) utilizan el programa BIND o derivados de su c\u00f3digo fuente. Sin la existencia del software libre Internet hoy en d\u00eda probablemente no existir\u00eda, o al menos no existir\u00eda tal y como se conoce. Ha sido igualmente importante el hecho de que los protocolos que definen la arquitectura de Internet sean abiertos y que no hayan sido controlados por ninguna empresa.</p>"},{"location":"UD1/Estructura/#el-camino-de-la-rentabilidad-y-la-ocultacion-el-software-propietario","title":"El camino de la rentabilidad y la ocultaci\u00f3n: el software propietario","text":"<p>La explosi\u00f3n de la microinform\u00e1tica a principio de los a\u00f1os 80 trajo consigo un descenso de precio de los sistemas inform\u00e1ticos y su popularizaci\u00f3n entre las empresas. Todas aquellas m\u00e1quinas requer\u00edan un sistema operativo para funcionar, y se gener\u00f3 una necesidad. Fruto de ella aparecieron las primeras compa\u00f1\u00edas de software. Estas empresas comenzaron a negar el acceso a los usuarios y a otros desarrolladores al c\u00f3digo fuente de las aplicaciones que desarrollaban, para conseguir una ventaja competitiva frente a sus rivales. En ese momento se rompi\u00f3 la tradici\u00f3n de compartir el c\u00f3digo que hab\u00eda imperado hasta entonces y consecuentemente con la propia \u00e9tica hacker.</p> <p>Se fue extendiendo ese modelo de c\u00f3digo cerrado en el cual el software se ofrec\u00eda sin el c\u00f3digo fuente, y recortando cada vez m\u00e1s las libertades a los usuarios los cuales estaban obligados a adquirir una licencia. El usuario pasaba de ser propietario del software a tener su usufructo, eso s\u00ed, pagando un alquiler a modo de licencia.</p> <p>Este tipo de software tuvo un especial expansi\u00f3n entre las empresas ya que, aunque se trataba un producto de pago, ofrec\u00edan una serie de ventajas a las que el software libre no llegaba. El software pasaba un control de calidad, ofrec\u00eda soporte y soluciones espec\u00edficas para cada aspecto de la empresa. Mucho de este software se convirti\u00f3 e uso com\u00fan entre hasta la actualidad.</p> <p>Innumerables han sido las empresas de software que han aparecido desde estos inicios, pero huelga decir que las m\u00e1s importantes han sido (y algunas lo siguen siendo) Microsoft, Oracle, AT&amp;T, Apple, Sun, International Business Machines (IBM) entre otras.</p>"},{"location":"UD1/Estructura/#todo-son-ventajas-e-inconvenientes","title":"Todo son ventajas e inconvenientes","text":"<p>Actualmente estos dos modelos coexisten en la mayor\u00eda de casos y de una manera eficaz. Se puede reducir el coste del software de servidor a trav\u00e9s de una soluci\u00f3n de c\u00f3digo abierto, mientras que los clientes ejecuten un sistema operativo privativo de Microsoft e, instalado en \u00e9ste, aplicaciones ofim\u00e1ticas de software libre.</p> <p>Ventajas del software libre:</p> <ul> <li>bajo coste de adquisici\u00f3n y uso, a veces este coste se reduce a cero.</li> <li>independencia del proveedor, se dispone del c\u00f3digo fuente.</li> <li>requisitos de hardware menores, especialmente en sistemas operativos.</li> <li>adaptabilidad del software, a cualquier situaci\u00f3n o escenario.</li> </ul> <p>Desventajas del software libre:</p> <ul> <li>curva de aprendizaje mayor, lo que puede repercute en un aumento de costos.</li> <li>no posee ninguna garant\u00eda, es responsabilidad del usuario usarlo.</li> <li>interfaces y configuraci\u00f3n poco intuitivas, si se considera como \u201cmodelo\u201d la interfaz creada por Microsoft.</li> <li>confusi\u00f3n en el usuario, la diversidad de distribuciones, las diferentes licencias de uso y la variedad de herramientas para un mismo prop\u00f3sito a veces abruman y confunden al usuario.</li> </ul> <p>Ventajas del software propietario:</p> <ul> <li>control de calidad, por lo general el software para unas pruebas antes de ser ofrecido a los usuarios.</li> <li>curva de aprendizaje menor, muchos usuarios han aprendido a usar la GUI de una determinada compa\u00f1\u00eda.</li> <li>soporte de producto y garant\u00eda, ante cualquier eventualidad los propietarios de la licencia ofrecen una soluci\u00f3n y adem\u00e1s se comprometen a tener el software actualizado.</li> </ul> <p>Desventajas del software propietario</p> <ul> <li>imposibilitad de acceso al c\u00f3digo, es imposible adaptar el software sin pasar por el equipo de desarrollo que lo cre\u00f3.</li> <li>adaptaci\u00f3n inversa, en numerosas ocasiones es el modus operandi de los usuarios el que se adapta al software y no al contrario.</li> <li>formaci\u00f3n costosa, si el software no goza de mucha popularidad, la formaci\u00f3n suele depender de la empresa que lo ofrece.</li> </ul> <p>La licencia de un software a utilizar en el sistema inform\u00e1tico debe pesar en la decisi\u00f3n casi tanto como el hardware de los equipos. Una mala elecci\u00f3n del software puede estrangular o dificultar su crecimiento.</p>"},{"location":"UD1/bios/","title":"Qu\u00e9 es la BIOS?. Caracter\u00edsticas. Configuraci\u00f3n y optimizaci\u00f3n","text":"<p>BIOS es el acr\u00f3nimo de Basic Input Output System y se trata del firmware que se ejecuta al iniciar el ordenador en modo fr\u00edo. Antes de iniciar el sistema operativo, un ordenador necesita realizar ciertas comprobaciones de hardware antes de cargarse en memoria. Para conseguir esa informaci\u00f3n sobre el estado de los componentes, necesitar\u00e1 el acceso a todo el hardware del sistema. Esta es una de las funciones de la BIOS, interponer una capa de abstracci\u00f3n entre ellos. De esta forma el sistema operativo obtiene esa informaci\u00f3n de la BIOS, que a su vez, la obtiene directamente del hardware.</p> <p>Uno de sus primeros cometidos es comprobar el estado del hardware mediante el POST (Power On Self Test), el cual comprueba si el hardware se comporta como debiera. Si el resultado de esta prueba es satisfactorio, reanudar\u00e1 la secuencia de arranque del sistema operativo.</p> <p>No solo las placas base contienen este firmware, casi cualquier dispositivo posee una BIOS que facilita la comunicaci\u00f3n con sus niveles superiores. Componentes como tarjetas de video, de red, impresoras y tarjetas capturadoras entre otros.</p> <p>La mayor\u00eda de los fabricantes de componentes delegan la producci\u00f3n de la BIOS a terceros. \u00c9stos actualizan el firmware para dotarlos de nuevas funcionalidades, compatibilidad con nuevos dispositivos o corregir errores. En la actualidad existen dos proveedores de BIOS mayoritarios que son American Megatrends y Phoenix Technologies que son de c\u00f3digo propietario. Existe una alternativa de c\u00f3digo abierto denominada Coreboot (en el que basa OpenBIOS), aunque muy poco extendida.</p> <p></p> <p>A medida que los requerimientos del hardware y de los sistemas operativos han ido aumentando, el sistema BIOS deb\u00eda someterse a numerosas revisiones. Adem\u00e1s, algunas de estos requerimientos no pod\u00edan implementarse dadas las limitaciones t\u00e9cnicas del firmware. Esto sucedi\u00f3 durante las primeras fases de desarrollo del procesador Itanium, dise\u00f1ado a la par entre Intel y Hewlett-Packard.</p> <p>De esta forma nace UEFI, acr\u00f3nimo de United Extensible Firmware Interface, con nuevas caracter\u00edsticas como proporcionar men\u00fas gr\u00e1ficos, uso del rat\u00f3n, acceso remoto para la teleasistencia o la utilizaci\u00f3n de extensiones que ampl\u00edan sus funcionalidades sin ser necesaria una actualizaci\u00f3n completa.</p> <p>Sin duda, una de las caracter\u00edsticas m\u00e1s importantes que introdujo en sistema UEFI, fue la creaci\u00f3n de un nuevo sistema de arranque, la que permite la carga directa del sistema operativo sin intermediaci\u00f3n de los gestores de arranque. Esta propiedad oblig\u00f3 a crear un modo de retrocompatibilidad con BIOS, debido a que los sistemas operativos antiguos necesitaban un gestor de arranque para poder iniciar el proceso. UEFI permite coexistir a ambos sistemas de arranque.</p> <p>En la actualidad el uso de UEFI se ha extendido y casi la totalidad de los sistemas operativos modernos es compatible con este firmware. Las diferencias entre ambos sistemas resultan evidentes y UEFI introduce las siguientes caracter\u00edsticas:</p> <ul> <li>una nueva apariencia gr\u00e1fica que permite el uso de rat\u00f3n y de animaciones.</li> <li>utiliza un nuevo sistema de particionado, GPT que sustituye a MBR (tema que se ver\u00e1 en lo sucesivo).</li> <li>mejora la seguridad con Secure Boot, el cual no permite la inicializaci\u00f3n de sistemas operativos no autentificados, para proteger de software malintencionado que se ejecuta al inicio.</li> <li>arranque del sistema m\u00e1s r\u00e1pido.</li> <li>el sistema UEFI no est\u00e1 bloqueado, lo que permite a\u00f1adir extensiones de terceros para complementar su funcionalidad.</li> </ul> <p></p> <p></p> <p>En ambos casos, la configuraci\u00f3n de este firmware pasa por establecer la hora y fecha del sistema, la velocidad el procesador y overclocking, la prioridad de dispositivos de arranque, la configuraci\u00f3n de puestos serie y paralelo y obtener informaci\u00f3n del hardware entre otras muchas funcionalidades. Toda esta configuraci\u00f3n se guarda en una memoria especial denominada CMOS (Complementary Metal Oxide Semiconductor) que se alimenta de una pila modelo CR-2032. Cuando el ordenador est\u00e1 apagado, es esta bater\u00eda la que mantiene los datos de configuraci\u00f3n guardados. Si esta pila dejase de funcionar, la BIOS/UEFI pasar\u00e1 a tomar los valores predeterminados de f\u00e1brica.</p>"},{"location":"UD1/lxd/","title":"Contenedores con LXD/LXC","text":"<p>LXD es un hypervisor para contenedores Linux desarrollado por Canonical Ltd. Es un complemento para los contenedores de Linux (LXC) que facilita su uso y a\u00f1ade nuevas posibilidades.</p> <p>La documentaci\u00f3n oficial est\u00e1 en el siguiente link</p> <p>En la red se puede encontrar mucha informaci\u00f3n sobre LXD, aqu\u00ed \u00fanicamente se pretende presentar una peque\u00f1a introducci\u00f3n a los contenedores en general y a LXD en particular.</p>"},{"location":"UD1/lxd/#que-son-los-contenedores","title":"\u00bfQu\u00e9 son los contenedores?","text":"<p>Aparentemente en un contenedor se ejecuta un sistema operativo GNU/Linux independiente de otros contenedores y del propio SO anfitri\u00f3n. Se trata de un producto de la virtualizaci\u00f3n pero, en lugar de utilizar m\u00e1quinas virtuales dentro de las cuales se ejecuta un sistema operativo que puede ser diferente del anfitri\u00f3n, aqu\u00ed se utilizan t\u00e9cnicas de virtualizaci\u00f3n a nivel de sistema operativo. De modo que s\u00f3lo hay un n\u00facleo, en nuestro caso el Linux que se ejecuta en el equipo anfitri\u00f3n, que mediante diferentes funciones (namespaces, cgroups, ...) muestra vistas parciales a algunos procesos para que crean que se ejecutan en un sistema aislado.</p> <p>As\u00ed que el sistema anfitri\u00f3n y todos los contenedores utilizan el mismo n\u00facleo. En el sistema anfitri\u00f3n se pueden ver todos los procesos y en cada uno de los contenedores \u00fanicamente los propios. La red, la ra\u00edz del sistema de archivos, los ficheros de dispositivo y otros recursos tambi\u00e9n est\u00e1n virtualizados as\u00ed que cada contenedor puede tener su propia interfaz de red y sistema de archivos ra\u00edz. Incluso es posible que un contenedor utilice una distribuci\u00f3n de GNU/Linux diferente del resto pero, eso s\u00ed, compartiendo el \u00fanico n\u00facleo que se ejecuta en el equipo anfitri\u00f3n.</p> <p>Las ventaja de los contenedores frente a las m\u00e1quinas virtuales tradicionales es la eficiencia. Un contenedor es mucho m\u00e1s ligero pues no necesita recrear el hardware de la m\u00e1quina virtual ni ejecutar dentro otro sistema operativo. Los procesos que se ejecutan en un contenedor al fin y al cabo son procesos nativos del equipo anfitri\u00f3n. Por lo tanto se consigue un mayor rendimiento y es posible ejecutar en un mismo ordenador un n\u00famero mucho mayor de contenedores que de m\u00e1quinas virtuales. Hay art\u00edculos en los que se menciona http://blog.dustinkirkland.com/2015/06/lxd-challenge-how-many-containers-can.html en un port\u00e1til con 16GB de RAM en el que \"solo\" es posible ejecutar 31 m\u00e1quinas KVM sin KSM activado y 65 con KSM activado.</p> <p>El inconveniente de los contenedores frente a la virtualizaci\u00f3n completa asistida por hardware es que se apoya en Linux y todos los contenedores deben ejecutar una distribuci\u00f3n de GNU/Linux. Pero como usted sabe con una distribuci\u00f3n de GNU/Linux es posible hacer mucho.</p> <p>Otras herramientas similares son:</p> <ul> <li>Docker: El rival directo de LXD/LXC. Tambi\u00e9n es una herramienta de virtualizaci\u00f3n a nivel de SO nativa de Linux. Pero una de las diferencias respecto a LXD/LXC es que en este caso cada contenedor est\u00e1 orientado a ejecutar \u00fanicamente un servicio (Apache, MySQL, ...) en lugar de un SO.</li> <li>Jails de FreeBSD: La opci\u00f3n nativa de FreeBSD.</li> <li>Solaris Containers: La opci\u00f3n nativa de Solaris, tambi\u00e9n presente en sus derivados libres: Illumos, OpenIndiana...</li> </ul>"},{"location":"UD1/lxd/#instalacion-en-linux","title":"Instalaci\u00f3n en Linux","text":"<p>LXD se puede instalar sobre Ubuntu 14.04 LTS agregando su propio PPA, pero en la versi\u00f3n 16.04 LTS forma parte de los repositorios oficiales y viene acompa\u00f1ado de una gran novedad: ZFS. LXD puede utilizar diferentes storage-backends, por defecto se utiliza un directorio en el sistema de archivos pero combinar los contenedores con alguna herramienta que proporcione COW (como ZFS, Btrfs o LVM) permite mejorar la velocidad y economizar espacio al trabajar con snapshots o al copiar contenedores. Aunque para probar LXD bastar\u00e1 cualquier sistema de archivos.</p> <p>La instalaci\u00f3n en LXD en Ubuntu se realiza con el comando:</p> Instalaci\u00f3n<pre><code>sudo snap install lxd\n</code></pre> <p>La instalaci\u00f3n crea el grupo lxd que incluye a los usuarios que pueden utilizarlo. Pero como la informaci\u00f3n sobre los grupos a los que pertenece un usuario se lee en el momento de iniciar sesi\u00f3n, ahora ser\u00e1 necesario salir y volver a entrar. O, alternativamente, ejecutar:</p> <pre><code>newgrp lxd\n</code></pre> <p>En Ubuntu no es necesario hacer nada especial para instalar LXD. \u00danicamente ser\u00e1 necesario que el usuario que lo vaya a utilizar forme parte del grupo lxd.</p> <p>Una vez instalado la gesti\u00f3n de los contenedores se realiza a trav\u00e9s de la herramienta lxc. Al ejecutarla sin par\u00e1metros se muestran las diferentes opciones:</p> <pre><code>julio@julio-Lenovo-ideapad-330-15ICH:~$ lxc\nUsage: lxc [subcommand] [options]\n\u00d3rdenes disponibles\nconfig - Manage configuration.\ncopy - Copy containers within or in between lxd instances.\ndelete - Delete containers or container snapshots.\nexec - Execute the specified command in a container.\nfile - Manage files on a container.\nhelp - Presents details on how to use LXD.\nimage - Manipulate container images.\ninfo - List information on LXD servers and containers.\nlaunch - Launch a container from a particular image.\nlist - Lists the available resources.\nmove - Move containers within or in between lxd instances.\nprofile - Manage configuration profiles.\npublish - Publish containers as images.\nremote - Manage remote LXD servers.\nrestart - Changes state of one or more containers to restart.\nrestore - Set the current state of a resource back to a snapshot.\nsnapshot - Create a read-only snapshot of a container.\nstart - Changes state of one or more containers to start.\nstop - Changes state of one or more containers to stop.\nversion - Prints the version number of this client tool.\n\nOpciones:\n--all Print less common commands.\n--debug Print debug information.\n--verbose Print verbose information.\n\nEntorno:\nLXD_CONF Path to an alternate client configuration directory.\nLXD_DIR Path to an alternate server directory.\njulio@julio-Lenovo-ideapad-330-15ICH:~$\n</code></pre>"},{"location":"UD1/lxd/#contenedores-imagenes-y-remotos","title":"Contenedores, im\u00e1genes y remotos","text":"<p>Los contenedores se lanzan a partir de im\u00e1genes y las im\u00e1genes se almacenan en repositorios locales o remotos. LXD facilita la gesti\u00f3n de contenedores, im\u00e1genes y remotos (repositorios de im\u00e1genes). De hecho, gracias a que la mayor\u00eda de operaciones son autom\u00e1ticas es posible lanzar un contenedor desde el primer momento (lo que descargar\u00e1 de manera autom\u00e1tica la imagen necesaria).</p> <p>Pero vamos a verlo con m\u00e1s detalle. La primera vez que se ejecuta LXD es posible utilizar el comando lxc image list para comprobar que esta m\u00e1quina todav\u00eda no tiene ninguna imagen:</p> Listar im\u00e1genes<pre><code>julio@julio-Lenovo-ideapad-330-15ICH:~$ sudo lxc image list # (1)\nIf this is your first time running LXD on this machine, you should also run: lxd init\nTo start your first container, try: lxc launch ubuntu:20.04\nOr for a virtual machine: lxc launch ubuntu:20.04 --vm\n</code></pre> <ol> <li> deberemos poner sudo para obtener privilegios de administrador.</li> </ol> <p>Y obtener dos informaciones:</p> <ul> <li>Que se puede utilizar <code>sudo lxd init</code> para configurar diferentes aspectos de LXD como la red o el backend de almacenamiento. Aunque las opciones por defecto son razonables y no es necesario cambiarlas.(deberemos lanzarlo antes de seguir creando contenedores.)</li> <li>Que se puede lanzar un nuevo contenedor mediante el comando: <code>lxc launch ubuntu:20.04</code></li> </ul> iniciar configuraci\u00f3n<pre><code>sudo lxd init\nWould you like to use LXD clustering? (yes/no) [default=no]: yes\nWhat IP address or DNS name should be used to reach this node? [default=192.168.1.37]:\nAre you joining an existing cluster? (yes/no) [default=no]:\nWhat name should be used to identify this node in the cluster? [default=julio-Lenovo-ideapad-330-15ICH]:\nSetup password authentication on the cluster? (yes/no) [default=no]:\nDo you want to configure a new local storage pool? (yes/no) [default=yes]:\nName of the storage backend to use (zfs, btrfs, dir, lvm) [default=zfs]:\nCreate a new ZFS pool? (yes/no) [default=yes]:\nWould you like to use an existing empty block device (e.g. a disk or partition)? (yes/no) [default=no]:\nSize in GB of the new loop device (1GB minimum) [default=13GB]:\nDo you want to configure a new remote storage pool? (yes/no) [default=no]:\nWould you like to connect to a MAAS server? (yes/no) [default=no]:\nWould you like to configure LXD to use an existing bridge or host interface? (yes/no) [default=no]:\nWould you like to create a new Fan overlay network? (yes/no) [default=yes]:\nWhat subnet should be used as the Fan underlay? [default=auto]:\nWould you like stale cached images to be updated automatically? (yes/no) [default=yes]\nWould you like a YAML \"lxd init\" preseed to be printed? (yes/no) [default=no]:\n</code></pre> <p>Lanzar un nuevo contenedor es tan sencillo como ejecutar el comando indicado, en cuyo caso nos lanzar\u00e1 un nuevo contenedor con un nombre generado din\u00e1micamente, o bien especificar el nombre del contenedor (u1 en este ejemplo) al ejecutar: lxc launch ubuntu:16.04 u1. Al ser la primera vez que se utiliza la imagen ubuntu:16.04 primero se descargar\u00e1 de forma autom\u00e1tica, se guardar\u00e1 en el repositorio local y despu\u00e9s se lanzar\u00e1 el contenedor u1.</p> Lanzar contenedores sobre im\u00e1genes<pre><code>julio@julio-Lenovo-ideapad-330-15ICH:~$ lxc launch ubuntu:20.04 u1\nCreando u1\nRetrieving image: 100%\nIniciando u1\njulio@julio-Lenovo-ideapad-330-15ICH:~$\n</code></pre> <p>Podemos ver el estado del nuevo contenedor al ejecutar: <code>sudo lxc list</code></p> Estado contenedores<pre><code>julio@julio-Lenovo-ideapad-330-15ICH:~$ sudo lxc list\n+------+---------+--------------------+------+-----------+-----------+--------------------------------+\n| NAME |  STATE  |        IPV4        | IPV6 |   TYPE    | SNAPSHOTS |            LOCATION            |\n+------+---------+--------------------+------+-----------+-----------+--------------------------------+\n| u1   | RUNNING | 240.37.0.72 (eth0) |      | CONTAINER | 0         | julio-Lenovo-ideapad-330-15ICH |\n+------+---------+--------------------+------+-----------+-----------+--------------------------------+\n</code></pre> <p>Y comprobar que ahora s\u00ed contamos con una imagen descargada: <code>sudo lxc image list</code></p> Estado de la im\u00e1genes que hemos descargado<pre><code>julio@julio-Lenovo-ideapad-330-15ICH:~$ sudo lxc image list\n+-------+--------------+--------+---------------------------------------------+--------------+-----------+----------+-------------------------------+\n| ALIAS | FINGERPRINT  | PUBLIC |                 DESCRIPTION                 | ARCHITECTURE |   TYPE    |   SIZE   |          UPLOAD DATE          |\n+-------+--------------+--------+---------------------------------------------+--------------+-----------+----------+-------------------------------+\n|       | 67c172d007a3 | no     | ubuntu 20.04 LTS amd64 (release) (20230908) | x86_64       | CONTAINER | 425.65MB | Sep 13, 2023 at 11:01am (UTC) |\n+-------+--------------+--------+---------------------------------------------+--------------+-----------+----------+-------------------------------+\n</code></pre> <p>A partir de una imagen se pueden lanzar diferentes contenedores. Y naturalmente es posible tener diferentes im\u00e1genes que sirvan como base para lanzar contenedores (unos con OpenSSH instalado, otros con la pila LAMP) o im\u00e1genes de diferentes distribuciones de GNU/Linux (Ubuntu, CentOS, Fedora...).</p> <p>Las im\u00e1genes se pueden importar/exportar desde/a un fichero tarball y a partir de un contenedor es posible publicar una imagen.</p>"},{"location":"UD1/lxd/#utilizando-contenedores","title":"Utilizando contenedores","text":"<p>Las operaciones b\u00e1sicas con los contenedores son:</p> Funci\u00f3n: Comando: Listar contenedores <code>lxc list</code> Lanzar un contenedor nuevo <code>lxc launch &lt;imagen&gt; [nombre]</code> Detener un contenedor <code>lxc stop &lt;nombre&gt;</code> Encender un contenedor <code>lxc start &lt;nombre&gt;</code> Obtener un shell en un contenedor <code>lxc exec &lt;nombre&gt; -- /bin/bash</code> Borrar un contenedor o snapshot <code>lxc delete &lt;nombre&gt;</code> <p>Es posible utilizar el comando lxc launch para lanzar un nuevo contenedor a partir de una imagen (por ejemplo: lxc launch ubuntu:16.04 u1). Una vez creado el contenedor estar\u00e1 en ejecuci\u00f3n y se podr\u00e1 detener o volver a encender respectivamente con los comandos lxc stop y lxc start. Cuando el contenedor ya no sea necesario se puede borrar con lxc delete.</p> <p>Tambi\u00e9n es posible abrir un terminal en un contenedor para ejecutar comandos de manera interactiva: <code>sudo lxc exec u1 -- /bin/bash</code></p> <p>Un peque\u00f1o ejemplo de uso:</p> Utilizaci\u00f3n de contenedores<pre><code>julio@julio-Lenovo-ideapad-330-15ICH:~$ sudo lxc list\n+------+---------+--------------------+------+-----------+-----------+--------------------------------+\n| NAME |  STATE  |        IPV4        | IPV6 |   TYPE    | SNAPSHOTS |            LOCATION            |\n+------+---------+--------------------+------+-----------+-----------+--------------------------------+\n| u1   | RUNNING | 240.37.0.72 (eth0) |      | CONTAINER | 0         | julio-Lenovo-ideapad-330-15ICH |\n+------+---------+--------------------+------+-----------+-----------+--------------------------------+\n\njulio@julio-Lenovo-ideapad-330-15ICH:~$ sudo lxc exec u1 -- /bin/bash\nroot@u1:~# uname -a\nLinux u1 5.4.0-162-generic #179-Ubuntu SMP Mon Aug 14 08:51:31 UTC 2023 x86_64 x86_64 x86_64 GNU/Linux\n\nroot@u1:~# exit\nexit\njulio@julio-Lenovo-ideapad-330-15ICH:~$ sudo lxc stop u1\njulio@julio-Lenovo-ideapad-330-15ICH:~$ sudo lxc list\n+--------+---------+------+------+------------+-----------+\n| NOMBRE | ESTADO | IPV4 | IPV6 | TIPO | SNAPSHOTS |\n+--------+---------+------+------+------------+-----------+\n| u1 | STOPPED | | | PERSISTENT | 0 |\n+--------+---------+------+------+------------+-----------+\njulio@julio-Lenovo-ideapad-330-15ICH:~$ lxc delete u1\njulio@julio-Lenovo-ideapad-330-15ICH:~$ lxc list\n+--------+--------+------+------+------+-----------+\n| NOMBRE | ESTADO | IPV4 | IPV6 | TIPO | SNAPSHOTS |\n+--------+--------+------+------+------+-----------+\n</code></pre> <p>Con los contenedores adem\u00e1s de las operaciones mostradas es posible:</p> <ul> <li>Crear instant\u00e1neas (snapshots) y restaurar su estado incluyendo su memoria.</li> <li>Copiar y/o mover contenedores entre diferentes servidores LXD.</li> <li>Copiar ficheros de y hacia el contenedor.</li> <li>Publicar una imagen a partir de un contenedor y, si se desea, obtener el tarball que la representa.</li> </ul>"},{"location":"UD1/lxd/#sobre-la-configuracion-por-defecto-de-la-red-en-los-contenedores","title":"Sobre la configuraci\u00f3n por defecto de la red en los contenedores","text":"<p>La configuraci\u00f3n de red por defecto para los contenedores est\u00e1 definida en el fichero <code>/etc/default/lxd-bridge</code>.</p> <p>B\u00e1sicamente all\u00ed se especifica:</p> <ul> <li>Que en el anfitri\u00f3n se declara un puente: <code>lxdbr0</code> (recuerde que los puentes se pueden inspeccionar/gestionar con <code>brctl</code>)</li> <li>Que se modificar\u00e1 el perfil por defecto de los contenedores para que hagan uso del puente.</li> <li>Por defecto est\u00e1n vac\u00edos, pero hay campos para especificar la IP del puente y el rango de concesiones DHCP a utilizar para los contenedores.</li> </ul> <p>La configuraci\u00f3n de los equipos del aula utiliza el fichero /etc/network/interfaces para inclu\u00edr la interfaz de red f\u00edsica como un puerto del puente, de tal manera que los contenedores puedan acceder a la LAN del aula tal y como lo hacen las estaciones f\u00edsicas.</p>"},{"location":"UD1/lxd/#es-posible-limitar-los-recursos-de-un-contenedor","title":"\u00bfEs posible limitar los recursos de un contenedor?","text":"<p>Por supesto, de hecho resulta muy recomendable limitar y priorizar los recursos de los contenedores. Si no se imponen l\u00edmites por defecto los contenedores comparten los recursos de la maquina anfitri\u00f3n: CPU, memoria principal, espacio swap, interfaces de red y disco.</p> <p>LXD permite manejar la configuraci\u00f3n de un contenedor de forma individual o bien crear un perf\u00edl que luego se puede aplicar a varios contenedores.</p> <p>Veamos qu\u00e9 configuraci\u00f3n tiene un contenedor reci\u00e9n creado:</p> Mostrar configuraci\u00f3n de un contenedor<pre><code>julio@julio-Lenovo-ideapad-330-15ICH:~$ sudo lxc config show u1\n[sudo] contrase\u00f1a para julio:\narchitecture: x86_64\nconfig:\n  image.architecture: amd64\n  image.description: ubuntu 20.04 LTS amd64 (release) (20230908)\n  image.label: release\n  image.os: ubuntu\n  image.release: focal\n  image.serial: \"20230908\"\n  image.type: squashfs\n  image.version: \"20.04\"\n  volatile.base_image: 67c172d007a3787c92ac4fa8de30c68d3540743f8235882c46460bbe68aa3546\n  volatile.eth0.host_name: veth5cba233b\n  volatile.eth0.hwaddr: 00:16:3e:ec:63:ed\n  volatile.idmap.base: \"0\"\n  volatile.idmap.current: '[{\"Isuid\":true,\"Isgid\":false,\"Hostid\":1000000,\"Nsid\":0,\"Maprange\":1000000000},{\"Isuid\":false,\"Isgid\":true,\"Hostid\":1000000,\"Nsid\":0,\"Maprange\":1000000000}]'\n  volatile.idmap.next: '[{\"Isuid\":true,\"Isgid\":false,\"Hostid\":1000000,\"Nsid\":0,\"Maprange\":1000000000},{\"Isuid\":false,\"Isgid\":true,\"Hostid\":1000000,\"Nsid\":0,\"Maprange\":1000000000}]'\n  volatile.last_state.idmap: '[{\"Isuid\":true,\"Isgid\":false,\"Hostid\":1000000,\"Nsid\":0,\"Maprange\":1000000000},{\"Isuid\":false,\"Isgid\":true,\"Hostid\":1000000,\"Nsid\":0,\"Maprange\":1000000000}]'\n  volatile.last_state.power: RUNNING\n  volatile.uuid: 4b1a0b9a-886c-4592-af66-7fa9aa30b46c\ndevices: {}\nephemeral: false\nprofiles:\n- default\nstateful: false\ndescription: \"\"\n</code></pre> <p>Y como es posible fijar un l\u00edmite para el consumo de memoria principal:</p> Establecer limites de un contenedor<pre><code>julio@julio-Lenovo-ideapad-330-15ICH:~$ sudo lxc config set u1 limits.memory 512MB\njulio@julio-Lenovo-ideapad-330-15ICH:~$ sudo lxc config show u1\narchitecture: x86_64\nconfig:\n  image.architecture: amd64\n  image.description: ubuntu 20.04 LTS amd64 (release) (20230908)\n  image.label: release\n  image.os: ubuntu\n  image.release: focal\n  image.serial: \"20230908\"\n  image.type: squashfs\n  image.version: \"20.04\"\n  limits.memory: 512MB\n  volatile.base_image: 67c172d007a3787c92ac4fa8de30c68d3540743f8235882c46460bbe68aa3546\n  volatile.eth0.host_name: veth5cba233b\n  volatile.eth0.hwaddr: 00:16:3e:ec:63:ed\n  volatile.idmap.base: \"0\"\n  volatile.idmap.current: '[{\"Isuid\":true,\"Isgid\":false,\"Hostid\":1000000,\"Nsid\":0,\"Maprange\":1000000000},{\"Isuid\":false,\"Isgid\":true,\"Hostid\":1000000,\"Nsid\":0,\"Maprange\":1000000000}]'\n  volatile.idmap.next: '[{\"Isuid\":true,\"Isgid\":false,\"Hostid\":1000000,\"Nsid\":0,\"Maprange\":1000000000},{\"Isuid\":false,\"Isgid\":true,\"Hostid\":1000000,\"Nsid\":0,\"Maprange\":1000000000}]'\n  volatile.last_state.idmap: '[{\"Isuid\":true,\"Isgid\":false,\"Hostid\":1000000,\"Nsid\":0,\"Maprange\":1000000000},{\"Isuid\":false,\"Isgid\":true,\"Hostid\":1000000,\"Nsid\":0,\"Maprange\":1000000000}]'\n  volatile.last_state.power: RUNNING\n  volatile.uuid: 4b1a0b9a-886c-4592-af66-7fa9aa30b46c\ndevices: {}\nephemeral: false\nprofiles:\n- default\nstateful: false\ndescription: \"\"\n</code></pre> <p>Y el cambio es visible desde el punto de vista del contenedor:</p> Establecer limites de un contenedor<pre><code>julio@julio-Lenovo-ideapad-330-15ICH:~$ lxc exec u1 -- /bin/bash\nroot@u1:~# free -m\ntotal used free shared buff/cache available\nMem: 512 11 421 8 79 421\nSwap: 1021 2 1019\n</code></pre> <p>La propia documentaci\u00f3n de LXD muestra qu\u00e9 configuraciones y l\u00edmites se pueden definir.</p> <p>Algunos de los par\u00e1metros b\u00e1sicos son:</p> Key Type Default Description boot.autostart boolean false Si est\u00e1 activo indica que se debe arrancar el contenedor cuando arranque LXD. limits.cpu string all N\u00famero o rango de CPUs para el contenedor. limits.cpu.allowance string 100% Cuota de CPU a utilizar por el contenedor. Si se utiliza un % se trata de un l\u00edmite blando, si se utiliza algo como \"25ms/100ms\" se trata de un l\u00edmite duro. limits.memory string all L\u00edmite de memoria para el contenedor. Es posible utilizar los sufijos: kB, MB, GB, TB, PB, EB."},{"location":"UD1/lxd/#como-anadir-discos-o-interfaces-de-red","title":"C\u00f3mo a\u00f1adir discos o interfaces de red:","text":"<p>La configuraci\u00f3n por defecto de un contenedor ya incluye un disco con el sistema ra\u00edz y una interfaz de red. Pero es posible a\u00f1adir nuevas interfaces de red o discos. Estos dispositivos se pueden a\u00f1adir:</p> <p>De manera particular a un contenedor De manera general a un perfil que utilizar\u00e1n varios contenedores</p>"},{"location":"UD1/lxd/#discos","title":"Discos","text":"<p>Los discos son b\u00e1sicamente directorios o dispositivos de bloques en el sistema anfitri\u00f3n que se montan en el lugar indicado del contenedor.</p> <p>En el siguiente ejemplo se lanza el contenedor u1, se crea el directorio directorio1 en el sistema anfitri\u00f3n, y se a\u00f1ade como un nuevo disco disponible en /mnt/disco1 en el contenedor.</p> A\u00f1adiendo un disco duro<pre><code>Iniciando u1\njulio@julio-Lenovo-ideapad-330-15ICH:~$ mkdir disco1\njulio@julio-Lenovo-ideapad-330-15ICH:~$ lxc config device add u1 disco1 disk source=/home/usuario/disco1 path=/mnt/disco1\nDevice disco1 added to u1\njulio@julio-Lenovo-ideapad-330-15ICH:~$ lxc exec u1 -- /bin/bash\nroot@u1:~# cd /mnt/\nroot@u1:/mnt# ll\ntotal 6\ndrwxr-xr-x 3 root root 3 Jul 27 08:24 ./\ndrwxr-xr-x 22 root root 22 Jul 27 07:20 ../\ndrwxrwxr-x 2 nobody nogroup 4096 Jul 27 08:22 disco1/\nroot@u1:/mnt#\n</code></pre>"},{"location":"UD1/lxd/#interfaces-de-red","title":"Interfaces de red","text":"<p>Es posible a\u00f1adir diferentes tipos de interfaces de red. Por ejemplo: physical (una interfaz f\u00edsica del anfitri\u00f3n que se dedica en exclusiva a un contenedor) o bridged (una interfaz del contenedor que estar\u00e1 asociada a una interfaz en el equipo f\u00edsico que formar\u00e1 parte del puente indicado).</p> <p>En el siguiente ejemplo se muestra c\u00f3mo a\u00f1adir una nueva interfaz de red en modo puente (eth1) utilizando el puente lxdbr0 de la m\u00e1quina f\u00edsica.</p> A\u00f1adiendo red<pre><code>julio@julio-Lenovo-ideapad-330-15ICH:~$ lxc config device add u1 eth1 nic nictype=bridged parent=lxdbr0\nDevice eth1 added to u1\njulio@julio-Lenovo-ideapad-330-15ICH:~$ lxc exec u1 -- /bin/bash\nroot@ubuntu:~# ifconfig eth1\neth1 Link encap:Ethernet HWaddr 00:16:3e:61:45:e8\nBROADCAST MULTICAST MTU:1500 Metric:1\nRX packets:0 errors:0 dropped:0 overruns:0 frame:0\nTX packets:0 errors:0 dropped:0 overruns:0 carrier:0\ncollisions:0 txqueuelen:1000\nRX bytes:0 (0.0 B) TX bytes:0 (0.0 B)\n</code></pre>"},{"location":"UD1/virtual/","title":"Virtualizaci\u00f3n","text":""},{"location":"UD1/virtual/#introduccionherramientas-de-virtualizacion","title":"Introducci\u00f3n.Herramientas de virtualizaci\u00f3n","text":"<p>A pesar de que parezca una tecnolog\u00eda moderna, fue desarrollada en la d\u00e9cada de los 60 por IBM. La primera m\u00e1quina dise\u00f1ada para estos menesteres fue el IBM S/360 Modelo 67. Estos mainframes o superordenadores no optimizaban sus recursos por lo que surgi\u00f3 la idea \u201cfraccionar l\u00f3gicamente\u201d los recursos y dividirlos en varias tarea, lo que hoy se conoce somo multitasking. En la d\u00e9cada de los 80 y principios de los 90 con el abaratamiento del hardware gracias a los procesadores x86 de Intel, comenz\u00f3 a generalizarse el uso de microordenadores que estaban lejos de las prestaciones ofrecidas por los mainframes. Esto provoc\u00f3 que la tecnolog\u00eda de virtualizaci\u00f3n dejara de utilizarse hasta bien entrados los a\u00f1os 90. Volvi\u00f3 a utilizarse profusamente en el \u00e1mbito de los servidores, pero tambi\u00e9n se empez\u00f3 a usar en otros \u00e1mbitos de la inform\u00e1tica como el test de software o seguridad de aplicaciones usando para ello los sandboxes.</p> <p>La virtualizaci\u00f3n crea una capa de abstracci\u00f3n de los recursos de un ordenador para que puedan ser utilizados por un sistema operativo virtualizado. Esta nueva capa de abstracci\u00f3n se denomina Hypervisor o VMM (Virtual Machine Monitor) y su trabajo consiste en administrar recursos reales de una m\u00e1quina y convertirlos en recursos virtuales.</p> <p>La m\u00e1quina que ofrece sus recursos reales para que sean convertidos en virtuales se denomina m\u00e1quina anfitri\u00f3n. Por otra parte, la m\u00e1quina que utiliza estos recursos virtualizados ofrecidos por la m\u00e1quina anfitri\u00f3n se denomina m\u00e1quina hu\u00e9sped. Lo habitual en esta tecnolog\u00eda es que existan m\u00e1s de una m\u00e1quina hu\u00e9sped por cada m\u00e1quina anfitri\u00f3n y no viceversa. Es posible encontrar el caso contrario y se trata de la tecnolog\u00eda empleada en los sistemas operativos distribuidos vistos en la unidad anterior.</p> <p></p> <p>Esta capa de software (VMM) gestiona los recursos principales del ordenador como el procesador, la memoria principal, dispositivos perif\u00e9ricos, memoria secundaria y redes de comunicaci\u00f3n. Se encarga de repartir los recursos de forma din\u00e1mica entre todos las m\u00e1quinas virtuales, lo que hace que se pueda contener varias m\u00e1quinas dentro de un s\u00f3lo anfitri\u00f3n. No es raro encontrar numerosas herramientas de virtualizaci\u00f3n en el mercado especializadas en diferentes \u00e1mbitos. Existen varias formas de virtualizaci\u00f3n y es posible virtualizar tanto el hardware como el software de servidor, sesiones de usuario, aplicaciones y tambi\u00e9n se pueden crear m\u00e1quinas virtuales en un ordenador de escritorio. Esta \u00faltima ser\u00e1 la forma que se utilizar\u00e1 a lo largo de este m\u00f3dulo. Se crear\u00e1n varias m\u00e1quinas virtuales conectadas entre s\u00ed para dar soporte a nuestra infraestructura de servicio de directorio.</p> <p>En cuanto a tipos de virtualizaci\u00f3n, existe cuantiosa casu\u00edstica, pero hay dos tipolog\u00edas que destacan entre ellas; por la infraestructura de virtualizaci\u00f3n y por la t\u00e9cnica de virtualizaci\u00f3n.</p> <p>En el primer caso disponemos de virtualizaci\u00f3n de nivel 1, que es la que realiza directamente sobre el hardware de la m\u00e1quina anfitri\u00f3n sin intermediarios. No existe sistema operativo que gestione los recursos de la m\u00e1quina para ofrec\u00e9rselos al software de virtualizaci\u00f3n, sino que es el software de virtualizaci\u00f3n el que accede directamente a los recursos f\u00edsicos y los transforma en virtuales. La ventaja de no contar con otro sistema operativo entre la virtualizaci\u00f3n y el hardware, facilita y optimiza la conversi\u00f3n de los recursos. Se pueden encontrar diferentes herramientas de nivel 1, recordemos las m\u00e1s destacadas:</p> <ul> <li> <p>Xen Project Hypervisor es una plataforma de virtualizaci\u00f3n de nivel 1 de c\u00f3digo abierto mantenido por una comunidad de desarrolladores que se mantiene muy activa. Muchas de las plataformas de virtualizaci\u00f3n on-line est\u00e1n basadas en Xen Project Hypervisor como Amazon Web Services, Aliyum y Verizon Cloud entre otras.</p> </li> <li> <p>Proxmox es un software de c\u00f3digo abierto con su propia comunidad de desarrolladores. Est\u00e1 orientada a la construcci\u00f3n de infraestructuras inform\u00e1ticas a lo largo de una red local. Posee una interfaz web para el control de las m\u00e1quinas y ofrece otra serie de servicios virtualizados como Proxmox Mail Gateway, un filtro de spam y virus, aunque estos productos requieren de una suscripci\u00f3n.</p> </li> <li>Hyper-V es otra propuesta por parte de Microsoft de c\u00f3digo propietario y de pago en este caso. La ventaja sobre otras plataformas de nivel 1 es que es una plataforma nativa para sistemas operativos de la compa\u00f1\u00eda, lo que favorece su rendimiento y escalabilidad. Esta plataforma tambi\u00e9n puede trabajar como una de nivel 2, integrada en la familia de servidores de Microsoft desde Windows Server 2008.</li> <li>WMware vSphere Hypervisor es otra plataforma de nivel 1 ofrecida por WMware (empresa referente en el mundo de la virtualizaci\u00f3n) de c\u00f3digo propietario pero de uso gratuito.</li> </ul> <p>La virtualizaci\u00f3n de nivel 2 al contrario, se realiza sobre el sistema operativo de la m\u00e1quina anfitri\u00f3n. Se instala una aplicaci\u00f3n que contendr\u00e1 las m\u00e1quinas virtuales. Este tipo de virtualizaci\u00f3n es la m\u00e1s extendida y es con la que se trabajar\u00e1 en este m\u00f3dulo. Entre los diferentes sistemas de virtualizaci\u00f3n de nivel 2, se destacan las siguientes:</p> <ul> <li>VMware Workstation que nos ofrece una de las plataformas de nivel 2 m\u00e1s potentes y se ha convertido en un est\u00e1ndar del sector para la virtualizaci\u00f3n. Es de c\u00f3digo propietario y su uso es de pago, aunque disponemos de VWware Workstation Player de forma gratuita, aunque perderemos la capacidad de crear m\u00e1quinas virtuales, tan s\u00f3lo administrarlas.</li> <li>Oracle VM VirtualBox es una propuesta que hasta 2007 dispon\u00eda de su versi\u00f3n OSE (Open Source Edition) bajo licencia GPL 2 (General Public License). Actualmente es de c\u00f3digo propietario pero gratuita, aunque tan s\u00f3lo se puede utilizar bajo licencia de \u201cUso personal y de Evaluaci\u00f3n\u201d PUEL (Personal Use and Evaluation License). Licencia que se ajustar\u00e1 las necesidades de este m\u00f3dulo, por lo que ser\u00e1 esta herramienta la que se usar\u00e1 para virtualizar la infraestructura necesaria.</li> <li>QEMU es un emulador y plataforma virtual de c\u00f3digo abierto que se distribuye de forma gratuita. Es compatible con la mayor\u00eda de m\u00e1quinas virtuales y permite administrar las creadas con Xen Project Hypervisor con un rendimiento muy cercano al original.</li> </ul> <p>En cuanto a la clasificaci\u00f3n por t\u00e9cnicas de virtualizaci\u00f3n disponemos de dos tipos:</p> <ul> <li>virtualizaci\u00f3n por software, que posibilita la virtualizaci\u00f3n en todo tipo de ordenadores, antiguos y modernos, pero las m\u00e1quinas virtuales son lentas y necesita m\u00e1s recursos por parte del procesador.</li> <li>virtualizaci\u00f3n por hardware, que aceleran la ejecuci\u00f3n del hu\u00e9sped, pero s\u00f3lo funcionan con procesadores modernos. En el caso de Intel, la virtualizaci\u00f3n por hardware se denomina VT-x y en el caso de AMD, se denomina AMD-V. En la mayor\u00eda de ordenadores, la virtualizaci\u00f3n por hardware se debe habilitar en la BIOS.</li> </ul> <p>Las ventajas que ofrece esta tecnolog\u00eda son notables y van desde la reutilizaci\u00f3n y optimizaci\u00f3n del aprovechamiento del hardware hasta la contribuci\u00f3n medioambiental, pasando por la r\u00e1pida incorporaci\u00f3n de nuevos recursos al sistema virtualizado, reducci\u00f3n de costes econ\u00f3micos y espaciales, mejora de los procesos de clonaci\u00f3n y copia de sistema, mejora los procesos de aislamiento ante un fallo o alerta de seguridad y la administraci\u00f3n global centralizada de los recursos.</p>"},{"location":"UD1/virtual/#configuracion-y-administracion-de-un-sistema-virtualizado","title":"Configuraci\u00f3n y administraci\u00f3n de un sistema virtualizado","text":"<p>Los pasos contenidos en este apartado son v\u00e1lidos para cualquier sistema de virtualizaci\u00f3n de nivel 2, pero se va a centrar los ejemplos en la soluci\u00f3n Oracle VM VirtualBox. Esta plataforma permite la creaci\u00f3n de m\u00e1quinas virtuales y una red virtual para conectar estas m\u00e1quinas sin ocasionar interferencias con las m\u00e1quinas o redes f\u00edsicas en las que se encuentre el equipo anfitri\u00f3n.</p>"},{"location":"UD1/virtual/#creacion-de-una-maquina-virtual","title":"Creaci\u00f3n de una m\u00e1quina virtual","text":"<p>A la hora de crear una m\u00e1quina virtual, Oracle VM VirtualBox ofrece un asistente que guiar\u00e1 a trav\u00e9s de todo el proceso. Una vez lanzado el asistente ahorraremos tiempo si se usa el bot\u00f3n de Modo Experto el cual mostrar\u00e1 en una sola ventana las opciones de creaci\u00f3n de nuestra m\u00e1quina.</p> <p></p> <p>Tres son los elementos que se deben configurar como m\u00ednimo para la creaci\u00f3n de una m\u00e1quina virtual:</p> <ul> <li>El tipo de sistema operativo que contendr\u00e1 la m\u00e1quina y su arquitectura,</li> <li>El tama\u00f1o de la memoria principal y</li> <li>Qu\u00e9 disco duro virtual le asignaremos como memoria secundaria.   Hay que tener presente los recursos de los que dispone la m\u00e1quina anfitri\u00f3n, y no ceder demasiados de \u00e9stos para que el rendimiento no caiga hasta l\u00edmites insufribles. Habitualmente el software de virtualizaci\u00f3n avisa al usuario si va a superar estos l\u00edmites.</li> </ul> <p>La elecci\u00f3n de un tipo de disco duro determinar\u00e1 en que plataformas ser\u00e1 compatible ese disco duro virtual. De esta manera VDI (VirtualBox Disk Image) ser\u00e1 el formato nativo de VirtualBox, aunque tambi\u00e9n disponemos de VHD (Virtual Hard Disk) de Microsoft Virtual PC, VMDK (Virtual Machine Disk) propia de VMware Workstation, HDD (Parallels Hard Disk) de Parallels o los formatos QCOW (QEMU Copy-On-Web) y QED (QEMU Enhanced Disk) de la plataforma QEMU.</p> <p>Algo a tener muy en cuenta es el tipo de almacenamiento f\u00edsico que vamos a dar al disco duro virtual. Existen dos opciones:</p> <ul> <li>Almacenamiento reservado din\u00e1micamente, aumenta el tama\u00f1o del fichero a medida que los archivos se van copiando en el disco duro virtual. En esta configuraci\u00f3n no importa el tama\u00f1o m\u00e1ximo del disco, ya que tan s\u00f3lo cuando \u00e9ste est\u00e9 lleno, ocupar\u00e1 ese espacio de forma f\u00edsica en el disco anfitri\u00f3n. Ofrece la ventaja de ahorrar espacio en el disco duro f\u00edsico, pero es una configuraci\u00f3n m\u00e1s lenta ya que tiene que redireccionar espacio nuevo cada vez que se escribe un archivo en el disco duro virtual.</li> <li>Almacenamiento en tama\u00f1o fijo, reserva el espacio en el disco anfitri\u00f3n en funci\u00f3n del total de la capacidad del disco duro virtual. Si el tama\u00f1o m\u00e1ximo del disco duro virtual es de 32 GB, ser\u00e1 ese el tama\u00f1o del archivo en el disco duro f\u00edsico. Esta configuraci\u00f3n consume m\u00e1s cantidad de recursos del sistema anfitri\u00f3n. Por contra en acceso al disco es m\u00e1s r\u00e1pido, ya que no ser\u00e1 necesario la redirecci\u00f3n de espacio nuevo en el disco duro en cada escritura.</li> </ul> <p>El fichero que contenga en disco duro virtual, tendr\u00e1 unas dimensiones considerables, sobre todo si se usa la t\u00e9cnica de almacenamiento en tama\u00f1o fijo. Oracle VM Workstation ofrece la posibilidad de dividir este fichero en fragmentos de 2 GB lo que permitir\u00e1 mejor gesti\u00f3n del disco duro, el aumento de seguridad y la compatibilidad. Marcar esta casilla es obligatorio si el disco duro anfitri\u00f3n posee un sistema de archivos anterior a NTFS (FAT16 o FAT32).</p>"},{"location":"UD1/virtual/#administrador-de-medios-virtuales","title":"Administrador de medios virtuales","text":"<p>Cuando se crea una m\u00e1quina virtual se crea tambi\u00e9n una disco duro virtual alojado en el disco duro anfitri\u00f3n, como se ya se ha mencionado. La creaci\u00f3n de este dispositivo virtual lleva consigo la asignaci\u00f3n de un identificador un\u00edvoco basado en UUID (Universal Unique Identifier). Se trata de un n\u00famero de 128 bits separado en cinco grupos por guiones. Esta identificaci\u00f3n \u00fanica evita que el mismo disco duro virtual sea asignado a varias m\u00e1quinas virtuales de forma simult\u00e1nea. Cuando se crea una m\u00e1quina, se le asocia un disco duro nuevo o bien uno ya existente. Mientras este disco est\u00e9 asignado a una m\u00e1quina virtual se encuentra en estado ligado y tan solo esa m\u00e1quina ser\u00e1 capaz de escribir en \u00e9l. Esto quiere decir tambi\u00e9n que no se puede asignar a ninguna otra.</p> <p>Si es necesario realizar esta asignaci\u00f3n, antes se debe liberar ese disco a trav\u00e9s del administrador de medios virtuales. De esta forma simulamos el funcionamiento f\u00edsico de los discos duros y, adem\u00e1s, dotamos de m\u00e1s seguridad al sistema virtualizado.</p> <p></p> <p>Desde este mismo men\u00fa podremos realizar una copia de un disco duro virtual. Una vez realizada, el disco duro copiado habr\u00e1 generado un nuevo UUID, indicando que, a pesar de ser una copia exacta del primero, en realidad Oracle VM VirtualBox lo tratar\u00e1 como un disco duro diferente. Este disco reci\u00e9n creado se le puede asignar a cualquier m\u00e1quina virtual disponible, incluso la que contiene el disco original.</p> <p>Otras de las acciones que se puede realizar en este administrador, es dotar de funcionalidades especiales a los discos duros virtuales. Existen diferentes modos los cuales se resumen en:</p> <ul> <li> <p>normal, esta es la configuraci\u00f3n por defecto cuando se crea un nuevo disco duro. No existen restricciones sobre como el sistema operativo hu\u00e9sped lee y escribe en el disco. Los cambios que se produzcan en \u00e9l ser\u00e1n permanentes.</p> </li> <li> <p>inmutable, cualquier dato escrito por un sistema operativo hu\u00e9sped en un disco inmutable se almacena en una imagen de disco de diferenciaci\u00f3n separada. Cuando la m\u00e1quina virtual a la que se adjunta la imagen de disco se apaga o reinicia, el disco de diferenciaci\u00f3n y los contenidos que se encuentran en \u00e9l se descartan, dejando el disco inmutable inalterado. Este enfoque permite que m\u00faltiples m\u00e1quinas virtuales que comparten el mismo archivo de imagen de disco, cada uno se le asigna su propio disco de diferenciaci\u00f3n durante el tiempo de ejecuci\u00f3n. A pesar de soportar m\u00e1s de una m\u00e1quina ligado a un dispositivo inmutable, tan s\u00f3lo una de ellas puede estar encendida de forma simultanea.</p> </li> <li> <p>escritura simult\u00e1nea, permite las operaciones de escritura y lectura como en modo normal con la salvedad que al apagar o reiniciar la m\u00e1quina el disco vuelve a su estado original.</p> </li> <li> <p>compartible, permite compartir un disco duro entre varias m\u00e1quinas virtuales. Esto lo hace ideal para la formaci\u00f3n de clusters. S\u00f3lo los discos de tama\u00f1o fijo pueden utilizar esta configuraci\u00f3n.</p> </li> <li> <p>multiconexi\u00f3n, b\u00e1sicamente se trata de un medio inmutable con conexi\u00f3n de varias m\u00e1quinas simult\u00e1neamente. Adem\u00e1s, el disco de diferenciaci\u00f3n que crea cada m\u00e1quina conectada a este disco duro, no se borra al reiniciar o apagar el sistema virtual.</p> </li> </ul> <p></p> <p>Este administrador tambi\u00e9n gestiona los discos \u00f3pticos y los discos flexibles, indicando a qu\u00e9 m\u00e1quina virtual est\u00e1n conectados y permitiendo conectarlos a otra m\u00e1quina si as\u00ed se requiere. Estos dispositivos funcionan de igual forma que los discos duros virtuales en modo normal, pudiendo estar conectados a una \u00fanica m\u00e1quina virtual de forma simult\u00e1nea.</p>"},{"location":"UD1/virtual/#configurar-redes-virtuales","title":"Configurar redes virtuales","text":"<p>Una de las ventajas de trabajar con m\u00e1quinas virtuales, es que desde el punto de vista de una red local, podemos tratarla de igual forma que si de un equipo f\u00edsico se tratase. Es m\u00e1s, si as\u00ed se requiere, tambi\u00e9n nos permite la creaci\u00f3n de una red local interna y que tan s\u00f3lo los equipos hu\u00e9sped sean capaces de detectar. Esta configuraci\u00f3n brinda la posibilidad de crear sistemas inform\u00e1ticos de prueba completamente virtualizados, y sin interacci\u00f3n alguna con la m\u00e1quina anfitri\u00f3n. Cualquiera de estas configuraciones debe realizarse sobre el adaptador de red virtual, que ser\u00e1 el encargado de gestionar la conexi\u00f3n de la m\u00e1quina. Hay que conocer las distintas configuraciones que se le pueden asignar a un dispositivo de red virtual:</p> <ul> <li>no conectado, la tarjeta virtual existe en el hu\u00e9sped, pero est\u00e1 configurada como si no tuviera ning\u00fan cable conectado. Huelga decir que la m\u00e1quina hu\u00e9sped no dispone de conexi\u00f3n de red alguna.</li> <li>NAT, (Network Address Translation) es el modo por defecto de la tarjeta de red virtual. La m\u00e1quina hu\u00e9sped puede conectarse a otras redes mediante un router virtual proporcionado por Oracle VirtualBox. En este modo es posible navegar por Internet sin ser detectado por el resto de nodos de la red. Dicho router sirve direcciones DHCP del tipo 10.0.X.0/24 donde X es igual a dos para la primera tarjeta de red, X es igual a tres para la segunda tarjeta de red y as\u00ed sucesivamente. En el caso de una \u00fanica tarjeta de red, el router tiene como puerta de enlace la direcci\u00f3n 10.0.2.2, como servidor DNS la direcci\u00f3n 10.0.2.3 y la primera direcci\u00f3n DHCP asignada es la 10.0.2.15.</li> <li>red NAT, configura una red a la que se unen todas las m\u00e1quinas virtuales que quieran tener acceso a Internet sin interferir con la red en la que est\u00e1 inmersa el anfitri\u00f3n. Antes de unirnos a una red de estas caracter\u00edsticas habr\u00e1 que crearla con la herramienta en l\u00ednea de comandos vboxmanage o a trav\u00e9s del administrador de redes.</li> <li>Adaptador puente, se crea un tarjeta de red virtual en el anfitri\u00f3n que intercepta el tr\u00e1fico del hu\u00e9sped y puede inyectar paquetes en la red, de manera que el hu\u00e9sped se configura como si estuviera conectado por un cable a la tarjeta de red virtual del anfitri\u00f3n. La m\u00e1quina hu\u00e9sped es visible en la red.</li> <li>red interna, se crea una red virtual visible entre las m\u00e1quinas virtuales, pero invisible al anfitri\u00f3n y a m\u00e1quinas externas a la red. Cada red virtual creada se identifica mediante un nombre. Para conectar a los hu\u00e9spedes en la misma red virtual, ser\u00e1 necesario que sus controladoras de red se sit\u00faen en la red con el mismo nombre.</li> <li>adaptador s\u00f3lo-an\ufb01tri\u00f3n: en este modo se crea una tarjeta de red virtual en el anfitri\u00f3n que puede conectarse con las m\u00e1quinas virtuales sin necesitar que el anfitri\u00f3n tenga una tarjeta destinada a esta tarea.</li> </ul> <p></p>"},{"location":"UD1/virtual/#instalacion-de-sistemas-operativos-requisitos-y-configuracion-previa","title":"Instalaci\u00f3n de sistemas operativos. Requisitos y configuraci\u00f3n previa","text":"<p>Una de las primera tareas que se deben realizar para la instalaci\u00f3n de un sistema operativo, es confirmar que efectivamente se puede instalar. Para ello es necesario comprobar los requisitos m\u00ednimos de hardware que se deben cumplir para que el sistema operativo se instale y funcione correctamente.</p> <p>Es necesario revisar los requerimientos en la velocidad del procesador, cantidad de memoria principal y CHIPSET de la placa base. En la actualidad las tarjetas gr\u00e1ficas y la memoria secundaria son requisitos que se cumplen con relativa facilidad.</p> <p>Adem\u00e1s, es muy importante comprobar que el fabricante del hardware dispone de los controladores para la versi\u00f3n del sistema operativo. La inexistencia de ellos no impide la instalaci\u00f3n, pero afectar\u00e1 al rendimiento general del ordenador. Una vez determinados los requisitos m\u00ednimos de hardware, hay que asegurarse si es compatible con el sistema operativo que haya elegido para la infraestructura, sobre todo en lo referente a la arquitectura del procesador. Un procesador con una arquitectura de 32 bits ser\u00e1 incapaz de manejar un sistema operativo de una arquitectura diferente. Adem\u00e1s, en la medida de lo posible se ha de elegir la arquitectura de 64 bits para contener los sistemas operativos, ya que la anterior posee ciertas limitaciones que supondr\u00edan un lastre en el sistema.</p> <p>En la actualidad, la instalaci\u00f3n de un sistema operativo es un proceso completamente guiado y trivial, por lo que no se ahondar\u00e1 mucho en este proceso. Ser\u00e1 con posterioridad cuando se configuren muchos de los aspectos que se han configurado de forma autom\u00e1tica. Pero antes ser\u00e1 necesario realizar ciertas comprobaciones:</p> <ul> <li>revisar la compatibilidad y requerimientos del hardware.</li> <li>arrancar el ordenador con el medio extra\u00edble conectado y la BIOS debidamente configurada.</li> <li>iniciar el asistente de instalaci\u00f3n que guiar\u00e1 el proceso de instalaci\u00f3n.</li> <li>asignar particiones de forma adecuada a los discos duros, proceso que se realizar\u00e1 de forma autom\u00e1tica en este apartado.</li> <li>tras la copia de ficheros, realizar configuraciones iniciales en cada sistema operativo, operaciones que se analizar\u00e1n en la unidad de trabajo n\u00famero 3.</li> </ul> <p>No existen muchas diferencias entre el proceso de instalaci\u00f3n de un sistema operativo cliente y uno de red, al menos en sistemas operativos de Microsoft. Por lo que respecta a distribuciones basadas en GNU/Linux usadas en este manual, s\u00ed existen algunas diferencias entre instalar un sistema operativo cliente o uno de red. Las diferencias se ilustran en el siguiente apartado.</p>"},{"location":"UD1/virtual/#instalacion-de-ubuntu-server","title":"Instalaci\u00f3n de Ubuntu Server","text":"<p>El proceso de instalaci\u00f3n de Ubuntu Server no es muy diferente del de Ubuntu Desktop pero al contrario que \u00e9ste, necesita instalar ciertas caracter\u00edsticas que todav\u00eda no se ha tratado. Por este motivo se realizar\u00e1 una peque\u00f1a gu\u00eda de instalaci\u00f3n destacando las configuraciones que son requeridas durante el proceso y propias de un servicio de directorio, como el servicio de DNS:</p> <ul> <li>tras elegir el idioma y configuraci\u00f3n del teclado, proceder\u00e1 a detectar el hardware del sistema y configurarlo, entre ellos, los dispositivos de red. Turno para la configuraci\u00f3n predeterminada de red y el nombre de la m\u00e1quina.</li> <li>turno de los usuarios. Configurar\u00e1 un usuario para usar en lugar de la cuenta de superusuario. El asistente es autoexplicativo: nombre del usuario, nombre de la cuenta, contrase\u00f1a, ubicaci\u00f3n y cifrado de la cuenta.</li> <li>la instalaci\u00f3n seguir\u00e1 con el particionado del disco y la copia de ficheros en el disco duro. Como de costumbre, ofrecer\u00e1 un particionado autom\u00e1tico y otro manual. En cada ocasi\u00f3n se proceder\u00e1 seg\u00fan requerimientos.</li> <li>una vez copiados los datos, se descargar\u00e1n las actualizaciones necesarias, se configurar\u00e1 el gestor de paquetes as\u00ed como las actualizaciones del sistema operativo. En el siguiente paso es d\u00f3nde se encuentra la diferencia a la que se hac\u00eda referencia. Ubuntu Server permite instalar diferentes servicios durante el proceso de instalaci\u00f3n del sistema operativo. Se seleccionar\u00e1 la opci\u00f3n \u201cHerramientas est\u00e1ndar del sistema\u201d y se instalar\u00e1n los servicios necesarios de forma manual a medida que sean necesarios tras la instalaci\u00f3n.</li> </ul> <p></p> <p>La instalaci\u00f3n de Microsoft Windows Server no ofrece esta posibilidad, siendo con posterioridad cuando el SOR sea promocionado a servidor y dotado de estas herramientas, tema que se abordar\u00e1 en la unidad de trabajo n\u00famero 5.</p>"},{"location":"UD1/virtual/#herramientas-de-virtualizacion","title":"Herramientas de virtualizaci\u00f3n","text":"<p>Para el estudio de los contenidos que se detallan es este punto ser\u00e1 necesario la instalaci\u00f3n, en cada sistema operativo contenido en una m\u00e1quina virtual, la herramienta Oracle Guest Additions.</p> <p>Para instalarla, una vez arrancada la m\u00e1quina virtual, se accede al men\u00fa Dispositivos  \u2192 Insertar imagen de CD de las Guest Additions\u2026  . Tras esto se deber\u00e1 instalar el software en la m\u00e1quina hu\u00e9sped como si de un programa normal se tratase (claro dependiendo que sistema operativo sea). Al acabar, y tras reiniciar el sistema virtualizado, ya se dispondr\u00e1 de las opciones de compartici\u00f3n que se especifican en este apartado.</p>"},{"location":"UD1/virtual/#comunicacion-anfitrion-huesped","title":"Comunicaci\u00f3n anfitri\u00f3n-hu\u00e9sped","text":"<p>Aunque dispongamos de una red y la m\u00e1quina hu\u00e9sped se encuentre dentro de esta red de alguna de las formas que se han visto en el apartado anterior, es posible que tanto el hu\u00e9sped como el anfitri\u00f3n se comuniquen sin necesidad de estar contenidos dentro de ella. Adem\u00e1s de ser una comunicaci\u00f3n m\u00e1s r\u00e1pida y c\u00f3moda, no interfiere en con el resto de equipos tanto virtuales como f\u00edsicos.</p>"},{"location":"UD1/virtual/#carpetas-compartidas","title":"Carpetas compartidas","text":"<p>En la m\u00e1quina anfitri\u00f3n se crea una carpeta a la que los hu\u00e9spedes pueden acceder. El acceso se realizar\u00e1 en funci\u00f3n del sistema operativo que contenga la m\u00e1quina virtual. Si se trata de un sistema de Microsoft, se acceder\u00e1 a la carpeta como si de un recurso de red se tratase. Si se trata de un sistema operativo GNU/Linux o Solaris se proporciona un sistema de archivos especial dise\u00f1ado para estas tareas denominado vboxsf.</p>"},{"location":"UD1/virtual/#dispositivos-usb","title":"Dispositivos USB","text":"<p>Otra forma r\u00e1pida de compartir ficheros es el uso de dispositivos de almacenamiento USB. Conseguiremos conectar un dispositivo USB a la m\u00e1quina virtual siguiendo estos pasos:</p> <ul> <li>conecta el USB a la m\u00e1quina anfitri\u00f3n.</li> <li>en la m\u00e1quina hu\u00e9sped Dispositivos\u2192 USB y aparecer\u00e1 un listado de los dispositivos que se encuentran conectados.</li> <li>pulsamos sobre alguno de ellos, el control de \u00e9ste pasar\u00e1 a manos de la m\u00e1quina virtual.</li> <li>para liberar el dispositivo USB, pulsamos sobre el dispositivo que queramos liberar, el anfitri\u00f3n retomar\u00e1 el control sobre \u00e9l.</li> </ul> <p>Hay que tener en cuenta que esta acci\u00f3n desconectar\u00e1 la el dispositivo USB de la m\u00e1quina anfitri\u00f3n. Si en ese momento existe alg\u00fan fichero abierto en \u00e9l, es posible la p\u00e9rdida de informaci\u00f3n. Esta situaci\u00f3n se repite cuando queremos liberar el dispositivo desde la m\u00e1quina hu\u00e9sped.</p>"},{"location":"UD1/virtual/#arrastrar-y-soltar","title":"Arrastrar y soltar","text":"<p>Oracle VirtualBox permite con este m\u00e9todo arrastrar archivos entre anfitri\u00f3n-cliente como si de una carpeta se tratase. Para habilitarlo hay que ir al men\u00fa a Dispositivos \u2192 Arrastrar y soltar. Se puede elegir el sentido de la copia de ficheros, desactivarlo o configurarlos como bidireccional.</p> <p></p>"},{"location":"UD1/virtual/#portapapeles","title":"Portapapeles","text":"<p>Tambi\u00e9n es posible compartir el portapapeles entre los sistemas anfitri\u00f3n-hu\u00e9sped a trav\u00e9s del men\u00fa Dispositivos \u2192 Portapapeles compartido. De igual forma que en el caso anterior, es posible configurar la direcci\u00f3n o deshabilitar esta caracter\u00edstica.</p> <p>En definitiva, se dispone de muchas opciones para compartir ficheros entre la m\u00e1quina anfitri\u00f3n y el hu\u00e9sped. A todas las vistas en este apartado hay que a\u00f1adir los recursos compartidos de red. Elegir una de ellas depender\u00e1 de la necesidades de cada ocasi\u00f3n y tambi\u00e9n de las preferencias del usuario.</p>"},{"location":"UD1/virtual/#herramientas-avanzadas","title":"Herramientas avanzadas","text":"<p>Este apartado no pretende ser exhaustivo, ya que la explicaci\u00f3n de todas las posibilidades que ofrece una herramienta como Oracle VirtualBox excede de las pretensiones de este manual. S\u00ed que se trata de acciones comunes que todo usuario debe conocer para optimizar su trabajo.</p>"},{"location":"UD1/virtual/#instantaneas","title":"Instant\u00e1neas","text":"<p>Las instant\u00e1neas, tambi\u00e9n conocidas como snapshots, permiten al usuario realizar una copia del estado actual de la m\u00e1quina para poder regresar a \u00e9l con posterioridad. Esta opci\u00f3n es \u00fatil cuando se necesita realizar una instalaci\u00f3n de software cr\u00edtico, alguna configuraci\u00f3n del sistema o alguna otra acci\u00f3n que ponga en peligro la estabilidad del sistema operativo. Antes de proceder a esta acci\u00f3n, es conveniente realizar una instant\u00e1nea para guardar el estado actual del sistema. A partir de este punto, todos los cambios que se realicen quedar\u00e1n guardados en un disco duro virtual diferencial. Una vez acabado la acci\u00f3n cr\u00edtica sobre el sistema, \u00e9ste podr\u00e1 volver a un estado anterior y comenzar una nueva l\u00ednea de tiempo, si as\u00ed se requiere.</p> <p></p> <p>Cuando Oracle VirtualBox realiza una instant\u00e1nea las guarda en la pesta\u00f1a de Instant\u00e1neas de cada m\u00e1quina virtual. Es posible realizarlas tanto con la m\u00e1quina corriendo como apagada y muy recomendable que escribamos un comentario del motivo por el cual realizamos la instant\u00e1nea. Pasados unos d\u00edas ser\u00e1 dif\u00edcil recordar el porqu\u00e9 se hizo esa snapshot. Si es necesario la recuperaci\u00f3n de una de ellas, tan s\u00f3lo habr\u00e1 que pulsar el bot\u00f3n derecho sobre ella y seleccionar la opci\u00f3n  Restaurar Instant\u00e1nea  del men\u00fa emergente.</p>"},{"location":"UD1/virtual/#atajos-de-teclado","title":"Atajos de teclado","text":"<p>Existen combinaciones de teclas especiales para cada sistema operativo. Cuando se realizan estas combinaciones, siempre son captadas por el anfitri\u00f3n, dejando sin posibilidad de reacci\u00f3n al hu\u00e9sped. Por ejemplo, si pulsamos la combinaci\u00f3n Alt+Crtl+Supr con una m\u00e1quina hu\u00e9sped abierta, no ser\u00e1 \u00e9sta la que muestre el administrador de tareas, sino el anfitri\u00f3n. Para enviar ordenes mediante combinaci\u00f3n de teclas especiales al hu\u00e9sped es posible realizarla de dos formas:</p> <ul> <li>a trav\u00e9s del men\u00fa Entrada  \u2192 Teclado  en la ventana de la m\u00e1quina   virtuales. <li>mediante una combinaci\u00f3n de teclas alternativa, todas los hu\u00e9spedes tienen una tecla especial denominada tecla anfitri\u00f3n que nos brinda otra forma de interactuar con ella. En el ejemplo anterior, si es necesario abrir el administrador de tareas en el hu\u00e9sped, se realizar\u00e1 pulsando la tecla anfitri\u00f3n+Supr .   Por defecto,Oracle VM VirtualBox establece que la tecla anfitri\u00f3n es Ctrl Derecho. A trav\u00e9s del men\u00fa Entrada  \u2192 Teclado \u2192 Preferencias de teclado\u2026  se habilitar\u00e1 un editor para poder cambiar tanto la tecla anfitri\u00f3n como sus combinaciones.</li> <p></p>"},{"location":"UD1/virtual/#clonar-una-maquina-virtual","title":"Clonar una m\u00e1quina virtual","text":"<p>Clonar una m\u00e1quina es crear una copia de un hu\u00e9sped exactamente igual a la clonada con la salvedad de sus n\u00fameros de identificaci\u00f3n (UUID) diferentes. De esta forma ambas m\u00e1quinas podr\u00e1n ser ejecutadas dentro del mismo entorno. Es una pr\u00e1ctica recomendable que, tras acabar la instalaci\u00f3n e instalar las Guess Additions, se realice una clon de la m\u00e1quina para disponer de una copia limpia por si ocurriera alg\u00fan desastre. Es importante tener en cuenta que el hu\u00e9sped clonado siempre debe permanecer apagado hasta que termine el proceso.</p> <p>Existe un asistente de clonado en que se deber\u00e1 indicar el nombre de la nueva m\u00e1quina, si se quiere cambiar la MAC de los dispositivos de red (importante, hay que recordar que no pueden haber dos tarjetas de red con la misma direcci\u00f3n f\u00edsica dentro del sistema), as\u00ed como si se desea clonar tan s\u00f3lo el estado actual de la m\u00e1quina o con todas sus instant\u00e1neas.</p> <p>Adem\u00e1s de estas opciones, es importante la selecci\u00f3n del tipo de clonaci\u00f3n que mejor se adapte a las necesidades del proyecto:</p> <ul> <li>completa, crea una copia de todos los archivos de la m\u00e1quina virtual junto con todos sus discos duros.</li> <li>enlazada, crea una copia de todos los archivos de la m\u00e1quina virtual pero no de los discos duros. En su lugar genera un nuevo disco duro diferencial donde almacena los cambios que se producen sobre el estado inicial de la m\u00e1quina clonada. En este estado, el nuevo hu\u00e9sped es dependiente de la m\u00e1quina original y no podr\u00e1 funcionar sin ella. Este m\u00e9todo ahorra espacio en el disco duro pero aumenta las dependencias entre dispositivos virtuales.</li> </ul> <p></p> <p>Una vez seleccionadas todas las opciones, pulsando el bot\u00f3n Clonar obtendremos una nueva m\u00e1quina id\u00e9ntica a la inicial.</p>"},{"location":"UD1/virtual/#exportacion-e-importacion-de-maquinas-virtuales","title":"Exportaci\u00f3n e importaci\u00f3n de m\u00e1quinas virtuales","text":"<p>Este m\u00e9todo es valido cuando queremos trasladar alguna m\u00e1quina hu\u00e9sped de un equipo a otro e incluso de un software de virtualizaci\u00f3n diferente de d\u00f3nde fue creado. Para ello se dispone de un est\u00e1ndar abierto para empaquetar y distribuir servicios virtualizados denominado Open Virtualization Format (OVF). Al tratarse de un est\u00e1ndar abierto no est\u00e1 vinculado a ninguna arquitectura de procesador en concreto. La unidad de empaquetado y distribuci\u00f3n se denomina paquete OVF y puede contener uno o m\u00e1s sistemas virtuales, cada uno de los cuales se puede implementar en una m\u00e1quina virtual distinta.</p> <p>Para realizar estas acciones, para las cuales las m\u00e1quinas y/o servicios virtualizados deben estar apagados, es necesario ir al  Archivo \u2192 Exportar servicio virtualizado\u2026  y seguir el asistente que aparece.</p>"},{"location":"UD1/virtual/#cifrado-de-maquinas-virtuales","title":"Cifrado de m\u00e1quinas virtuales","text":"<p>Oracle VM VirtualBox ofrece una opci\u00f3n para cifrar las m\u00e1quinas virtuales que contengan informaci\u00f3n sensible. En concreto cifrar\u00e1 el archivo de disco o discos duros que del que el sistema virtualizado disponga. A trav\u00e9s del men\u00fa Configuraci\u00f3n&lt; \u2192 General  \u2192 Cifrado se puede activar el cifrado de la m\u00e1quina virtual.</p> <p>Se utilizar\u00e1 un algoritmo de cifrado sim\u00e9trico AES de 128 o 256 bits. Tras insertar la contrase\u00f1a comenzar\u00e1 el proceso de cifrado. Es posible revertir esta operaci\u00f3n si se desmarca la opci\u00f3n Habilitar cifrado. En ese caso el programa solicitar\u00e1 la clave AES y proceder\u00e1 al descifrado de los archivos de la m\u00e1quina virtual. <p>El cifrado del disco duro virtual permitir\u00e1 que tan s\u00f3lo la m\u00e1quina que lo ha cifrado pueda usarlo, a menos que, al configurarlo en otro hu\u00e9sped, introduzcamos la contrase\u00f1a de cifrado. Esto evita que el disco virtual pueda conectarse a otras m\u00e1quinas sin el consentimiento del administrador del sistema.</p> <p>Se ha de tener en cuenta que, al menos hasta la versi\u00f3n 5.1 de Oracle VM VirtualBox, es necesario instalar el Oracle VirtualBox Extension Pack para tener disponible la opci\u00f3n de cifrado. Este paquete es descargable desde su p\u00e1gina oficial. Adem\u00e1s de esta caracter\u00edstica ofrece la posibilidad de cambiar el controlador de los dispositivos USB virtuales de la versi\u00f3n 1.0 a la 2.0 o 3.0, con el significativo aumento de rendimiento, el uso de la webcam del anfitri\u00f3n y el VirtualBox RDP (Remote Desktop Protocol) entre otras funcionalidades.</p> <p>Son muchas las caracter\u00edsticas que ofrece este software de virtualizaci\u00f3n, aunque conocerlas todas no es el objetivo de este manual. Conociendo las herramientas descritas en esta unidad, el trabajo del resto del manual se realizar\u00e1 sin complicaciones.</p>"},{"location":"UD10/012_PowerShellTotal/","title":"Power Shell","text":"Duraci\u00f3n y criterios de evaluaci\u00f3n <p>Duraci\u00f3n estimada: 3 sesiones (2h por sesi\u00f3n)</p> <p>Resultado de aprendizaje y Criterios de evaluaci\u00f3n:</p> <ol> <li>Utiliza lenguajes de guiones en sistemas operativos, describiendo su aplicaci\u00f3n y administrando servicios del sistema operativo.<ol> <li>Se han utilizado y combinado las estructuras del lenguaje para crear guiones.</li> <li>Se han utilizado herramientas para depurar errores sint\u00e1cticos y de ejecuci\u00f3n.</li> <li>Se han interpretado guiones de configuraci\u00f3n del sistema operativo.</li> <li>Se han realizado cambios y adaptaciones de guiones del sistema.</li> <li>Se han creado y probado guiones de administraci\u00f3n de servicios.</li> <li>Se han creado y probado guiones de automatizaci\u00f3n de tareas.</li> <li>Se han implantado guiones en sistemas propietarios.</li> <li>Se han consultado y utilizado librer\u00edas de funciones.</li> <li>Se han documentado los guiones creados.</li> </ol> </li> </ol>"},{"location":"UD10/012_PowerShellTotal/#introduccion","title":"Introducci\u00f3n","text":"<ul> <li>Los sistemas operativos basados en Microsoft Windows cuentan con la herramienta PowerShell, que surgi\u00f3 ante las carencias que presenta el viejo terminal basado en MS-DOS.</li> <li>PowerShell es una interfaz de consola (CLI) con posibilidad de escritura y uni\u00f3n de comandos por medio de instrucciones (scripts).</li> <li>Esta interfaz de consola est\u00e1 dise\u00f1ada para su uso por parte de administradores de sistemas, con el prop\u00f3sito de automatizar tareas o realizarlas de forma m\u00e1s controlada.</li> <li>En abril de 2006 Microsoft lanz\u00f3 una nueva interfaz CLI, con una sintaxis moderna que comparte similitudes con el lenguaje Perl.</li> <li>Perl es un lenguaje de programaci\u00f3n dise\u00f1ado por Larry Wall en 1987. Perl toma caracter\u00edsticas del lenguaje C, del lenguaje interpretado bourne shell, AWK, sed, Lisp y, en un grado inferior, de muchos otros lenguajes de programaci\u00f3n.</li> <li>Se trata de una interfaz gratuita, y que antes de Microsoft Windows 7 no se inclu\u00eda con el sistema operativo.</li> <li>En la actualidad, est\u00e1 incluida en todos los sistemas operativos de Microsoft, aunque requiere la presencia de <code>.NET</code> framework del que hereda sus caracter\u00edsticas orientadas a objetos.</li> <li>En agosto de 2016, Microsoft public\u00f3 su c\u00f3digo en GitHub para que pueda portarse a otros sistemas como GNU/Linux y MAC OSX.</li> <li>Los comandos incluidas en PowerShell reciben el nombre de cmdlets (command-let) y posee conjuntos espec\u00edficos para trabajar con Active Directory, Exchange, entre otros roles de servidor.</li> </ul> <p>Info</p> <p>cmdlets Existen cientos de cdmlet en la versi\u00f3n 5.1 de PowerShell. Es posible consultar la ayuda de cada uno de ellos en la p\u00e1gina oficial de Microsoft.</p> <ul> <li>Otra ventaja de PowerShell es que se dispone de la mayor\u00eda de comandos que del CLI tradicional de Microsoft. De ese modo, es posible ejecutar el comando <code>dir</code> en lugar del <code>Get-ChildItem</code>, cmdlet que realiza la misma tarea. En realidad lo que est\u00e1 usando es un alias del segundo para lanzar el primero.</li> <li>Dispone de autocompletado de comandos y par\u00e1metros que facilitar\u00e1 las tareas de creaci\u00f3n de scripts. Basta con comenzar a escribir un cmdlet y pulsarla tecla Tab.</li> <li>Si utilizamos PowerShell ISE al escribir aparecer\u00e1 una ventana con todos los cmdlets que coincidan con el texto escrito, incluso puede aparecer un recuadro con ayuda sobre su sintaxis. Para aceptar la sugerencia se pulsar la tecla Intro .</li> </ul> <p>Note</p> <p>Los nombres de todos los cmdlets est\u00e1n formados por un verbo, un gui\u00f3n y un nombre en singular. Habitualmente, se escribe con may\u00fasculas la primera letra de cada palabra, pero no se trata m\u00e1s que de una norma de estilo, porque PowerShell no distingue entre may\u00fasculas y min\u00fasculas.</p>"},{"location":"UD10/012_PowerShellTotal/#primer-script","title":"Primer Script","text":"<ul> <li>Al igual que ocurre en GNU/Linux un script de PowerShell no es m\u00e1s que un archivo de texto plano que contiene una secuencia de comando y de cmdlets para realizar una tarea.</li> <li>La diferencia con ellos es que aqu\u00ed ser\u00e1 necesario dotarlos de una extensi\u00f3n; <code>ps1</code>.</li> </ul> <p>Example</p> <p>``` Write-Host \"Hola!. Esto es mi primer script en PowerShell\" Write-Host \"Y esto es una segunda l\u00ednea\" ````</p> <ul> <li>A continuaci\u00f3n, se guarda el script desde el men\u00fa <code>Acci\u00f3n \u2192 Guardar Como\u2026</code> asign\u00e1ndole un nombre.</li> <li>Para ejecutarlo tan s\u00f3lo es necesario escribir su nombre en el terminal de PowerShell anteponiendo un punto y una barra.</li> </ul> <p>Example</p> <p><code>./Script.ps1</code></p> <ul> <li>Aunque tambi\u00e9n es posible ejecutar el script desde la herramienta gr\u00e1fica pulsando la tecla <code>F5</code>, ejecutar una parte de \u00e9l con <code>F8</code> o detener la ejecuci\u00f3n con <code>Ctrl+Intro</code>.</li> </ul>"},{"location":"UD10/012_PowerShellTotal/#powershell-ise","title":"PowerShell ISE","text":"<ul> <li>PowerShell viene acompa\u00f1ado de una herramienta gr\u00e1fica que facilita la administraci\u00f3n de todos los scripts. Se denomina Microsoft PowerShell ISE (Integrated Scripting Environment), y se accede a trav\u00e9s de: <code>Administrador del servidor \u2192 Herramientas \u2192 Windows PowerShell ISE</code>.</li> <li>El uso de esta herramienta gr\u00e1fica va a facilitar la creaci\u00f3n de los scripts de forma significativa.</li> <li>Es pr\u00e1ctico comenzar con esta ayuda ya que la sintaxis de los cmdlets, aunque sea l\u00f3gica y sencilla, tambi\u00e9n lo es amplia y desconocida.</li> </ul> Interfaz de la herramienta Windows PowerShell ISE <p>!!! info - Uno de los aspectos m\u00e1s interesantes que posee esta aplicaci\u00f3n es la barra de informaci\u00f3n que muestra un listado de todos los cmdlets de esta herramienta. Permite filtrarlos por funci\u00f3n y consultar la ayuda de cada uno de ellos. - Tambi\u00e9n posee un formulario destinado a generar el c\u00f3digo de un cmdlet de forma autom\u00e1tica.</p> <p>Example</p> <ul> <li>Creaci\u00f3n de un comando que realice una copia de seguridad de los scripts de trabajo en una memoria externa. Es necesario el uso de Copy-Item para ello, pero no se conoce su sintaxis.</li> <li>Si escribimos este cmdlet en el recuadro <code>Nombre</code> y se pulsa sobre <code>Mostrar Ayuda</code>, aparecer\u00e1 un formulario con sus opciones. Tras completar las necesarias y pulsando el bot\u00f3n <code>Insertar</code> situado en la parte inferior, el c\u00f3digo completo ser\u00e1 escrito la parte destinada al terminal.</li> </ul> Creaci\u00f3n autom\u00e1tica de scripts en Windows PowerShell ISE."},{"location":"UD10/012_PowerShellTotal/#comentarios","title":"Comentarios","text":"<p>Note</p> <p>Los comentarios en PowerShell se realizan precediendo a la l\u00ednea con el car\u00e1cter <code>#</code> si se trata de una sola l\u00ednea y <code>&lt;#</code> y <code>#&gt;</code> si es multil\u00ednea.</p>"},{"location":"UD10/012_PowerShellTotal/#parametros-en-powershell","title":"Par\u00e1metros en PowerShell","text":"<ul> <li>Como ocurr\u00eda en GNU/Linux, los par\u00e1metros que reciba el script se deben recoger de forma interna en una variable para poder operar con ellos.</li> </ul> <p>Example</p> <pre><code>      param ([string]$nombre)\n      Write-Host \"Hola!. Esto es mi primer script en PowerShell\"\n      Write-Host \"Y esto es una segunda l\u00ednea\"\n      Write-Host \"Hola de nuevo, tu nombre es $nombre\"\n      ```\n</code></pre> <p>Note</p> <ul> <li>El script anterior esperar\u00e1 un par\u00e1metro de tipo <code>string</code> que ser\u00e1 contenido en la variable nombre.</li> <li>En la cuarta l\u00ednea mostrar\u00e1 el contenido de la variable por pantalla.</li> <li>Para poder ejecutar este script, ser\u00e1 necesario acompa\u00f1arlo de un par\u00e1metro del siguiente modo.</li> </ul> <pre><code>./Script.ps1 \u201cF\u00ba Javier Hern\u00e1ndez Ill\u00e1n\u201d\n</code></pre> <ul> <li>Para entender por completo el ejemplo anterior, ser\u00e1 necesario ver como PowerShell maneja las variables.</li> </ul>"},{"location":"UD10/012_PowerShellTotal/#variables","title":"Variables","text":"<ul> <li>Para definir una variable en PowerShell s\u00f3lo tenemos que nombrarla utilizando para ello cualquier combinaci\u00f3n de caracteres, ya sean n\u00fameros, letras o s\u00edmbolos.</li> <li>Es posible utilizar espacios en el nombre, aunque en este caso el nombre debe ir rodeado por s\u00edmbolos de llaves {}.</li> <li>Al contrario que ocurre en shellscript, PowerShell es fuertemente tipado, lo que significa que las variables no son tratadas como cadenas de texto, sino que hay que especificar el tipo de dato que se guardar\u00e1 en ella.</li> <li>Para definir variables es posible utilizar el m\u00e9todo expl\u00edcito (adem\u00e1s con New-Variable y sus opciones), pero tambi\u00e9n se puede utilizar el m\u00e9todo impl\u00edcito anteponiendo el s\u00edmbolo $ delante del nombre.</li> </ul> <p>Info</p> <p>Get-Variable En cualquier momento puedes obtener una lista completa de las variables que se hayan definido hasta ese momento. Para lograrlo, basta con utilizar Get- Variable.</p>"},{"location":"UD10/012_PowerShellTotal/#implicita","title":"Implicita","text":"Tipo Descripci\u00f3n <code>[string]</code> Cadena de caracteres Unicode <code>[char]</code> Un s\u00f3lo car\u00e1cter Unicode de 16 bits <code>[byte]</code> Un s\u00f3lo car\u00e1cter Unicode de 8 bits <code>[int]</code> Entero con signo de 32 bits <code>[float]</code> N\u00famero con coma flotante de 32 bits <code>[double]</code> N\u00famero con coma flotante de 64 bits <code>[datetime]</code> Fecha y Hora <code>[bool]</code> Valor l\u00f3gico booleano <p>Example</p> <p><code>yaml   $numero = 9.99   $Final_2021 = 30   ${Mi variable} = \u201cContiene espacios en el nombre\u201d</code></p> <ul> <li>En la forma implicita el shell establece el tipo de dato de la variable en funci\u00f3n del dato que se le asigne en su creaci\u00f3n.</li> <li>En el ejemplo anterior <code>$numero</code> es de forma autom\u00e1tica de tipo <code>[double]</code>, ya que al crearla se ha inicializado con un n\u00famero con decimales.</li> <li>Por contra la variable <code>$Final_2021</code> es de tipo <code>[int]</code> ya que se ha guardado un n\u00famero entero en ella.</li> </ul> <p>Info</p> <p>_ GetType Para poder obtener el tipo de dato de una variable hay que usar el m\u00e9todo <code>GetType().Name</code> sobre cualquier variable: _ <code>Write-Host $feo.GetType().Name.</code></p> <p>!!! tip - Una variable cuya definici\u00f3n de tipo se ha realizado de forma impl\u00edcita, podr\u00e1 cambiar el tipo de dato almacenado durante la ejecuci\u00f3n del programa sin experimentar ning\u00fan tipo de error. - Esta pr\u00e1ctica aunque c\u00f3moda no es muy recomendable.</p>"},{"location":"UD10/012_PowerShellTotal/#explicita","title":"Explicita","text":"<ul> <li>Es buena idea tomar el control del tipado de las variables y asignarlo en funci\u00f3n de las necesidades del programa.</li> <li>De esta forma se ahorrar\u00e1n futuras conversiones de datos y posibles p\u00e9rdidas de informaci\u00f3n.</li> <li>Para ello se usa la forma expl\u00edcita de crear variables y junto con su creaci\u00f3n se define el tipo de dato que va a contener.</li> </ul> <p>Example</p> <p><code>yaml   [float] $numero = 9.99   [int] $Final_2021 = 30   [string] ${Mi variable} = \u201cContiene espacios en el nombre\u201d</code></p> <p>Al contrario que en el caso anterior, cuando el dato asignado no coincida con el tipo esperado, pueden ocurrir dos cosas:</p> <ol> <li>que las caracter\u00edsticas del dato se modifiquen para amoldarse al tipo de variable, lo que puede traducirse en la p\u00e9rdida de datos y un mal funcionamiento del script,</li> <li>o que se producir\u00e1 un error si esa conversi\u00f3n no es posible y se detenga el script.</li> </ol>"},{"location":"UD10/012_PowerShellTotal/#interaccion-con-el-usuario","title":"Interacci\u00f3n con el usuario","text":"<p>PowerShell posee dos cmdlets para realizar estas tareas.</p> <ol> <li>El primero de ellos es Write-Host y tiene un comportamiento similar al echo en GNU/Linux.</li> <li>El segundo comando para interactuar con el usuario es Read-Host el cual permite imprimir un mensaje por el terminal y recoger aquello que el usuario ha escrito. Funciona de forma muy parecida al comando read en el terminal de GNU/Linux.</li> </ol> <pre><code>[string] $feo = Read-Host \u201c\u00bfCu\u00e1l es el nombre del marine de Doom?\u201d\nWrite-Host \u201cNo se sabe, pero lo has intentado con $feo\u201d\n</code></pre> <p>Note</p> <p>Este script detendr\u00e1 su ejecuci\u00f3n en la l\u00ednea donde aparece Read-Host, esperar\u00e1 a que el usuario conteste a la pregunta y seguir\u00e1 con la ejecuci\u00f3n, del mismo modo que ocurre con shellscript.</p>"},{"location":"UD10/012_PowerShellTotal/#operadores","title":"Operadores","text":""},{"location":"UD10/012_PowerShellTotal/#aritmeticos","title":"Aritm\u00e9ticos","text":"<ul> <li>Las operaciones aritm\u00e9ticas en PowerShell son m\u00e1s intuitivas que en shellscript.</li> <li>Son las mismas que en el caso anterior: <code>+</code>, <code>-</code>, <code>*</code> , <code>/</code> y <code>%</code>.</li> <li>Su uso es m\u00e1s sencillo puesto que es el propio terminal en que realiza los c\u00e1lculos aritm\u00e9ticos y no a trav\u00e9s de un comando.</li> </ul> <pre><code>[int] $a=10\n[float] $b=20\n[int] $res=$a+$b\nWrite-Host $res\nWrite-Host $a+$b\nWrite-Host \"$a x $b = \" ($a*$b)\n</code></pre> <p>Tambi\u00e9n se dispone de expansores de terminal como en GNU/Linux.</p> <p>Note</p> <p>N\u00f3tese que en la \u00faltima l\u00ednea aparece directamente el producto \\(a*\\)b ya que al rodear la operaci\u00f3n con par\u00e9ntesis, se convierte en un expansor, realiza la operaci\u00f3n en su interior y env\u00eda el resultado fuera.</p> <p>Existen variantes que simplifican el uso de algunos operadores.</p> Operador Uso Equivalencia <code>+=</code> $contador += 5 $contador = $contador+5 <code>-=</code> $contador -= 5 $contador = $contador-5 <code>*=</code> $contador *= 5 $contador = $contador*5 <code>/=</code> $contador /= 5 $contador = $contador/5 <p>Adem\u00e1s de estos operadores existen dos espec\u00edficos para el incremento (<code>++</code>) y decremento (<code>--</code>) de una unidad, ideal para el uso de variables como contadores.</p>"},{"location":"UD10/012_PowerShellTotal/#logicos","title":"L\u00f3gicos","text":"Operador Descripci\u00f3n <code>-and</code> Devuelve verdadero si las dos expresiones son verdaderas. <code>-or</code> Devuelve verdadero si una de las dos expresiones o las dos son verdaderas. <code>-xor</code> Devuelve verdadero si tan s\u00f3lo una de las expresiones es verdadera. <code>-not o !</code> Devuelve verdadero cuando la expresi\u00f3n da el valor falso. <p>Example</p> <p><code>yaml   Write-Host ((6 -ge 4) -and (7 -le 7))   Write-Host ((10 -gt 1) -or (2 -lt 2))   Write-Host ((1 -gt 0) -xor (4 -le 1))   Write-Host ( -not (12 -lt 10))   Write-Host (!(12 -lt 10))</code></p> <p>Note</p> <p>En el ejemplo anterior si se ejecuta el script en un terminal PowerShell, todos los resultados ser\u00e1n verdaderos.</p> <ul> <li>Como en todos los lenguajes de programaci\u00f3n fuertemente tipados, existen operadores l\u00f3gicos para comprobar el tipo de dato de una variable, que resultan muy \u00fatiles para la interacci\u00f3n con los usuarios.</li> </ul> Operador Acci\u00f3n Ejemplo <code>-is</code> Devuelve verdadero si es del tipo indicado. <code>\u201cJavi\u201d -is [string]</code> es verdadero <code>-isnot</code> Devuelve falso si es del tipo indicado. <code>\u201cJavi\u201d -isnot [string]</code> es falso <code>-as</code> Convierte tipos de datos compatibles. <code>$valor = 19.90</code>; <code>Write-Host ($valor -as [int])</code>"},{"location":"UD10/012_PowerShellTotal/#comparacion","title":"Comparaci\u00f3n","text":"<p>los operadores tipo l\u00f3gicos devuelven tan s\u00f3lo un valor booleano que puede tener dos valores; verdadero o falso.</p> Operador Acci\u00f3n Ejemplo <code>-eq</code> Comprueba si son iguales. <code>5 -eq 3</code> es falso <code>-ieq</code> Iguales. En cadenas no es casesensitive. <code>\u201cJavi\u201d -ieq \u201cjavi\u201d</code> es verdadero <code>-ceq</code> Iguales. En cadenas es casesensitive. <code>\u201cJavi\u201d -ceq \u201cjavi\u201d</code> es falso <code>-ne</code> Verifica si son diferentes. <code>5 -ne 3</code> es verdadero <code>-lt</code> Coteja si la izquierda es menor que derecha. <code>5 -lt 3</code> es falso <code>-le</code> Constata si la izquierda es menor o igual que derecha. <code>5 -le 3</code> es falso <code>-gt</code> Examina si la izquierda en mayor que la derecha. <code>5 -gt 3</code> es verdadero <code>-ge</code> Revisa si la izquierda en mayor o igual que la derecha. <code>5 -ge 3</code> es verdadero <p>PowerShell a\u00f1ade operadores de comparaci\u00f3n que aportan un nivel de complejidad mayor.</p> Operador Acci\u00f3n Ejemplo <code>-like</code> Eval\u00faa un patr\u00f3n \u201ces como\u201d. <code>\u201cPerro\u201d -like \u201cPe*\u201d</code> es verdadero <code>-notlike</code> Eval\u00faa un patr\u00f3n \u201cno es como\u201d. <code>\u201cPerro\u201d -notlike \u201cPe*\u201d</code> es falso <code>-contains</code> Contiene un valor. <code>1,2,3 -contains 2</code> es verdadero <code>-notcontains</code> No contiene un valor. <code>1,2,3 -notcontains 2</code>es falso"},{"location":"UD10/012_PowerShellTotal/#control-del-flujo-en-powershell","title":"Control del flujo en PowerShell","text":"<p>En esta parte se indicar\u00e1 tan s\u00f3lo la sintaxis de las estructuras alternativas e iterativas, ya que los conceptos te\u00f3ricos ya se han abordado en el apartado de Shellscript.</p>"},{"location":"UD10/012_PowerShellTotal/#alternativa-simple","title":"Alternativa Simple","text":"<pre><code>if ( condici\u00f3n ){\nejecutar este c\u00f3digo si la condici\u00f3n es verdadera\n}\n</code></pre>"},{"location":"UD10/012_PowerShellTotal/#alternativa-doble","title":"Alternativa doble","text":"<pre><code>if ( condici\u00f3n ) {\nejecutar este c\u00f3digo si la condici\u00f3n es verdadera\n} else {\nejecutar este c\u00f3digo si la condici\u00f3n es falsa\n}\n</code></pre>"},{"location":"UD10/012_PowerShellTotal/#alternativa-multiple","title":"Alternativa m\u00faltiple","text":"<pre><code>if ( condici\u00f3n1 ) {\nejecutar este c\u00f3digo si la condici\u00f3n1 es verdadera\n} elseif ( condici\u00f3n2 ) {\nejecutar este c\u00f3digo si la condici\u00f3n2 es verdadera\n} else {\nejecutar este c\u00f3digo si todas las condiciones son falsas\n}\n</code></pre>"},{"location":"UD10/012_PowerShellTotal/#el-equivalente-a-case-en-gnulinux","title":"El equivalente a case en GNU/Linux","text":"<pre><code>switch ($valor){\nopci\u00f3n1 { c\u00f3digo a ejecutar si opci\u00f3n1 coincide con $valor }\nopci\u00f3n2 { c\u00f3digo a ejecutar si opci\u00f3n2 coincide con $valor }\nopci\u00f3nN { c\u00f3digo a ejecutar si opci\u00f3nN coincide con $valor }\ndefault { c\u00f3digo a ejecutar si ninguna de las opciones coincide }\n}\n</code></pre> <p>Example</p> <p><code>yaml       $saludo = Read-Host \"Escribe un saludo\"       switch ($saludo){           \"Buenos d\u00edas\" { Write-Host \"Saludaste en Castellano\" }           \"Bon dia\" { Write-Host \"Saludaste en Catal\u00e1n\" }           \"Bo dias\" { Write-Host \"Saludaste en Gallego\" }           \"Egun on\" { Write-Host \"Saludaste en Euskera\" }           \"Good morning\" { Write-Host \"Saludaste en Ingl\u00e9s\" }           \"Bonjour\" { Write-Host \"Saludaste en Franc\u00e9s\" }           \"Buon Giorno\" { Write-Host \"Saludaste en Italiano\" }           \"Bom d\u00eda\" { Write-Host \"Saludaste en Portugu\u00e9s\" }           \"Guten Tag\" { Write-Host \"Saludaste en Alem\u00e1n\" }           {$_ -is [string]} { Write Host \"La variable que has pasado es una cadena\" }           default { \"Eso no parece un saludo\" }       }</code></p> <p>Note</p> <p>_ Existe la posibilidad de colocar operadores l\u00f3gicos como opciones de un <code>switch</code>, si estos operadores l\u00f3gicos devuelven un valor verdadero, se ejecutar\u00e1 esa parte del c\u00f3digo, si se eval\u00faa a falso, no realizar\u00e1 esa parte del c\u00f3digo. _ El car\u00e1cter $_ hace referencia a la variable $saludo, de ese modo es posible realizar operaciones l\u00f3gicas con el valor pasado.</p> <ul> <li>Adem\u00e1s de todo esto, <code>switch</code> posee una serie de opciones que no est\u00e1n presentes en GNU/Linux, aunque es posible realizarlas de otra manera.</li> </ul> Operador Descripci\u00f3n <code>-wildcard</code> S\u00f3lo aplicable a <code>[string]</code>. Indica si cumple un patr\u00f3n determinado. <code>-exact</code> S\u00f3lo aplicable a <code>[string]</code>. Debe coincidir exactamente con alguno de los patrones. <code>-casesensitive</code> S\u00f3lo aplicable a <code>[string]</code>. Debe coincidir en may\u00fasculas y min\u00fasculas. <code>-file</code> La entrada es un archivo. Se evaluar\u00e1 cada l\u00ednea del archivo. <code>-regex</code> S\u00f3lo aplicable a <code>[string]</code>. Permite usar expresiones regulares en la comparaci\u00f3n. <p>Example</p> <p><code>-regex</code> <code>yaml   $target = 'https://bing.com'   switch -Regex ($target){       '^ftp\\://.*$' { \"$_ is an ftp address\"; Break }       '^\\w+@\\w+\\.com|edu|org$' { \"$_ is an email address\"; Break }       '^(http[s]?)\\://.*$' { \"$_ is a web address that uses $($matches[1])\"; Break }   }</code></p> <p>Example</p> <p><code>-wildcard</code> <code>yaml   switch -wildcard ( Read-Host \"Escribe u n\u00famero de tel\u00e9fono\" ){       \"8*\" { Write-Host \"Es un tel\u00e9fono fijo: $_\"; break }       \"9*\" { Write-Host \"Es un tel\u00e9fono fijo: $_\"; break }       \"6*\" { Write-Host \"Es un tel\u00e9fono m\u00f3vil: $_\"; break }       default { \"$_ no parece un tel\u00e9fono\" }   }</code></p> <ul> <li>El comando break que aparece al final de cada opci\u00f3n indica que si encuentra una coincidencia no siga buscando m\u00e1s y rompa el switch, ahorr\u00e1ndose as\u00ed el resto de comprobaciones.</li> </ul>"},{"location":"UD10/012_PowerShellTotal/#estructuras-iterativas","title":"Estructuras iterativas","text":""},{"location":"UD10/012_PowerShellTotal/#while","title":"while","text":"<p>A diferencia de lo que ocurr\u00eda en GNU/Linux, en PowerShell existen diferencias entre las estructuras while, do while y do until. En este caso, la \u00fanica de las tres que evaluar\u00e1 la condici\u00f3n al inicio del bloque de c\u00f3digo ser\u00e1 la primera. El resto comprueba la condici\u00f3n al final del bloque ejecutando como m\u00ednimo una vez el c\u00f3digo que contiene.</p> <pre><code>while ( condici\u00f3n ){\nbloque de c\u00f3digo a ejecutar mientras condici\u00f3n sea verdadera\n}\n</code></pre> <pre><code>do {\nbloque de c\u00f3digo a ejecutar mientras condici\u00f3n sea verdadera\n} while ( condici\u00f3n )\n</code></pre> <p>Existe una variante de esta estructura que se crea sustituyendo el while por un until. Esto cambia el sentido de la condici\u00f3n y es este caso el bloque se repite hasta que la condici\u00f3n se cumpla. Esta estructura no es muy utilizada, pero siempre es bueno contar con herramientas extra.</p>"},{"location":"UD10/012_PowerShellTotal/#for","title":"for","text":"<p>Tambi\u00e9n la estructura <code>for</code> es sensiblemente diferente que en shellscript. Esta estructura en PowerShell tiene m\u00e1s que ver con los lenguajes de programaci\u00f3n y se utiliza cuando el programador sabe el n\u00famero de iteraciones que hay que realizar para solucionar un problema.</p> <pre><code>for ( inicializaci\u00f3n; condici\u00f3n; incremento ){\nbloque de c\u00f3digo a ejecutar mientras condici\u00f3n sea verdadera\n}\n</code></pre> <ul> <li>Por ejemplo, la creaci\u00f3n de la tabla de multiplicar de un n\u00famero especificado por el usuario. Para resolver este problema s\u00ed se conoce el n\u00famero de iteraciones necesarias, concretamente diez.</li> </ul> <p>Example</p> <p><code>yaml   $numero = Read-Host \"Dame un n\u00famero\"   Write-Host \"Esta es la tabla del $num\"   for ( $i=0; $i -lt 11; $i++){       Write-Host \" $i x $numero = \"($i*$numero)   }</code></p>"},{"location":"UD10/012_PowerShellTotal/#foreach","title":"foreach","text":"<p>La estructura <code>foreach</code> en PowerShell es el equivalente a for en shellscript. Est\u00e1 pensada para recorrer un conjunto de valores y ejecutar el bloque de c\u00f3digo una vez por cada elemento del conjunto.</p> <pre><code>foreach ( elemento in conjunto ){\nbloque de c\u00f3digo a ejecutar por cada elemento del conjunto\n}\n</code></pre> <p>Al igual que ocurre en GNU/Linux, el conjunto puede serlo de cualquier tipo de objetos, incluso los ficheros de una carpeta. En el siguiente ejemplo se buscan los ficheros que en su nombre contengan la cadena de texto que el usuario ha especificado:</p> <p>Example</p> <p><code>yaml   $ruta = \"C:\\Users\\Administrador\\Desktop\"   $busca = Read-Host \"Escribe el texto a buscar\"   foreach ($archivo in Get-ChildItem $ruta){       if ($archivo.Name.IndexOf($busca) -ge 0){       Write-Host $archivo.Name       }   }</code></p> <p>Note</p> <p>Las opciones que ofrece PowerShell en cuanto a estructuras de control parece una oferta m\u00e1s completa que la de shellscript, aunque para las tareas que se van a realizar en este m\u00f3dulo, ambos sistemas poseen herramientas suficientes.</p>"},{"location":"UD10/012_PowerShellTotal/#vectores","title":"Vectores","text":"<ul> <li>PowerShell considera como un vector a toda colecci\u00f3n de objetos, sea cual sea su tipo.</li> <li>Los elementos que lo conforman pueden estar separados por comas, estar expresados por el operador de rango <code>..</code> o ser el resultado de alguna expresi\u00f3n que devuelva una colecci\u00f3n, como as\u00ed lo hacen muchos cmdlets.</li> </ul> <p>Example</p> <p><code>yaml   $Vacia = @{}   $Enteros = 1,2,3,4,5   $Texto = \u201cLunes\u201d,\u201cMartes\u201d,\u201dMi\u00e9rcoles\u201d, \u201cJueves\u201d,\u201dViernes\u201d   $EnterosRango = 1..10</code></p> <p>De esta forma se han definido cuatro vectores; el segundo contendr\u00e1 enteros y el tercero cadenas de caracteres. La \u00faltima l\u00ednea asigna los valores desde el 1 al 10 utilizando el operador rango <code>..</code> .</p> <p>Note</p> <p>El operador de rango representa una secuencia de enteros, con los l\u00edmites superior e inferior separados por dos puntos decimales. Permite expresar el rango en orden ascendente o descendente, as\u00ed como tambi\u00e9n que los l\u00edmites inferior o superior sean establecidos por medio de variables que contengan enteros.</p> <ul> <li>Un vector tambi\u00e9n puede definirse como el resultado de una expresi\u00f3n.</li> </ul> <p>Example</p> <p><code>yaml   $EnterosFor = @(For($i;$i &lt; 5;$i++){$i})   $Comando = Get-Process | Sort-Object ProcessName</code></p> <p>En la primera l\u00ednea <code>$enteros</code> ser\u00e1 completado a trav\u00e9s del resultado de una estructura iterativa, mientras que la segunda contendr\u00e1 el resultado del cmdlet indicado. Adem\u00e1s de todas estas formas de declaraci\u00f3n, tambi\u00e9n se puede realizar a trav\u00e9s del cmdlet <code>New-Variable</code></p> <p>Example</p> <p><code>yaml   New-Variable -Name Enteros -Value 1,2,3,4,5 -Force   New-Variable -Name Texto -Value \"Lunes\",\"Martes\",\"Mi\u00e9rcoles\",\"Jueves\",\"Viernes\" \u2013Force   New-Variable -Name EnterosRango -Value (1..5) -Force   New-Variable -Name EnterosFor -value (. {For($i=1;$i -lt 5;$i++){$i}}) -Force</code></p> <p>Note</p> <p>El atributo <code>-Force</code> sobrescribe la variable si esta ya existe, de ese modo no saltar\u00e1 ning\u00fan error a la hora de definir estas variables.</p> <ul> <li>Para obtener el n\u00famero de elementos de un vector se utiliza el m\u00e9todo Length, si se aplica a un elemento del vector, devolver\u00e1 el tama\u00f1o de este elemento, no del vector completo.</li> </ul> <p>Example</p> <p><code>yaml   $Texto.Length # mostrar\u00e1 5 por pantalla   $Texto[2].Length # mostrar\u00e1 9, las letras de \u201cMi\u00e9rcoles\u201d</code></p> <ul> <li>Para a\u00f1adir elementos al final de un vector se utiliza el operador <code>+=</code>.</li> </ul> <p>Example</p> <p><code>yaml   $Enteros += 6   $Texto += \u201cS\u00e1bado\u201d, \u201cDomingo\u201d</code></p> <p>Note</p> <p>La primera l\u00ednea a\u00f1ade el entero 6 al vector <code>$Enteros</code>, mientras que en la segunda se a\u00f1aden los elementos \u201cS\u00e1bado\u201d y \u201cDomingo\u201d al vector <code>$Texto</code>.</p> <ul> <li>Para eliminar un elemento de un vector PowerShell no ofrece un sistema parecido al de a\u00f1adir valores, sino que tendr\u00e1 que reescribirse el vector de nuevo sin los valores no deseados.</li> </ul>"},{"location":"UD10/012_PowerShellTotal/#funciones","title":"Funciones","text":"<p>Tambi\u00e9n en PowerShell es posible utilizar funciones a trav\u00e9s de la siguiente estructura:</p> <pre><code>Function &lt;NOMBRE&gt; {\nParam (&lt;Parametro&gt;,&lt;Parametro&gt;,...)\nComandos PowerShell\n}\n</code></pre> <p>Warning</p> <p>El paso de par\u00e1metros a una funci\u00f3n se realiza de id\u00e9ntica forma que en shell script. La principal diferencia entre las funciones usadas en shell script es que ahora es preferible declarar y tipar antes de iniciar con el c\u00f3digo de la funci\u00f3n.</p> <p>Example</p> <p><code>yaml   Function Get-Sumar {       param ([integer] $a, [integer] $b)       $sumar = $a + $b       Write-Host \u201cLa suma es $sumar\u201d   }</code></p> <p>Note</p> <p>Si se ejecuta la siguiente instrucci\u00f3n: <code>Get-Sumar 2 8</code> La salida del terminal ser\u00e1 <code>La suma es 10</code>.</p> <p>Si se necesita que las funciones est\u00e9n disponibles durante la sesi\u00f3n del usuario o si es necesario enlazarlas desde otro script, se deber\u00e1 utilizar la notaci\u00f3n de punto, del mismo modo que ocurr\u00eda en shell script.</p>"},{"location":"UD10/012_PowerShellTotal/#actividades-powershell","title":"Actividades PowerShell","text":"<p>Note</p> <p>Escribe el c\u00f3digo de los scripts en PowerShell que se detallan en cada ejercicio. Deber\u00e1s crear un fichero de texto para cada ejercicio con el siguiente nombre: ejXXX.sh, donde las X representan el n\u00famero de ejercicio. Una vez terminada la pr\u00e1ctica, comprime todos estos ficheros en uno y s\u00fabelos al Moodle.</p>"},{"location":"UD10/012_PowerShellTotal/#actividades-iniciales-powershell","title":"Actividades Iniciales PowerShell","text":"<ol> <li> <p>Genera un Script que muestre los procesos del sistema ordenados por el id.</p> </li> <li> <p>Muestra los servicios cuyo nombre empiece por la letra <code>n</code>, utilizando la creaci\u00f3n de un script.</p> </li> <li> <p>Crea un script que si no se le pasa ning\u00fan argumento nos lo diga.</p> </li> </ol>"},{"location":"UD10/012_PowerShellTotal/#actividades-de-desarrollo-ud1_04","title":"Actividades de desarrollo UD1_04","text":"<ol> <li> <p>Dise\u00f1a un script PowerShell que pida al usuario dos n\u00famero (comprobando que sean n\u00fameros) y muestre por pantalla el mayor de ellos o si son iguales.</p> </li> <li> <p>Crea un script PowerShell que al ejecutarlo muestre por pantalla uno de estos mensajes \u201cBuenos d\u00edas\u201d, \u201cBuenas tardes\u201d o \u201cBuenas noches\u201d, en funci\u00f3n de la hora que sea en el sistema (de 8:00 de la ma\u00f1ana a 15:00 ser\u00e1 ma\u00f1ana, de 15:00 a 20:00 ser\u00e1 tarde y el resto ser\u00e1 noche). Usa el <code>cmdlet Get-Date</code>.</p> </li> <li> <p>Construye tres script PowerShell utilizando estructuras iterativas:</p> </li> <li>el primero ej118A.ps1, que imprima la tabla de multiplicar de un n\u00famero preguntado al usuario. Este      n\u00famero debe ser entero positivo.</li> <li>el segundo ej118B.ps1, que pida un n\u00famero e indique si se trata de un n\u00famero par y si es n\u00famero primo.</li> <li> <p>el tercero ej118C.ps1, que muestre las diez primeras tablas de multiplicar por pantalla. Hay un tiempo de espera de un segundo entre ellas. Utiliza las estructuras while, do while, for y foreach y el cmdlet Start-Sleep.</p> </li> <li> <p>Dise\u00f1a un script PowerShell que lea un vector con 365 temperaturas y calcule la media y cuantos d\u00edas han estado por encima y cuantos por debajo de ella. Rellena el vector con valores aleatorios entre -5 y 35, para ello usa Get-Random.</p> </li> </ol>"},{"location":"UD10/012_PowerShellTotal/#actividades-de-desarrollo-ud1_05","title":"Actividades de desarrollo UD1_05","text":"<ol> <li> <p>Crea un script PowerShell que rellene un vector con diez n\u00fameros de forma aleatoria y que los muestre por pantalla de la siguiente forma:</p> </li> <li> <p>en orden inverso a como han sido introducidos los valores.</p> </li> <li>los valores ordenados de menor a mayor en una sola l\u00ednea.</li> <li>los valores ordenados de mayor a menor en una sola l\u00ednea la suma total de sus valores.</li> <li>cantidad de valores pares que contiene el vector.</li> <li>la suma total de n\u00fameros impares.</li> <li> <p>la media aritm\u00e9tica de los valores que contiene el vector.</p> </li> <li> <p>Crea un script PowerShell para que haga una copias de seguridad de todos los archivos del directorio de trabajo del usuario actual. Deber\u00e1 realizar las siguientes acciones:</p> </li> <li> <p>comprobar\u00e1 si el archivo ya existe en la copia de seguridad, si es as\u00ed comprobar\u00e1 cual de los dos es m\u00e1s reciente y que tama\u00f1o tienen. Si es m\u00e1s reciente o posee un tama\u00f1o mayor, lo copiar\u00e1. En cualquier otro caso, no lo copia.</p> </li> <li>llevar\u00e1 un registro de todos los archivos copiados cada vez que se ejecute mediante un archivo de bit\u00e1cora. Guarda este fichero el directorio que contiene el script.</li> </ol> <p>Crea una funci\u00f3n para cada tarea realizada en este script.</p> <ol> <li> <p>Dise\u00f1a un script PowerShell que muestre un men\u00fa al usuario con cuatro operaciones disponibles: Crear directorio, Eliminar directorio, Mostrar directorio, Informe de directorio, Copia de directorio y Salir. Una vez elegida una opci\u00f3n correcta, el programa debe solicitar un nombre de directorio y hacer la operaci\u00f3n seleccionada. Tras esto debe mostrar un mensaje con el resultado de la operaci\u00f3n. Crea una funci\u00f3n para cada una de estas opciones.</p> </li> <li> <p>Si se elige la opci\u00f3n Informe de directorio, mostrar\u00e1 por pantalla el n\u00famero de ficheros que contiene, cuantos son carpetas, cuantos directorios y el tama\u00f1o total de ellos. Si la carpeta no existe, mostrar\u00e1 un error.</p> </li> <li> <p>Si elige la opci\u00f3n Copia de directorio, preguntar\u00e1 la carpeta de destino y mostrar\u00e1 fichero a fichero la copia.</p> </li> <li> <p>Realiza un script PowerShell que permita crear un informe de las IP libres en la red en la que se encuentra el equipo. Debe contener las siguientes opciones:</p> </li> <li> <p>el informe contendr\u00e1 un listado de todas las IP de la red a la que pertenece el equipo indicando si est\u00e1 libre o no (usa el comando ping).</p> </li> <li>en el informe debe aparecer el tipo de red (A, B o C) en el que est\u00e1 inmerso el ordenador con el nombre de la red, su broadcast y su m\u00e1scara de subred.</li> </ol>"},{"location":"UD10/021_Introducci%C3%B3nPwSh/","title":"Power Shell","text":""},{"location":"UD10/021_Introducci%C3%B3nPwSh/#introduccion","title":"Introducci\u00f3n","text":"<ul> <li>Los sistemas operativos basados en Microsoft Windows cuentan con la herramienta PowerShell, que surgi\u00f3 ante las carencias que presenta el viejo terminal basado en MS-DOS.</li> <li>PowerShell es una interfaz de consola (CLI) con posibilidad de escritura y uni\u00f3n de comandos por medio de instrucciones (scripts).</li> <li>Esta interfaz de consola est\u00e1 dise\u00f1ada para su uso por parte de administradores de sistemas, con el prop\u00f3sito de automatizar tareas o realizarlas de forma m\u00e1s controlada.</li> <li>En abril de 2006 Microsoft lanz\u00f3 una nueva interfaz CLI, con una sintaxis moderna que comparte similitudes con el lenguaje Perl.</li> <li>Perl es un lenguaje de programaci\u00f3n dise\u00f1ado por Larry Wall en 1987. Perl toma caracter\u00edsticas del lenguaje C, del lenguaje interpretado bourne shell, AWK, sed, Lisp y, en un grado inferior, de muchos otros lenguajes de programaci\u00f3n.</li> <li>Se trata de una interfaz gratuita, y que antes de Microsoft Windows 7 no se inclu\u00eda con el sistema operativo.</li> <li>En la actualidad, est\u00e1 incluida en todos los sistemas operativos de Microsoft, aunque requiere la presencia de <code>.NET</code> framework del que hereda sus caracter\u00edsticas orientadas a objetos.</li> <li>En agosto de 2016, Microsoft public\u00f3 su c\u00f3digo en GitHub para que pueda portarse a otros sistemas como GNU/Linux y MAC OSX.</li> </ul> <p>Info</p> <p>cmdlets Existen cientos de cdmlet en la versi\u00f3n 5.1 de PowerShell. Es posible consultar la ayuda de cada uno de ellos en la p\u00e1gina oficial de Microsoft.</p>"},{"location":"UD10/021_Introducci%C3%B3nPwSh/#primer-script","title":"Primer Script","text":"<ul> <li>Al igual que ocurre en GNU/Linux un script de PowerShell no es m\u00e1s que un archivo de texto plano que contiene una secuencia de comando y de cmdlets para realizar una tarea.</li> <li>La diferencia con ellos es que aqu\u00ed ser\u00e1 necesario dotarlos de una extensi\u00f3n; <code>ps1</code>.</li> </ul> <p>Example</p> <pre><code>    Write-Host \"Hola!. Esto es mi primer script en PowerShell\"\n    Write-Host \"Y esto es una segunda l\u00ednea\"\n</code></pre> <ul> <li>A continuaci\u00f3n, se guarda el script desde el men\u00fa <code>Acci\u00f3n \u2192 Guardar Como\u2026</code> asign\u00e1ndole un nombre.</li> <li>Para ejecutarlo tan s\u00f3lo es necesario escribir su nombre en el terminal de PowerShell anteponiendo un punto y una barra.</li> </ul> <p>Example</p> <pre><code>  ./Script.ps1\n</code></pre>"},{"location":"UD10/021_Introducci%C3%B3nPwSh/#powershell-ise","title":"PowerShell ISE","text":"<ul> <li>PowerShell viene acompa\u00f1ado de una herramienta gr\u00e1fica que facilita la administraci\u00f3n de todos los scripts. Se denomina Microsoft PowerShell ISE (Integrated Scripting Environment), y se accede a trav\u00e9s de: <code>Administrador del servidor \u2192 Herramientas \u2192 Windows PowerShell ISE</code>.</li> <li>El uso de esta herramienta gr\u00e1fica va a facilitar la creaci\u00f3n de los scripts de forma significativa.</li> <li>Es pr\u00e1ctico comenzar con esta ayuda ya que la sintaxis de los cmdlets, aunque sea l\u00f3gica y sencilla, tambi\u00e9n lo es amplia y desconocida.</li> </ul> Interfaz de la herramienta Windows PowerShell ISE <p>Info</p> <ul> <li>Uno de los aspectos m\u00e1s interesantes que posee esta aplicaci\u00f3n es la barra de informaci\u00f3n que muestra un listado de todos los cmdlets de esta herramienta. Permite filtrarlos por funci\u00f3n y consultar la ayuda de cada uno de ellos.</li> <li>Tambi\u00e9n posee un formulario destinado a generar el c\u00f3digo de un cmdlet de forma autom\u00e1tica.</li> </ul> <p>Example</p> <ul> <li>Creaci\u00f3n de un comando que realice una copia de seguridad de los scripts de trabajo en una memoria externa. Es necesario el uso de Copy-Item para ello, pero no se conoce su sintaxis.</li> <li>Si escribimos este cmdlet en el recuadro <code>Nombre</code> y se pulsa sobre <code>Mostrar Ayuda</code>, aparecer\u00e1 un formulario con sus opciones. Tras completar las necesarias y pulsando el bot\u00f3n <code>Insertar</code> situado en la parte inferior, el c\u00f3digo completo ser\u00e1 escrito la parte destinada al terminal.</li> </ul> Creaci\u00f3n autom\u00e1tica de scripts en Windows PowerShell ISE. <ul> <li>Es posible ejecutar el script desde la herramienta gr\u00e1fica pulsando la tecla <code>F5</code>, ejecutar una parte de \u00e9l con <code>F8</code> o detener la ejecuci\u00f3n con <code>Ctrl+Intro</code>.</li> </ul>"},{"location":"UD10/021_Introducci%C3%B3nPwSh/#comentarios","title":"Comentarios","text":"<p>Note</p> <p>Los comentarios en PowerShell se realizan precediendo a la l\u00ednea con el car\u00e1cter <code>#</code> si se trata de una sola l\u00ednea y <code>&lt;#</code> y <code>#&gt;</code> si es multi-l\u00ednea.</p>"},{"location":"UD10/021_Introducci%C3%B3nPwSh/#depuracion","title":"Depuraci\u00f3n","text":"<ul> <li>La depuraci\u00f3n es el proceso de examinar un script mientras se ejecuta para identificar y corregir errores en las instrucciones del script.</li> <li>El depurador de PowerShell puede ayudarle a examinar e identificar errores e ineficiencias en los scripts, funciones, comandos, configuraciones o expresiones de PowerShell Desired State Configuration (DSC).</li> </ul> <p>El depurador de PowerShell incluye el siguiente conjunto de cmdlets:</p> <ul> <li>Set-PSBreakpoint: establece puntos de interrupci\u00f3n en l\u00edneas, variables y comandos.</li> <li>Get-PSBreakpoint: obtiene puntos de interrupci\u00f3n en la sesi\u00f3n actual.</li> <li>Disable-PSBreakpoint: desactiva los puntos de interrupci\u00f3n en la sesi\u00f3n actual.</li> <li>Enable-PSBreakpoint: vuelve a habilitar los puntos de interrupci\u00f3n en la sesi\u00f3n actual.</li> <li>Remove-PSBreakpoint: elimina puntos de interrupci\u00f3n de la sesi\u00f3n actual.</li> <li>Get-PSCallStack: muestra la pila de llamadas actual.</li> </ul>"},{"location":"UD10/022_PowerShell_Sintaxis/","title":"Sintaxis","text":""},{"location":"UD10/022_PowerShell_Sintaxis/#parametros-en-powershell","title":"Par\u00e1metros en PowerShell","text":"<ul> <li>A diferencia de GNU/Linux, los par\u00e1metros que reciba el script en PowerShell se reciben en el array args,</li> <li>Cada posici\u00f3n del array <code>args[]</code> guarda los par\u00e1metros introducidos al script en el orden indicado.</li> <li>Por lo tanto para acceder a los par\u00e1metros introducidos se debe acceder al valor de la posici\u00f3n que se desee.</li> </ul> <p>Example</p> <pre><code>[string]$param1= $args[0]\nWrite-Host \"Hola!. Esto es mi primer script en PowerShell\"\nWrite-Host \"Y esto es una segunda l\u00ednea\"\nWrite-Host \"El primer par\u00e1metro introducido es $param1\"\n</code></pre> <p>Note</p> <ul> <li>El script anterior esperar\u00e1 un par\u00e1metro de tipo <code>string</code> que ser\u00e1 contenido en la variable $param1.</li> <li>En la cuarta l\u00ednea mostrar\u00e1 el contenido de la variable por pantalla.</li> </ul> <ul> <li>Para poder ejecutar este script, ser\u00e1 necesario acompa\u00f1arlo de un par\u00e1metro del siguiente modo.</li> </ul> <pre><code>./Script.ps1 \"F\u00ba Javier Hern\u00e1ndez Ill\u00e1n\"\n</code></pre> <ul> <li>Para entender por completo el ejemplo anterior, ser\u00e1 necesario ver como PowerShell maneja las variables.</li> </ul>"},{"location":"UD10/022_PowerShell_Sintaxis/#variables","title":"Variables","text":"<ul> <li>Para definir una variable en PowerShell s\u00f3lo tenemos que nombrarla utilizando para ello cualquier combinaci\u00f3n de caracteres, ya sean n\u00fameros, letras o s\u00edmbolos.</li> <li>Es posible utilizar espacios en el nombre, aunque en este caso el nombre debe ir rodeado por s\u00edmbolos de llaves {}.</li> <li>Al contrario que ocurre en shellscript, PowerShell es fuertemente tipado, lo que significa que las variables no son tratadas como cadenas de texto, sino que hay que especificar el tipo de dato que se guardar\u00e1 en ella.</li> <li>Para definir variables es posible utilizar el m\u00e9todo expl\u00edcito (adem\u00e1s con New-Variable y sus opciones), pero tambi\u00e9n se puede utilizar el m\u00e9todo impl\u00edcito anteponiendo el s\u00edmbolo $ delante del nombre.</li> </ul> <p>Info</p> <p>Get-Variable En cualquier momento puedes obtener una lista completa de las variables que se hayan definido hasta ese momento. Para lograrlo, basta con utilizar Get- Variable.</p>"},{"location":"UD10/022_PowerShell_Sintaxis/#implicita","title":"Impl\u00edcita","text":"Tipo Descripci\u00f3n <code>[string]</code> Cadena de caracteres Unicode <code>[char]</code> Un s\u00f3lo car\u00e1cter Unicode de 16 bits <code>[byte]</code> Un s\u00f3lo car\u00e1cter Unicode de 8 bits <code>[int]</code> Entero con signo de 32 bits <code>[float]</code> N\u00famero con coma flotante de 32 bits <code>[double]</code> N\u00famero con coma flotante de 64 bits <code>[datetime]</code> Fecha y Hora <code>[bool]</code> Valor l\u00f3gico booleano <p>Example</p> <pre><code>    $numero = 9.99\n    $Final_2021 = 30\n    ${Mi variable} = \"Contiene espacios en el nombre\"\n</code></pre> <ul> <li>En la forma impl\u00edcita el shell establece el tipo de dato de la variable en funci\u00f3n del dato que se le asigne en su creaci\u00f3n.</li> <li>En el ejemplo anterior <code>$numero</code> es de forma autom\u00e1tica de tipo <code>[double]</code>, ya que al crearla se ha inicializado con un n\u00famero con decimales.</li> <li>Por contra la variable <code>$Final_2021</code> es de tipo <code>[int]</code> ya que se ha guardado un n\u00famero entero en ella.</li> </ul> <p>Info</p> <p>-GetType Para poder obtener el tipo de dato de una variable hay que usar el m\u00e9todo <code>GetType().Name</code> sobre cualquier variable:</p> <p><code>Write-Host $numero.GetType().Name.</code></p> <p>Tip</p> <p>Una variable cuya definici\u00f3n de tipo se ha realizado de forma impl\u00edcita, podr\u00e1 cambiar el tipo de dato almacenado durante la ejecuci\u00f3n del programa sin experimentar ning\u00fan tipo de error. - Esta pr\u00e1ctica aunque c\u00f3moda no es muy recomendable.</p>"},{"location":"UD10/022_PowerShell_Sintaxis/#explicita","title":"Explicita","text":"<ul> <li>Es buena idea tomar el control del tipado de las variables y asignarlo en funci\u00f3n de las necesidades del programa.</li> <li>De esta forma se ahorrar\u00e1n futuras conversiones de datos y posibles p\u00e9rdidas de informaci\u00f3n.</li> <li>Para ello se usa la forma expl\u00edcita de crear variables y junto con su creaci\u00f3n se define el tipo de dato que va a contener.</li> </ul> <p>Example</p> <pre><code>[float] $numero = 9.99\n[int] $Final_2021 = 30\n[string] ${Mi variable} = \"Contiene espacios en el nombre\"\n</code></pre> <p>Al contrario que en el caso anterior, cuando el dato asignado no coincida con el tipo esperado, pueden ocurrir dos cosas:</p> <ol> <li>Se modifiquen las caracter\u00edsticas del dato para amoldarse al tipo de variable, lo que puede traducirse en la p\u00e9rdida de datos y un mal funcionamiento del script,</li> <li>Se produzca un error si esa conversi\u00f3n no es posible y se detenga el script.</li> </ol>"},{"location":"UD10/022_PowerShell_Sintaxis/#interaccion-con-el-usuario","title":"Interacci\u00f3n con el usuario","text":"<p>PowerShell posee dos cmdlets para realizar estas tareas.</p> <ol> <li>El primero de ellos es Write-Host y tiene un comportamiento similar al echo en GNU/Linux.</li> <li>El segundo comando para interactuar con el usuario es Read-Host el cual permite imprimir un mensaje por el terminal y recoger aquello que el usuario ha escrito. Funciona de forma muy parecida al comando read en el terminal de GNU/Linux.</li> </ol> <pre><code>[string] $marine = Read-Host \"\u00bfCu\u00e1l es el nombre del marine de Doom?\"\nWrite-Host \"No se sabe, pero lo has intentado con $marine\n</code></pre> <p>Note</p> <p>Este script detendr\u00e1 su ejecuci\u00f3n en la l\u00ednea donde aparece Read-Host, esperar\u00e1 a que el usuario conteste a la pregunta y seguir\u00e1 con la ejecuci\u00f3n, del mismo modo que ocurre con shellscript.</p>"},{"location":"UD10/022_PowerShell_Sintaxis/#operadores","title":"Operadores","text":""},{"location":"UD10/022_PowerShell_Sintaxis/#aritmeticos","title":"Aritm\u00e9ticos","text":"<ul> <li>Las operaciones aritm\u00e9ticas en PowerShell son m\u00e1s intuitivas que en shellscript.</li> <li>Son las mismas que en el caso anterior: <code>+</code>, <code>-</code>, <code>*</code> , <code>/</code> y <code>%</code>.</li> <li>Su uso es m\u00e1s sencillo puesto que es el propio terminal en que realiza los c\u00e1lculos aritm\u00e9ticos y no a trav\u00e9s de un comando.</li> </ul> <pre><code>[int] $a=10\n[float] $b=20\n[int] $res=$a+$b\nWrite-Host $res\nWrite-Host $a+$b\nWrite-Host \"$a x $b = \" ($a*$b)\n</code></pre> <p>Tambi\u00e9n se dispone de expansores de terminal como en GNU/Linux.</p> <p>Note</p> <p>N\u00f3tese que en la \u00faltima l\u00ednea aparece directamente el producto \\(a*\\)b ya que al rodear la operaci\u00f3n con par\u00e9ntesis, se convierte en un expansor, realiza la operaci\u00f3n en su interior y env\u00eda el resultado fuera.</p> <p>Existen variantes que simplifican el uso de algunos operadores.</p> Operador Uso Equivalencia <code>+=</code> $contador += 5 $contador = $contador+5 <code>-=</code> $contador -= 5 $contador = $contador-5 <code>*=</code> $contador *= 5 $contador = $contador*5 <code>/=</code> $contador /= 5 $contador = $contador/5 <p>Adem\u00e1s de estos operadores existen dos espec\u00edficos para el incremento (<code>++</code>) y decremento (<code>--</code>) de una unidad, ideal para el uso de variables como contadores.</p>"},{"location":"UD10/022_PowerShell_Sintaxis/#logicos","title":"L\u00f3gicos","text":"Operador Descripci\u00f3n <code>-and</code> Devuelve verdadero si las dos expresiones son verdaderas. <code>-or</code> Devuelve verdadero si una de las dos expresiones o las dos son verdaderas. <code>-xor</code> Devuelve verdadero si tan s\u00f3lo una de las expresiones es verdadera. <code>-not o !</code> Devuelve verdadero cuando la expresi\u00f3n da el valor falso. <p>Example</p> <pre><code>Write-Host ((6 -ge 4) -and (7 -le 7))\nWrite-Host ((10 -gt 1) -or (2 -lt 2))\nWrite-Host ((1 -gt 0) -xor (4 -le 1))\nWrite-Host ( -not (12 -lt 10))\nWrite-Host (!(12 -lt 10))\n</code></pre> <p>Note</p> <p>En el ejemplo anterior si se ejecuta el script en un terminal PowerShell, todos los resultados ser\u00e1n verdaderos.</p> <ul> <li>Como en todos los lenguajes de programaci\u00f3n fuertemente tipados, existen operadores l\u00f3gicos para comprobar el tipo de dato de una variable, que resultan muy \u00fatiles para la interacci\u00f3n con los usuarios.</li> </ul> Operador Acci\u00f3n Ejemplo <code>-is</code> Devuelve verdadero si es del tipo indicado. <code>\"Javi\" -is [string]</code> es verdadero <code>-isnot</code> Devuelve falso si es del tipo indicado. <code>\"Javi\" -isnot [string]</code> es falso <code>-as</code> Convierte tipos de datos compatibles. <code>$valor = 19.90</code>; <code>Write-Host ($valor -as [int])</code>"},{"location":"UD10/022_PowerShell_Sintaxis/#comparacion","title":"Comparaci\u00f3n","text":"<p>los operadores tipo l\u00f3gicos devuelven tan s\u00f3lo un valor booleano que puede tener dos valores; verdadero o falso.</p> Operador Acci\u00f3n Ejemplo <code>-eq</code> Comprueba si son iguales. <code>5 -eq 3</code> es falso <code>-ieq</code> Iguales. En cadenas no es casesensitive. <code>\"Javi\" -ieq \"javi\"</code> es verdadero <code>-ceq</code> Iguales. En cadenas es casesensitive. <code>\"Javi\" -ceq \"javi\"</code> es falso <code>-ne</code> Verifica si son diferentes. <code>5 -ne 3</code> es verdadero <code>-lt</code> Coteja si la izquierda es menor que derecha. <code>5 -lt 3</code> es falso <code>-le</code> Constata si la izquierda es menor o igual que derecha. <code>5 -le 3</code> es falso <code>-gt</code> Examina si la izquierda en mayor que la derecha. <code>5 -gt 3</code> es verdadero <code>-ge</code> Revisa si la izquierda en mayor o igual que la derecha. <code>5 -ge 3</code> es verdadero <p>PowerShell a\u00f1ade operadores de comparaci\u00f3n que aportan un nivel de complejidad mayor.</p> Operador Acci\u00f3n Ejemplo <code>-like</code> Eval\u00faa un patr\u00f3n \"es como\". <code>\"Perro\" -like \"Pe*\"</code> es verdadero <code>-notlike</code> Eval\u00faa un patr\u00f3n \"no es como\". <code>\"Perro\" -notlike \"Pe*\"</code> es falso <code>-contains</code> Contiene un valor. <code>1,2,3 -contains 2</code> es verdadero <code>-notcontains</code> No contiene un valor. <code>1,2,3 -notcontains 2</code>es falso <pre><code>\n</code></pre>"},{"location":"UD10/023_PowerShell_ControlFlujo/","title":"Control de Flujo","text":""},{"location":"UD10/023_PowerShell_ControlFlujo/#estructuras","title":"Estructuras","text":"<p>En esta parte se indicar\u00e1 tan s\u00f3lo la sintaxis de las estructuras alternativas e iterativas, ya que los conceptos te\u00f3ricos ya se han abordado en el apartado de Shellscript.</p>"},{"location":"UD10/023_PowerShell_ControlFlujo/#alternativa-simple","title":"Alternativa Simple","text":"<pre><code>    if ( condici\u00f3n ){\n        ejecutar este c\u00f3digo si la condici\u00f3n es verdadera\n    }\n</code></pre>"},{"location":"UD10/023_PowerShell_ControlFlujo/#alternativa-doble","title":"Alternativa doble","text":"<pre><code>    if ( condici\u00f3n ) {\n        ejecutar este c\u00f3digo si la condici\u00f3n es verdadera\n    } else {\n        ejecutar este c\u00f3digo si la condici\u00f3n es falsa\n    }\n</code></pre>"},{"location":"UD10/023_PowerShell_ControlFlujo/#alternativa-multiple","title":"Alternativa m\u00faltiple","text":"<pre><code>    if ( condici\u00f3n1 ) {\n        ejecutar este c\u00f3digo si la condici\u00f3n1 es verdadera\n    } elseif ( condici\u00f3n2 ) {\n        ejecutar este c\u00f3digo si la condici\u00f3n2 es verdadera\n    } else {\n        ejecutar este c\u00f3digo si todas las condiciones son falsas\n    }\n</code></pre>"},{"location":"UD10/023_PowerShell_ControlFlujo/#el-equivalente-a-case-en-gnulinux","title":"El equivalente a case en GNU/Linux","text":"<pre><code>    switch ($valor){\n        opci\u00f3n1 { c\u00f3digo a ejecutar si opci\u00f3n1 coincide con $valor }\n        opci\u00f3n2 { c\u00f3digo a ejecutar si opci\u00f3n2 coincide con $valor }\n        opci\u00f3nN { c\u00f3digo a ejecutar si opci\u00f3nN coincide con $valor }\n        default { c\u00f3digo a ejecutar si ninguna de las opciones coincide }\n    }\n</code></pre> <p>Example</p> <pre><code>```pwsh\n        $saludo = Read-Host \"Escribe un saludo\"\n        switch ($saludo){\n            \"Buenos d\u00edas\" { Write-Host \"Saludaste en Castellano\" }\n            \"Bon dia\" { Write-Host \"Saludaste en Catal\u00e1n\" }\n            \"Bo dias\" { Write-Host \"Saludaste en Gallego\" }\n            \"Egun on\" { Write-Host \"Saludaste en Euskera\" }\n            \"Good morning\" { Write-Host \"Saludaste en Ingl\u00e9s\" }\n            \"Bonjour\" { Write-Host \"Saludaste en Franc\u00e9s\" }\n            \"Buon Giorno\" { Write-Host \"Saludaste en Italiano\" }\n            \"Bom d\u00eda\" { Write-Host \"Saludaste en Portugu\u00e9s\" }\n            \"Guten Tag\" { Write-Host \"Saludaste en Alem\u00e1n\" }\n            {$_ -is [string]} { Write Host \"La variable que has pasado es una cadena\" }\n            default { \"Eso no parece un saludo\" }\n        }\n\n```\n</code></pre> <p>Note</p> <ul> <li> <p>Existe la posibilidad de colocar operadores l\u00f3gicos como opciones de un <code>switch</code>, si estos operadores l\u00f3gicos devuelven un valor verdadero, se ejecutar\u00e1 esa parte del c\u00f3digo, si se eval\u00faa a falso, no realizar\u00e1 esa parte del c\u00f3digo.</p> </li> <li> <p>El car\u00e1cter $_ hace referencia a la variable $saludo, de ese modo es posible realizar operaciones l\u00f3gicas con el valor pasado.</p> </li> </ul> <ul> <li>Adem\u00e1s de todo esto, <code>switch</code> posee una serie de opciones que no est\u00e1n presentes en GNU/Linux, aunque es posible realizarlas de otra manera.</li> </ul> Operador Descripci\u00f3n <code>-wildcard</code> S\u00f3lo aplicable a <code>[string]</code>. Indica si cumple un patr\u00f3n determinado. <code>-exact</code> S\u00f3lo aplicable a <code>[string]</code>. Debe coincidir exactamente con alguno de los patrones. <code>-casesensitive</code> S\u00f3lo aplicable a <code>[string]</code>. Debe coincidir en may\u00fasculas y min\u00fasculas. <code>-file</code> La entrada es un archivo. Se evaluar\u00e1 cada l\u00ednea del archivo. <code>-regex</code> S\u00f3lo aplicable a <code>[string]</code>. Permite usar expresiones regulares en la comparaci\u00f3n. <p>Example</p> <pre><code> `-regex`\n\n```pwsh\n    $target = 'https://bing.com'\n    switch -Regex ($target){\n    '^ftp\\://.*$' { \"$_ is an ftp address\"; Break }\n    '^\\w+@\\w+\\.com|edu|org$' { \"$_ is an email address\"; Break }\n    '^(http[s]?)\\://.*$' { \"$_ is a web address that uses $($matches[1])\"; Break }\n}\n```\n</code></pre> <p>Example</p> <pre><code>    `-wildcard`\n\n```pwsh\n     switch -wildcard ( Read-Host \"Escribe un n\u00famero de tel\u00e9fono\" ){\n      \"8*\" { Write-Host \"Es un tel\u00e9fono fijo: $_\"; break }\n      \"9*\" { Write-Host \"Es un tel\u00e9fono fijo: $_\"; break }\n      \"6*\" { Write-Host \"Es un tel\u00e9fono m\u00f3vil: $_\"; break }\n        default { \"$_ no parece un tel\u00e9fono\" }\n    }\n```\n</code></pre> <ul> <li>El comando break que aparece al final de cada opci\u00f3n indica que si encuentra una coincidencia no siga buscando m\u00e1s y rompa el switch, ahorr\u00e1ndose as\u00ed el resto de comprobaciones.</li> </ul>"},{"location":"UD10/023_PowerShell_ControlFlujo/#estructuras-iterativas","title":"Estructuras iterativas","text":""},{"location":"UD10/023_PowerShell_ControlFlujo/#while","title":"while","text":"<p>A diferencia de lo que ocurr\u00eda en GNU/Linux, en PowerShell existen diferencias entre las estructuras while, do while y do until. En este caso, la \u00fanica de las tres que evaluar\u00e1 la condici\u00f3n al inicio del bloque de c\u00f3digo ser\u00e1 la primera. El resto comprueba la condici\u00f3n al final del bloque ejecutando como m\u00ednimo una vez el c\u00f3digo que contiene.</p> <pre><code>while ( condici\u00f3n ){\n    bloque de c\u00f3digo a ejecutar mientras condici\u00f3n sea verdadera\n}\n</code></pre> <pre><code>do {\n    bloque de c\u00f3digo a ejecutar mientras condici\u00f3n sea verdadera\n} while ( condici\u00f3n )\n</code></pre> <p>Existe una variante de esta estructura que se crea sustituyendo el while por un until. Esto cambia el sentido de la condici\u00f3n y es este caso el bloque se repite hasta que la condici\u00f3n se cumpla. Esta estructura no es muy utilizada, pero siempre es bueno contar con herramientas extra.</p>"},{"location":"UD10/023_PowerShell_ControlFlujo/#for","title":"for","text":"<p>Tambi\u00e9n la estructura <code>for</code> es sensiblemente diferente que en shellscript. Esta estructura en PowerShell tiene m\u00e1s que ver con los lenguajes de programaci\u00f3n y se utiliza cuando el programador sabe el n\u00famero de iteraciones que hay que realizar para solucionar un problema.</p> <pre><code>for ( inicializaci\u00f3n; condici\u00f3n; incremento ){\n    bloque de c\u00f3digo a ejecutar mientras condici\u00f3n sea verdadera\n}\n</code></pre> <ul> <li>Por ejemplo, la creaci\u00f3n de la tabla de multiplicar de un n\u00famero especificado por el usuario. Para resolver este problema s\u00ed se conoce el n\u00famero de iteraciones necesarias, concretamente diez.</li> </ul> <p>Example</p> <pre><code>$numero = Read-Host \"Dame un n\u00famero\"\nWrite-Host \"Esta es la tabla del $num\"\nfor ( $i=0; $i -lt 11; $i++){\n    Write-Host \" $i x $numero = \"($i*$numero)\n}\n</code></pre>"},{"location":"UD10/023_PowerShell_ControlFlujo/#foreach","title":"foreach","text":"<p>La estructura <code>foreach</code> en PowerShell es el equivalente a for en shellscript. Est\u00e1 pensada para recorrer un conjunto de valores y ejecutar el bloque de c\u00f3digo una vez por cada elemento del conjunto.</p> <pre><code>foreach ( elemento in conjunto ){\n bloque de c\u00f3digo a ejecutar por cada elemento del conjunto\n}\n</code></pre> <p>Al igual que ocurre en GNU/Linux, el conjunto puede serlo de cualquier tipo de objetos, incluso los ficheros de una carpeta. En el siguiente ejemplo se buscan los ficheros que en su nombre contengan la cadena de texto que el usuario ha especificado:</p> <p>Example</p> <pre><code>```pwsh\n    $ruta = \"C:\\Users\\Administrador\\Desktop\"\n    $busca = Read-Host \"Escribe el texto a buscar\"\n    foreach ($archivo in Get-ChildItem $ruta){\n        if ($archivo.Name.IndexOf($busca) -ge 0){\n        Write-Host $archivo.Name\n        }\n    }\n```\n</code></pre> <p>Otro ejemplo con el misma salida.</p> <p>Example</p> <pre><code>``` PowerShell title=\"\"\nForeach ($elemento in Get-Process) {\n\n\"{0} arrancado el : {1}\" -f $elemento.Name, $elemento.StartTime\n}\n\n```\n\nEn este segundo forma se utiliza un pipeline.\n``` PowerShell title=\"\"\nGet-Process | Foreach {\n\u2019{0} arrancado el : {1}\u2019 -f $_.Name, $_.StartTime\n}\n\n```\n</code></pre> <p>Note</p> <p>Las opciones que ofrece PowerShell en cuanto a estructuras de control parece una oferta m\u00e1s completa que la de shellscript, aunque para las tareas que se van a realizar en este m\u00f3dulo, ambos sistemas poseen herramientas suficientes.</p>"},{"location":"UD10/024_PowerShell_VectoresFunciones/","title":"Vectores y Funciones","text":""},{"location":"UD10/024_PowerShell_VectoresFunciones/#vectores","title":"Vectores","text":"<ul> <li>PowerShell considera como un vector a toda colecci\u00f3n de objetos, sea cual sea su tipo.</li> <li>Los elementos que lo conforman pueden estar separados por comas, estar expresados por el operador de rango <code>..</code> o ser el resultado de alguna expresi\u00f3n que devuelva una colecci\u00f3n, como as\u00ed lo hacen muchos cmdlets.</li> </ul> <p>Example</p> <pre><code>    $Vacia = @{}\n    $Enteros = 1,2,3,4,5\n    $Texto = \u201cLunes\u201d,\u201cMartes\u201d,\u201dMi\u00e9rcoles\u201d, \u201cJueves\u201d,\u201dViernes\u201d\n    $EnterosRango = 1..10\n</code></pre> <p>De esta forma se han definido cuatro vectores; el segundo contendr\u00e1 enteros y el tercero cadenas de caracteres. La \u00faltima l\u00ednea asigna los valores desde el 1 al 10 utilizando el operador rango <code>..</code> .</p> <p>Note</p> <p>El operador de rango representa una secuencia de enteros, con los l\u00edmites superior e inferior separados por dos puntos decimales. Permite expresar el rango en orden ascendente o descendente, as\u00ed como tambi\u00e9n que los l\u00edmites inferior o superior sean establecidos por medio de variables que contengan enteros.</p> <ul> <li>Un vector tambi\u00e9n puede definirse como el resultado de una expresi\u00f3n.</li> </ul> <p>Example</p> <pre><code>    $EnterosFor = @(For($i;$i &lt; 5;$i++){$i})\n    $Comando = Get-Process | Sort-Object ProcessName\n</code></pre> <p>En la primera l\u00ednea <code>$enteros</code> ser\u00e1 completado a trav\u00e9s del resultado de una estructura iterativa, mientras que la segunda contendr\u00e1 el resultado del cmdlet indicado. Adem\u00e1s de todas estas formas de declaraci\u00f3n, tambi\u00e9n se puede realizar a trav\u00e9s del cmdlet <code>New-Variable</code></p> <p>Example</p> <pre><code>    New-Variable -Name Enteros -Value 1,2,3,4,5 -Force\n    New-Variable -Name Texto -Value \"Lunes\",\"Martes\",\"Mi\u00e9rcoles\",\"Jueves\",\"Viernes\" \u2013Force\n    New-Variable -Name EnterosRango -Value (1..5) -Force\n    New-Variable -Name EnterosFor -value (. {For($i=1;$i -lt 5;$i++){$i}}) -Force\n</code></pre> <p>Note</p> <p>El atributo <code>-Force</code> sobrescribe la variable si esta ya existe, de ese modo no saltar\u00e1 ning\u00fan error a la hora de definir estas variables.</p> <ul> <li>Para obtener el n\u00famero de elementos de un vector se utiliza el m\u00e9todo Length, si se aplica a un elemento del vector, devolver\u00e1 el tama\u00f1o de este elemento, no del vector completo.</li> </ul> <p>Example</p> <pre><code>    $Texto.Length # mostrar\u00e1 5 por pantalla\n    $Texto[2].Length # mostrar\u00e1 9, las letras de \u201cMi\u00e9rcoles\u201d\n</code></pre> <ul> <li>Para a\u00f1adir elementos al final de un vector se utiliza el operador <code>+=</code>.</li> </ul> <p>Example</p> <pre><code>$Enteros += 6\n$Texto += \u201cS\u00e1bado\u201d, \u201cDomingo\u201d\n</code></pre> <p>Note</p> <p>La primera l\u00ednea a\u00f1ade el entero 6 al vector <code>$Enteros</code>, mientras que en la segunda se a\u00f1aden los elementos \u201cS\u00e1bado\u201d y \u201cDomingo\u201d al vector <code>$Texto</code>.</p> <ul> <li>Para eliminar un elemento de un vector PowerShell no ofrece un sistema parecido al de a\u00f1adir valores, sino que tendr\u00e1 que reescribirse el vector de nuevo sin los valores no deseados.</li> </ul>"},{"location":"UD10/024_PowerShell_VectoresFunciones/#funciones","title":"Funciones","text":"<p>Tambi\u00e9n en PowerShell es posible utilizar funciones a trav\u00e9s de la siguiente estructura:</p> <pre><code>Function &lt;NOMBRE&gt; {\n Param (&lt;Par\u00e1metro&gt;,&lt;Par\u00e1metro&gt;,...)\n     Comandos PowerShell\n}\n</code></pre> <p>Warning</p> <p>El paso de par\u00e1metros a una funci\u00f3n se realiza de id\u00e9ntica forma que en shell script. La principal diferencia entre las funciones usadas en shell script es que ahora es preferible declarar y tipar antes de iniciar con el c\u00f3digo de la funci\u00f3n.</p> <p>Example</p> <pre><code>``` pwsh\nFunction Get-Sumar {\n    param ([integer] $a, [integer] $b)\n    $sumar = $a + $b\n    Write-Host \u201cLa suma es $sumar\u201d\n}\n```\n</code></pre> <p>Note</p> <pre><code>Si se ejecuta la siguiente instrucci\u00f3n: `Get-Sumar 2 8` La salida del terminal ser\u00e1 `La suma es 10`.\n</code></pre> <p>Si se necesita que las funciones est\u00e9n disponibles durante la sesi\u00f3n del usuario o si es necesario enlazarlas desde otro script, se deber\u00e1 utilizar la notaci\u00f3n de punto, del mismo modo que ocurr\u00eda en shell script.</p>"},{"location":"UD10/Actividades/","title":"Actividades","text":""},{"location":"UD10/Actividades/#introduccion","title":"Introducci\u00f3n","text":"<ol> <li>Genera un Script que muestre los procesos del sistema ordenados por el id.</li> <li>Muestra los servicios cuyo nombre empiece por la letra <code>n</code>, utilizando la creaci\u00f3n de un script.</li> <li>Crea un script que se le introduzca dos n\u00fameros como argumentos y los muestre por pantalla.</li> <li>Dise\u00f1a un script en Shell que pida al usuario dos n\u00fameros, los guarde en dos variables y los muestre por pantalla.</li> <li> <p>Crea un shell script que muestre por pantalla el resultado de de las siguientes operaciones. Debes tener en cuenta que a, b y c son variables enteras que son preguntadas al usuario al iniciar el script.</p> </li> <li> <p>a%b</p> </li> <li>a/c</li> <li>2 _ b + 3 _ (a-c)</li> <li>a * (b/c)</li> <li>(a*c)%b</li> </ol>"},{"location":"UD10/Actividades/#control-de-flujo","title":"Control de flujo","text":"<ol> <li> <p>Crea un script que si no se la pasa ning\u00fan argumento nos lo diga.</p> </li> <li> <p>Crea un script PowerShell que al ejecutarlo muestre por pantalla uno de estos mensajes \u201cBuenos d\u00edas\u201d, \u201cBuenas tardes\u201d o \u201cBuenas noches\u201d, en funci\u00f3n de la hora que sea en el sistema (de 8:00 de la ma\u00f1ana a 15:00 ser\u00e1 ma\u00f1ana, de 15:00 a 20:00 ser\u00e1 tarde y el resto ser\u00e1 noche). Usa el <code>cmdlet Get-Date</code>.</p> </li> <li> <p>Construye tres script PowerShell utilizando estructuras iterativas:</p> </li> <li>el primero ej208A.ps1, que imprima la tabla de multiplicar de un n\u00famero preguntado al usuario. Este    n\u00famero debe ser entero positivo.</li> <li>el segundo ej208B.ps1, que pida un n\u00famero e indique si se trata de un n\u00famero par y si es n\u00famero primo.</li> <li>el tercero ej208C.ps1, que muestre las diez primeras tablas de multiplicar por pantalla. Hay un tiempo de espera de un segundo entre ellas. Utiliza las estructuras while, do while, for y foreach y el cmdlet Start-Sleep.</li> </ol>"},{"location":"UD10/Actividades/#vectores-y-funciones","title":"Vectores y Funciones","text":"<ol> <li> <p>Dise\u00f1a un script PowerShell que lea un vector con 365 temperaturas y calcule la media y cuantos d\u00edas han estado por encima y cuantos por debajo de ella. Rellena el vector con valores aleatorios entre -5 y 35, para ello usa Get-Random.</p> </li> <li> <p>Crea un script PowerShell para que haga una copias de seguridad de todos los archivos del directorio de trabajo del usuario actual. Deber\u00e1 realizar las siguientes acciones:</p> </li> <li> <p>comprobar\u00e1 si el archivo ya existe en la copia de seguridad, si es as\u00ed comprobar\u00e1 cual de los dos es m\u00e1s reciente y que tama\u00f1o tienen. Si es m\u00e1s reciente o posee un tama\u00f1o mayor, lo copiar\u00e1. En cualquier otro caso, no lo copia.</p> </li> <li>llevar\u00e1 un registro de todos los archivos copiados cada vez que se ejecute mediante un archivo de bit\u00e1cora. Guarda este fichero el directorio que contiene el script.</li> </ol> <p>Crea una funci\u00f3n para cada tarea realizada en este script.</p> <p>Warning</p> <p>Utiliza en la generaci\u00f3n de los scripts los cmdlets de depuraci\u00f3n si as\u00ed lo consideras al haber encontrado problemas en la ejecuci\u00f3n.</p> <p>NOTA</p> <p>Escribe el c\u00f3digo de los scripts en PowerShell que se detallan en cada ejercicio. Deber\u00e1s crear un fichero de texto para cada ejercicio con el siguiente nombre: ejXXX.sh, donde las X representan el n\u00famero de ejercicio. Una vez terminada la pr\u00e1ctica, comprime todos estos ficheros en uno y s\u00fabelos al Moodle.</p>"},{"location":"UD10/Actividades/#administracion","title":"Administraci\u00f3n","text":"<ol> <li> <p>Dise\u00f1a un script <code>(scriptAd1.ps1</code>) que liste todos los equipos de un Dominio y que que muestre si est\u00e1n conectado o no.</p> Salida del script<pre><code>Equipo   Version\n---\nSERVIDOR alcanzado\nCLIENTE2 alcanzado\nASIR no alcanzado\nUBUNTU1 no alcanzado\nASIRL... no alcanzado\nLINUX... no alcanzado\nUBUNT... no alcanzado\n</code></pre> <p>Note</p> <p>Comando para conseguir todos los equipos <code>Get-ADComputer</code> Envio de un solo ping <code>Test-Connection $Equipo -quiet -count 1)</code>.</p> </li> <li> <p>Modifica el anterior script y gu\u00e1rdalo como <code>(scriptProcesVirtual.ps1</code>). Tenemos que comprobar el tama\u00f1o en memoria del procesos que se llame PowerShell (propiedad <code>VirtualMemorySize</code>) de todos los equipos.</p> </li> </ol> Salida del Script<pre><code>Equipo   MemoriaVirtual\n------   --------------\nSERVIDOR      268861440\nCLIENTE2      725434368\nASIR       no alcanzado\nUBUNTU1    no alcanzado\nASIRL...   no alcanzado\nLINUX...   no alcanzado\n</code></pre> <pre><code>!!!note\n\n    Tenemos dos opciones utilizar la propiedad `ComputerName` o crear una sesi\u00f3n por cada uno de los ordenadores.\n</code></pre> <ol> <li> <p>Modifica el anterior script y gu\u00e1rdalo como <code>(scriptMediaPlayerVersion.ps1</code>). De tal manera, que en esta versi\u00f3n consigamos la versi\u00f3n del programa Media player. Para ello, es necesario que realizes una funci\u00f3n que se llame <code>Get-Key</code> y mandes esta a todos los equipos.</p> Salida del script<pre><code>Equipo   Version\n---      ----\nSERVIDOR 12,0,10011,16384\nCLIENTE2 12,0,10011,16384\nASIR Equipo inalca...\nUBUNTU1 Equipo inalca...\nASIRL... Equipo inalca...\n</code></pre> <p>Note</p> <p>La versi\u00f3n la tenemos que coger del registro de windows. mediante el comando <code>Get-ItemProperty HKLM:\\SOFTWARE\\Microsoft\\MediaPlayer\\PlayerUpgrade -Name \"PlayerVersion\" -ea silentlycontinue</code>. Recordar que s\u00f3lo nos interesa la version. Tambi\u00e9n, si no est\u00e1 instalada que nos diga que no instalada.</p> </li> <li> <p>Crea el siguiente script <code>(scriptDNSConfig.ps1</code>) De tal manera, que este script consiga la configuracion DNS de todos las interfaces activas en los equipos. Esta vez vamos a crear una funci\u00f3n que se le pasen por par\u00e1metros todos los equipos.</p> </li> </ol> <p>Esta funci\u00f3n debe empezar de la siguiente manera:</p> <pre><code>``` PowerShell title=\"\"\nfunction Get-DNSConfiguration\n    {\n        [CmdletBinding()]\n        Param ( [Parameter(Mandatory=$true,ValueFromPipeline=$true)} [String[]]$ComputerName\n    Process\n    {\n    #Aqu\u00ed ten\u00e9is que poner el c\u00f3digo.\n    }\n    }\n```\n</code></pre> <p>Aclaraciones sobre la creaci\u00f3n de la funci\u00f3n:</p> <ul> <li>El <code>CmdletBinding</code> atributo es un atributo de funciones que hace que funcionen como cmdlets compilados escritos en C#. Proporciona acceso a las caracter\u00edsticas de los cmdlets. Como por ejemplo que acepte valores desde un Pipeline (<code>ValueFromPipeline=$true</code>).</li> <li>Despu\u00e9s tendremos que buscar de todos los computadoras las interfaces que est\u00e1n activas. Buscando la instancia de la clase <code>Win32_NetworkAdapter</code></li> <li>A continuaci\u00f3n, deberemos pasarle esas interfaces para recuperar la configuraci\u00f3n con la clase Win32_NetworkAdapterConfiguration</li> </ul> <p>El resultado debe ser el siguiente:</p> Salida<pre><code>Get-DNSConfiguration -ComputerName cliente2\n\nHostName Ping DNS\n-------- ---- ---\ncliente2 OK   {172.16.0.3, 8.8.8.8}\n\n#O, como aceptamos pipeline.\n\n\nGet-ADComputer -Filter * | Select-Object Name -ExpandProperty Name |\nGet-DNSConfiguration\n#Podemos llamar a esa funci\u00f3n de esa manera  porque hemos establecido el bloque process, sino tendr\u00edamos que utilizar la variable $_ para cada uno de los objetos que se les pasa.\n\n\nHostName Ping DNS\n-------- ---- ---\nSERVIDOR OK   {127.0.0.1, 8.8.8.8}\nCLIENTE2 OK   {172.16.0.3, 8.8.8.8}\nASIR     NOK\nUBUNTU1  NOK\nASIRL... NOK\n</code></pre> <ol> <li>Modifica el anterior script con el nombre scriptSetDNSConfig.ps1. Con el objetivo de asignar DNS a las interfaces con la opci\u00f3n <code>SetDNSServerSearchOrder($DNSList)</code>.Donde <code>$DNSList</code> es un par\u00e1metro que por defecto no es obligatorio por defecto y que tenga unos valores por defecto como <code>[String[]]$DNSList = @('192.168.0.30', '192.168.0.40')</code>. Tendr\u00e1s que determinar si se ha actualizado las DNS o no.</li> </ol> <p>El resultado debe ser el siguiente:</p> Salida<pre><code> Get-DNSConfiguration -ComputerName cliente2\nHostName  Ping DNS\n-------- ---- ---\nCLIENTE2 OK {192.168.1.30, 192.168.1.40}\n</code></pre> <ol> <li>Crea el siguiente script <code>scriptNewUser.ps1</code>. Con el objetivo que en un controlador de dominio con el Rol de Active Directory creemos todos los usuarios desde un listado en un fichero CSV. Para realizar esto deberemos tener un fichero de la siguiente manera:</li> </ol> Formato de fichero con ; de separador<pre><code>Name;SAMAccountName;givenName;surname;Description;profilePath;scriptPath;\nPerez;Perez;Eduardo;P\u00e9rez;Cuenta de usuario;;login.vbs;L:;\\\\srvfic1\\users\nLarea;Larea;Pedro;Larea;Cuenta de usuario;;login.vbs;L:;\\\\srvfic1\\users\nGonzalo;Gonzalo;Juan;Gonzalo;Cuenta de usuario;;login.vbs;L:;\\\\srvfic1\\users\nArellano;Arellano;Marcelo;Arellano;Cuenta de usuario;;login.vbs;L:;\\\\srvfic1\\\nusers\nNavarro;Navarro;Jorge;Navarro;Cuenta de usuario;;login.vbs;L:;\\\\srvfic1\\users\n</code></pre> <pre><code>Este fichero tendr\u00e1s que importarlo con el comando `Import-Csv` y posteriormente pasar los datos al comando `New-ADUser`. **Cada columna del fichero ser\u00e1 una opci\u00f3n del comando anterior.**\nUtiliza los datos que te he dado pero tendr\u00e1s que incluir un password para cada uno de ellos, adem\u00e1s establecer que no expira nunca la contrase\u00f1a.Tambi\u00e9n, \u00e9stos tendr\u00e1n que estar en una OU del dominio que hay\u00e1is hecho.\n</code></pre>"},{"location":"UD10/Estandares%20WMI-CIM/","title":"Est\u00e1ndares.","text":""},{"location":"UD10/Estandares%20WMI-CIM/#que-son-cim-y-wmi","title":"\u00bfQu\u00e9 son CIM y WMI?","text":"<p>CIM (Common Information Model) es un est\u00e1ndar abierto creado por la organizaci\u00f3n DMTF orientado a proveer una definici\u00f3n com\u00fan para el intercambio de informaci\u00f3n entre sistemas, redes, aplicaciones y servicios.</p> <p>WMI (Windows Management Instrumentation) es la implementaci\u00f3n de Microsoft de CIM, con la que se proveen m\u00e9todos para consultar y modificar la configuraci\u00f3n de una m\u00e1quina Window.</p> <p>Aunque esta definido anteriormente como un est\u00e1ndar abierto, actualmente es el nombre de la implementaci\u00f3n . Por lo tanto:</p> <p>Los cmdlets Wmi fueron los que aparecieron primero pero a partir de Windows PowerShell 3 fueron sustituidos por los CimCmdlets.</p>"},{"location":"UD10/Estandares%20WMI-CIM/#descubrir-las-clases-que-soporta","title":"Descubrir las clases que soporta.","text":"<p><code>Get-CimClass</code> es EL comando elegido para descubrir todo lo que se esconde en una infraestructura CIM/WMI ya que el descubrimiento era hasta ahora el gran punto d\u00e9bil de esta tecnolog\u00eda.</p> <p>Veamos un ejemplo:</p> Filtrar clases<pre><code> Get-CimClass -ClassName *network*\n&gt;&gt;\n\n\n   NameSpace: ROOT/cimv2\n\nCimClassName                        CimClassMethods      CimClassProperties\n------------                        ---------------      ------------------\nWin32_NetworkLoginProfile           {}                   {Caption, Description, SettingID, AccountExpires...}\nWin32_NetworkAdapterConfiguration   {EnableDHCP, Rene... {Caption, Description, SettingID, ArpAlwaysSourceRoute...}\nWin32_NetworkAdapterSetting         {}                   {Element, Setting}\n</code></pre> <p>Pero podemos, tambi\u00e9n las propiedades y m\u00e9todos.</p> <pre><code>PS C:\\Users\\Administrador.WIN-OT4FJF7Q1AT&gt;  (Get-CimClass -ClassName Win32_NetworkAdapterConfiguration).\n&gt;&gt; CimClassProperties | Select-Object Name\n&gt;&gt;\n\nName\n----\nCaption\nDescription\nSettingID\n</code></pre> <p>Tambi\u00e9n podemos buscar clases que tengan una propiedad o m\u00e9todo en concreto.</p> <pre><code>PS C:\\Users\\Administrador.WIN-OT4FJF7Q1AT&gt;  Get-CimClass -PropertyName speed\n\n\n   NameSpace: ROOT/cimv2\n\nCimClassName                        CimClassMethods      CimClassProperties\n------------                        ---------------      ------------------\nCIM_NetworkAdapter                  {SetPowerState, R... {Caption, Description, InstallDate, Name...}\nWin32_NetworkAdapter                {SetPowerState, R... {Caption, Description, InstallDate, Name...}\n</code></pre>"},{"location":"UD10/Estandares%20WMI-CIM/#recuperar-las-instancias-de-esas-clases","title":"Recuperar las instancias de esas clases.","text":"<p>Ya hemos visto que tipos hay. Ahora debemos recuperar el objeto o instancia perteneciente a una clase en concreto.</p> <p>Veamoslo en el siguiente ejemplo.</p> <pre><code>PS C:\\Users\\Administrador.WIN-OT4FJF7Q1AT&gt; Get-CimInstance -ClassName Win32_BIOS\n\n\nSMBIOSBIOSVersion : VirtualBox\nManufacturer      : innotek GmbH\nName              : Default System BIOS\nSerialNumber      : 0\nVersion           : VBOX   - 1\n</code></pre>"},{"location":"UD10/Estandares%20WMI-CIM/#recuperar-con-un-filtro-qlcql","title":"Recuperar con un filtro QL/CQL","text":"<p>Cuando una consulta CIM/WMI devuelve un gran n\u00famero de objetos, es preferible utilizar (con <code>Where-Object</code>).</p>"},{"location":"UD10/Estandares%20WMI-CIM/#comandos-de-la-familia-wmi","title":"Comandos de la familia WMI","text":"<p>Como hemos dicho anteriormente el conjunto de comandos WMI ha sido sustituido por los comandos de la familia CIM. Aunque hay muchos scripts que poseen dichos comandos. Por ejemplo, el comando <code>Get-CimInstance</code> tienes como equivalente a <code>get-wmiObject</code></p>"},{"location":"UD10/Estandares%20WMI-CIM/#establecer-sesiones-con-equipos-remotos","title":"Establecer sesiones con equipos remotos","text":"<p>Mientras que los comando WMI se comunicaban con m\u00e1quinas remotas mediante los protocolos DCOM y RPC. \u00c9stas, no eran \u00f3ptimas dado que la sesi\u00f3n se elimina despu\u00e9s de haber devuelto los resultados.</p> <p>Sin embargo, los comandos de la familia CIM mejoran enormemente esta comunicaci\u00f3n aportando:</p> <ul> <li>Una comunicaci\u00f3n que permite eligir entre los protocolos HTTPS/WS-Man o DCOM/RPC.</li> <li>La posibilidad de mantener una sesi\u00f3n entre el cliente y los servidores.</li> <li>La posibilidad de enviar consultas de manera paralela y no secuencial.</li> <li>Un mecanismo de \u00abremoting\u00bb similar a las sesiones PowerShell remotas.</li> </ul> <p>Para el siguiente ejemplo tenemos un Windows server con un dominio y un windows 10 a\u00f1adido al dominio de tal manera que consultamos desde un ordenador a otro. el nombre de la computadora y el dia que instal\u00f3 el sistema operativo y su versi\u00f3n.</p> <pre><code>PS C:\\Users\\Administrador.WIN-OT4FJF7Q1AT&gt; $s = New-CimSession -ComputerName localhost, cliente2\nPS C:\\Users\\Administrador.WIN-OT4FJF7Q1AT&gt; Get-CimInstance -ClassName Win32_operatingSystem -CimSession $s |\n&gt;&gt; Select-Object PSComputerName, Installdate, Version, Caption\n\nPSComputerName Installdate         Version    Caption\n-------------- -----------         -------    -------\nlocalhost      06/10/2023 8:55:15  10.0.20348 Microsoft Windows Server 2022 Standard\ncliente2       15/03/2022 18:27:37 10.0.19044 Microsoft Windows 10 Education\n</code></pre> <p>Este ejemplo lo he realizado desde el Windows Server dado que tenemos un usuario administrador del dominio. Se puede realizar al contrario, pero tenemos que cambiar la credencial.</p> <p>Podemos tambi\u00e9n, quitar todas las conexiones que hemos establecido anteriormente mediante.</p> <pre><code>PS C:\\Users\\Administrador.WIN-OT4FJF7Q1AT&gt; Get-CimSession\n\n\nId           : 1\nName         : CimSession1\nInstanceId   : d92a043e-ff09-4abb-9fe1-dc53a7678539\nComputerName : cliente2\nProtocol     : WSMAN\n\nId           : 2\nName         : CimSession2\nInstanceId   : ec1f236f-d97a-4efb-a18f-ad788b8e7f45\nComputerName : localhost\nProtocol     : WSMAN\n\n\n\nPS C:\\Users\\Administrador.WIN-OT4FJF7Q1AT&gt; Get-CimSession | Remove-CimSession\n&gt;&gt;\nPS C:\\Users\\Administrador.WIN-OT4FJF7Q1AT&gt; Get-CimSession\nPS C:\\Users\\Administrador.WIN-OT4FJF7Q1AT&gt;\n</code></pre>"},{"location":"UD10/Estandares%20WMI-CIM/#gestionar-o-monitorizar-eventos","title":"Gestionar o monitorizar eventos.","text":"<p>Es una herramienta muy \u00fatil de CIM/WMI que permite vigilar eventos (click, ejecuci\u00f3n de procesos, etc.. ).</p> <p>Para suscribirnos a un evento, por ejemplo a la creaci\u00f3n de proceso.El comando PowerShell clave para llevar a cabo esta operaci\u00f3n es <code>Register-CimIndicationEvent</code>.</p> <p>Vamos a ver un ejemplo en el que se monitoriza la ejecuci\u00f3n cualquier proceso y nos muestra un mensaje.</p> Script cuando se genera proceso<pre><code>$action = {\n  $name = $event.SourceEventArgs.NewEvent.ProcessName\n  $id = $event.SourceEventArgs.NewEvent.ProcessId\n  Write-Host -Object \"New Process Started : Name = $name\n ID = $id\"\n}\nRegister-CimIndicationEvent -ClassName 'Win32_ProcessStartTrace' -SourceIdentifier \"ProcessSta\" -Action $action\n</code></pre> <p>En este ejemplo se suscribe a los eventos generados por la clase denominada Win32_ProcessStartTrace. Esta clase genera un evento cada vez que se inicia un proceso. La variable $action contiene el bloque de script para Action, que usa la $event variable para acceder al evento recibido de CIM.</p>"},{"location":"UD10/Estandares%20WMI-CIM/#comunicaciones-remotas-de-windows-powershell","title":"Comunicaciones remotas de Windows PowerShell","text":"<p>El mecanismo de comunicaci\u00f3n remota de Windows PowerShell, presente desde la versi\u00f3n 2.0, llamado tambi\u00e9n Gesti\u00f3n remota de Windows (WinRM) y nos permite la administraci\u00f3n de equipos Windows.</p> <p>Para autorizar a un sistema a recibir comandos remotos, es necesario activar el remoting con el comando <code>Enable-PSRemoting</code>. El comando debe ejecutarse en una consola PowerShell abierta con la opci\u00f3n Ejecutar como administrador.</p> <p>El servicio WinRM se configura b\u00e1sicamente con HTTP en el puerto 5985 y escucha en todas las direcciones IP. Para forzar el uso de HTTPS y as\u00ed cifrar sus conexiones, debe primero obtener un certificado que almacenar\u00e1 en el almac\u00e9n Equipo local/Personal.</p> <p>Note</p> <p>La activaci\u00f3n y configuraci\u00f3n del servicio WinRM en un gran n\u00famero de servidores o puestos de trabajo puede realizarse con GPO.</p>"},{"location":"UD10/Estandares%20WMI-CIM/#sesiones-remotas","title":"Sesiones Remotas.","text":"<p>Antes de poder enviar \u00f3rdenes a un equipo remoto para administrarlo, es necesario establecer una sesi\u00f3n remota. Una sesi\u00f3n remota puede ser:</p> <ul> <li>Temporal: una sesi\u00f3n temporal se establece justo durante el tiempo del env\u00edo de un comando con <code>Invoke-Command o Enter-PSSession</code>.</li> <li>Permanente: Una sesi\u00f3n permanente es \u00fatil en los casos donde debemos ejecutar varios comandos que comparten datos mediante variables o funciones. La creaci\u00f3n de una conexi\u00f3n permanente a un equipo local o remoto se realiza con el comando   <code>New-PSSession</code></li> </ul> Establecientod una sesion con Cliente2<pre><code>$session = New-PSSession -ComputerName cliente2\n# Si necesitamos cambiar de credenciales podemos utilizar el siguiente comandos\n\n$cred = Get-Credential\n$session = New-PSSession -ComputerName cliente2  -Credential $cred\n</code></pre> <p>Ahora podemos ejecutar de comandos remotos con <code>Invoke-Command</code></p> consulta de servicios en ejecuci\u00f3n de Cliente2<pre><code>$cmde = { Get-Service | Where {$_.Status -eq \u2019running\u2019} }\nInvoke-Command -ComputerName cliente2 -ScriptBlock $cmde\nStatus   Name               DisplayName                            PSComputerName\n------   ----               -----------                            --------------\nRunning  AdobeARMservice    Adobe Acrobat Update Service           cliente2\nRunning  Appinfo            Informaci\u00f3n de la aplicaci\u00f3n           cliente2\nRunning  AppXSvc            Servicio de implementaci\u00f3n de AppX ... cliente2\n</code></pre> <p>En el siguiente ejemplo lanzamos un comando en la m\u00e1quina cliente2 utilizando la sesi\u00f3n anteriormente creada $sesion.</p> <pre><code> Invoke-Command -Session $session -ScriptBlock {$s=Get-Service wuauserv}\n\n\n\nPS C:\\Users\\Administrador.WIN-OT4FJF7Q1AT&gt;  Invoke-Command -Session $session -ScriptBlock {$s}\n\n\n\nStatus   Name               DisplayName                            PSComputerName\n------   ----               -----------                            --------------\nRunning  wuauserv           Windows Update                         cliente2\n\nInvoke-Command -Session $session -ScriptBlock {$s | Stop-Service}\n\n\n\nPS C:\\Users\\Administrador.WIN-OT4FJF7Q1AT&gt;  Invoke-Command -Session $session -ScriptBlock {$s}\n\n\n\nStatus   Name               DisplayName                            PSComputerName\n------   ----               -----------                            --------------\nStopped  wuauserv           Windows Update                         cliente2\n</code></pre> <p>En el siguiente ejemplo vamos a la ver cuanto disco duro queda libre en el equipo remoto , pero esta vez ejecutamos un script en el equipo remoto. Empecemos por el script.</p> Script freeSpace.ps1<pre><code>Function Get-DiskFreeSpace {\n$Disks = Get- Win32_LogicalDisk |\nWhere {$_.DriveType -eq 3}\nForeach($disk in $Disks)\n{\n$prop = [Ordered]@{\n\u2019ID\u2019 = $disk.DeviceID\n\u2019FreeSpace(GB)\u2019 = [Math]::Round(($disk.FreeSpace)/1GB,3)\n\u2019FreeSpace(%)\u2019 =\n[Math]::Round(($disk.FreeSpace)*100/($disk.Size),3)\n}\nNew-Object -TypeName PSObject -Property $prop\n}\n}\n</code></pre> <p>Vamos a explicar el anterior script un poco m\u00e1s:</p> <ul> <li>Hemos creado una funci\u00f3n que podemos reutilizar.</li> <li>Se crea una variable <code>$disk</code> para contener la consulta sobre los discos que sean de tipo 3. Estos son discos locales.</li> <li>Se crea un objeto personalizado <code>New-Object</code> por cada uno de los discos en las que las propiedades de estos viene determinada por una matriz diccionario ordenada <code>[Ordered]@</code>.</li> </ul> <p>A continuaci\u00f3n se ejecuta ese script en los ordenadores remotos, en este caso cliente2.</p> Invocamos<pre><code>PS C:\\Users\\Administrador.WIN-OT4FJF7Q1AT&gt; Invoke-Command -ComputerName cliente2 -FilePath .\\Documents\\free.ps1\n\n\nDeviceID DriveType ProviderName VolumeName Size        FreeSpace PSComputerName\n-------- --------- ------------ ---------- ----        --------- --------------\nC:       3                                 53083406336 765591552 cliente2\n\nID             : C:\nFreeSpace(GB)  : 0,713\nFreeSpace(%)   : 1,442\nPSComputerName : cliente2\nRunspaceId     : 1f37c8a5-986b-4766-ba65-c85143e3d03f\n</code></pre> <p>En el anterior ejemplo no hemos abierto una sesi\u00f3n , hemos utilizado la opci\u00f3n <code>-ComputerName</code></p>"},{"location":"UD10/Estandares%20WMI-CIM/#apertura-de-una-sesion-remota-interactiva-powershell","title":"Apertura de una sesi\u00f3n remota interactiva PowerShell","text":"<p>Se puede ejecutar comandos en modo interactivo en un equipo remoto. Se trata de un funcionamiento similar al de SSH.</p> <p>El comando <code>Enter-PSSession</code> arranca una \u00fanica sesi\u00f3n interactiva en un equipo remoto. Se puede abrir una sola sesi\u00f3n interactiva a la vez. Ejemplo:</p> Sesion remota interactiva<pre><code>PS C:\\Users\\Administrador.WIN-OT4FJF7Q1AT&gt; Enter-PSSession -ComputerName cliente2\n[cliente2]: PS C:\\Users\\Administrador\\Documents&gt;\n</code></pre>"},{"location":"UD10/Estandares%20WMI-CIM/#importacion-de-comandos","title":"Importaci\u00f3n de comandos","text":"<p>Supongamos que en un equipo tenemos modulos que nos gustar\u00eda usar en nuestro equipo local.</p> <p>Veamos un ejemplo, en nuestro disponemos de un servidor con el rol \u00abActive Directory Domain Services\u00bb instalado. Este m\u00f3dulo aporta numerosos comandos para la gesti\u00f3n de objetos de usuario, equipos, grupos, OUs, etc. Por lo tanto queremos importar este m\u00f3dulo en la sesi\u00f3n actual de nuestro cliente.</p> <p>Creamos una sesi\u00f3n e importamos el m\u00f3dulo desde el servidor al <code>cliente2</code>. La sesi\u00f3n que tenemos que abrir en el cliente es de administrador, sino no nos deja.</p> Importaci\u00f3n de m\u00f3dulo<pre><code>PS &gt; $s = New-PSSession -ComputerName servidor\nPS &gt; Invoke-Command -Session $s -ScriptBlock { Import-Module ActiveDirectory }\n# ya hemos importado (esto se toma un poco de tiempo) desde server y ahora podemos importar los comandos que lo componen.\nPS &gt; Import-PSSession -Session $s -Module ActiveDirectory\n</code></pre> <p>Con lo cu\u00e1l, ahora ya podemos utilizar esos comandos.</p> Demostraci\u00f3n<pre><code>PS &gt; Get-Command *-AD*\n</code></pre>"},{"location":"UD10/Manejo%20resultados/","title":"Manejo y selecci\u00f3n de resultados.","text":"<p>Podemos utilizar dos b\u00e1sicamente <code>Select-objet</code> o realizar un filtro m\u00e1s especifico mediante <code>Where-Object</code> y todos ellos se les trasfiere los objetos mediante el pipe \u00ab|\u00bb.</p>"},{"location":"UD10/Manejo%20resultados/#recuperacion-de-objetos","title":"Recuperaci\u00f3n de Objetos.","text":"<p>La recuperaci\u00f3n de objetos mediante <code>Select-Object</code> es muy sencilla y tiene opciones muy interesantes.</p> <p>Veamos un ejemplo:</p> Selecci\u00f3n de cinco procesos<pre><code>S /home/julio&gt; $processes | Select-Object -first 5\n\n NPM(K)    PM(M)      WS(M)     CPU(s)      Id  SI ProcessName\n ------    -----      -----     ------      --  -- -----------\n      0     0,00       4,08       0,00  155061 \u202630 (sd-pam)\n      0     0,00       8,53       0,20     992 992 accounts-daemon\n      0     0,00       3,92       0,09    8039 \u202639 accounts-daemon\n      0     0,00       0,69       0,17     996 996 acpid\n      0     0,00       0,00       0,00     162   0 acpi_thermal_pm\n</code></pre> <p>Podemos sacar los procesos \u00fanicos con la opci\u00f3n <code>-Unique</code>.</p> Selecci\u00f3n de cinco procesos \u00fanicos<pre><code>PS /home/julio&gt;  Get-Process | Select-Object -Unique | Select-Object -First 5\n\n NPM(K)    PM(M)      WS(M)     CPU(s)      Id  SI ProcessName\n ------    -----      -----     ------      --  -- -----------\n      0     0,00       4,07       0,00  155061 \u202630 (sd-pam)\n      0     0,00       8,41       0,35     992 992 accounts-daemon\n      0     0,00       0,69       0,33     996 996 acpid\n      0     0,00       0,00       0,00     162   0 acpi_thermal_pm\n      0     0,00       4,65       0,00  156132 \u202631 agent\n</code></pre> <p>Para recuperar el nombre de los procesos as\u00ed como el id asociado podemos escribirlo.</p> <pre><code>PS /home/julio&gt;  Get-Process | Select-Object ProcessName,ID |  Select-Object -First 5\n\nProcessName         Id\n-----------         --\n(sd-pam)        155061\naccounts-daemon    992\naccounts-daemon   8039\nacpid              996\nacpi_thermal_pm    162\n</code></pre> <p>Otra forma de recuperar los objetos es mediante el filtro de busqueda, gracias a <code>Where-Object</code>.</p> <p>Vemos el siguiente ejemplo:</p> Recupera servicios en ejecuci\u00f3n<pre><code>PS C:\\Users\\Administrador.WIN-OT4FJF7Q1AT&gt; $services = Get-Service\nPS C:\\Users\\Administrador.WIN-OT4FJF7Q1AT&gt; $services\n\nStatus   Name               DisplayName\n------   ----               -----------\nRunning  ADWS               Servicios web de Active Directory\nStopped  AJRouter           Servicio de enrutador de AllJoyn\nStopped  ALG                Servicio de puerta de enlace de niv...\n\n\nPS C:\\Users\\Administrador.WIN-OT4FJF7Q1AT&gt; $services | Where-Object {$_.Status -eq \u2019running\u2019}\nStatus   Name               DisplayName\n------   ----               -----------\nRunning  ADWS               Servicios web de Active Directory\nRunning  AppXSvc            Servicio de implementaci\u00f3n de AppX ...\nRunning  BFE                Motor de filtrado de base\n</code></pre> <p>Aplicamos ahora un filtro para recuperar \u00fanicamente los servicios de Windows en ejecuci\u00f3n de.</p> <p>El \u00ab$_\u00bb indica que tratamos el objeto actual, en cada momento.</p> <p>Ahora podemos encadenar otra comparaci\u00f3n separadas por un \u00abpipe\u00bb.</p> Los tres \u00faltimos servicios<pre><code>PS C:\\Users\\Administrador.WIN-OT4FJF7Q1AT&gt;\n&gt;&gt; $services | Where-Object {$_.Status -eq \u2019running\u2019}| Select-Object -Last 3\n\nStatus   Name               DisplayName\n------   ----               -----------\nRunning  WpnService         Servicio del sistema de notificacio...\nRunning  WpnUserService_... Servicio de usuario de notificacion...\nRunning  wuauserv           Windows Update\n</code></pre>"},{"location":"UD10/Manejo%20resultados/#formateo-para-su-visualizacion","title":"Formateo para su visualizaci\u00f3n","text":""},{"location":"UD10/Manejo%20resultados/#listado","title":"Listado","text":"<p>Para mostrarlo en formato lista. Es decir que cada propiedad de cada objeto se muestra en una nueva l\u00ednea. Mediante al propiedad <code>Format-first</code></p> <pre><code>PS C:\\Users\\Administrador.WIN-OT4FJF7Q1AT&gt;  Get-ChildItem C:\\ | Format-List\n   Directorio: C:\\\nName           : PerfLogs\nCreationTime   : 08/05/2021 10:20:24\nLastWriteTime  : 08/05/2021 10:20:24\nLastAccessTime : 08/05/2021 10:20:24\n</code></pre> <p>Otro ejemplo, para mostrar selectivamente algunas propiedades de los servicios de Windows:</p> <pre><code>PS C:\\Users\\Administrador.WIN-OT4FJF7Q1AT&gt; Get-Service | Format-List Name, Displayname,Status\n\nName        : ADWS\nDisplayName : Servicios web de Active Directory\nStatus      : Running\n</code></pre> <p>Note</p> <p>La ventaja principal de usar el comando Format-List respecto a la visualizaci\u00f3n de un tipo tabla (Format-Table), es que los valores de las propiedades disponen de m\u00e1s sitio en pantalla para mostrarse, y por lo tanto no se truncan.</p>"},{"location":"UD10/Manejo%20resultados/#tabla","title":"Tabla","text":"<p>Casi la mayor\u00eda de los cmlets lo muestran as\u00ed, si no es el caso, tenemos <code>Format-table</code>.</p> <p>Para que no se trunque informaci\u00f3n podemos poner la opci\u00f3n <code>Autosize</code>. Veamos un ejemplo:</p> <pre><code>PS C:\\Users\\Administrador.WIN-OT4FJF7Q1AT&gt;  Get-ChildItem C:\\| Format-Table -Property mode,name,length,\n&gt;&gt; isreadonly,creationTime -Autosize\n\nMode   Name                length isreadonly CreationTime\n----   ----                ------ ---------- ------------\nd----- PerfLogs                              08/05/2021 10:20:24\nd-r--- Program Files                         08/05/2021 10:20:24\nd----- Program Files (x86)                   08/05/2021 10:20:24\nd-r--- Users                                 08/05/2021 10:06:51\nd----- Windows                               08/05/2021 10:06:51\n</code></pre>"},{"location":"UD10/Manejo%20resultados/#redireccion","title":"Redirecci\u00f3n","text":"<p>Para redirigir el flujo de salida hacia un archivo podemos utilizar <code>&gt; y &gt;&gt;</code>, de la misma manera que en linux Veamos varios ejemplos.</p> Mandar a un archivo<pre><code>PS C:\\Users\\Administrador.WIN-OT4FJF7Q1AT&gt; Get-Process &gt; .\\temp\\process.txt\n\nPS C:\\Users\\Administrador.WIN-OT4FJF7Q1AT\\temp&gt; Get-Content .\\process.txt\n\nHandles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName\n-------  ------    -----      -----     ------     --  -- -----------\n     92       6      868       4688       0,00   2204   0 AggregatorHost\n    258      14     8600      26888       0,36   4836   1 conhost\n</code></pre> <p>Por ejemplo si queremos redirigir el canal de error, que es el mismo que en linux, a un archivo, lo podemos realizar de la siguiente manera.</p> <pre><code> C:\\Users\\Administrador.WIN-OT4FJF7Q1AT\\temp&gt;  Get-ChildItem C:\\Temp\\DirInexistente 2&gt; .\\err.txt\n&gt;&gt;\nPS C:\\Users\\Administrador.WIN-OT4FJF7Q1AT\\temp&gt; Get-Content .\\err.txt\nGet-ChildItem : No se encuentra la ruta de acceso 'C:\\Temp\\DirInexistente' porque no existe.\nEn l\u00ednea: 1 Car\u00e1cter: 2\n+  Get-ChildItem C:\\Temp\\DirInexistente 2&gt; .\\err.txt\n+  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : ObjectNotFound: (C:\\Temp\\DirInexistente:String) [Get-ChildItem], ItemNotFoundException\n    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.GetChildItemCommand\n</code></pre>"},{"location":"UD10/ProgramacionAula/","title":"Programaci\u00f3n de Aula","text":""},{"location":"UD10/ProgramacionAula/#resultados-de-aprendizaje","title":"Resultados de Aprendizaje","text":"<p>Esta unidad cubre el Resultado de aprendizaje 7 (RA7) seg\u00fan el Real Decreto 1629/2009, de 30 de octubre, el cual es:</p> <ol> <li>Utiliza lenguajes de guiones en sistemas operativos, describiendo su aplicaci\u00f3n y administrando servicios del sistema operativo.</li> </ol> <p>Los criterios de evaluaci\u00f3n asociados son:</p> <ol> <li>a. Se han utilizado y combinado las estructuras del lenguaje para crear guiones.</li> <li>b. Se han utilizado herramientas para depurar errores sint\u00e1cticos y de ejecuci\u00f3n.</li> <li>g. Se han implantado guiones en sistemas libres y propietario.</li> <li>h. Se han consultado y utilizado librer\u00edas de funciones.</li> <li>i. Se han documentado los guiones creados.</li> </ol>"},{"location":"UD10/ProgramacionAula/#planificacion-temporal","title":"Planificaci\u00f3n Temporal","text":"<p>Sesi\u00f3n.</p> <p>Fecha</p> <p>Contenido</p> <p>Recurso Did\u00e1ctico</p> <p>             1             </p> <p>             27/09/22             </p> <p>             Introducci\u00f3n PowerShell, Creaci\u00f3n Primer Script, Comentarios y depuraci\u00f3n.             </p> <p> Introducci\u00f3n PowerShell </p> <p>             2             </p> <p>             28/09/22             </p> <p>             Sintaxis, Argumentos y variables, Interacci\u00f3n con el usuario, Operadores.             </p> <p> Sintaxis PowerShell </p> <p>             3             </p> <p>             29/09/22             </p> <p>             Control de Flujo. Estructuras condicionales e iterativas.             </p> <p> Control de Flujo. </p> <p>             4             </p> <p>             04/10/22             </p> <p>             Vectores y funciones             </p> <p> Vectores y Funciones. </p> <p>             5             </p> <p>             05/10/22             </p> <p>             Refuerzo y Ampliaci\u00f3n.             </p> <p>              Refuerzo y Ampliaci\u00f3n.             </p>"},{"location":"UD10/ResumenUD/","title":"Resumen UD","text":"<p>A continuaci\u00f3n se muestra un resumen de la Unidad Did\u00e1ctica:</p>  RESUMEN UNIDAD DID\u00c1CTICA <p>Unidad Did\u00e1ctica</p> <p>UD1.- ShellScripting. Realizaci\u00f3n de Guiones en Sistemas Operativos Libres.</p> <p>Horas</p> <p>6 Sesiones - 12 Horas</p> <p>Resultados de Aprendizaje</p> <p>RA7. Utiliza lenguajes de guiones en sistemas operativos, describiendo su aplicaci\u00f3n y administrando servicios del sistema operativo.</p> <p>Preconocimiento</p> <p>Funcionamiento del terminal de Linux/GNU. Aplicaci\u00f3n de comandos. Utilizaci\u00f3n de editores. Conocimiento de permisos de archivos.</p> <p>Objetivos Operativos</p> <p>Competencias Personales y Sociales. Transversales</p> <p> <ul> <li>Administraci\u00f3n de terminal de Linux/GNU.</li> <li>Conocer comandos b\u00e1sicos y avanzados en Shell.</li> <li>Optimizar el c\u00f3digo de los scripts mediante tuber\u00edas y redirecciones.</li> </ul> </p> <p>14. Gestionar y/o realizar el mantenimiento de los recursos de su \u00e1rea (programando y verificando su cumplimiento), en funci\u00f3n de las cargas de trabajo y el plan de mantenimiento.</p> <p>16. Mantener el esp\u00edritu de innovaci\u00f3n y actualizaci\u00f3n en el \u00e1mbito de su trabajo para adaptarse a los cambios tecnol\u00f3gicos y organizativos de su entorno profesional.</p> <p>Contenidos conceptuales</p> <p> <ul> <li>Introducci\u00f3n Linux. Creaci\u00f3n ShellScripts. Depuraci\u00f3n.</li> <li>Argumentos, variables, operadores; Entrada y Salida.</li> </ul> </p> <p> <ul> <li>Control de Flujo. Estructuras condicionales e iterativas.</li> <li>Funciones y vectores.</li> </ul> </p> <p>Instrumentos Evaluaci\u00f3n</p> <p>Actividades INICIALES (Ense\u00f1anza/Aprendizaje).</p> <p>Criterios Evaluaci\u00f3n</p> <p>Instrumento Calificaci\u00f3n</p> <p>Actividades desde la 101 a la 104. Basadas en Scripts de nivel bajo, en concreto, sobre el desarrollo de:</p> <p> <ul> <li>Creaci\u00f3n primeros scripts de nivel bajo</li> <li>Depuraci\u00f3n de scripts.</li> </ul> </p> <p> <ul> <li>CE7b. Se han utilizado herramientas para depurar errores sint\u00e1cticos y de ejecuci\u00f3n.</li> <li>CE7g. Se han implantado guiones en sistemas libres y propietarios.</li> <li>CE7i. Se han documentado los guiones creados.</li> </ul> </p> <p> <ul> <li>R\u00fabrica.</li> </ul> </p> <p>Actividades DESARROLLO (Ense\u00f1anza/Aprendizaje).</p> <p>Criterios Evaluaci\u00f3n</p> <p>Instrumento Calificaci\u00f3n</p> <ul> <li>Actividades desde la 105 a la 107. Interacci\u00f3n con usuario, utilizaci\u00f3n de variables, par\u00e1metros y operadores.</li> <li>Actividades desde la 108 a la 110. Control de Flujo. Estructuras condicionales e iterativas.</li> <li>Actividades desde la 111 a la 114. Vectores y funciones.</li> </ul> <p> <ul> <li>CE7a. Se han utilizado y combinado las estructuras del lenguaje crear guiones.</li> <li>CE7g. Se han implantado guiones en sistemas libres y propietario.</li> <li>CE7h. Se han consultado y utilizado librer\u00edas de funciones.</li> <li>CE7i. Se han documentado los guiones creados.</li> </ul> </p> <ul> <li>R\u00fabrica.</li> </ul> <p>Actividades Refuerzo.</p> <p>Criterios Evaluaci\u00f3n</p> <p>Instrumento Calificaci\u00f3n</p> <ul> <li>Actividades desde la 115 a la 118. Variables, par\u00e1metros, comprobaciones, estructuras condicionales e iterativas.</li> </ul> <p> <ul> <li>CE7a. Se han utilizado y combinado las estructuras del lenguaje crear guiones.</li> <li>CE7g. Se han implantado guiones en sistemas libres y propietario.</li> <li>CE7i. Se han documentado los guiones creados.</li> </ul> </p> <ul> <li>R\u00fabrica.</li> </ul> <p>Actividades Ampliaci\u00f3n.</p> <p>Criterios Evaluaci\u00f3n</p> <p>Instrumento Calificaci\u00f3n</p> <ul> <li>Actividades desde la 119 a la 121. Vectores, funciones, estructuras condicionales e iterativas.</li> </ul> <p> <ul> <li>CE7a. Se han utilizado y combinado las estructuras del lenguaje crear guiones.</li> <li>CE7g. Se han implantado guiones en sistemas libres y propietario.</li> <li>CE7h. Se han consultado y utilizado librer\u00edas de funciones.</li> <li>CE7i. Se han documentado los guiones creados.</li> </ul> </p> <ul> <li>R\u00fabrica.</li> </ul> <p>Prueba espec\u00edfica de evaluaci\u00f3n.</p> <p> <ul> <li></li> <li></li> </ul> </p>"},{"location":"UD10/comandos/","title":"comandos","text":""},{"location":"UD10/comandos/#estructura-de-comandos","title":"Estructura de comandos.","text":"<p>Los comandos incluidas en PowerShell reciben el nombre de cmdlets (command-let) y posee conjuntos espec\u00edficos para trabajar con Active Directory, Exchange, cada uno de ellos se denominar\u00e1n m\u00f3dulos.</p> <p>Los nombres de todos los cmdlets est\u00e1n formados por un verbo, un guion y un nombre en singular. Habitualmente, se escribe con may\u00fasculas la primera letra de cada palabra, pero no se trata m\u00e1s que de una norma de estilo, porque *PowerShell no distingue entre may\u00fasculas y min\u00fasculas.</p> <p>Una caracter\u00edstica de PowerShell es que se dispone de la mayor\u00eda de comandos que del CLI tradicional de Microsoft. De ese modo, es posible ejecutar el comando <code>dir</code> en lugar del <code>Get-ChildItem</code>, cmdlet que realiza la misma tarea. En realidad lo que est\u00e1 usando es un alias del segundo para lanzar el primero.</p> <p>Dispone de auto-completado de comandos y par\u00e1metros que facilitar\u00e1 las tareas de creaci\u00f3n de scripts. Basta con comenzar a escribir un cmdlet y pulsarla tecla Tab. Como hemos visto en Linux</p> <p>Si utilizamos PowerShell ISE al escribir aparecer\u00e1 una ventana con todos los cmdlets que coincidan con el texto escrito, incluso puede aparecer un recuadro con ayuda sobre su sintaxis. Para aceptar la sugerencia se pulsa la tecla Intro.</p>"},{"location":"UD10/comandos/#ayuda-sobre-los-comandos","title":"Ayuda sobre los comandos","text":"<p>Para solicitar ayuda acerca de un comando, puede hacerlo de distintas maneras:</p> <ul> <li>Get-Help miComando</li> <li>HelpmiComando</li> <li>miComando-?</li> </ul>"},{"location":"UD10/comandos/#get-command","title":"Get-Command","text":"<p>Si no sabemos que comandos disponemos. <code>Get-command</code> permite descubrir todos los comandos PowerShell.</p> <pre><code>PS /home/julio&gt; Get-Command -CommandType cmdlet\u00a0\n\nCommandType     Name                                               Version    Source\n-----------     ----                                               -------    ------\nCmdlet          Add-Content                                        7.0.0.0    Microsoft.PowerShell.Management\nCmdlet          Add-History                                        7.0.3.0    Microsoft.PowerShell.Core\nCmdlet          Add-Member                                         7.0.0.0    Microsoft.PowerShell.Utility\nCmdlet          Add-Type                                           7.0.0.0    Microsoft.PowerShell.Utility\nCmdlet          Clear-Content                                      7.0.0.0    Microsoft.PowerShell.Management\nCmdlet          Clear-History                                      7.0.3.0    Microsoft.PowerShell.Core\n</code></pre> <p>El par\u00e1metro <code>-CommandType</code> seguido del tipo de comando elegido, cmdlet. Pero podemos elegir otros tipos como alias , funciones etc..</p> <p>Otra opci\u00f3n importante es <code>-verb</code> permite conocer todos los comandos que empiezan por un verbo concreto.</p>"},{"location":"UD10/comandos/#objetos","title":"Objetos","text":"<p>No voy desarrollar la programaci\u00f3n orientada a objetos. Pero hay que entender que es un objeto. Porque en todos lo elementos en PowerShell son objetos.</p> <p>Por ejemplo mi coche es un objeto que dispone de propiedades y m\u00e9todos. Las propiedades pueden ser:</p> <ul> <li>Marca,</li> <li>Modelo,</li> <li>Cilindrada,</li> <li>Potencia,</li> <li>Color,</li> <li>Peso,</li> </ul> <p>Pero \u00bfqu\u00e9 acciones (m\u00e9todos) podemos realizar con nuestra moto? Pues entre otras cosas, podemos:</p> <ul> <li>Arrancar/parar el motor,</li> <li>Acelerar/frenar,</li> </ul> <p>Pero como podemos utilizar o recuperar esa informatic\u00f3n. Por ejmplo, en un objeto llamado \u00abmiCoche\u00bb, para recuperar el color usaremos la sintaxis siguiente:</p> <pre><code>PS &gt; $miMoto.color\n</code></pre> <p>Y para arrancar \u00abmiCoche\u00bb, la sintaxis que sigue:</p> <pre><code>PS &gt; $miMoto.arrancar()\n</code></pre>"},{"location":"UD10/comandos/#get-member","title":"Get-Member","text":"<p>Devuelve todas las propiedades y m\u00e9todos de un objeto as\u00ed como su tipo.</p> Obtenci\u00f3n de tipo<pre><code>PS /home/julio&gt; $result = Get-ChildItem /\nPS /home/julio&gt; $result | Get-Member\n\n\n   TypeName: System.IO.DirectoryInfo\n\nName                      MemberType     Definition\n----                      ----------     ----------\nLinkType                  CodeProperty   System.String LinkType{get=GetLinkType;}\nMode                      CodeProperty   System.String Mode{get=Mode;}\nModeWithoutHardLink       CodeProperty   System.String ModeWithoutHardLink{get=ModeWithoutHardLink;}\nTarget                    CodeProperty   System.String Target{get=GetTarget;}\n\n....\n\nTypeName: System.IO.FileInfo\n\nName                      MemberType     Definition\n----                      ----------     ----------\nLinkType                  CodeProperty   System.String LinkType{get=GetLinkType;}\n...\n## Podemos ver que es miembro de dos tipos.\n## Adem\u00e1s, podemos utilizarlo de la siguiente manera en la que podemos sacar los nombres.\n\nPS /home/julio&gt; $result.Name\nbin\nboot\n</code></pre> <p>Pero si lo ejecutamos de la siguiente forma:</p> <pre><code> PS /home/julio&gt; Get-Member -InputObject $result\n\n   TypeName: System.Object[]\n\nName           MemberType            Definition\n----           ----------            ----------\nAdd            Method                int IList.Add(System.Object value)\nAddress        Method                System.Object&amp;, System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e Address(int )\n</code></pre> <p>Nos est\u00e1 indicando que esta compuesto de un array de objetos.</p> <p>!!! note title=\u00bfQu\u00e9 es un array(vector)?</p> <pre><code>Pues, a una zona de almacenamiento contiguo que contiene una serie de elementos del mismo tipo, en este caso otros objetos de tipo ficheros o directorios.\nEsto no lo indica los [].\n</code></pre> <p>Ahora si vemos el siguiente ejemplo.</p> <pre><code>PS /home/julio/tmp/temp&gt; $result.Length\n27\n</code></pre> <p>Lo que nos est\u00e1 indicando es que tenemos 27 ficheros y carpetas</p>"},{"location":"UD10/comandos/#gestion-de-carpetas-y-archivos","title":"Gesti\u00f3n de carpetas y archivos","text":"<p>Cuando en Linux utilizamos el comando <code>ls</code> (funciona en PowerShell) lista todos los elementos que tiene en una carpeta. Tambi\u00e9n en el comando DOS/CMD <code>dir</code> podemos realizar la misma tarea.</p> <p>Pero, cuando tecleamos <code>dir</code> en PowerShell, en realidad llama a un alias. El alias ejecuta el comando <code>Get-ChildItem</code>.</p> <pre><code>PS /home/julio&gt; Get-Alias dir\u00a0\n\nCommandType     Name                                               Version    Source\n-----------     ----                                               -------    ------\nAlias           dir -&gt; Get-ChildItem\n</code></pre> <p>Vamos a poner algunos ejemplos, date cuenta que tenemos diferentes alias.</p> <p>Ejemplos:</p> <ul> <li>Para mostrar los archivos ocultos, agregue al comando <code>Get-Childitem</code> el par\u00e1metro -Force.</li> </ul> <pre><code>PS /home/julio&gt; gci / -Force\n\n\nDirectory: /\nMode LastWriteTime Length Name\n\n  ---\n\n      d-r-- 16/2/2024 16:02 bin\n      d-r-- 7/3/2024 10:17 boot\n      d-r-- 30/11/2018 23:26 cdrom\n      d-r-- 14/3/2024 10:04 dev\n      d-r-- 13/3/2024 8:47 etc\n      d-r-- 8/1/2024 12:02 home\n</code></pre> <ul> <li>Mostrar todos los archivos con extensi\u00f3n texto</li> </ul> <pre><code>PS /home/julio/Documentos/CursoBigdate/tmp/hive&gt;  Get-ChildItem / -Include *.txt -Recurse\n</code></pre> <ul> <li>Obtener el nombre de todos los archivos cuyo tama\u00f1o es superior a 32 KB.   <pre><code>Get-ChildItem  / -Recurse | Where-Object {$_.Length -gt 32KB}\n</code></pre></li> <li>Obtener los archivos cuya fecha de \u00faltima modificaci\u00f3n sea posterior al 01(mes)/03(dia)/2023(a\u00f1o)</li> </ul> <pre><code>Get-ChildItem | Where-Object {$_.LastWriteTime -gt \u201901/03/2023\u2019}\n</code></pre> <p>Pero como nos podemos desplazar entre los directorios. Lo seguimos haciendo con el comando <code>cd</code> pero el comando verdadero se llama <code>Set-Location</code></p> <p>Ejemplo:</p> <pre><code>PS /home/julio&gt; Set-Location /\nPS /&gt;\n</code></pre> <p>Para la creaci\u00f3n de una carpeta se realiza con el comando <code>New-item</code>.</p> <p>Ejemplo:</p> <pre><code>PS /home/julio&gt; Set-Location /\nPS /&gt; Set-Location ~\nPS /home/julio&gt; New-Item -ItemType directory -Name TempPS\n\n\n    Directory: /home/julio\n\nMode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\nd----           10/4/2024    12:02                TempPS\n\nPS /home/julio&gt;\n</code></pre> <p>En el anterior ejemplo cambiamos de localizaci\u00f3n y creamos un directorio.</p> <p>En el siguiente ejemplo vamos a eliminar todos los archivos .log contenidos en la carpeta C:\\Temp. Lo podemos hacer de distinta manera con o sin Pipe.</p> <pre><code>PS /home/julio&gt;  Remove-Item ~/temp/*.log\nPS /home/julio&gt;\n\n# o con tuber\u00edas.\n\n PS /home/julio&gt; Get-ChildItem ~/temp/* -Include *.txt -Recurse | Remove-Item\n</code></pre> <p>En el siguiente ejemplo vamos a mover los ficheros log de una carpeta a otra.</p> <pre><code>PS /home/julio/temp&gt; ls\narchivo.log\nPS /home/julio/temp&gt; Move-Item *.log ../\nPS /home/julio/temp&gt;\n</code></pre> <p>Hemos movidos desde la carpeta actual todos los archivos log ha la carpeta padre.</p> <p>El mismos procedimiento ser\u00eda con los directorios.</p> <p>Ahora vamos a renombrar el fichero log que tenemos de dos formas.</p> <pre><code>PS /home/julio/temp&gt;  Rename-Item -Path archivo.log -Newname archivo.txt\nPS /home/julio/temp&gt; ls\narchivo.txt\nPS /home/julio/temp&gt;\n#O\nRename-Item archivo.log  archivo.txt\n</code></pre> <p>Observa las dos formas. La primera tenemos dos modificadores o opciones y en la segunda no.</p> <p>Vamos a copiar archivos o carpetas.</p> <pre><code>PS /home/julio/temp&gt; Copy-Item ./archivo.txt /home/julio/tmp/\n# Copiamos un archivo\n#Ahora vamos a copiar una estructura completa\nPS /home/julio&gt; Copy-Item -Path ./temp -Destination ./tmp -Recurse\nPS /home/julio&gt; Get-ChildItem tmp\n\n\n    Directory: /home/julio/tmp\n\nMode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\nd----           11/4/2024    11:18                temp\n-----           11/4/2024    11:10              0 archivo.txt\n-----            6/3/2024    17:39            237 equipos.txt\n\nPS /home/julio&gt; sl ./tmp/temp/\nPS /home/julio/tmp/temp&gt; dir\n\n\n    Directory: /home/julio/tmp/temp\n\nMode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\nd----           11/4/2024    11:18                casa\n-----           11/4/2024    11:10              0 archivo.txt\n</code></pre>"},{"location":"UD11/01_seguridadIntegridad/","title":"Seguridad del sistema y de los datos.","text":"<p>Una vez construido el sistema que gestionar\u00e1 toda la infraestructura de red, es muy arriesgado asumir que \u00e9ste no es sensible a fallos. En efecto, todo sistema inform\u00e1tico est\u00e1 condenado a sufrir fallos, p\u00e9rdidas de datos, ca\u00eddas y otras alteraciones que detienen temporalmente, en el mejor de los casos, el funcionamiento de parte o la totalidad del sistema. Es por esto que se hace necesaria la implantaci\u00f3n de un sistema de seguridad que reponga los datos si se produce alg\u00fan fallo en el hardware, o que permita seguir trabajando sin que el usuario note que existe un error. Varias son las t\u00e9cnicas empleadas en este sentido: - copias de seguridad, encargadas de hacer un respaldo de la informaci\u00f3n sensible del sistema (datos de usuario o el propio sistema). De este modo es posible recuperar la informaci\u00f3n perdida por causas de un fallo de software, hardware o humano. - tolerancia a fallos, que consiguen que el sistema siga funcionando cuando se ha producido un fallo de hardware, como por ejemplo un disco duro ha dejado de funcionar. - cifrado de la informaci\u00f3n, lo que permite que la informaci\u00f3n se encuentre disponible a aquellas personas que cuenten con la debida autorizaci\u00f3n.</p> <p>Se trata pues de t\u00e9cnicas no exclusivas y que, combinadas entre s\u00ed, consiguen que la infraestructura inform\u00e1tica siga funcionando con normalidad y conserve su confidencialidad, disponibilidad e integridad.</p>"},{"location":"UD11/02_VolumenesDistribuidos/","title":"Vol\u00famenes distribuidos.","text":"<p>Como ya se vio en temas anteriores, sobre la estructura f\u00edsica un disco duro es posible crear una estructura l\u00f3gica que lo dote de forma. Ya son conocidos conceptos como sistemas de particionado (Master Boot Record y GUID Partition Table), partici\u00f3n o sistema de archivos. Cuando se habla de una partici\u00f3n, \u00e9sta queda confinada en un \u00fanico dispositivo hardware. Adem\u00e1s la modificaci\u00f3n de alguna de sus propiedades puede ser costosa en tiempo.</p> <p>Los vol\u00famenes poseen las mismas caracter\u00edsticas que las particiones vistas con anterioridad, con el a\u00f1adido de que un volumen distribuido puede contener varios dispositivos f\u00edsicos, es decir, una estructura l\u00f3gica que se desarrolla en varios discos duros al mismo tiempo. Entre otras ventajas, los vol\u00famenes permiten el uso de t\u00e9cnicas de tolerancia a fallos como los RAID.</p> <p>En Microsoft Windows Serverla creaci\u00f3n de vol\u00famenes distribuidos se denominan Grupos de almacenamiento y se construyen a trav\u00e9s de la herramienta de Administrador del Servidor, como casi cualquier tarea de administraci\u00f3n del servidor.</p> <p>La creaci\u00f3n de un grupo de almacenamiento pasa por iniciar los discos que se acaban de instalar. Para ello se accede a Administrador del servidor \u2192 Servicios de archivos y de almacenamiento \u2192 Vol\u00famenes \u2192 Discos en donde pulsando con el bot\u00f3n derecho sobre cada disco se procede a Poner en l\u00ednea. Esta acci\u00f3n asigna el control del disco al servidor donde est\u00e1 conectado. Esto parece una obviedad, pero cualquier otro servidor puede gestionar un disco duro conectado a \u00e9ste. Tambi\u00e9n es posible inicializar el disco, que consiste en asignarle una tabla de particionado, aunque esta tarea de momento es opcional.</p> <p></p> <p>Ahora se accede al apartado Grupos de almacenamiento y se crea uno nuevo con la opci\u00f3n Nuevo grupo de almacenamiento\u2026 del desplegable TAREAS. Esto iniciar\u00e1 un asistente en que se debe indicar el nombre del grupo y los dispositivos f\u00edsicos que formar\u00e1n parte de \u00e9l. De este modo ya se dispone de un volumen l\u00f3gico en el sistema.</p> <p></p> <p>Una vez creado, es posible a\u00f1adir o eliminar discos f\u00edsicos a este conjunto de igual modo, pero esta vez eligiendo la opci\u00f3n Agregar nuevo disco f\u00edsico\u2026 al pulsar con el bot\u00f3n derecho sobre el grupo. A trav\u00e9s de la opci\u00f3n Eliminar grupo de almacenamiento es posible eliminarlo y dejar libre los discos involucrados en \u00e9l. Este proceso elimina todos los datos que pueda contener.</p> <p>Los vol\u00famenes l\u00f3gicos en GNU/Linux se forman a trav\u00e9s de la aplicaci\u00f3n LVM (Logical Volume Manager), una herramienta que inicialmente fue creado por Heinz Mauelshagen en 1998 para el sistema operativo HP-UX, el Unix de HP. Despu\u00e9s ser\u00eda implementado en el kernel GNU/Linux, por lo que no ser\u00e1 necesaria su instalaci\u00f3n.</p> <p>LVM puede gestionar grupos de discos y particiones como un todo en lugar de manejar varios espacios independientes. Permite unir varias particiones como una sola, ampliarlas en otros discos f\u00edsicos diferentes, montar varios discos en modo RAID, a\u00f1adir discos duros en caliente, sin olvidar la funci\u00f3n snapshot para crear backups. Esta utilidad maneja varios conceptos con lo que el administrador debe estar familiarizado:</p> <ul> <li>PV (Phisical Volume), son los vol\u00famenes f\u00edsicos, es decir, discos duros o particiones de un equipo.</li> <li>VG (Volume Group), grupo volumen, es el \u00e1rea creada por uno o varios dispositivos f\u00edsicos.</li> <li>LV (Logical Volume), vol\u00famenes l\u00f3gicos o dispositivos donde se pueden crear sistemas de ficheros y creados sobre un grupo de volumen.</li> </ul> <p>La creaci\u00f3n de un volumen l\u00f3gico pasa por seguir estos pasos;</p> <ul> <li>creaci\u00f3n de vol\u00famenes f\u00edsicos PV para que LVM pueda gestionarlos,</li> <li>la creaci\u00f3n de un grupo de PV en un grupo de volumen VG de este modo se crear\u00e1 un nuevo dispositivo en el sistema que ser\u00e1 la uni\u00f3n de los discos f\u00edsicos,</li> <li>creaci\u00f3n de vol\u00famenes l\u00f3gicos LV, de igual forma que en un disco tradicional, se le puede asignar un sistema de ficheros o particionar seg\u00fan necesidades del sistema.</li> </ul> <p>Para la gesti\u00f3n de estos elementos se dispone de numerosos comandos cuya explicaci\u00f3n queda fuera del alcance de este manual. No obstante, se ilustrar\u00e1 el uso de ellos a trav\u00e9s de un ejemplo. Para la gesti\u00f3n de los vol\u00famenes f\u00edsicos PV (phisical volume), entre otros, se dispone de:</p> <ul> <li><code>pvcreate</code>, usado para crear un volumen f\u00edsico.</li> <li><code>pvchange</code>, cambia los atributos de un volumen f\u00edsico.</li> <li><code>pvdisplay</code>, muestra informaci\u00f3n sobre un volumen f\u00edsico.</li> <li><code>pvmove</code>, mueve extensiones f\u00edsicas de un volumen a otro.</li> <li><code>pvscan</code>, localiza y enumera todos los vol\u00famenes f\u00edsicos.</li> <li><code>pvremove</code>, elimina el volumen f\u00edsico.   Para la administraci\u00f3n de grupos de vol\u00famenes o VG:</li> <li><code>vgchange</code>, cambia los atributos de un grupo volumen.</li> <li><code>vgck</code>, comprueba la consistencia del grupo volumen.</li> <li><code>vgcreate</code>, crea un grupo volumen a partir de vol\u00famenes f\u00edsicos.</li> <li><code>vgdisplay</code>, muestra los atributos de un grupo volumen.</li> <li><code>vgextend</code>, a\u00f1ade vol\u00famenes f\u00edsicos a un grupo volumen.</li> <li><code>vgmerge</code>, combina dos grupos volumen.</li> <li><code>vgreduce</code>, elimina vol\u00famenes f\u00edsicos de un grupo volumen.</li> <li><code>vgremove</code>, elimina un grupo volumen.</li> <li><code>vgrename</code>, renombra un grupo volumen.</li> <li><code>vgsplit</code>, divide un grupo volumen.</li> </ul> <p>Y finalmente, para el manejo de vol\u00famenes l\u00f3gicos LV:</p> <ul> <li><code>lvchange</code>, cambia los atributos de un volumen l\u00f3gico.</li> <li><code>lvcreate</code>, crea un volumen l\u00f3gico.</li> <li><code>lvdisplay</code>, muestra los atributos de los vol\u00famenes l\u00f3gicos existentes.</li> <li><code>lvextend</code>, incrementa el tama\u00f1o de un volumen l\u00f3gico.</li> <li><code>lvreduce</code>, reduce el tama\u00f1o de un volumen l\u00f3gico.</li> <li><code>lvremove</code>, elimina un volumen l\u00f3gico.</li> <li><code>lvrename</code>, renombra un volumen l\u00f3gico.</li> <li><code>lvscan</code>, localiza y enumera todos los vol\u00famenes l\u00f3gicos del sistema.</li> </ul> <p>Cada uno de estos comandos posee numerosas opciones y modificadores que por s\u00ed solos dar\u00edan para un tema. Es conveniente revisar la ayuda de estos comandos antes de su utilizaci\u00f3n.</p> <p>Las ventajas de este sistema de vol\u00famenes son m\u00faltiples. Imagina que creamos cuatro particiones contiguas en un disco. Si en el futuro fuese necesario aumentar alguna de las tres primeras no podr\u00edamos hacerlo sin borrar las siguientes, lo que es complejo, peligroso y requiere de parada del servidor casi con toda seguridad. Es posible aumentar el tama\u00f1o de cada volumen independientemente de que no haya espacio libre. Para ello se utiliza el espacio de otros discos f\u00edsicos, e incluso se dispone de la opci\u00f3n para mover vol\u00famenes l\u00f3gicos entre dispositivos f\u00edsicos. Y todo ello sin la necesidad de para el servidor o sin desmontar el sistema de ficheros.</p> <p>Para ilustrar mejor el uso de estos comandos, se han instalado en el servidor de Ubuntu Server, cuatro discos duros SATA de 100 GB de tama\u00f1o cada uno en el sistema y se han dividido en dos particiones de 50 GB. Se dispone por tanto de los siguientes dispositivos <code>/dev/sdb1, /dev/sdb2, /dev/sdc1, /dev/sdc2, /dev/sdd1, /dev/sdd2, /dev/sde1 y /dev/sde2</code>, adem\u00e1s del dispositivo de disco que contiene el sistema operativo. Para crear un volumen con las tres particiones 1 de los tres primeros discos, primero debemos crear unidades f\u00edsicas con estas particiones</p> <pre><code>sudo pvcreate /dev/sdb1 /dev/sdc1 /dev/sdd1\n</code></pre> <p>El terminal contestar\u00e1 con este mensaje</p> <pre><code>Physical volume \"/dev/sdc1\" successfully created.\nPhysical volume \"/dev/sdb1\" successfully created.\nPhysical volume \"/dev/sdd1\" successfully created.\n</code></pre> <p>Ahora LVM dispone de estos tres vol\u00famenes para poder crear un grupo, que se crea a trav\u00e9s del comando</p> <pre><code>vgcreate &lt;nombre_del_volumen&gt; &lt;vol\u00famenes_f\u00edsicos_en_lvm&gt;\n</code></pre> <p>de este modo</p> <pre><code>sudo vgcreate grupoFeo /dev/sdb1 /dev/sdc1 /dev/sdd1\n</code></pre> <p>que obtenemos este mensaje</p> <pre><code>Volume group \"grupoFeo\" successfully created\n</code></pre> <p>Llegados a este punto ya se dispone de un volumen f\u00edsico que engloba las tres primeras partes de los discos <code>/dev/sdb, /dev/sdc y /dev/sdd</code>. Para ello se comprueba la informaci\u00f3n del grupo con el comando <code>vgdisplay</code>, que ofrece el siguiente resultado:</p> <pre><code>--- Volume group ---\nVG Name grupoFeo\nSystem ID\nFormat lvm2\nMetadata Areas 3\nMetadata Sequence No 1\nVG Access read/write\nVG Status resizable\nMAX LV 0\nCur LV 0\nOpen LV 0\nMax PV 0\nCur PV 3\nAct PV 3\nVG Size &lt;139,69 GiB\nPE Size 4,00 MiB\nTotal PE 35760\nAlloc PE / Size 0 / 0\nFree PE / Size 35760 / &lt;139,69 GiB\nVG UUID rNXzAV-kDIJ-YsQU-bc5Z-OjsD-e6tf-ePKeec\n</code></pre> <p>Varios son los datos importantes en este informe. El primero es comprobar que el tama\u00f1o del grupo coincide con el tama\u00f1o de los tres discos; <code>VG Size &lt;139,69 GiB</code>, el nombre <code>VG Name grupoFeo</code> y el estado del grupo <code>VG Status resizable</code>, que indica si el grupo es modificable o no. En este caso s\u00ed lo es. Esto va a permitir la modificaci\u00f3n de este grupo, como por ejemplo si se a\u00f1adiera la primera partici\u00f3n del cuarto disco, que se hab\u00eda quedado en el olvido. Para ello hay que crear su unidad f\u00edsica y extender el grupo creado</p> <pre><code>sudo pvcreate /dev/sde1\nsudo vgextend grupoFeo /dev/sde1\n</code></pre> <p>Ahora el tama\u00f1o del grupo de vol\u00famenes debe haber cambiado, se consulta con <code>vgdisplay</code> y se comprueba la l\u00ednea <code>VG Size &lt;186,25 GiB</code>. Todo ha ido de forma correcta.</p> <p>De igual modo que en un disco duro f\u00edsico normal, es hora de crear los vol\u00famenes l\u00f3gicos al igual que si se tratasen de particiones de un disco duro tradicional, pero utilizando LVM</p> <pre><code>lvcreate &lt;opciones&gt; &lt;nombre_del_volumen&gt; &lt;nombre_del_grupo&gt;\n</code></pre> <p>As\u00ed, si es necesario crear un volumen de 100 GiB.</p> <pre><code>sudo lvcreate -L 100G -n volumen1Feo grupoFeo\n</code></pre> <p>Las opciones <code>-L</code> especifica el tama\u00f1o del volumen y <code>-n</code> el nombre del mismo. Es posible comprobarlo con <code>lvdisplay o lvscan</code>, del mismo modo que que en grupos de vol\u00famenes. De este modo es posible crear los vol\u00famenes necesarios dentro de un grupo. La parte interesante de este proceso es que, en este punto se ha generado un archivo de dispositivo en la carpeta <code>/dev</code>, por lo que es posible utilizarlos como si de un dispositivo normal se tratase.</p> <p>Este nuevo dispositivo tiene el nombre asignado al grupo y dentro de \u00e9l, el nombre de los vol\u00famenes creados. Ahora tan s\u00f3lo ser\u00e1 necesario dotarlo de un sistema de ficheros y un punto de montaje del modo aprendido</p> <pre><code>sudo mkfs.ext4 /dev/grupoFeo/volumen1Feo\nsudo mount /dev/grupoFeo/volumen1Feo /media/discoFeo\n</code></pre> <p>La ventaja de este esquema de vol\u00famenes es su versatilidad. A\u00fan quedan disponibles 86,25 GiB del grupo que se cre\u00f3, por lo que se incrementar\u00e1 la capacidad del volumen creado</p> <pre><code>sudo lvextend -L +86,25G /dev/grupoFeo/voluemn1Feo\n</code></pre> <p>Si se comprueba el espacio con el comando vldisplay se comprobar\u00e1 como el volumen ha crecido. Lo interesante de este m\u00e9todo es que no es necesario desmontar el volumen y adem\u00e1s los ficheros contenidos quedan intactos. Tambi\u00e9n es posible reducir el tama\u00f1o del volumen con el comando <code>lvreduce</code>, aunque para esta tarea s\u00ed es necesario desmontar el volumen, pero con la ventaja de los datos no se ver\u00e1n afectados.</p> <p>Una vez construidos los vol\u00famenes es necesario la modificaci\u00f3n del fichero fstab para que monte este volumen con el inicio del sistema, como ya se ha visto en unidades anteriores.</p> <p>Llegados hasta aqu\u00ed tan s\u00f3lo queda indicar como deshacer todo este trabajo y devolver el control de los discos al sistema. La destrucci\u00f3n de esta infraestructura l\u00f3gica ha de realizarse de manera inversa a su creaci\u00f3n, es decir, se destruyen los vol\u00famenes l\u00f3gicos, luego los grupos y finalmente los discos f\u00edsicos</p> <pre><code>sudo unmout /media/discoFeo\nsudo lvremove /dev/grupoFeo/volumen1Feo\nsudo vgremove grupoFeo\nsudo pvremove /dev/sdb1 /dev/sdc1 /dev/sdd1 /dev/sde1\n</code></pre> <p>El uso de este tipo de vol\u00famenes din\u00e1micos simplifica las tareas de ampliaci\u00f3n o modificaci\u00f3n de discos, las cuales se realizan sin necesidad de apagar el sistema y conservando los ficheros, caracter\u00edsticas a tener muy en cuenta para para todo buen administrador de sistemas.</p>"},{"location":"UD11/03_toleranciaFallos/","title":"Sistemas de tolerancia a fallos.","text":"<p>El t\u00e9rmino RAID es un acr\u00f3nimo del ingl\u00e9s \"Redundant Array of Independent Disks\" (matriz redundante de discos independientes). RAID combina varios discos duros para formar una \u00fanica unidad l\u00f3gica en la que se almacenan los datos de forma redundante. Ofrecen tolerancia a fallos y altos niveles de rendimiento que un s\u00f3lo disco duro o un grupo de discos duros independientes. Si se produce un fallo, el RAID mantiene el servidor activo y en funcionamiento mientras se sustituye la unidad defectuosa. Se utiliza tambi\u00e9n con mucha frecuencia para mejorar el rendimiento de servidores y estaciones de trabajo. Estos dos objetivos, protecci\u00f3n de datos y mejora del rendimiento, no se excluyen entre s\u00ed.</p> <p>Un RAID ofrece varias opciones de configuraci\u00f3n, llamadas niveles RAID, cada una de las cuales proporciona un equilibrio distinto entre tolerancia a fallos, rendimiento y coste. Adem\u00e1s, todos los sistemas RAID suponen la p\u00e9rdida de parte de la capacidad de almacenamiento de los discos, para conseguir la redundancia o almacenar los datos de paridad.</p> <p>Los sistemas RAID profesionales deben incluir los elementos cr\u00edticos por duplicado: fuentes de alimentaci\u00f3n y ventiladores redundantes y deben ser extra\u00edbles en caliente (Hot Swap). De poco sirve disponer de un sistema tolerante al fallos de un disco si despu\u00e9s falla por ejemplo una fuente de alimentaci\u00f3n que provoca la ca\u00edda del sistema.</p> <p>Un RAID ofrece las siguientes ventajas:</p> <ul> <li>tolerancia a fallos, protege contra la p\u00e9rdida de datos y proporciona recuperaci\u00f3n de datos en tiempo real con acceso ininterrumpido en caso de que falle un disco.</li> <li>mejora del rendimiento/velocidad, consta de dos o m\u00e1s discos duros que ante el sistema principal funcionan como un \u00fanico dispositivo. Los datos se desglosan en fragmentos que se escriben en varias unidades de forma simult\u00e1nea. Este proceso, denominado fraccionamiento de datos, incrementa notablemente el rendimiento.</li> <li>mayor fiabilidad, emplean dos t\u00e9cnicas para aumentar la fiabilidad: la redundancia de datos y la informaci\u00f3n de paridad. La redundancia implica el almacenamiento de los mismos datos en m\u00e1s de una unidad. De esta forma, si falla una unidad, todos los datos quedan disponibles en la otra unidad de inmediato. Aunque este planteamiento es muy eficaz, tambi\u00e9n es muy costoso, ya que exige el uso de conjuntos de unidades duplicados. El segundo planteamiento para la protecci\u00f3n de los datos consiste en el uso de la paridad de datos. RAID utiliza un algoritmo matem\u00e1tico para generar informaci\u00f3n de paridad. Cuando se produce un fallo en una unidad se leen los datos correctos que quedan y se comparan con los datos de paridad almacenados por la matriz.</li> <li>alta disponibilidad, que depende de dos aspectos: la integridad de los datos y tolerancia a fallos. La integridad de los datos se refiere a la capacidad para obtener los datos adecuados en cualquier momento. La mayor\u00eda de las soluciones RAID ofrecen reparaci\u00f3n din\u00e1mica de sectores, que repara sobre la marcha los sectores defectuosos debidos a errores de software. La tolerancia a fallos, el segundo aspecto de la disponibilidad, es la capacidad para mantener los datos disponibles en caso de que se produzcan uno o varios fallos en el sistema.</li> </ul>"},{"location":"UD11/03_toleranciaFallos/#tipos-de-raid","title":"Tipos de RAID.","text":"<p>Los niveles de RAID pueden implementarse en dos tipos de tecnolog\u00eda: basada en software y basada en hardware, y estos \u00faltimos pueden estar basados en host o RAID externo.</p> <p>Los RAID basados en software vienen por defecto como una opci\u00f3n en la configuraci\u00f3n de los sistemas operativos. Sin embargo, no son implementaciones adecuadas en la mayor\u00eda de los casos y cada vez son menos empleados por su bajo rendimiento.</p> <p>La ventaja de los RAID basados en hardware es su independencia de la plataforma o sistema operativo, ya que son vistos por \u00e9ste como un gran disco duro m\u00e1s, y con un mejor rendimiento.</p> <p>Dentro de los RAID basados en hardware encontramos los basado en host, que utilizan controladoras conectadas a una ranura PCIe del equipo servidor. Ofrece ventajas significativas en lo que respecta a rendimiento, integridad de los datos y gesti\u00f3n.</p> <p>Sin embargo, la soluci\u00f3n m\u00e1s profesional y recomendada es la soluci\u00f3n hardware RAID externa. En este caso, las operaciones RAID se llevan a cabo mediante un controlador situado en el sistema externo, que se conecta al servidor mediante un adaptador de bus de host iSCSI, SCSI, SAS o Fibre Channel. Las soluciones RAID externas son independientes del sistema operativo, aportan mayor flexibilidad y permiten crear sistemas de almacenamiento de gran capacidad para servidores de gama alta.</p> <p>A\u00fan as\u00ed, los RAID por software se usa de forma extendida debido a un factor muy importante: su costo y facilidad de implementaci\u00f3n. Ser\u00e1n \u00e9stos los que se tratar\u00e1n en este punto.</p> <p></p>"},{"location":"UD11/03_toleranciaFallos/#niveles-de-raid","title":"Niveles de RAID.","text":"<p>La elecci\u00f3n de los diferentes niveles de RAID va a depender de las necesidades del sistema en lo que respecta a factores como seguridad, velocidad, capacidad y coste. No hay un nivel mejor que otro, cada uno es apropiado para determinadas aplicaciones y entornos inform\u00e1ticos. De hecho, resulta frecuente el uso de varios niveles RAID para distintas aplicaciones del mismo servidor. De este modo se dispone de varios niveles b\u00e1sicos con los que se pueden crear otros mucho m\u00e1s complejos.</p> <ul> <li> <p>RAID 0: Data Striping   Tambi\u00e9n conocido como fraccionados. Reparte los datos en peque\u00f1os segmentos que se distribuyen entre varias unidades. Este nivel de RAID no ofrece tolerancia al fallos, ya que no existe redundancia. El fallo de cualquier disco del RAID tendr\u00eda como resultado la p\u00e9rdida de los datos y ser\u00eda necesario restaurarlos desde una copia de seguridad.   Por contra ofrece una velocidad de transferencia de datos la cual aumenta en relaci\u00f3n al n\u00famero de discos que forman el conjunto. Esto representa una gran ventaja en operaciones secuenciales con ficheros de gran tama\u00f1o. Es aconsejable en aplicaciones que necesiten un almacenamiento a gran velocidad pero que no requiera tolerancia a fallos. Para implementar una soluci\u00f3n RAID 0 se necesita un m\u00ednimo de dos unidades de disco.   </p> </li> <li> <p>RAID 1: Mirroring</p> </li> </ul> <p>Tambi\u00e9n llamado discos en espejo, se basa en la utilizaci\u00f3n de discos adicionales sobre los que se realiza una copia s\u00edncrona de los datos. Ofrece una excelente disponibilidad de los datos con redundancia. Para ello, se duplican todos los datos de una unidad en otra. De esta manera se asegura la integridad de los datos y la tolerancia al fallos, pues en caso de aver\u00eda, la controladora sigue trabajando con los discos no da\u00f1ados sin detener el sistema. Es una buena soluci\u00f3n para las aplicaciones que requieren redundancia cuando hay s\u00f3lo dos unidades disponibles. Los servidores de archivos peque\u00f1os son un buen ejemplo. Se necesita un m\u00ednimo de dos unidades para implementar un RAID 1. </p> <ul> <li>RAID 3: Paridad.</li> </ul> <p>Dedica un \u00fanico disco al almacenamiento de informaci\u00f3n de paridad. La informaci\u00f3n de ECC (Error Checking and Correction) se usa para detectar errores y corregirlos. La recuperaci\u00f3n de datos se consigue mediante operaciones del tipo O exclusivo (XOR) de la informaci\u00f3n registrada en los otros discos. Las operaciones de lectura y escritura acceden a todos los discos al mismo tiempo, por lo cual el RAID 3 es mejor para sistemas de un s\u00f3lo usuario con aplicaciones que utilicen ficheros de gran tama\u00f1o.   Ofrece altas tasas de transferencia, alta fiabilidad y alta disponibilidad, a un coste inferior que un Mirroring (RAID 1). Sin embargo, su rendimiento en escritura es menor e igual al de un disco debido a que la informaci\u00f3n de paridad ha de escribirse siempre en el mismo disco. Se necesita un m\u00ednimo de tres unidades para implementar una soluci\u00f3n RAID 3.   </p> <ul> <li>RAID 5: Paridad distribuida.</li> </ul> <p>Este RAID optimiza la capacidad del sistema mediante el uso de paridad distribuida. Esto lo consigue mediante el c\u00e1lculo de informaci\u00f3n de paridad y su almacenamiento alternativo por bloques en todos los discos del conjunto. La informaci\u00f3n del usuario se graba por bloques y de forma alternativa en todos ellos. De esta manera, si cualquiera de las unidades de disco falla, se puede recuperar la informaci\u00f3n en tiempo real mediante una operaci\u00f3n l\u00f3gica de O exclusivo a partir de la informaci\u00f3n de paridad y los datos de los otros discos.   El RAID 5 ofrece la mejor relaci\u00f3n rendimiento-coste, gracias a la combinaci\u00f3n del fraccionamiento de datos y la paridad como m\u00e9todo para recuperar los datos en caso de fallo.   Este nivel de array es especialmente indicado para trabajar con sistemas operativos multiusuario. Puede configurarse si se dispone de tres unidades de disco en la configuraci\u00f3n, aunque su resultado \u00f3ptimo de capacidad se obtiene a partir de seis.   Estos son las tres configuraciones b\u00e1sicas de RAID. La combinaci\u00f3n de ellas da como resultado otros tipos de matrices combinados y m\u00e1s especializados. Son los RAID h\u00edbridos.</p> <p></p> <ul> <li> <p>RAID 6: Doble paridad.</p> <p>Es similar al RAID 5, pero incluye un segundo esquema de paridad distribuido por los distintos discos y por tanto ofrece tolerancia extremadamente alta a las aver\u00edas de disco, pues soporta el fallo simult\u00e1neo de dos discos. No obstante, este elevado nivel de seguridad tiene como contrapartida un menor rendimiento en la escritura debido a que debe llevar a cabo dos escrituras de paridad por cada una de datos. A pesar de ello es un nivel de RAID que se utiliza frecuentemente en entornos donde prima la seguridad por delante de la velocidad.</p> </li> <li> <p>Combinando sistemas: RAID 10     Combinaci\u00f3n de los RAID 1 y 0 que proporciona velocidad y tolerancia a fallos simult\u00e1neamente. El nivel de RAID 10 fracciona los datos para mejorar el rendimiento, pero tambi\u00e9n utiliza un conjunto de discos duplicados para conseguir redundancia de datos. Al ser una variedad de RAID h\u00edbrida, RAID 10 combina las ventajas de rendimiento de RAID 0 con la redundancia que aporta RAID 1. Sin embargo, la principal desventaja es que requiere un m\u00ednimo de cuatro unidades y s\u00f3lo dos de ellas se utilizan para el almacenamiento de datos. Las unidades se deben a\u00f1adir en pares cuando se aumenta la capacidad, lo que multiplica por dos los costes de almacenamiento.     Existen numerosas combinaciones de arrays mucho m\u00e1s complejas y espec\u00edficas para ciertos sistemas. Por ejemplo el RAID 30 que conecta dos RAID 3 a trav\u00e9s de un RAID 0, lo el cual necesita un m\u00ednimo de seis discos, o el RAID 100 , para dotar de una seguridad extrema al sistema de ficheros.     Hay que tener en cuenta el coste de espacio a la hora de implementar cada una de estas soluciones. La utilizaci\u00f3n de varios discos no convierte la capacidad del RAID con la suma de \u00e9stos, sino que es posible que se deba sacrificar hasta un 50% del espacio en aras de la seguridad y/o el rendimiento     </p> </li> </ul>"},{"location":"UD11/03_toleranciaFallos/#creacion-de-un-raid","title":"Creaci\u00f3n de un RAID","text":"<p>Desde la Administraci\u00f3n de equipos en Microsoft Windows Server es desde donde se lanzan los asistentes que guiar\u00e1n al administrador durante la creaci\u00f3n de estos dispositivos. Hay que tener en cuenta la nomenclatura que utiliza Microsoft y hay que familiarizarse con ella:</p> <ul> <li>volumen simple, adscrito a un \u00fanico dispositivo f\u00edsico.</li> <li>volumen distribuido, los estudiados en esta unidad.</li> <li>volumen seccionado, hace referencia un RAID 0.</li> <li>volumen reflejado, contiene un RAID 1 o Espejo.</li> <li>volumen RAID-5, su nombre en indicativo.</li> </ul> <p>La creaci\u00f3n de estas matrices viene guiada por un asistente que se inicia desde El Administrador de equipos. Basta con pulsar con el bot\u00f3n derecho sobre un disco para comenzar el asistente.</p> <p>Algo m\u00e1s laboriosa es la creaci\u00f3n de un RAID 10. Para ello ser\u00e1 necesario la creaci\u00f3n de dos grupos de almacenamiento de dos discos cada uno y sobre ellos, implementar un RAID 0.</p> <p>Como siempre, en Ubuntu Server estas tareas se realizar\u00e1n desde el terminal y para ello ser\u00e1 necesario la instalaci\u00f3n del paquete mdadm, si no estuviera instalado.</p> <pre><code>sudo apt-get install mdadm\n</code></pre> <p>El comando <code>mdadm</code> permite la creaci\u00f3n, administraci\u00f3n, monitorizaci\u00f3n de RAID en GNU/Linux y su uso es muy intuitivo, si se conoce el concepto de volumen din\u00e1mico y matriz. Una vez dise\u00f1ado y colocado en el sistema los discos necesarios, tan s\u00f3lo habr\u00e1 que crear el comando necesario. Las acciones que mdadm acepta son:</p> <ul> <li><code>--create</code>, para crea una nuevo RAID.</li> <li><code>--detail, --query o \u2013-misc</code>, muestra informaci\u00f3n de un RAID.</li> <li><code>--examine</code>, informaci\u00f3n de las unidades f\u00edsicas que componen el RAID.</li> <li><code>--fail</code>, marcar un dispositivo como fallido</li> <li><code>--remove</code>, eliminar un dispositivo del RAID o eliminar el propio RAID.</li> <li><code>--stop</code>, detiene el RAID para modificar sus discos. Se utiliza si no se dispone de tecnolog\u00eda \u201cen-caliente\u201d para la desconexi\u00f3n de los discos.</li> <li><code>--add</code>, a\u00f1ade un dispositivo al RAID.</li> </ul> <p>Otra de las opciones necesarias para la creaci\u00f3n de un RAID es su nivel, el cual se especifica a trav\u00e9s de la opci\u00f3n <code>\u2013-level</code>, de este modo 0 indica RAID 0, 1 crea un RAID 1, 5 construye un RAID 5 y 10 monta un RAID 10, entre otras opciones. El siguiente comando crea un RAID 1 con los dispositivos <code>/dev/sdb y /dev/sdc</code> y que tendr\u00e1 como archivo de dispositivo <code>/dev/md/md0</code></p> <pre><code>  sudo mdadm -\u2013create -\u2013verbose /dev/md/md0 \u2013-level=1 \u2013-raid-devices=2 /dev/sdb /dev/sdc\n</code></pre> <p>El proceso de creaci\u00f3n de un RAID puede ser largo y no debe interrumpirse. Es posible consultar el estado de creaci\u00f3n a trav\u00e9s del comando</p> <pre><code>sudo cat /proc/mdstat\n</code></pre> <p>el cu\u00e1l informa del estado de creaci\u00f3n de la siguiente manera</p> <pre><code>Personalities : [linear] [multipath] [raid0] [raid1] [raid6] [raid5] [raid4] [raid10]\nmd127 : active raid1 sdc[1] sdb[0]\n104792064 blocks super 1.2 [2/2] [UU]\n[=======&gt;.............] resync = 37.8% (39644032/104792064) finish=5.4min speed=200310K/sec\nunused devices: &lt;none&gt;\n</code></pre> <p>Una vez creado se puede consultar sus caracter\u00edsticas con el comando sudo mdadm \u2013detail /dev/md/md0 El cual ofrece el siguiente resultado</p> <pre><code>/dev/md/md0:\nVersion : 1.2\nCreation Time : Wed Jul 18 16:16:39 2018\nRaid Level : raid1\nArray Size : 104792064 (99.94 GiB 107.31 GB)\nUsed Dev Size : 104792064 (99.94 GiB 107.31 GB)\nRaid Devices : 2\nTotal Devices : 2\nPersistence : Superblock is persistent\n\n    Update Time : Wed Jul 18 16:25:25 2018\n          State : clean\n\nActive Devices : 2\nWorking Devices : 2\nFailed Devices : 0\nSpare Devices : 0\n\n           Name : ubuntuserver:md0  (local to host ubuntuserver)\n           UUID : 71cee8c2:16078f1e:60d18789:a31904eb\n         Events : 17\n\n    Number   Major   Minor   RaidDevice State\n       0       8       16        0      active sync   /dev/sdb\n       1       8       32        1      active sync   /dev/sdc\n</code></pre> <p>Se trata de un informe completo en donde se identifica el nivel de RAID, los dispositivos que lo conforman as\u00ed como si est\u00e1n activos, fallidos o en reserva. Informaci\u00f3n muy \u00fatil que el administrador deber\u00e1 revisar peri\u00f3dicamente. El resultado de todo este proceso es un nuevo dispositivo en el sistema, pero que contiene dos unidades de disco duro f\u00edsicas. Tras su creaci\u00f3n es necesario dotarlo de un sistema de archivos, un punto de montaje y a\u00f1adir este dispositivo en el fichero fstab para su auntomontaje al inicio de sesi\u00f3n, como ya se ha visto con anterioridad.</p>"},{"location":"UD11/03_toleranciaFallos/#supervisar-un-raid","title":"Supervisar un RAID.","text":"<p>La aplicaci\u00f3n <code>mdadm</code> tambi\u00e9n ofrece herramientas para la supervisi\u00f3n de los RAID creados. Cuando <code>mdadm</code> est\u00e1 configurado para ejecutarse como un demonio genera informes sobre los eventos detectados a trav\u00e9s de correo electr\u00f3nico, de notificaci\u00f3n o syslog. Por defecto, <code>mdadm</code> escanea todas dispositivos existentes y registra cualquier evento detectado en <code>/var/log/syslog</code>. Si el sistema posee un gran n\u00famero de estos dispositivos o si es necesario centrarse en uno de ellos, es posible indicarlos en el fichero mdadm.conf situado en <code>/etc/mdadm/mdadm.conf</code>a\u00f1adiendo la siguiente l\u00ednea al final del fichero</p> <p><code>ARRAY /dev/md/md0 devices=/dev/sdb,/dev/sdc</code></p> <p>Tras modificar el fichero, ser\u00e1 necesario reiniciar el demonio con</p> <pre><code>service mdmonitor restart\n</code></pre> <p>Si en alguno de estos informes se detecto un error en uno de los dispositivos, ser\u00e1 necesario la sustituci\u00f3n de ese disco. El primer paso es marcar este dispositivo como fallido</p> <pre><code>sudo mdadm /dev/md/md0 \u2013fail /dev/sdb\n</code></pre> <p>para despu\u00e9s proceder a retirarlo de la matriz</p> <pre><code>sudo mdadm \u2013remove /dev/md/md0 /dev/sdb\n</code></pre> <p>Una vez que se haya instalado de forma correcta en el servidor, es decir, se saque el disco del equipo y se coloque el nuevo, ser\u00e1 necesario a\u00f1adir este dispositivo a la matriz</p> <pre><code>sudo mdadm /dev/md/md0 \u2013add /dev/sdd\n</code></pre> <p>y reconstruir la matriz con los nuevos discos</p> <pre><code>sudo mdadm --assemble /dev/md/md0 /dev/sdc /dev/sdd\n</code></pre> <p>Es posible anticiparse al fallo de un dispositivo incluyendo uno en la matriz que act\u00fae como reserva. En el ejemplo anterior, si el disco /dev/sdd se hubiera configurado como reserva, no hubiese sido necesario todo este proceso, el propio RAID desactivar\u00eda el disco fallido y lo implementar\u00eda en la matriz. Para realizar esta reserva es necesario usar la opci\u00f3n <code>\u2013-spare-devices=1 /dev/sdd</code> durante la creaci\u00f3n de la matriz, o a\u00f1adirlo con posterioridad con el comando</p> <pre><code>sudo mdadm \u2013add /dev/md/md0 /dev/sdd\n</code></pre> <p>Al a\u00f1adir un nuevo dispositivo y no realizar la reconstrucci\u00f3n con la opci\u00f3n <code>\u2013-assemble</code>, este nuevo dispositivo queda en la reserva.</p>"},{"location":"UD11/04_encriptDatos/","title":"Encriptaci\u00f3n de datos.","text":"<p>El cifrado es una tecnolog\u00eda que protege la informaci\u00f3n contenida en el sistema, convirti\u00e9ndola en un c\u00f3digo ilegible que no resulta f\u00e1cil descifrar sin la clave de descifrado. Si esta t\u00e9cnica se aplica a un disco, unidad, partici\u00f3n o volumen se evita el acceso no autorizado a la informaci\u00f3n contenida en ellos.</p> <p>Es habitual que el proceso de cifrado se realice de forma transparente, tambi\u00e9n conocido como cifrado en tiempo real. Es un m\u00e9todo en el que los datos son autom\u00e1ticamente cifrados o descifrados al mismo tiempo que son le\u00eddos o escritos. Si se introduce un archivo en una unidad cifrada, de forma autom\u00e1tica ese archivo pasar\u00e1 a estar cifrado con la clave de cifrado de la unidad. Algo a tener en cuenta es que el cifrado de unidades no reemplaza en ning\u00fan caso al cifrado de ficheros. Es posible combinar ambos sistemas de cifrado si es necesario dotar de seguridad reforzada a ciertos contenidos del disco. Si un intruso consigue acceso al sistema en tiempo de ejecuci\u00f3n, tambi\u00e9n tendr\u00e1 acceso a todos los archivos del mismo. El cifrado de archivos dota de seguridad extra a la informaci\u00f3n sensible contenida en la unidad. En sistemas de \u00e1mbito empresarial ya es muy com\u00fan el uso del TPM (Trusted Platform Module) tanto en servidores como en equipos cliente, especialmente en port\u00e1tiles. Se trata de un chip integrado en la placa base del ordenador que se encarga de cifrar la informaci\u00f3n y asociarla a ese dispositivo. Por lo tanto, la informaci\u00f3n contenida en las unidades de almacenamiento tan s\u00f3lo podr\u00e1 ser descifrada si se encuentra conectado a placa base que lo encript\u00f3. Dado que cada chip TPM es \u00fanico para cada dispositivo en particular, es capaz de realizar la autenticaci\u00f3n de de la informaci\u00f3n de los datos contenidos en el soporte de almacenamiento. El problema reside en si es la placa base o el chip TPM el que se aver\u00eda. En ese caso ser\u00eda necesario recurrir a copias de seguridad externas para recuperar la informaci\u00f3n. Existen numerosas herramientas para la encriptaci\u00f3n de la informaci\u00f3n. Sin embargo, se pueden clasificar en tres tipos:</p> <ul> <li>cifrado por software, en la que es un programa el que se encarga de cifrar/descifrar la informaci\u00f3n. Tiene un impacto sensible en el sistema y puede resultar un proceso lento en funci\u00f3n de la carga de trabajo.</li> <li>cifrado hardware basado en la localizaci\u00f3n de dispositivos de almacenamiento, que usa el chip TPM para el cifrado de datos. No tiene un impacto significativo en el rendimiento del sistema.</li> <li>cifrado hardware basado en otros componentes, el cual funciona de forma similar al TPM, pero que usa otro hardware como el procesador o la direcci\u00f3n f\u00edsica de la tarjeta de red para realizar el cifrado. Este es el \u00fanico cambio, ya que comparten inconvenientes si se sustituye el hardware.</li> </ul> <p>Los sistemas operativos de Microsoft disponen de varias aplicaciones de terceros para realizar esta tarea como TrueCrypt, AES Crypt o AxCrypt, que son muy intuitivas gracias a su interfaz gr\u00e1fica. Pero el propio sistema operativo tambi\u00e9n dispone de BitLocker y es posible activarlo para vol\u00famenes internos como pata externos. Para acceder a BitLocker hay que dirigirse a Panel de control \u2192 -Sistema y seguridad \u2192 Cifrado de unidad BitLocker, y activarlo en las unidades que se necesite encriptar. Como es habitual, esta acci\u00f3n lanza un asistente que guiar\u00e1 al usuario durante el proceso.</p> <p>Para modificar las caracter\u00edsticas de cifrado como el algoritmo de encriptaci\u00f3n o la longitud de la clave, hay que dirigirse a la directiva de grupo correspondiente, situada en Directiva de Equipo local \u2192 Configuraci\u00f3n del equipo \u2192 Plantillas Administrativas \u2192 Componentes de Windows \u2192 Cifrado de unidad BitLocker . El cambio de configuraci\u00f3n de las t\u00e9cnicas de cifrado a trav\u00e9s de estas directivas, no afecta a las unidades ya cifradas, sino a los que se encripten tras su modificaci\u00f3n. Recuerda que una vez cambiada una directiva de grupo, es posible que los cambios no se vean reflejados has los siguientes noventa minutos. Si el tiempo apremia, es posible forzar la actualizaci\u00f3n con el siguiente comando</p> <pre><code>gpupdate /target:Computer /force\n</code></pre> <p>En Microsoft Windows Server esta aplicaci\u00f3n no viene instalada por defecto y, por tanto, habr\u00e1 que instalar la caracter\u00edstica Cifrado de unidad Bitlocker desde el instalador de roles y caracter\u00edsticas, como es habitual. Adem\u00e1s de \u00e9sta, el sistema debe instalar el Visor de contrase\u00f1as de recuperaci\u00f3n de BitLocker que se encargar\u00e1 de la gesti\u00f3n de las contrase\u00f1as de cifrado. </p> <p>El proceso de encriptado que usa BitLocker funciona a trav\u00e9s de asistentes muy intuitivos, por lo que no se profundizar\u00e1 en este apartado.</p> <p>Tambi\u00e9n es posible el cifrado de cualquier archivo del sistema accediendo a sus propiedades, a trav\u00e9s de la pesta\u00f1a General \u2192 Avanzados\u2026, en el di\u00e1logo siguiente se elegir\u00e1 la opci\u00f3n Cifrar contenido para proteger datos.</p> <p>En los sistemas operativos basados en GNU/Linux es posible realizar esta operaci\u00f3n tanto en clientes como en servidores. Ubuntu Desktop ofrece la posibilidad de crear particiones cifradas durante el proceso de creaci\u00f3n de una partici\u00f3n. En la opci\u00f3n de Utilizar como se elige Volumen f\u00edsico para cifrado, inmediatamente despu\u00e9s se pedir\u00e1 al usuario una contrase\u00f1a de encriptaci\u00f3n y, de forma transparente, el sistema operativo encriptar\u00e1 cada uno de los datos que contenga o se depositen en esta unidad.</p> <p></p> <p>De la misma forma, ese sistema operativo permite la encriptaci\u00f3n de la carpeta personal /home del usuario, por si no se requiere el cifrado de todo un volumen. Ser\u00e1 tan sencillo como, durante el proceso de creaci\u00f3n de un usuario, marcar la opci\u00f3n de Cifrar mi carpeta personal.</p> <p>Tambi\u00e9n es posible la instalaci\u00f3n de aplicaciones que realicen estas tareas y tener m\u00e1s libertad a la hora de elegir qu\u00e9 partes de un volumen se deben cifrar y cuales no. Son varias aplicaciones la que dan esa libertad al usuario como VeraCrypt, LUKS o eCryptfs la cual permite tanto el cifrado de carpetas \u00fanicamente como el de vol\u00famenes enteros. Por su versatilidad se tratar\u00e1 la \u00faltima de ellas. Lo primero que hay que hacer es instalar el software necesario</p> <pre><code>sudo apt-get update | sudo apt-get install ecryptfs-utils\n</code></pre> <p>Esta aplicaci\u00f3n permite el cifrado de vol\u00famenes, carpetas de usuario <code>(ecryptfs-migrate-home)</code>, \u00e1rea de intercambio <code>(ecryptfs-setup-swap)</code> y cualquier carpeta del sistema. Para realizar el cifrado de cualquier carpeta, bastar\u00e1 con montarla sobre s\u00ed misma usando un sistema de archivos proporcionado por ecryptsfs</p> <pre><code>sudo mount -t ecryptfs /home/administrador/feo /home/administrador/feo\n</code></pre> <p>Lanzado el comando, preguntar\u00e1 varias cosas como la contrase\u00f1a de cifrado, el tipo de cifrado, la longitud de \u00e9ste, si se desea guardar la clave de cifrado en un fichero (totalmente desaconsejable) y, por \u00faltimo, si se desea encriptar tambi\u00e9n el nombre de los ficheros y no s\u00f3lo su contenido. Para acceder a esta carpeta o para descifrarla habr\u00e1 que utilizar, como parece l\u00f3gico, la contrase\u00f1a creada durante el proceso de cifrado. El proceso de descifrado se realiza desmontando esta carpeta con el comando <code>umount</code>.</p> <p>Hay que tener presente que el cifrado de datos no solo consume recursos del sistema, sino que tambi\u00e9n aumentar\u00e1 el espacio consumido por los archivos cifrados.</p>"},{"location":"UD11/05_compresionDatos/","title":"Compresi\u00f3n de datos.","text":"<p>Una forma de optimizar la capacidad de almacenamiento en una unidad es usar la compresi\u00f3n. Se puede activar la compresi\u00f3n de un volumen NTFS o configurar carpetas y archivos individuales para comprimir. La compresi\u00f3n no es recomendable en discos cuyo tama\u00f1o de cl\u00faster es mayor de 4 KB, debido a que el ahorro de espacio no compensa la p\u00e9rdida de rendimiento y el impacto en el sistema que se produce. Tambi\u00e9n es preciso se\u00f1alar que la cantidad de espacio ahorrada depende del tipo y el tama\u00f1o de archivos a comprimir.</p> <p>El comportamiento de los archivos comprimidos a trav\u00e9s de este sistema, es diferente en funci\u00f3n de la acci\u00f3n que se realiza sobre ellos:</p> <ul> <li>si se mueve un archivo sin comprimir a una carpeta, el archivo permanece sin comprimir, independientemente del atributo de compresi\u00f3n de la carpeta.</li> <li>si se mueve un archivo comprimido a una carpeta, el archivo permanece comprimido, independiente del atributo de compresi\u00f3n de la carpeta.</li> <li>si se copia un archivo a una carpeta, \u00e9ste toma el atributo de compresi\u00f3n de la carpeta destino.</li> <li>si se sobrescribe un archivo, el nuevo toma el atributo de compresi\u00f3n de su predecesor.</li> </ul> <p>Adem\u00e1s, hay que tener en cuenta varios factores sobre la compresi\u00f3n: los archivos est\u00e1n descomprimidos al ser transferidos por la red, de modo que no se obtienen beneficios en el uso del ancho de banda en transmisiones telem\u00e1ticas.</p> <ul> <li>comprimir ciertos tipos de archivos ya comprimidos como jpg, zip, rar, 7z entre otros, puede ser contraproducente y generar archivos mayores que los originales.</li> </ul> <p>Un servidor puede experimentar una degradaci\u00f3n importante cuando se usa compresi\u00f3n. En general, los servidores con poca carga de trabajo o los que son principalmente para lectura son los m\u00e1s apropiados para la compresi\u00f3n, ya que no sufrir\u00e1n tanta degradaci\u00f3n como los que tienen gran carga de trabajo o muchas operaciones de escritura.</p> <p>La \u00fanica forma de determinar como afectar\u00e1 la compresi\u00f3n a un sistema, es mediante el ensayo-error. Hay que exigir una relaci\u00f3n \u00f3ptima entre espacio ganado y consumo de recursos que permita la justificaci\u00f3n de la compresi\u00f3n. Si no se ahorra tanto espacio como el esperado o el rendimiento se degrada significativamente, sencillamente no es una buena opci\u00f3n y es suficiente con descomprimir el volumen o las carpetas comprimidas.</p> <p>Para activar la compresi\u00f3n en sistemas operativos de Microsoft existe un atributo en los vol\u00famenes que permite comprimir su contenido. Disponen de dos formas de activar la compresi\u00f3n:</p> <ul> <li>al formatear un volumen, ser\u00e1 necesario activar la casilla de verificaci\u00f3n Habilitar compresi\u00f3n de archivos y carpetas.</li> <li>activar o desactivar la compresi\u00f3n de un volumen ya formateado. Hay que acceder a la propiedades del volumen y en la pesta\u00f1a General, seleccionar la opci\u00f3n Comprimir esta unidad para ahorrar espacio en disco. Tras la activaci\u00f3n del atributo, el asistente preguntar\u00e1 si se desea comprimir s\u00f3lo la carpeta ra\u00edz, o todos los archivos y carpetas.</li> </ul> <p>El proceso de descompresi\u00f3n pasa por desactivar estos atributos de la misma manera que se activaron.</p> <p>Tambi\u00e9n existe la posibilidad de comprimir archivos determinados y no todo un volumen. Para comprimir/descomprimir un archivo se accede a sus propiedades, a trav\u00e9s de la pesta\u00f1a General \u2192 Avanzados\u2026, en el di\u00e1logo siguiente se elegir\u00e1 la opci\u00f3n Comprimir contenido para ahorrar espacio en disco.</p> <p>En los sistemas operativos GNU/Linux, al igual que en los de Microsoft, la compresi\u00f3n de vol\u00famenes se realiza a trav\u00e9s del sistema de ficheros que tenga asignado y ext3 como ext4 no permiten la compresi\u00f3n. Hay dos sistemas de ficheros que lo permiten y son utilizables en GNU/Linux:</p> <ul> <li>ZFS (Zettabyte File System), est\u00e1 desarrollado por Sun Microsystems para el sistema operativo Solaris y no viene incluido con ninguna de las grandes distribuciones de GNU/Linux, aunque es posible instalarlo y usarlo en Ubuntu Server.</li> <li>BTRFS (B TRee File System) que est\u00e1 incluido de forma experimental en la versi\u00f3n 2.6.29 del n\u00facleo de GNU/Linux. Es compatible con varios m\u00e9todos de compresi\u00f3n como LZO (Lempel Ziv Oberhumer) especializado en la compresi\u00f3n r\u00e1pida de ficheros.</li> </ul> <p>No es esta una tarea para la que GNU/Linux est\u00e9 dise\u00f1ado, o mejor dicho, sus sistema de ficheros. Existen alternativas que, m\u00e1s pronto que tarde, ser\u00e1n opciones viables en estos sistemas operativos.</p>"},{"location":"UD11/06_discosArranque/","title":"Discos de arranque y de recuperaci\u00f3n.","text":"<p>Un disco de arranque o disco de inicio es un tipo de medio extra\u00edble, como un disquete, un CD, DVD o unidad USB, que contiene los archivos de inicio del sistema operativo. Con \u00e9l se puede iniciar el equipo cuando existe un error de hardware o de software que impide el inicio normal del sistema. Generalmente el m\u00e9todo m\u00e1s utilizado para instalar un sistema operativo en un ordenador, como ya se ha estudiado en temas anteriores, es a trav\u00e9s de un DVD. Sin embargo, algunos ordenadores no vienen por defecto con hardware lector de discos, especialmente los port\u00e1tiles. Actualmente existen alternativas m\u00e1s r\u00e1pidas, c\u00f3modas y eficaces como los dispositivos de memoria extra\u00edbles USB. Existen varias aplicaciones para crear discos de arranque y recuperaci\u00f3n tanto para Microsoft Windows como GNU/Linux. La idea es crear un dispositivo de instalaci\u00f3n en una de estas unidades a trav\u00e9s de la cual sea posible tanto reparar el sistema operativo da\u00f1ado, como iniciarlo desde uno de estos dispositivos. Ya se han visto varios m\u00e9todos de creaci\u00f3n de estos discos como RUFUS o Microsoft USB/DVD Download Tool, aunque tambi\u00e9n es posible crear uno de estos dispositivos de forma manual.</p>"},{"location":"UD11/06_discosArranque/#creacion-de-un-dispositivo-usb-de-instalacion-de-windows","title":"Creaci\u00f3n de un dispositivo USB de instalaci\u00f3n de Windows","text":"<p>Estos programas anteriores se centran en automatizar un proceso que tambi\u00e9n podemos realizar a trav\u00e9s de las opciones del sistema operativo. Dicho proceso se basa en preparar la memoria USB para que los sistemas sean capaces de arrancar desde ella y, una vez configurada, copiar los archivos necesarios para la instalaci\u00f3n.</p> <p>En sistemas operativos de Microsoft, se accede a la herramienta a trav\u00e9s de Inicio \u2192 Herramientas administrativas de Windows \u2192 Unidad de recuperaci\u00f3n  aparecer\u00e1 un asistente que guiar\u00e1 el proceso.</p> <p>Para crear un disco de arranque de forma manual simplemente hay que dar dos pasos.</p> <ul> <li>Crear una partici\u00f3n primaria activa en el dispositivo y asignarle el sistema de archivos FAT32. Es posible realizar este proceso en modo gr\u00e1fico, pero se revisar\u00e1 c\u00f3mo hacerlo desde el terminal de Microsoft a trav\u00e9s de la utilidad <code>diskpart</code>.</li> <li>Se abre una ventana de terminal con permisos de administraci\u00f3n y se ejecuta el comando <code>diskpart</code>, el cual abrir\u00e1 una nueva ventana con su propio prompt.</li> </ul> <p>Para ver una lista de todos los dispositivos conectados e identificar el dispositivo USB</p> <pre><code>list disk\n</code></pre> <p>Despu\u00e9s se elige la unidad con la que va a trabajar, representada por el n\u00famero del dispositivo del listado</p> <pre><code>select disk 2\n</code></pre> <p>Para asegurar que la unidad seleccionada es la adecuada, se usa de nuevo el comando list disk y debe aparecer un asterisco antes del nombre del disco seleccionado. Tras esta comprobaci\u00f3n, y antes de crear ninguna partici\u00f3n, se borran las particiones existentes en la unidad</p> <pre><code>clean\n</code></pre> <p>Una vez limpia, se crea una partici\u00f3n primaria create partition primary. Y queda la asignaci\u00f3n del sistema de ficheros.</p> <pre><code>format fs=fat32 quick\n</code></pre> <p>El proceso no deber\u00eda llevar mucho tiempo y una vez finalice ya se dispone de una memoria lista para arrancar el equipo.</p> <p>Ahora ser\u00e1 necesario el segundo paso que es sencillo: copiar los ficheros de un disco de instalaci\u00f3n en la unidad preparada. Una vez terminado, se dispone de un dispositivo de inicio con el que poder arrancar cualquier equipo.</p> <p>Para crear un disco de arranque en GNU/Linux tambi\u00e9n existen aplicaciones con GUI, aunque la explicaci\u00f3n se centrar\u00e1 en el uso de <code>dd</code> a trav\u00e9s de CLI.</p> <p>Los pasos a seguir son los mismo que en el caso anterior: prepara la unidad USB y copiar los ficheros necesarios. Tras insertar la unidad de USB en el sistema, se busca que fichero de dispositivo est\u00e1 asociado a ella con el comando</p> <pre><code>sudo fdisk -l\n</code></pre> <p>Se detecta que la unidad de USB est\u00e1 situada en <code>/dev/sdf</code> y que tiene una \u00fanica partici\u00f3n en <code>/dev/sdf1</code>. Si la unidad ha sido montada de forma autom\u00e1tica, algunas distribuciones lo hacen, ser\u00e1 necesario desmontarla. Primero se comprueba si existe montaje</p> <pre><code>mount | grep /dev/sdf\n</code></pre> <p>Si devuelve alguna l\u00ednea la unidad est\u00e1 montada, por lo que hay que proceder a desmontarla</p> <pre><code>sudo umount /dev/sdf\n</code></pre> <p>Por \u00faltimo, tan s\u00f3lo queda copiar los ficheros de instalaci\u00f3n en el disco. Adem\u00e1s, dar\u00e1 el formato adecuado al dispositivo</p> <pre><code>sudo dd if=ubuntu-18.10-desktop-amd64.iso of=/dev/sdf bs=4M\n</code></pre> <p>En donde, if representa el origen de datos, <code>of</code> el destino y <code>bs=4M</code> es una opci\u00f3n para acelerar el proceso de creaci\u00f3n del disco de arranque. Al finalizar el proceso, se dispondr\u00e1 de un dispositivo de inicio con el que poder iniciar desde cualquier equipo.</p>"},{"location":"UD11/Actividades/","title":"Actividades","text":""},{"location":"UD11/Actividades/#actividad-1","title":"Actividad 1","text":"<ol> <li>Instala cuatro discos duros de 1TB de tama\u00f1o, expansi\u00f3n din\u00e1mica y del tipo SAS en cada uno de los servidores. Utiliza un nuevo controlador para contener todos los discos. Deber\u00e1s apagar la m\u00e1quina virtual para poder hacerlo, pero recuerda que en la realidad este hardware se puede instalar \u201cen caliente\u201d. Describe el proceso que sigues para hacer esta instalaci\u00f3n y activar los discos en el sistema operativo en un documento.</li> <li>En el equipo ServidorWindows, configura dos grupos de almacenamiento denominado grupo1 (primer y tercer disco instalados) y grupo2 (segundo y cuarto disco instalados). Luego transforma cada uno en un volumen con sistema de archivos NTFS. Asigna las letras X: al primero y K: al segundo. Comprueba que todo funciona de forma adecuada. Escribe un documento con los pasos que sigues para realizar esta configuraci\u00f3n</li> </ol>"},{"location":"UD11/Actividades/#actividad-2","title":"Actividad 2","text":"<ol> <li>En el servidor ServidorUbuntu, divide los cuatro discos en tres particiones del mismo tama\u00f1o (aproximadamente). Con LVM configura tres vol\u00famenes l\u00f3gicos:</li> <li>el primero con las primeras particiones de los tres primeros discos y con el nombre \u201cFeo1\u201d</li> <li>el segundo con las segundas particiones de los tres primeros discos y con nombre \u201cFeo2\u201d</li> <li>el tercero con las dos primeras particiones del cuarto disco duro y de nombre \u201cFeo3\u201d</li> </ol> <p>Asigna un sistema de ficheros FAT32 al primero, ext4 al segundo y ext3 al tercero. Tras esto, monta esos vol\u00famenes en <code>/media/Windows</code> el primero, en <code>/media/Linux</code> el segundo y en <code>/home</code> el tercero. El proceso de montaje debe ser permanente (modifica el fichero <code>/etc/fstab</code>). Documenta todo el proceso junto con los comandos necesarios para realizar estas operaciones.</p> <ol> <li> <p>Modifica los vol\u00famenes distribuidos creados en ServidorUbuntu de este modo:</p> </li> <li> <p>a\u00f1ade la tercera partici\u00f3n del primer disco a Feo1.</p> </li> <li>a\u00f1ade la tercera partici\u00f3n del segundo y tercer disco a Feo2.</li> <li>elimina Feo3 y crea un nuevo volumen l\u00f3gico con las particiones sobrantes con el nombre \u201cHorrible1\u201d.</li> </ol> <p>Redacta un documento que describa los pasos a seguir as\u00ed como los comandos necesarios.</p> <ol> <li>Realiza las configuraciones necesarias para crear un nuevo volumen RAID 1 en ServidorWindows. Este RAID debe tener una capacidad de 500 GB y estar montado en la letra L:. Necesitar\u00e1s varios discos duros virtuales para realizar esta pr\u00e1ctica. Instala los que necesites para su realizaci\u00f3n. Redacta un documento con los pasos que sigues para la configuraci\u00f3n.</li> <li>Realiza las configuraciones necesarias para crear un nuevo volumen RAID 1 en ServidorUbuntu. Este RAID debe tener una capacidad de 1 TB y estar montado en la carpeta <code>/media/discoRAID1</code>. Necesitar\u00e1s varios discos duros virtuales para realizar esta pr\u00e1ctica. Instala los que necesites para su realizaci\u00f3n. Redacta un documento con los pasos y comandos que sigues para la configuraci\u00f3n de cada uno de los RAID.</li> <li>Crea un nuevo volumen RAID 5 en ServidorWindows. Este RAID debe tener una capacidad de 1 TB y estar montado en la letra J:. Necesitar\u00e1s varios discos duros virtuales para realizar esta pr\u00e1ctica. Instala los que necesites. Como siempre, escribe una gu\u00eda con los pasos que sigues para la configuraci\u00f3n.</li> <li> <p>Crea un nuevo volumen RAID 5 en ServidorUbuntu. Este RAID debe tener una capacidad de 2 TB y estar montado en <code>/media/discoRAID5</code>. Necesitar\u00e1s varios discos duros virtuales para realizar esta pr\u00e1ctica. Instala los que necesites. Escribe una gu\u00eda con los pasos y comandos que sigues para la configuraci\u00f3n de cada uno de los RAID.</p> </li> <li> <p>En ServidorWindows instala la caracter\u00edstica \u201cCifrado de unidad Bitlocker\u201d a trav\u00e9s de Instalar Roles y Caracter\u00edsticas. Tras reiniciar el equipo, cifra el disco del sistema operativo y el de los documentos de los usuarios del dominio (donde se guardan las carpetas personales y los perfiles). Utiliza para ello un cifrado AES-CBC de 256 bits para el volumen que contiene el sistema operativo, y un cifrado AES-CBC de 128 bits para el resto. Documenta el proceso.</p> </li> <li> <p>En ServidorUbuntu, instala la aplicaci\u00f3n eCryptfs y encripta las carpetas de los usuarios del sistema y de los usuarios del directorio (perfiles, carpetas personales y directorio <code>/home</code>). El cifrado debe ser de AES de 128 bits en todos los casos. Documenta el proceso que sigues as\u00ed como los comandos necesarios para realizar esta instalaci\u00f3n.</p> </li> <li> <p>Crea un disco de arranque del sistema de ServidorWindows. Este disco se crear\u00e1 de forma manual con las utilidades del sistema y se particionar\u00e1 con la herramienta <code>diskpart</code> en modo CLI. Utiliza un dispositivo USB real capturado por la m\u00e1quina virtual para realizar este ejercicio. Una vez creado comprueba que funciona.</p> </li> <li> <p>Crea un disco de arranque en una unidad USB real capturada por la m\u00e1quina virtual a trav\u00e9s de la utilidad dd. El disco de arranque ser\u00e1 de la versi\u00f3n Ubuntu Desktop utilizada en los clientes. Comprueba que funciona de forma correcta. Redacta una gu\u00eda con los pasos que sigues y los comandos necesarios para realizar esta tarea.</p> </li> </ol>"},{"location":"UD11/Actividades/#actividad-3","title":"Actividad 3","text":"<ol> <li>Realiza las configuraciones necesarias para crear un RAID 10 en cada uno de los servidores. Debe tener una capacidad de 2 TB. Monta este nuevo volumen donde creas oportuno. Ya sabes, redacta un documento con los pasos y comandos que sigues para su instalaci\u00f3n.</li> </ol> <p>Necesitar\u00e1s varios discos duros virtuales m\u00e1s para realizar esta pr\u00e1ctica. Llegados a este punto el sistema puede volverse inestable (recuerda que estamos trabajando con sistemas operativos virtualizados). Puedes reutilizar los discos de pr\u00e1cticas anteriores o eliminarlos y colocar los que necesites para la realizaci\u00f3n de esta pr\u00e1ctica.</p> <ol> <li>Instala un nuevo disco en ServidorUbuntu de 1 TB de espacio, de tipo SAS y con expansi\u00f3n din\u00e1mica. Realiza las siguientes configuraciones con \u00e9l:</li> <li>Antes de montarlo, instala el sistema de ficheros ZFS. Antes de ello, aseg\u00farate que las fuentes de software principales, restringidas, universe y multiverse est\u00e1n habilitadas (sudo apt edit-sources ). Si no es el caso, habil\u00edtalas con estos comandos seg\u00fan proceda:<ul> <li><code>sudo apt-add-repository main</code>, para las principales</li> <li><code>sudo apt-add-repository restricted</code>, para las restringidas</li> <li><code>sudo apt-add-repository universe</code>, para las universe</li> <li><code>sudo apt-add-repository multiverse</code>, para las multiverse</li> <li>instala con el comando <code>sudo apt-get install zfsutils-linux</code></li> <li>monta esa unidad en <code>/media/Comprimida</code></li> <li>asigna el sistema de ficheros ZFS</li> <li>comprime la unidad con la compresi\u00f3n que estimes oportuna (consulta la ayuda del comando para ello).</li> </ul> </li> </ol>"},{"location":"UD12/01CopiasSeguridad/","title":"Copias de seguridad del sistema","text":"<p>Es vital que uno de los principales activos de la empresa como lo es su informaci\u00f3n, se mantenga a salvo de posibles p\u00e9rdidas. A\u00fan as\u00ed, es muy com\u00fan el descuido de esta pr\u00e1ctica convirti\u00e9ndolo en algo accesorio y no recibiendo la importancia que se merece.</p> <p>La verdadera utilidad de crear copias de seguridad reside en la recuperaci\u00f3n de la informaci\u00f3n de una forma r\u00e1pida y sencilla. Adem\u00e1s, ser\u00e1 necesario la comprobaci\u00f3n peri\u00f3dica del proceso y consulta de bit\u00e1coras para poder garantizar que el proceso se est\u00e1 efectuando de forma correcta.</p> <p>Se dispone de diferentes tipos de copia de seguridad que se usar\u00e1n en funci\u00f3n de los datos a respaldar y las necesidades del sistema. No ser\u00e1n tratados por igual los ficheros que contienen la informaci\u00f3n de los datos de contabilidad que los datos personales de usuarios del sistema. Los primeros ser\u00e1n objeto de respaldos con una periodicidad mayor que los segundos, debido fundamentalmente a la impronta de su p\u00e9rdida. Tan importante como los datos de la empresa, es lo copia de seguridad del propio sistema. Es de vital importancia que la herramienta que gestiona el directorio se mantenga respaldado en todo momento y pueda ser sustituido en caso necesario. Para ello se dispone de varios tipos de copias de seguridad:</p> <ul> <li>copias completas, es el formato de copia m\u00e1s sencillo y se basa en realizar una copia de todos los datos en otro soporte como cintas, discos duros externos, soporte \u00f3pticos, etc\u00e9tera. La ventaja es que se dispone de todos los datos en cada copia por lo que se podr\u00e1 acceder a diferentes versiones de los archivos guardados. Adem\u00e1s estas copias pueden ser comprimidas y cifradas si as\u00ed se requiere. Los inconvenientes son evidentes:tiempo y costo de almacenaje.   Por ejemplo, se realiza una copia de seguridad de todos los datos los viernes, al cierre de la empresa.</li> <li>copias diferenciales, solo realiza la copia de los archivos que han cambiado desde la \u00faltima copia completa, exceptuando la primera vez que se realiza, que tendr\u00e1 el mismo comportamiento que la copia completa. Su principal ventaja es que son m\u00e1s r\u00e1pidas y su impacto en el sistema es mucho menor.   Por ejemplo, se realiza una copia diaria al cierre de la jornada. La copia del martes contendr\u00e1 todos los datos que se han modificado desde la \u00faltima copia completa. As\u00ed, el martes contendr\u00e1 los datos que se han modificado ese mismo d\u00eda m\u00e1s los del d\u00eda anterior. A medida que la copia diferencial de aleja de la completa, crece en tama\u00f1o y carga en el sistema.</li> <li>copias incrementales, s\u00f3lo realizan copias de los datos que han cambiado desde la \u00faltima copia de seguridad, se trate de una completa o diferencial.   Por ejemplo, si la copia se realiza el martes, tan s\u00f3lo contendr\u00e1 los archivos modificados desde la \u00faltima copia realizada. Contendr\u00e1 los ficheros modificados el martes y no los del lunes. Al ser una copia m\u00e1s peque\u00f1a se puede ejecutar con mayor periodicidad ya que el impacto sobre el sistema es menor.</li> <li>copias espejo, son similares a las copias completas salvo por la diferencia de que los archivos no pueden ser comprimidos ni cifrados. Las desventajas son claras: consumo de espacio elevado y poca seguridad.</li> </ul>"},{"location":"UD12/01CopiasSeguridad/#programacion-de-copias-de-seguridad","title":"Programaci\u00f3n de copias de seguridad","text":"<p>Una buena planificaci\u00f3n de las copias de seguridad debe tener en cuenta varios factores como la importancia de los datos a respaldar, el impacto del proceso en el sistema y consumo de recursos. No existen una \u00fanica soluci\u00f3n v\u00e1lida de copias de seguridad. Correr\u00e1 cargo del administrador del sistema especificar un plan de respaldo combinando todos los factores mencionados con anterioridad.</p> <p>De este modo, las copias completos proporcionan una buena alternativa si queremos tener mayor tolerancia a fallos y una restauraci\u00f3n m\u00e1s r\u00e1pida. Realizar copias completas diarias, est\u00e1 recomendado para empresas con vol\u00famenes de datos muy peque\u00f1os, ya que tendremos un elevado nivel de protecci\u00f3n a cambio de un moderado coste de almacenamiento.</p> <p>Si se opta por una copia completa semanal en combinaci\u00f3n con incrementales diarias, se obtendr\u00e1 un proceso m\u00e1s r\u00e1pido de copia y un menor coste de almacenamiento. Por contra, al disponer de un mayor n\u00famero de copias, consumir\u00e1 m\u00e1s tiempo restaurar la informaci\u00f3n. Si se combina una copia completa semanal y diferenciales diarios, se conseguir\u00e1n unos resultados intermedios: un mayor nivel de protecci\u00f3n de los datos, tiempos de restauraci\u00f3n m\u00e1s cortos y un peque\u00f1o incremento en el coste de almacenamiento.</p> <p>Por supuesto las combinaciones van a depender de las necesidades de la empresa y la importancia de los datos a respaldar. Ser\u00e1 el administrador el que decida una estrategia v\u00e1lida de respaldo que combine todos estos factores.</p> <p>En unidades anteriores se ha tratado el tema de la salvaguarda de la informaci\u00f3n de los usuarios y documentos del sistema. En este apartado se tratar\u00e1 de la protecci\u00f3n de la configuraci\u00f3n del SO a trav\u00e9s de copias de seguridad del sistema. Casi tan importante como mantener a salvo los datos de los usuarios es, sin lugar a dudas, mantener a salvo de errores y p\u00e9rdidas la configuraci\u00f3n de los controladores de dominio. Los motivos resultan obvios. Adem\u00e1s, si las copias se encuentran programadas, la protecci\u00f3n se producir\u00e1 de forma autom\u00e1tica con la frecuencia que se estime necesaria.</p> <p>En los SO basados en Microsoft Windows, ser\u00e1 necesario instalar la caracter\u00edstica de Copias de seguridad de Windows Server. Recuerda que el proceso solicita la instalaci\u00f3n de los roles antes que las caracter\u00edsticas, por lo que pulsa el bot\u00f3n siguiente cuando solicite instalar un rol para pasar directamente a la instalaci\u00f3n de caracter\u00edsticas.</p> <p></p> <p>A partir de Microsoft Windows Server 2008 se utiliza la herramienta para copias de seguridad denominada Windows Server Backup, instalada en el apartado anterior. Esta utilidad destaca, entre otras funcionalidades, por:</p> <ul> <li>mejores prestaciones a la hora de realizar copias de seguridad completas del servidor</li> <li>copias parciales, es decir, s\u00f3lo algunos de sus vol\u00famenes</li> <li>copias de la configuraci\u00f3n de aplicaciones de software base</li> <li>posibilidad de salvaguardar s\u00f3lo el estado del sistema</li> </ul> <p>Pero esta caracter\u00edstica no instala s\u00f3lo una herramienta, sino que est\u00e1 compuesta por varias utilidades que permiten un control total del proceso de respaldo y recuperaci\u00f3n. Entre ellas hay que destacar el complemento Copias de seguridad de MMC (Microsoft Management Console), que permite realizar estas copias tambi\u00e9n a trav\u00e9s de CLI con el comando <code>wbadmin</code>, y que, adem\u00e1s integra la extensi\u00f3n Instant\u00e1neas de carpetas compartidas.</p> <p>Otra de estas herramientas es el Entorno de recuperaci\u00f3n de Windows, que integra la herramienta de Recuperaci\u00f3n de imagen del sistema, la Herramienta de diagn\u00f3stico de memoria de Windows y los comandos del s\u00edmbolo del sistema.</p> <p>Junto con la inclusi\u00f3n de este nuevo software, Microsoft ha eliminado el soporte y la utilidad <code>Ntbackup.exe</code>, que gestionaba las copia de seguridad previamente. No es posible por tanto recuperar datos almacenados en copias de seguridad realizadas con este sistema. No obstante, Microsoft ofrece de una versi\u00f3n que permite la recuperaci\u00f3n de datos contenidos en copias de seguridad antiguas, aunque no es posible su respaldo completo.</p> <p>Ahora que ya se dispone de una herramienta para la copia del sistema, es preciso planificar estas copias para que realicen en funci\u00f3n de varios par\u00e1metros:</p> <ul> <li>carga del sistema, en efecto, no es buena idea realizar estas tareas cuando el sistema soporta la mayor carga de trabajo. Adem\u00e1s de a\u00f1adir una carga extra, la copia de seguridad se alargar\u00e1 en el tiempo quedando expuesta a una mayor posibilidad de sufrir errores.</li> <li>horario de trabajo, es muy recomendable que las copias se planifiquen fuera del horario laboral, en la medida de lo posible. Es durante la jornada laboral cuando se realizan los cambios en el sistema que hay que salvaguardar. Parece l\u00f3gico que, al finalizar la jornada y con ella los cambios, se produzca la copia de seguridad del sistema.</li> <li>adecuar la periodicidad de la copia, dependiendo de la actividad del sistema en general y sobre todo del flujo de la informaci\u00f3n. En sistemas con poco cambios es posible espaciar las copias de seguridad. Por contra, cuando el sistema se enfrenta a continuos cambios ser\u00e1 necesario realizar estas copias con una mayor asiduidad.</li> <li>programaci\u00f3n y tipo de copias, es recomendable que el sistema sea capaz de realizar las copias de seguridad atendiendo a una programaci\u00f3n, de forma desatendida y de tipo incremental.</li> </ul> <p>Todas estas caracter\u00edsticas las posee Windows Server Backup.</p> <p>Para iniciar la gesti\u00f3n de copias de seguridad en Microsoft Windows Server tan s\u00f3lo es necesario abrir la herramienta reci\u00e9n instalada y pulsar sobre el men\u00fa Acci\u00f3n. En \u00e9l aparecen el acceso a tres asistentes que simplificar\u00e1n al m\u00e1ximo esta tarea.</p> <p>En Ubuntu Server existen varias opciones para realizar esta tarea a trav\u00e9s de GUI como BackupPC, Konserve o Grsync. Casi todas las soluciones basadas en GUI utilizan por debajo el paquete <code>rsync</code> que es posible utilizarlo con CLI. Ser\u00e1 este el modo en el que se trabajar\u00e1 en este apartado. Para comenzar a trabajar con ella, primero hay que proceder a su instalaci\u00f3n, de la forma habitual</p> <pre><code>sudo apt-get install rsync\n</code></pre> <p><code>rsync</code> ofrece copias de seguridad de datos tanto totales como incrementales. Adem\u00e1s tiene la posibilidad de comprimir y cifrar datos.</p> <p>El uso de este paquete es</p> <pre><code>rsync &lt;opciones&gt; &lt;origen&gt; &lt;destino&gt;\n</code></pre> <p>Al poderse utilizar en la l\u00ednea de comandos, es posible a\u00f1adirlo a la tabla de cron para programar las copias de seguridad, como ya se ha tratado en unidades anteriores.</p> <p>Las opciones que ofrece rsync son, entre otras:</p> <pre><code>- -a, copiar recursivamente manteniendo privilegios, fechas y permisos (similar a la opci\u00f3n conjunta -rlptgoD).\n- -r, copia una carpeta de forma recursiva.\n- -A, conserva los ACL de los ficheros.\n- -g, mantiene el grupo al que pertenece el fichero.\n- -o, preserva el propietario del archivo.\n- -E, mantener ejecutabilidad de los ficheros.\n- -v, activa el modo verbose.\n- -z, comprimir los datos.\n- --exclude, excluye archivos de un directorio en concreto o de un patr\u00f3n determinado.\n</code></pre> <p>Las opciones de <code>rsync</code> son interminables. Como siempre, es altamente recomendable consultar la ayuda de este comando.</p> <p>Una vez que se han seleccionado las opciones para la copia de seguridad, tan s\u00f3lo habr\u00e1 que escribir el comando</p> <pre><code>rsync -aAXv --exclude={\"/tmp/_\",\"/mnt/_\",\"/media/_\",\"/lost+found/_\"} /\\_ /media/copia\n</code></pre> <p>Usando el conjunto de opciones <code>-aAX</code>, los ficheros son transferidos en modo archivo, asegur\u00e1ndose que los enlaces simb\u00f3licos, dispositivos, permisos, atributos de propiedad, tiempos de modificaci\u00f3n, ACLs y atributos extendidos se mantienen intactos.</p> <p>La opci\u00f3n <code>--exclude</code> har\u00e1 que aquellos ficheros que coincidan con los patrones dados sean excluidos. /lost+found es espec\u00edfico del sistema de archivos, por lo que ser\u00e1 excluido de la copia de seguridad. Entrecomillar los patrones de exclusi\u00f3n evitar\u00e1 su expansi\u00f3n por parte del int\u00e9rprete de ordenes, lo que es necesario cuando, por ejemplo, se hacen copias de seguridad por SSH.</p> <p>A la hora de hacer una copia de todo el sistema, hay que tener en cuenta algunas consideraciones:</p> <ul> <li>los contenidos de <code>/dev, /proc, /sys, /tmp</code> son creados al cargar el sistema, por lo que guardarlo es un trabajo totalmente in\u00fatil. Algo parecido con la carpeta <code>/lost+found</code>, estos datos no se generan al inicio del sistema, pero s\u00ed que pertenecen a una distribuci\u00f3n de GNU/Linux en concreto. Todos estos contenidos es buena pr\u00e1ctica excluirlos de la copia de seguridad del sistema.</li> <li>las carpetas <code>/mnt y /media</code> son excluidas para evitar la creaci\u00f3n de bucles infinitos. Si se plantea hacer una copia de seguridad en alguna ubicaci\u00f3n que no sea ninguna de \u00e9stas, es necesario a\u00f1adirla a la lista de exclusi\u00f3n, por id\u00e9ntico motivo.</li> <li>si el sistema usa un archivo <code>swap</code>, es buena idea de excluirlo tambi\u00e9n.</li> <li>hay que considerar si tambi\u00e9n hay que respaldar la carpeta <code>/home</code>. Los datos contenidos en esta carpeta ser\u00e1n considerablemente m\u00e1s cuantiosos que los del sistema. Adem\u00e1s se puede excluir subdirectorios no importantes como <code>/home/_/.thumbnails/_, /home/_/.cache/mozilla/_, /home/_/.cache/chromium/_, /home/\\_/.local/share/Trash/\\*</code>, dependiendo del software que haya instalado en el sistema.</li> <li>separar la copia de seguridad del sistema de los datos de usuario puede ser buena idea.</li> </ul> <p>Como siempre, la opci\u00f3n CLI ofrece m\u00e1s posibilidades que la versi\u00f3n GUI.</p>"},{"location":"UD12/02Recuperacion/","title":"Recuperaci\u00f3n del sistema. Opciones de restauraci\u00f3n del sistema","text":"<p>Si el sistema falla, presenta alg\u00fan problema de rendimiento o sencillamente no inicia, el administrador del sistema deber\u00e1 plantearse la restauraci\u00f3n del sistema completo. Una de las incorporaciones del software Copia de seguridad Windows Server es precisamente \u00e9sta. Para ello ser\u00e1 necesario haber realizado previamente una copia completa del sistema, tal y como se ha explicado en el punto anterior.</p> <p>Existen varias formas de iniciar el proceso de recuperaci\u00f3n, y depender\u00e1 de la sintomatolog\u00eda del servidor; si posee la capacidad de arrancar se utilizar\u00e1 la opci\u00f3n de Reparar el equipo a la que accederemos pulsando la tecla F8. Si no posee capacidad de arrancar, es posible utilizar el disco de instalaci\u00f3n de Microsoft Windows Server. Esta \u00faltima forma ser\u00e1 utilizable en cualquiera de los casos de recuperaci\u00f3n del sistema por lo que ser\u00e1 buena idea aprenderla.</p> <p>En los casos m\u00e1s graves en los que haya que sustituir parte del hardware o el equipo, ser\u00e1 conveniente comprobar dos par\u00e1metros de vital importancia:</p> <ul> <li>que la unidad de almacenamiento sea de un tama\u00f1o mayor o igual a la sustituida. Aunque los vol\u00famenes del disco a recuperar no ocupen la capacidad total del disco, en la definici\u00f3n del volumen en la tabla de particiones est\u00e1 definido hasta qu\u00e9 bloque puede llegar, por lo que ser\u00e1 necesario tener esa capacidad como m\u00ednimo.</li> <li>que la arquitectura del procesador sea la misma o compatible. No es funcional una copia de seguridad realizada en una arquitectura diferente a la del equipo a restaurar. Es este caso ser\u00eda necesario realizar una recuperaci\u00f3n parcial una vez instalado el sistema.</li> </ul> <p>Para iniciar el proceso de recuperaci\u00f3n es necesario arrancar el sistema con el disco de instalaci\u00f3n, seleccionar idioma y entrar en la opci\u00f3n Reparar el equipo. Se dispone de tres opciones; Continuar, Solucionar problemas o Apagar el equipo.</p> <p></p> <p>Al seleccionar la opci\u00f3n Solucionar problemas, es posible iniciar a trav\u00e9s del s\u00edmbolo del sistema o realizar una recuperaci\u00f3n de imagen del sistema. Ser\u00e1 la segunda la que se seleccionar\u00e1. En caso de tener disponibles varias versiones del sistema operativo, preguntar\u00e1 cual de ellas es necesario recuperar.</p> <p>Una vez especificado el sistema operativo, detectar\u00e1 las diferentes copias de seguridad de las que dispone el sistema y sugerir\u00e1 la \u00faltima realizada. Esta ser\u00e1 la opci\u00f3n recomendable, aunque existe la posibilidad de seleccionar otra imagen del sistema.</p> <p>Tras la selecci\u00f3n de la copia, ofrece la posibilidad de volver a particionar y dar formato a discos pudiendo excluir alguno de los discos del sistema. Esta opci\u00f3n es v\u00e1lida si es necesario el reemplazo del disco duro por uno nuevo. De esta forma no ser\u00e1 necesario el particionado previo, y se podr\u00e1 dejar en manos del sistema de recuperaci\u00f3n.</p> <p>Tambi\u00e9n, si el disco duro ha cambiado de tecnolog\u00eda, por ejemplo se ha cambiado un disco duro SATA por uno SAS, quiz\u00e1s sea necesario la inclusi\u00f3n de controladores para el correcto funcionamiento de este dispositivo. Por \u00faltimo, a trav\u00e9s de la opci\u00f3n Opciones avanzadas\u2026 permite el reinicio del sistema al finalizar la copia y la comprobaci\u00f3n de los datos.</p> <p>Para realizar estas tareas en los sistemas operativos basados en GNU/Linux se usa el comando rsync intercambiando el origen y el destino. Si no se dispone de acceso al sistema, se deben seguir estos pasos:</p> <ul> <li>se inicia el equipo desde el disco de instalaci\u00f3n de GNU/Linux y seleccionar la opci\u00f3n Live, con esta acci\u00f3n ya se dispone de un terminal con el que poder realizar las siguientes acciones.</li> <li>montar la unidad a reparar, por ejemplo en <code>/mnt/reparar.</code></li> <li>montar la unidad de respaldo, por ejemplo en <code>/mnt/respaldo.</code></li> <li>utilizar estos puntos de montaje para realizar un <code>rsync</code>, pero en sentido inverso.</li> </ul> <p>Si la recuperaci\u00f3n es de la informaci\u00f3n contenida en la carpeta <code>/home</code>, el proceso se simplifica ya que tan s\u00f3lo ser\u00e1 necesario realizar el \u00faltimo punto del listado anterior.</p>"},{"location":"UD12/03Clonacion/","title":"Instalaci\u00f3n por clonaci\u00f3n","text":"<p>Tras la instalaci\u00f3n del sistema operativo hay que proceder a su configuraci\u00f3n y la instalaci\u00f3n del software necesario. Son tareas que se repiten en cada uno de los clientes del sistema y, si estos son numerosos, convendr\u00eda automatizar. Es habitual elegir uno de los ordenadores del sistema como modelo y realizar una copia del disco duro que se denomina imagen.</p> <p>Esa imagen pasa a un dispositivo extra\u00edble desde donde se podr\u00e1 distribuir al resto de equipos. A trav\u00e9s de un software espec\u00edfico, esa imagen es clonada a cualquiera de los equipos del sistema inform\u00e1tico con la ventaja de que todo el software estar\u00e1 instalado y configurado. Tan solo son necesarios unos peque\u00f1os ajustes, como cambiar el nombre al equipo o revisar los controladores, que consumen mucho menos tiempo que el trabajo completo.</p> <p>Para poder realizar esta clonaci\u00f3n es necesario que los equipos que reciben la imagen clonada dispongan de un hardware similar o compatible con el de la imagen copiada. Resulta evidente que no todos lo equipos de un sistema inform\u00e1tico poseen el mismo hardware.</p> <p>En estas ocasiones los t\u00e9cnicos de TIC pueden construir diferentes versiones de la imagen clonada en funci\u00f3n de los requerimientos de cada ordenador.</p> <p>La clonaci\u00f3n de un equipo se puede realizar a trav\u00e9s de varias formas, siendo las m\u00e1s comunes:</p> <ul> <li>a trav\u00e9s de un dispositivo extra\u00edble como un DVD, un pendrive o un disco duro externo, que habr\u00e1 que conectar al equipo antes de iniciar el proceso.</li> <li>a trav\u00e9s de la red, usando para ello las NIC (Network Interface Card) de los equipos. Para ello estas tarjetas deben ser compatibles con el protocolo PXE (Preboot eXecution Enviroment). Este punto se tratar\u00e1 de forma m\u00e1s extensa en lo sucesivo.</li> <li>a trav\u00e9s de la nube, muchas empresas ofrecen servicios de Cloud (nube en ingl\u00e9s) para desempe\u00f1ar esta tarea. Ser\u00e1 necesario arrancar el ordenador desde un pendrive que cargar\u00e1 la interfaz necesaria para acceder a las im\u00e1genes.</li> </ul> <p>La elecci\u00f3n de uno u otro m\u00e9todo ser\u00e1 responsabilidad del t\u00e9cnico y se realizar\u00e1 en funci\u00f3n de las necesidades o posibilidades del sistema inform\u00e1tico.</p> <p>Los sistema operativos de Microsoft, desde su versi\u00f3n Vista, ofrecen una herramienta en l\u00ednea de comandos que se conoce como ImageX. Esta herramienta permite crear un archivo de imagen del sistema operativo para trasladarlo a otro ordenador. Para ello utiliza el formato WIN (Windows Imaging Format) que tiene la particularidad de ser arrancable gracias a la creaci\u00f3n de un fichero anexo denominado BOOT.WIN. No se va a profundizar m\u00e1s en esta t\u00e9cnica, ya que este sistema tan s\u00f3lo es v\u00e1lido para sistemas operativos de Microsoft.</p> <p>Existen muchas herramientas de clonado independientes del sistema operativo, ya que se ejecutan antes de cargar el sistema operativo. Una de la empresas l\u00edder en este sector es Symantec con su producto Ghost Solution Suite, del cual podremos descargar una versi\u00f3n de prueba desde su p\u00e1gina web. Es una excelente soluci\u00f3n si se dispone de los medios econ\u00f3micos para implementarla, ya que posee una interfaz simple y efectiva que facilita la realizaci\u00f3n de todas estas tareas. No obstante, en este manual se ofrece la opci\u00f3n de usar software libre y gratuito para la realizaci\u00f3n de estas tareas. Una alternativa de c\u00f3digo libre bajo licencia GPL es Clonezilla. Ofrece dos versiones:</p> <ul> <li>Clonezilla live, est\u00e1 formada por una distribuci\u00f3n GNU/Linux peque\u00f1a y arrancable desde un medio extra\u00edble. Permite hacer la restauraci\u00f3n de la m\u00e1quina donde se ejecuta.</li> <li>Clonezilla SE (Server Edition), requiere la instalaci\u00f3n de un sistema operativo DRBL (Diskless Remote Boot in Linux) para dar respuesta a las solicitudes. Este sistema operativo se instala en un ordenador conectado a la red y compatible con el protocolo PXE (Preboot eXecution Enviroment). El servidor de im\u00e1genes almacenar\u00e1 las im\u00e1genes y las ofrecer\u00e1 bajo demanda.</li> </ul> <p>Esta herramienta ofrece las siguientes caracter\u00edsticas:</p> <ul> <li>soporta casi todos los sistemas de ficheros comerciales</li> <li>es compatible tanto particionado MBR como GPT</li> <li>realiza copias de discos enteros como de particiones espec\u00edficas.</li> <li>la imagen a clonar puede ser ofrecida de forma local, o a trav\u00e9s de un servidor SSH (Secure Shell), Samba o WebDAV (Web Distributed Authoring and Versioning). - permite encriptar las im\u00e1genes para una mayor seguridad y confidencialidad de la informaci\u00f3n.</li> </ul> <p>A pesar de tratarse de un software mimado por la comunidad y con una gran funcionalidad, todav\u00eda presenta algunas limitaciones:</p> <ul> <li>la partici\u00f3n de destino de la imagen ha de ser de igual o superior tama\u00f1o, a pesar de que el tama\u00f1o de la imagen sea inferior.</li> <li>no es posible realizar im\u00e1genes incrementales o diferenciales.</li> <li>el clonado on-line no est\u00e1 implementado, todav\u00eda.</li> <li>las im\u00e1genes creadas no pueden ser exploradas con ning\u00fan gestor de ficheros.</li> </ul> <p>La comunidad no ceja en el empe\u00f1o de subsanar estas limitaciones, que seguro que en un tiempo prudencial ser\u00e1n implementadas.</p>"},{"location":"UD12/03Clonacion/#creacionrestauracion-de-una-imagen-con-clonezilla-live","title":"Creaci\u00f3n/restauraci\u00f3n de una imagen con Clonezilla Live","text":"<p>Se va a desgranar los diferentes pasos que hay que seguir para crear/restaurar una imagen utilizando la herramienta Clonezilla Live.</p> <ul> <li>descargar el software Clonezilla Live en formato ISO y arrancar una m\u00e1quina virtual con esta imagen como primera opci\u00f3n de arranque. Adem\u00e1s, se debe dotar a la m\u00e1quina virtual de un segundo disco duro para contener la imagen. Se debe particionar de forma adecuada y asignarle un sistema de archivos al nuevo disco duro. Es conveniente etiquetar tambi\u00e9n el disco duro para que resulta f\u00e1cilmente identificable.</li> <li>arrancar la imagen y seleccionar la opci\u00f3n \u201cClonezilla live (default settings, VGA 800x600)\u201d. Tras esto seleccionaremos el idioma en el que aparecer\u00e1 la interfaz y la configuraci\u00f3n del teclado.   </li> <li>para crear una imagen de un dispositivo, es preciso seleccionar la primera opci\u00f3n device-image, es decir, desde un dispositivo a una imagen. Adem\u00e1s de \u00e9sta, ofrece la posibilidad de copiar un dispositivo a otro, cargar/enviar una imagen desde/hasta un servidor preexistente o configurar este ordenador como un servidor ligero de Clonezilla Server Edition, la cual desaparecer\u00e1 al reiniciar el equipo.</li> <li>se selecciona el destino donde se guardar\u00e1 la imagen creada. Ofrece multitud de soluciones a trav\u00e9s de diferentes servidores, pero en esta ocasi\u00f3n, el dispositivo est\u00e1 conectado de forma local. Tras esta selecci\u00f3n, detectar\u00e1 los dispositivos conectados y se elegir\u00e1 el que contendr\u00e1 la imagen.   </li> <li>ser\u00e1 necesario crea un punto de montaje para que el programa pueda acceder al nuevo dispositivo. El punto de montaje ser\u00e1 /home/partimag por defecto. Si es necesario cambiarlo, el nuevo nombre no deber\u00e1 contener espacios en blanco.   </li> <li>es posible seleccionar dos modos de asistente a partir de este punto. Se recomienda seleccionar el modo experto ya que ofrecer\u00e1 m\u00e1s opciones. Despu\u00e9s se seleccionar\u00e1 crear una imagen de un disco completo, es decir, con su tabla de particiones.</li> <li>se debe especificar un nombre a la imagen que se va a crear. Tras esto, se selecciona el disco duro de origen.</li> <li> <p>a partir de aqu\u00ed el asistente nos guiar\u00e1 a trav\u00e9s de las diferentes opciones que el t\u00e9cnico dispone para realizar la imagen: modo de compatibilidad, configurar par\u00e1metros avanzados, de compresi\u00f3n de la imagen, si es necesario dividir el archivo resultante en vol\u00famenes, comprobaciones de integridad del disco de origen/destino, si es necesario cifrar la imagen o no y qu\u00e9 hacer tras finalizar la clonaci\u00f3n. Es altamente recomendable leer los mensajes que el programa nos ofrece, no est\u00e1n ah\u00ed de adorno.   </p> </li> <li> <p>una vez configurada la imagen, el programa mostrar\u00e1 por pantalla el comando resultante que ejecutar\u00e1 en el terminal para crear la imagen. Guardar este comando para su reutilizaci\u00f3n es una pr\u00e1ctica recomendable si se necesita repetir el proceso.</p> </li> </ul> <p>De este modo se ha creado una imagen desde un dispositivo. Ahora queda revisar el proceso inverso; volcar la imagen en una nueva m\u00e1quina. Para ello, se seguir\u00e1n los siguientes pasos:</p> <ul> <li>se crear\u00e1 una nueva m\u00e1quina virtual con un disco duro de igual o superior tama\u00f1o al clonado. Adem\u00e1s, se ha de desvincular el disco duro que contiene la imagen creada y colocarlo como segundo disco en la nueva m\u00e1quina. Para finalizar, se ha de colocar la imagen del software Clonezilla Live en la unidad \u00f3ptica de la nueva m\u00e1quina.</li> <li>se inicia y configura el programa de igual forma que en el caso anterior. Tambi\u00e9n es necesario indicar la misma opci\u00f3n que en el caso anterior device-image y a trav\u00e9s de un dispositivo local local_dev, ya que el dispositivo se encuentra conectado directamente.</li> <li>se ha de seleccionar el dispositivo que contiene la imagen y que se necesita restaurar. \u00c9sta estar\u00e1 contenida en una carpeta con el nombre facilitado a la hora de realizarla, que si no se ha modificado se ubicar\u00e1 en <code>/home/partimag.</code></li> <li>entre las opciones que ofrece Clonezilla Live, se seleccionar\u00e1 la m\u00e1s apropiadas, en esta ocasi\u00f3n restoredisk. Se elige la imagen a restaurar, el destino de la misma, las opciones de la restauraci\u00f3n, si es necesario crear una nueva tabla de particiones o se usa la que posee el archivo, las opciones de comprobaci\u00f3n y qu\u00e9 hacer tras la restauraci\u00f3n.</li> </ul> <p>De este modo es como Clonezilla Live crea y restaura im\u00e1genes. El proceso es adaptable a cada situaci\u00f3n ya que existen numerosas opciones de configuraci\u00f3n y el programa es compatible con casi todos los sistemas de archivo existentes.</p>"},{"location":"UD12/04InstalacionDesatendidas/","title":"Configuraci\u00f3n y uso de instalaciones desatendidas","text":"<p>La instalaci\u00f3n desatendida permite realizar esta tarea con poca intervenci\u00f3n del usuario y se basa en archivo de respuesta. Este archivo contiene un guion en texto simple que indica el modo de instalarlo sin a penas intervenci\u00f3n del usuario.</p> <p>Tanto los sistemas operativos de Microsoft desde su versi\u00f3n Windows XP, como las distribuciones de GNU/Linux disponen de software destinado a realizar estas tareas. Los primeros cuentan con un conjunto de herramientas denominado Windows Assessment and Deployment Kit (Windows ADK). Se puede descargar desde su p\u00e1gina web y contiene, entre otras, las Herramientas de implementaci\u00f3n. </p> <p>Tras su instalaci\u00f3n, se accede a trav\u00e9s de Inicio \u2192 Windows Kits \u2192 Administrador de Im\u00e1genes del Sistema de Windows. Se debe disponer de acceso lectura escritura a un fichero de imagen WIM (Windows Imaging Format), por lo que es necesario copiar el contenido de una imagen ISO al disco duro. Una vez copiada, se especifica la ruta de acceso al fichero y se empieza con la edici\u00f3n.</p> <p>Se trata de un programa muy intuitivo que permite integraci\u00f3n de Service Packs, eliminaci\u00f3n de componentes, integraci\u00f3n de controladores, paquetes de software de terceros, configuraci\u00f3n de servicios y parches del sistema, entre otras opciones. Si es necesario, existe un manual de uso elaborado por parte de Microsoft al que poder consultar. Tambi\u00e9n existen utilidades de terceros para realizar esta tarea como nLite que, aunque parezca imposible, su utilizaci\u00f3n es todav\u00eda m\u00e1s sencilla.</p> <p></p> <p>Los sistemas operativos basados en GNU/Linux tambi\u00e9n disponen de herramientas para realizar estas tareas, como Preseed o Kickstart. El primero de ellos surgi\u00f3 de para distribuciones basadas en Debian. Se trata de escribir un gui\u00f3n que se realizar\u00e1 tras el proceso de instalaci\u00f3n del kernel y asociarlo a una imagen ISO de instalaci\u00f3n. Pero \u00faltimamente ,se ha impuesto cloud-init como m\u00e9todo de automatizaci\u00f3n la inicializaci\u00f3n de las instancias de la nube durante el arranque del sistema.</p> <p>Algunos ejemplos de tareas que puede realizar cloud-init son:</p> <ul> <li>Configurar un nombre de host</li> <li>Instalaci\u00f3n de paquetes en una instancia</li> <li>Ejecuci\u00f3n de scripts</li> <li>Suprimir el comportamiento por defecto de la m\u00e1quina virtual</li> </ul> <p><code>cloud-init</code> fue desarrollado inicialmente por Canonical para las im\u00e1genes cloud de Ubuntu usadas por AWS. Desde entonces, la aplicaci\u00f3n ha evolucionado y puede ser usada en otras muchas distribuciones y en otros entornos cloud (y no cloud).</p> <p>Funciona en dos etapas una antes de que se configure la red del sistemas, en esta primera se descubre la fuente de datos, obtiene todos los datos de configuraci\u00f3n de ella y configura la red. Y en la segunda es donde configura la instancia en ejecuci\u00f3n seg\u00fan sus necesidades, seg\u00fan lo especificado en los datos del proveedor y/o datos del usuario.</p> <p>Como hemos podido leer, cloud-init est\u00e1 enfocado en la nube pero en nuestro caso vamos a realizar una ISO en el que se automatiza la instalaci\u00f3n de Ubuntu 22.04. Tambi\u00e9n decir que de la versi\u00f3n 20.04 a la versi\u00f3n que vamos a instalar ha habido cambios y no valdr\u00eda estos pasos.</p>"},{"location":"UD12/04InstalacionDesatendidas/#prerequisitos","title":"Prerequisitos","text":"<p>Necesitamos la ISO de ubuntu 24 de base para nuestra nueva ISO. Por lo que necesitamos los siguientes paquetes que tienes que ser instalados. <code>p7zip</code> que nos servir\u00e1 para descomprimir la ISO de base ( la versi\u00f3n 24 de ubuntu server ) y <code>xorriso</code> que nos sirve para construir la ISO nueva.</p>"},{"location":"UD12/04InstalacionDesatendidas/#creacion-del-entorno","title":"Creaci\u00f3n del entorno.","text":"<p>Crea un directorio para trabajar,y dentro de el otro que se llame <code>source-files</code>. En el directorio de trabajo descarga la iso y descomprimala con el siguiente comando.</p> <pre><code>7z -y x ubuntu.iso -osource-files\n</code></pre> <p>Warning</p> <p>Ten en cuenta que no hay espacio en <code>-osource-files</code></p> <p>En el directorio <code>source-files</code> vemos los archivos ISO m\u00e1s un directorio llamado '[BOOT]'. Ese directorio contiene los archivos <code>1-Boot-NoEmul.img 2-Boot-NoEmul.img</code> que son, respectivamente, las im\u00e1genes de partici\u00f3n mbr (registro de arranque maestro) y efi (UEFI) de la ISO. Estos se utilizar\u00e1n cuando creemos el ISO modificado. Vamos a quitarlos y los movemos al directorio BOOT del directorio de trabajo</p> <pre><code>mv  '[BOOT]' ../BOOT\n</code></pre>"},{"location":"UD12/04InstalacionDesatendidas/#editando-el-grub","title":"Editando el grub","text":"<p>Edita source-files/boot/grub/grub.cfg y a\u00f1adela encima de las entradas del men\u00fa existentes,</p> <pre><code>menuentry \"Autoinstall Ubuntu Server\" {\n    set gfxpayload=keep\n    linux   /casper/vmlinuz quiet autoinstall ds=nocloud\\;s=/cdrom/server/  ---\n    initrd  /casper/initrd\n}\n</code></pre> <p>Si observamos la \u201c\\\u201d delante del punto y coma. Esto es necesario para escapar del \u201c;\u201d, de lo contrario, grub tratar\u00eda el resto de la l\u00ednea como un comentario.</p> <p>Esta entrada del men\u00fa agrega la directiva de autoinstalaci\u00f3n del kernel y la \"fuente de datos\" (ds) para cloud-init de tipo \"nocloud\". s=/cdrom/server/es una referencia al directorio donde agregaremos archivos de datos de usuario y metadatos que contienen la configuraci\u00f3n del instalador yaml. /cdrom es el directorio de nivel superior de la ISO.</p> <p>Antes de crear los ficheros de configuraci\u00f3n de la instalaci\u00f3n, vamos a crear un directorio que se llame <code>server</code> dentro de <code>source-files</code> donde almacenemos estos ficheros.</p>"},{"location":"UD12/04InstalacionDesatendidas/#crear-datos-de-la-instalacion","title":"Crear datos de la Instalaci\u00f3n.","text":"<p>Creamos el fichero meta-data que es obligatorio que est\u00e9 pero que en nuestro caso va a estar vac\u00edo.</p> <pre><code>touch source-files/server/meta-data\n</code></pre> <p>A continuaci\u00f3n, los datos del usuario se pondr\u00e1n en un fichero yaml. Estos ficheros siguen unas reglas especificas . Las podemos ver en esta web.</p> <p>La \u00fanica gu\u00eda en la que podemos basarnos para saber que es lo que podemos poner en este fichero o no est\u00e1 en el siguiente link</p> Ejemplo de archivo user-data<pre><code>#cloud-config\nautoinstall:\n  version: 1\n  interactive-sections:  # Install groups listed here will wait for user input\n   - storage\n  storage:  # This should set the interactive (lvm set) default\n    layout:\n      name: lvm\n      match:\n        size: largest\n  locale: es_ES.UTF-8\n  keyboard:\n    layout: es\n  identity:\n    hostname: Server\n    password: $6$PiTL.ZmMVYG6U4q4$qa8lkOtlAAioKLKqt1q1Ci03HUAE4xRnhrvNd1x1oaSVoma2sTRCHtvt2/QV61tn0QQF6m2e/n0Uf1fQ/3yid0\n    username: ubuntu\n  ssh:\n    allow-pw: true\n    install-server: true\n  apt:\n    primary:\n      - arches: [default]\n        uri: http://us.archive.ubuntu.com/ubuntu/\n #   sources:     # Example for adding a ppa source\n #     ignored1:  # This is here to get the yaml formatting right when adding a ppa\n #       source: ppa:graphics-drivers/ppa\n  packages:\n    - build-essential\n    - network-manager\n    - dkms\n    - emacs-nox\n    # - ubuntu-desktop-minimal^  # uncomment to add a minimal desktop\n  package_update: true\n  package_upgrade: true\n  late-commands:\n    # Changing from networkd to NetworkManager\n    # move existing config out of the way\n    - find /target/etc/netplan/ -name \"*.yaml\" -exec sh -c 'mv \"$1\" \"$1-orig\"' _ {} \\;\n    # Create a new netplan and enable it\n    - |\n      cat &lt;&lt;EOF | sudo tee /target/etc/netplan/01-netcfg.yaml\n      network:\n        version: 2\n        renderer: NetworkManager\n      EOF\n    - curtin in-target --target /target netplan generate\n    - curtin in-target --target /target netplan apply\n    - curtin in-target --target /target systemctl enable NetworkManager.service\n    # Install NVIDIA driver (with apt-get flags)\n    - curtin in-target -- apt-get -y install --no-install-recommends nvidia-driver-520\n  #user-data: # Commands here run during first boot (cannot be interactive)\n  #  runcmd:\n  #    # Install the NVIDIA driver from the ppa we setup earlier\n  #    - [apt-get, install, --yes,  nvidia-driver-510, --no-install-recommends]\n</code></pre> <p>Si hacemos una inspecci\u00f3n del documento anterior tenemos dos partes totalmente separadas. Antes de la instalaci\u00f3n y despu\u00e9s de ella. Una vez realizada la primera parte, con curtin podemos modificar e instalar m\u00f3dulos de hardware o modificar la red.</p>"},{"location":"UD12/04InstalacionDesatendidas/#creacion-de-una-iso","title":"Creaci\u00f3n de una ISO","text":"<p>Ahora es el momento de crear la ISO personalizada pero lo primero que tenemos que hacer es que con el siguiente comando, observar la informaci\u00f3n de como montar la ISO.</p> <pre><code>xorriso -indev ubuntu.iso -report_el_torito as_mkisofs\n</code></pre> <p>Con la anterior informaci\u00f3n vamos a crear nuestra nueva ISO modificada.</p> <pre><code>cd source-files\n\nxorriso -as mkisofs -r \\\n-V 'Ubuntu 24.04 LTS '\\\n -o ../ubuntu-24.04-autoinstall.iso \\\n--grub2-mbr ../BOOT/1-Boot-NoEmul.img \\\n--protective-msdos-label \\\n-partition_cyl_align off \\\n-partition_offset 16 \\\n--mbr-force-bootable \\\n-append_partition 2 28732ac11ff8d211ba4b00a0c93ec93b ../BOOT/2-Boot-NoEmul.img \\\n -part_like_isohybrid \\\n -iso_mbr_part_type a2a0d0ebe5b9334487c068b6b72699c7 \\\n -c '/boot.catalog' \\\n -b 'boot/grub/i386-pc/eltorito.img'\\\n -no-emul-boot -boot-load-size 4\\\n -boot-info-table --grub2-boot-info \\\n-eltorito-alt-boot \\\n-e '--interval:appended_partition_2_start_1342505s_size_10140d:all::' -no-emul-boot \\\n-boot-load-size 10140 \\\n-isohybrid-gpt-basdat \\\n</code></pre> <p>Vamos a destacar dos modificadores. El primero, <code>--grub2-mbr ../BOOT/1-Boot-NoEmul.img</code> que le indica el arranque de la imagen con un sistema mbr y el segundo, <code>-append_partition 2 28732ac11ff8d211ba4b00a0c93ec93b ../BOOT/2-Boot-NoEmul.img \\</code> que le indica que el arranque por UEFI.</p> <p>Ahora solo basta probarla, en una m\u00e1quina virtual por ejemplo.</p>"},{"location":"UD12/Actividades/","title":"Actividades","text":""},{"location":"UD12/Actividades/#introduccion","title":"INTRODUCCI\u00d3N","text":"<ol> <li>Realiza una planificaci\u00f3n de las copias de seguridad de la empresa que generaste con al menos dos copias de seguridad. Debe responder a a las siguiente preguntas:</li> <li>\u00bfQu\u00e9 tipos de copia de seguridad debo utilizar?</li> <li>\u00bfQu\u00e9 ficheros debo incluir en cada una de las copias de seguridad?</li> <li>\u00bfCon qu\u00e9 periodicidad se realizar\u00e1n las copias de seguridad?</li> <li>\u00bfSe realizar\u00e1n de forma autom\u00e1tica o manual?. \u00bfCu\u00e1l ser\u00e1 su programaci\u00f3n?</li> <li>Si falla el sistema, \u00bfen cu\u00e1nto tiempo se podr\u00e1n recuperar las copias?</li> <li>\u00bfEn qu\u00e9 tipo de dispositivos se realizar\u00e1n las copias de seguridad?</li> </ol> <p>Elabora un documento con la planificaci\u00f3n de las copias de seguridad</p> <ol> <li> <p>Instala la caracter\u00edstica Copias de seguridad de Windows Server en ServidorWindows y configura estas dos copias de seguridad. Para ello deber\u00e1s a\u00f1adir dos discos duros de 1 TB al servidor, uno para cada copia</p> <ul> <li>programa una copia de seguridad incremental del sistema operativo que se ejecutar\u00e1 de forma diaria a las 2:00 hora</li> <li>programa una copia incremental de las carpetas Datos y Perfiles cada 4 horas empezando a las 8:00 horas.   !!! warning   si se nota que el rendimiento se resiente, elimina los vol\u00famenes RAID creados con anterioridad y reutiliza esos discos.</li> </ul> <p>Elabora una gu\u00eda con las configuraciones que sigues para realizar esta tarea y, una vez revisada.</p> </li> </ol>"},{"location":"UD12/Actividades/#desarrollo","title":"DESARROLLO","text":"<ol> <li> <p>Utilizando <code>rsync</code>, haz una copia del sistema de ServidorUbuntu en un nuevo volumen contenido en un disco duro instalado a tal efecto. Este nuevo disco estar\u00e1 montado en <code>/media/Seguridad</code> y la copia tendr\u00e1 las siguientes caracter\u00edstica</p> <ul> <li>ser\u00e1n excluidas las carpetas <code>/dev, /proc, /sys, /tmp, /mnt, /swap y /med</code></li> <li>los archivos copiados deben disponer de los mismos permisos y pertenencia a grupo</li> <li>la copia debe estar comprimida</li> <li>se ejecutar\u00e1 todos los d\u00edas a la 2:00 horas</li> </ul> </li> <li> <p>Simula la p\u00e9rdida de datos (borrando alguno de ellos) y recupera las copias de seguridad tanto en ServidorWindows como en ServidorUbuntu. Realiza una peque\u00f1a memoria con los para que sigues para realizar esta tarea.</p> </li> <li>Elimina las copias de seguridad realizadas en los ejercicio anteriores e implanta en ServidorWindows y ServidorUbuntu las copias dise\u00f1adas en la planificaci\u00f3n que has realizado. Detalla los pasos que sigues en un documento y s\u00fabelo al Moodle del m\u00f3dulo cuando lo revises.</li> <li> <p>Crea una imagen del cliente CW1001 con Clonezilla siguiendo los siguientes pasos:</p> </li> <li> <p>instala un nuevo disco duro con capacidad suficiente para contener el volumen C:\\ de esta m\u00e1quina.</p> </li> <li>arranca el sistema y crea una tabla de particiones con una \u00fanica partici\u00f3n primaria</li> <li> <p>inicia la m\u00e1quina virtual con el disco de Clonezilla y crea una imagen total del volumen (no del disco), en el disco que acabas de instalar.   Redacta un documento con los pasos que sigues para realizar este ejercicio. Una vez terminado,</p> </li> <li> <p>Restaura la imagen que acabas de creada siguiendo estos pasos:</p> </li> <li> <p>crea una nueva m\u00e1quina virtual con las mismas caracter\u00edsticas que la anterior</p> </li> <li>conecta el disco duro que contiene la imagen clonada de la m\u00e1quina CW1001</li> <li>restaura la imagen en la nueva m\u00e1quina</li> <li>antes de poner la m\u00e1quina en red, cambia la MAC y la IP de la NIC. Tambi\u00e9n deber\u00e1s cambiar el nombre del equipo seg\u00fan la nomenclatura del dominio</li> <li>ingresa esa nueva m\u00e1quina en el dominio</li> </ol> <p>Escribe una gu\u00eda con los pasos que sigues para realizar esta tarea y s\u00fabela al Moodle del m\u00f3dulo una vez finalizada. 8. Crea una imagen ISO del disco de instalaci\u00f3n de Microsoft Windows 10 Professional con nLite que contenga las siguientes modificaciones:</p> <ul> <li>el \u00faltimo service pack integrado</li> <li>la \u00faltima versi\u00f3n de Mozilla Firefox instalada</li> <li>la configuraci\u00f3n de red sea la establecida para el dominio</li> <li>a\u00f1ade el idioma Catal\u00e1n/Valenciano</li> <li>el particionado del disco principal debe ser autom\u00e1tico (el disco se dividir\u00e1 en dos particiones primarias con un volumen cada una C:\\ y D:)</li> <li> <p>al finalizar el proceso de instalaci\u00f3n deber\u00e1 meterse en el domino de forma autom\u00e1tica   Redacta un documento con los pasos que sigues para realizar este ejercicio.</p> </li> <li> <p>Crea una imagen ISO de Ubuntu Desktop 24.04 personalizada mediante <code>cloud-init</code> con las caracter\u00edsticas descritas en el archivo de configuraci\u00f3n user-data de la teor\u00eda. Comprueba que funciona e instala el sistema operativo. Lo \u00fanica configuraci\u00f3n que deber\u00edas tocar es las de las particiones. Despu\u00e9s de la instalaci\u00f3n se bloquea. \u00bfQue est\u00e1 pasando? (revisa el archivo de configuraci\u00f3n)    !!! note</p> </li> </ul>"},{"location":"UD13/01DeteccionProblemas/","title":"Detecci\u00f3n de problemas de forma local","text":""},{"location":"UD13/01DeteccionProblemas/#registro-de-sucesos","title":"Registro de sucesos.","text":"<p>Es importante para un administrador conocer todo lo que pasa en el sistema. Resulta evidente que a medida que dicho sistema crezca ser\u00e1 imposible el seguimiento de todos los eventos que se generen. Afortunadamente, los sistemas operativos, y otras muchas aplicaciones, guardan detalles de su funcionamiento en unos archivos especiales, llamados registros de eventos, tambi\u00e9n conocidos como bit\u00e1coras o logs, por su nombre en ingl\u00e9s.</p> <p>El objetivo de estos ficheros es contener anotaciones sobre toda su actividad y funcionamiento, sus anomal\u00edas, interferencias con otro software o cualquier otro tipo de informaci\u00f3n que sea rese\u00f1able. Este tipo de ficheros agrupan los registros en funci\u00f3n del tipo de evento que lo haya generado. Cada sistema posee una tipolog\u00eda diferente de sucesos, aunque es posible, al menos, destacar tres tipos de eventos:</p> <ul> <li>de aplicaciones, lanzados por el software instalado en el sistema. No todas las acciones ser\u00e1n registradas, sino aquellas que sean de vital importancia.</li> <li>de sistema, acciones desencadenadas por el sistema operativo. Cualquier acci\u00f3n queda guardada en un fichero de bit\u00e1cora y agrupada, a su vez, a trav\u00e9s de una serie de subcategor\u00edas cuyo n\u00famero y tipolog\u00eda dependen del sistema operativo que las genere.</li> <li>de seguridad, registra toda acci\u00f3n referida con la autenticaci\u00f3n de usuarios, permisos de acceso a recursos, ejecuci\u00f3n de software, acceso a redes, etc\u00e9tera. En definitiva, cualquier acci\u00f3n que pueda suponer un peligro potencial.</li> </ul> <p>Adem\u00e1s de estos tipos de eventos, si el sistema operativo act\u00faa como controlador dentro de una estructura de dominio, tambi\u00e9n registrar\u00e1 los eventos relacionados con el servicio de directorio,la replicaci\u00f3n de archivos, y todos los servicios que tenga implementados, como por ejemplo el DNS o el DHCP.</p> <p>Toda esta cantidad ingente informaci\u00f3n se registra en tiempo real y se guarda en ficheros con formato XML. Afortunadamente los sistemas operativos disponen de herramientas para poder gestionar toda esta informaci\u00f3n de una manera r\u00e1pida y eficaz. En sistemas operativos de Microsoft se dispone del Visor de eventos.</p> <p>Permite consultar y administrar, de una forma potente y centralizada, la informaci\u00f3n contenida en los m\u00faltiples registros de eventos.</p> <p>Se accede a esta herramienta a trav\u00e9s del Administrador del servidor \u2192 Administrador del servidor \u2192 Visor de eventos. La columna de la izquierda contiene una estructura arborescente con cuatro nodos principales</p> <ul> <li>Vistas personalizadas, que permitir\u00e1 elegir una serie de eventos a los que prestaremos especial atenci\u00f3n, incluso es posible indicar que al producirse un evento, desencadene una acci\u00f3n.</li> <li>Registros de Windows, parte fundamental de esta herramienta muestra los eventos del sistema relacionadas con la seguridad, sistema y aplicaci\u00f3n. Se entrar\u00e1 en detalle en lo sucesivo.</li> <li>Registros de aplicaciones, todos los eventos generados por las aplicaciones y servicios del directorio se recogen en esta rama. Desde el panel de administraci\u00f3n del servidor, ya se informa al administrador de forma puntual sobre los posibles eventos de cada uno de los servicios de directorio.</li> <li>Suscripciones, es posible configurar avisos que procedan desde otros equipos del domino. Para ello ser\u00e1 necesario la activaci\u00f3n del servicio de suscripci\u00f3n de eventos. Al crear una suscripci\u00f3n, por defecto activa este servicio tanto en el servidor como en el cliente que se necesite vigilar.</li> </ul> <p>En la rama Registros de Windows se encuentran varios tipos de eventos:</p> <ul> <li>aplicaci\u00f3n, eventos de las aplicaciones y los servicios que no forman parte del sistema.</li> <li>seguridad, eventos relacionados con la seguridad del sistema.</li> <li>instalaci\u00f3n, eventos relativos a la configuraci\u00f3n de roles y caracter\u00edsticas.</li> <li>sistema, eventos del sistema y de sus componentes.</li> </ul> <p>Para ver los eventos de diferentes tipos, bastar\u00e1 con pinchar sobre cada categor\u00eda y se filtrar\u00e1n por tipo. </p> <p>En la rama Vista personalizada se presenta la informaci\u00f3n separada en dos ramas bien diferenciadas; la que hace referencia a los Eventos administrativos del sistema y las que lo hacen de los Roles de servidor, en donde la informaci\u00f3n se agrupar\u00e1 por roles y caracter\u00edsticas.</p> <p>A\u00fan as\u00ed, la informaci\u00f3n registrada es ingente y el administrador puede perderse en la b\u00fasqueda de un dato en concreto. Por ese motivo se ha implementado la creaci\u00f3n de vistas predeterminadas que no son otra cosa que aplicar filtros para limitar los resultados de tal modo que resulte sencillo encontrar el registro buscado.</p> <p>A trav\u00e9s del men\u00fa Acci\u00f3n \u2192 Crear vista personalizada\u2026 el cual permite filtrar por el momento en el que se ha registrado el evento, el nivel al que se ha producido (cr\u00edtico, advertencia, error entre otros), por qu\u00e9 parte del registro se ha producido o qu\u00e9 software ha producido el evento e incluso es posible excluir ciertos eventos a trav\u00e9s de su ID, si son de cierto usuario o han sido realizados en alg\u00fan equipo determinado. Es posible ajustar la b\u00fasqueda hasta que encontrar el registro sea trivial.</p> <p>Una vez configurada convenientemente la b\u00fasqueda, el asistente solicitar\u00e1 un nombre y lugar en d\u00f3nde guardar la vista. De esta forma se dispondr\u00e1 de un r\u00e1pido acceso a ella.</p>"},{"location":"UD13/01DeteccionProblemas/#creacion-de-una-vista-personalizada","title":"Creaci\u00f3n de una vista personalizada","text":"<p>Por ejemplo, uno de los eventos que se suelen tener en cuenta es las veces que se intenta el inicio de sesi\u00f3n en el dominio. Es posible crear una vista que contenga tan s\u00f3lo los eventos de esta subcategor\u00eda. Para ello se crea una nueva vista personalizada con los siguientes par\u00e1metros:</p> <ul> <li>En la opci\u00f3n Registrado, se elegir\u00e1 el intervalo de tiempo en el que se registran todos los eventos del tipo seleccionado. Es posible seleccionar una fecha espec\u00edfica. En este ejemplo se elegir\u00e1n los \u00faltimos 7 d\u00edas.</li> <li>Nivel de evento se elegir\u00e1 Advertencia y Error ya que son los de eventos que nos interesa registrar. Si no se tiene muy claro a qu\u00e9 tipo de evento pertenece la acci\u00f3n que se pretende registrar, no se marcan ninguna opci\u00f3n, de este modo se contemplar\u00e1n todas. Ya habr\u00e1 tiempo para filtrar despu\u00e9s.</li> <li>El origen del evento ser\u00e1 lanzado por el servicio Microsoft Windows security auditing, por lo que ser\u00e1 necesario elegir el registro Por origen y no Por registro, ya que no interesa un registro de un tipo espec\u00edfico, sino los lanzados desde un servicio determinado. En Or\u00edgenes del evento se marca el servicio mencionado antes. N\u00f3tese que de forma autom\u00e1tica el Registro de eventos marca Seguridad, ya que es el tipo de evento al que pertenecen los eventos que lanza este servicio.</li> <li>Si se conoce el ID del evento, es posible colocarlo en la casilla de inclusi\u00f3n de identificadores. Si no se conoce, es recomendable dejarlo en blanco, de este modo se registrar\u00e1n todos los eventos de la categor\u00eda elegida con anterioridad. Cuando se conozca el ID del evento, se podr\u00e1 editar la vista personalizada.</li> <li>En la opci\u00f3n Categor\u00eda de la tareas se ofrecen todas las tipolog\u00edas de eventos relacionadas con el origen de evento seleccionado en el apartado anterior. Se marcar\u00e1 Inicio de sesi\u00f3n que es la que interesa en este ejemplo. Es posible incluir varias de ellas si fuese necesario.</li> <li>Adem\u00e1s de todos estos filtros, es posible a\u00f1adir Palabras clave, los Usuarios a los que afecta y los Equipos en donde se producen. En este ejemplo no se indicar\u00e1 palabra clave alguna y se auditar\u00e1n todos los usuarios y todos los equipos.</li> </ul> <p>Para finalizar el nombre de la vista ser\u00e1 Intentos de Inicio y su ubicaci\u00f3n por defecto. Esto crear\u00e1 una nueva vista personalizada que aparecer\u00e1 en el panel de la izquierda del administrador de eventos.</p> <p></p> <p>Otra de las caracter\u00edsticas interesantes que ofrece esta aplicaci\u00f3n es la de vincular una tarea cuando se produzca un evento determinado. As\u00ed por ejemplo es posible ejecutar un programa, enviar un mensaje de correo electr\u00f3nico o mostrar una alerta. Bastar\u00e1 con ir al men\u00fa Acci\u00f3n \u2192 Adjuntar tarea a esta vista personalizada\u2026, el cual lanzar\u00e1 un asistente que permitir\u00e1 especificar que acci\u00f3n se necesita realizar y c\u00f3mo. Esta opci\u00f3n cobra especial inter\u00e9s si se ha creado un script de terminal o de PowerShell con acciones a seguir para tratar este evento.</p>"},{"location":"UD13/01DeteccionProblemas/#sucesos-en-gnulinux","title":"Sucesos en GNU/Linux","text":"<p>En los sistemas operativos basados en GNU/Linux, si no se especifica lo contrario, todos los archivos de bit\u00e1cora o logs se encuentran en el directorio <code>/var/log</code>. En versiones antiguas de este sistema operativo, era el demonio <code>syslogd (Syslog Daemon)</code> el que se encargaba de guardar informaci\u00f3n sobre el funcionamiento del sistema.</p> <p>En la actualidad y, desde la versi\u00f3n de Ubuntu Server 14.04, se utiliza una versi\u00f3n mejorada de syslogd denominada <code>rsyslogd</code>. Esta versi\u00f3n ofrece posibilidades multhilado, acceso a bases de datos para guardar la informaci\u00f3n y una salida de datos altamente configurable.</p> <p>Alguno de los registros m\u00e1s importantes que vigila <code>rsyslogd</code> son:</p> <ul> <li>auth y authpriv, informaci\u00f3n relativa a autorizaciones y seguridad (anteriormente esta tipolog\u00eda se llamaba security).</li> <li>cron, mensajes sobre demonios de programaci\u00f3n de tareas como <code>cron o anacrom</code>.</li> <li>daemon, mensaje sobre otros procesos del sistema.</li> <li>ftp, lpr, mail, news entre otros, informaci\u00f3n referida a cada uno de estos servicios.</li> <li>kern, mensajes referidos al n\u00facleo del sistema operativos.</li> <li>user, datos sobre aplicaciones de terceros. Si se analiza el contenido de la carpeta <code>/var/log</code>se observa que existen varios ficheros con id\u00e9ntico nombre a estas categor\u00edas pero con extensi\u00f3n log. En ellos estar\u00e1n contenida la informaci\u00f3n que estos procesos o demonios generen; por ejemplo <code>auth.log o kern.log</code>. Tambi\u00e9n es posible observar como existen otros como apt o dpkg.log que recopilan informaci\u00f3n sobre las acciones realizadas sobre los programas instalados.</li> </ul> <p>El formato de un archivo de bit\u00e1cora es aproximadamente el mismo, aunque existen diferencias en funci\u00f3n del proceso que lo origina. Es necesario conocer este formato antes de poder analizar su contenido, por ejemplo la estructura del fichero auth.log est\u00e1 compuesta por la fecha y hora del suceso, nombre del equipo donde se ha producido, el programa o servicio que lo ha originado (acompa\u00f1ado por su PID de forma opcional) y un mensaje que describe el suceso.</p> <p>La configuraci\u00f3n de <code>rsyslogd</code> se encuentra definido en el archivo <code>/etc/rsyslog.conf</code>, aunque algunas opciones tambi\u00e9n se establecen en <code>/etc/rsyslog.d/</code>. Es posible modificar estos archivos para cambiar dicho comportamiento, pero su explicaci\u00f3n se escapa de los objetivos de este texto.</p> <p>Como siempre ocurre en los sistemas operativos GNU/Linux, existe una opci\u00f3n a trav\u00e9s del terminal que ofrece un sinf\u00edn de posibilidades para la consulta de estos registros. Para ello se utilizar\u00e1 la aplicaci\u00f3n <code>logcheck</code> que facilita la consulta a los ficheros de bit\u00e1cora, los analiza y ofrece informaci\u00f3n procesada. Esta tarea se realiza de forma peri\u00f3dica, por lo que el administrador podr\u00e1 despreocuparse de generar esta informaci\u00f3n.</p> <p>El resultado es un documento m\u00e1s sencillo de leer y dividido en tres categor\u00edas de seguridad ordenadas de mayor a menor importancia: Active system attacks, Security violations y Usual activity.</p> <p>Para realizar estas tareas ser\u00e1 necesario</p> <pre><code>instalar la aplicaci\u00f3n logcheck\nsudo apt-get install logcheck\n</code></pre> <p>Durante el proceso de instalaci\u00f3n, es necesario configurar el modo en el que logcheck se comunica con el administrador. La forma est\u00e1ndar es configurando una direcci\u00f3n de correo electr\u00f3nico externa para recibir el documento procesado en ese buz\u00f3n. Existen otras posibilidades como correo interno de la red local o dejarlo sin configurar, en tal caso guardar\u00eda estos ficheros en memoria secundaria. Tambi\u00e9n pide el nombre de host del equipo para identificar los informes por equipo, el cual se recomienda no cambiar.</p> <p>Una vez terminada la instalaci\u00f3n, es necesario crear el archivo de configuraci\u00f3n a trav\u00e9s de una plantilla contenida en el fichero <code>logcheck.conf.dpkg-new</code> el cual habr\u00e1 que copiar</p> <pre><code>sudo cp /etc/logcheck/logcheck.conf.dpkg-new /etc/logcheck/logcheck.conf\n</code></pre> <p>dotarlo de permisos de lectura y escritura</p> <pre><code>sudo cdmod 664 /etc/logcheck/logcheck.conf\n</code></pre> <p>Y ahora editar estas l\u00edneas del fichero. La primera la que hace referencia al correo electr\u00f3nico donde se enviar\u00e1 la informaci\u00f3n,</p> <p><code>SENDMAILTO=\u201dadministradorFeo@gamil.com\u201d</code> otra para especificar que los informes se enviar\u00e1n como adjuntos al mensaje <code>MAILASATTACH=1</code> y esta que hace referencia al nivel del informe que ser\u00e1 enviado <code>REPORTLEVEL=\u201dparanoid\u201d</code></p> <p>Esta \u00faltima l\u00ednea soporta varias opciones como server, configuraci\u00f3n por defecto y que ofrece informaci\u00f3n aceptable, paranoid en donde la informaci\u00f3n m\u00e1s relevante es la de seguridad y workstation, una buena opci\u00f3n si se trabaja con estaciones de trabajo clientes de un dominio.</p> <p>Existen otras muchas m\u00e1s l\u00edneas de configuraci\u00f3n, pero escapan al objetivo de este texto. Por defecto, logcheck comprueba las bit\u00e1coras /<code>var/log/syslog y /etc/log/auth.log</code>. Si es necesario incluir m\u00e1s ficheros de bit\u00e1cora al proceso de an\u00e1lisis ser\u00e1 necesario incluirlos en <code>/etc/logcheck/logcheck.logfiles</code>. De igual modo que en el caso del fichero anterior, ser\u00e1 necesario crear una copia desde el fichero plantilla /etc/logcheck/logcheck.logfiles.dpkg-new y asignarle los permisos de escritura lectura. Una vez realizada esta acci\u00f3n, se a\u00f1ade la direcci\u00f3n del fichero de bit\u00e1cora que se necesite analizar</p> <pre><code>sudo echo \u201c#Fichero a\u00f1adido de forma manual\u201d &gt;&gt;/etc/logcheck/logcheck.conf\n\nsudo echo \u201c/etc/var/dpkg.log\u201d &gt;&gt;/etc/logcheck/logcheck.conf\n</code></pre> <p>Con este comando, se a\u00f1aden l\u00edneas al final del fichero /etc/logcheck/logcheck.conf, ahorr\u00e1ndose as\u00ed tener que usar un editor de textos.</p> <p>Si tratamos de lanzar la aplicaci\u00f3n, ahora que ya est\u00e1 configurada, se obtiene la siguiente advertencia</p> <pre><code>logcheck should not be run as root. Use su to invoke logcheck:\n</code></pre> <p>la cual se soluciona lanzando la aplicaci\u00f3n a trav\u00e9s del usuario <code>logcheck</code>, creado durante el proceso de instalaci\u00f3n para gestionar esta aplicaci\u00f3n. Esta es una pr\u00e1ctica muy com\u00fan entre los desarrolladores de software para GNU/Linux, de este modo se deja al margen al usuario root, cuyo uso puede ser un peligro, como ya se ha visto con anterioridad. Por tanto, lanzamos la aplicaci\u00f3n utilizando la opci\u00f3n -u de sudo.</p> <p>Al instalarse esta aplicaci\u00f3n, el demonio cron.d establece una periodicidad de los informes de una hora, configuraci\u00f3n que es posible cambiar modificando las caracter\u00edsticas de crontab, como se ha visto en otras unidades.</p> <pre><code>sudo -u logcheck logcheck\n</code></pre> <p>Warning</p> <p>Si el terminal informa que no existe el usuario logcheck, se deber\u00e1 crear con el comando <code>sudo adduser logcheck</code>. Adem\u00e1s hay que estar seguro que el servicio de correo sendmail est\u00e1 debidamente configurado.</p>"},{"location":"UD13/02SupervisionRendimiento/","title":"Monitorizaci\u00f3n del rendimiento del sistema","text":"<p>Es posible definir el concepto rendimiento como la rapidez con la que un equipo realiza las tareas para las que fue dise\u00f1ado, tanto relacionadas con el sistema, como aplicaciones y servicios. Este rendimiento del sistema estar\u00e1 limitado por diferentes aspectos:</p> <ul> <li>la velocidad del procesador,</li> <li>la cantidad y velocidad de la memoria principal,</li> <li>la velocidad de los dispositivos de almacenamiento externo y</li> <li>la velocidad de las interfaces de red.</li> </ul> <p>Implantar un sistema de vigilancia es importante porque:</p> <ul> <li>son el complemento necesario para la administraci\u00f3n de sistemas.</li> <li>se dispone de alarmas que avisan cuando algo no funciona bien.</li> <li>permite detectar el origen de las incidencias.</li> <li>genera estad\u00edsticas que dar\u00e1n una visi\u00f3n de las necesidades del sistema y como anticiparlas.</li> </ul> <p>Todo proceso de monitorizaci\u00f3n y administraci\u00f3n de sistemas comienza por un estudio previo de las necesidades, es decir, contestar a la pregunta \u00bfqu\u00e9 y c\u00f3mo debo vigilar?. La respuesta a esta pregunta facilita la creaci\u00f3n de un plan de monitorizaci\u00f3n del sistema, aunque el plan ideal es aquel que engloba la observaci\u00f3n de todo el sistema en conjunto.</p> <p>Es preciso realizar una prueba del rendimiento del sistema inmediatamente despu\u00e9s de la instalaci\u00f3n y configuraci\u00f3n. Una vez medido, cuando instalemos un servicio, programa, hardware o sencillamente cambiemos una configuraci\u00f3n, es recomendable volver a ejecutar la prueba de rendimiento para compararla con la anterior y comprobar as\u00ed c\u00f3mo ha afectado el cambio al sistema.</p> <p>Es necesario ajustar las observaciones por costes de tiempo y consumo de recursos. En efecto, el hecho de observar el sistema no debe ser una interferencia para el funcionamiento del mismo. Es perentorio encontrar un compromiso entre observaci\u00f3n y consumo de recursos. De cualquier otro modo el funcionamiento del sistema puede verse degradado por el sistema de control y observaci\u00f3n.</p> <p>Tambi\u00e9n es importante que los datos que se recojan se encuentren sintetizados y ordenados de manera que sea sencilla su interpretaci\u00f3n. De nada sirve una ingente cantidad de informaci\u00f3n si no es posible sintetizarla de manera r\u00e1pida y eficaz. Para ello se cuenta con gr\u00e1ficos, informes e histogramas que facilitan la interpretaci\u00f3n de los datos.</p>"},{"location":"UD13/02SupervisionRendimiento/#herramientas-de-monitorizacion-en-tiempo-real-y-continuada-local","title":"Herramientas de monitorizaci\u00f3n: en tiempo real y continuada (local)","text":"<p>Existen numerosas herramientas para realizar estas tareas, pero este secci\u00f3n se centra en las que se encuentran disponibles en los sistemas operativos de forma nativa. Los sistemas operativos de Microsoft han contado de forma tradicional con el Monitor de rendimiento el cual ofrece un resumen en tiempo real del estado del equipo. M\u00e1s reciente es el Monitor de recursos, que ofrece informaci\u00f3n mucho m\u00e1s pormenorizada sobre diferentes aspectos del sistema.</p> <p></p> <p>El monitor de rendimiento de Microsoft Windows Server 2016 permite comprobar c\u00f3mo est\u00e1 afectando los programas en ejecuci\u00f3n al rendimiento del sistema inform\u00e1tico, ofreciendo datos que permiten ser analizados en tiempo real o almacenados para su an\u00e1lisis posterior. A esta herramienta se accede desde  Administrador del servidor \u2192 Herramientas \u2192 Monitor de rendimiento.</p> <p>Estas herramientas ofrecen utilidades que permiten la supervisi\u00f3n, an\u00e1lisis del sistema, recogida de datos y sintetizar la informaci\u00f3n en informes. Adem\u00e1s, su GUI permite personalizar la recogida de datos de rendimiento y sesiones de seguimiento de eventos. Para poder realizar todas estas actividades, huelga decir que el  Monitor de rendimiento  debe ejecutarse desde un usuario que pertenezca al grupo Administradores. No obstante, si es necesario crear Conjuntos de recopiladores de datos, ver informes o configurar los registros, es posible usar cualquier usuario contenido en el grupo incorporado Usuarios del registro de rendimiento.</p>"},{"location":"UD13/02SupervisionRendimiento/#supervisar-una-actividad-concreta","title":"Supervisar una actividad concreta","text":"<p>Una de las ventajas de esta herramientas es que no s\u00f3lo permite la observaci\u00f3n de todo el sistema, sino que permite la vigilancia detallada de un elemento sospechoso. Es posible a\u00f1adir contadores al gr\u00e1fico de evoluci\u00f3n para poder visualizar ya no s\u00f3lo un elemento hardware del equipo, sino tambi\u00e9n software.</p> <p></p> <p>En efecto, esta aplicaci\u00f3n permite la supervisi\u00f3n de un proceso o servicio y adem\u00e1s de forma pormenorizada, analizando el consumo de RAM, acceso a la memoria secundaria o uso del procesador o utilizaci\u00f3n de las interfaces de red.</p> <p>Otra de las caracter\u00edsticas de esta utilidad que resulta enormemente interesante, es la de poder registrar estos datos en cualquier equipo del dominio. Para ello tan s\u00f3lo ser\u00e1 necesario la selecci\u00f3n del equipo a trav\u00e9s del men\u00fa Examinar...</p> <p>Para agregar una actividad de este tipo ser\u00e1 suficiente con pulsar en el bot\u00f3n de la cruz verde (tal y como se indica en la Figura ) y elegir qu\u00e9 actividad y sobre qu\u00e9 elemento es necesario realizar el seguimiento. Es posible realizar este proceso tantas veces como sea necesario para obtener el resultado deseado.</p> <p></p> <p>Cada vez que se incluya una actividad, \u00e9sta se a\u00f1adir\u00e1 al gr\u00e1fico inicial de la herramienta, donde puede ser analizado. Si este gr\u00e1fico contiene demasiada informaci\u00f3n es posible editar el estilo a trav\u00e9s de la leyenda en la parte inferior. Adem\u00e1s se pueden a\u00f1adir, quitar o editar nuevos elementos al gr\u00e1fico desde los iconos de la parte superior.</p> <p>Otro de los aspectos interesantes de esta herramienta es la posibilidad de cambiar el tipo de gr\u00e1fico. Resulta evidente que esto va a depender del tipo de informaci\u00f3n que se necesite monitorizar.</p>"},{"location":"UD13/02SupervisionRendimiento/#crear-un-recopilador-de-datos","title":"Crear un Recopilador de datos","text":"<p>Tras haber a\u00f1adido las actividades al monitor de recursos, es muy probable que en un futuro se requiera volver a supervisar estos datos para comprobar si todo sigue con normalidad. Para esta tarea es posible crear un recopilador de datos y guardarlo para cuando sea necesario su consulta. Para crear un nuevo Conjunto de recopiladores de datos, el primer paso ser\u00e1 disponer de los contadores adecuados a la medici\u00f3n y guardarlos como un conjunto de recopiladores de datos, que se podr\u00e1 utilizar en lo sucesivo. Se accede a trav\u00e9s del men\u00fa Acci\u00f3n \u2192 Crear nueva Vista personalizada\u2026</p> <p>Esta acci\u00f3n disparar\u00e1 un asistente que preguntar\u00e1 el nombre del conjunto de datos, el lugar donde se guardar\u00e1 y el usuario con el cual se lanzar\u00e1 por defecto. El usuario que lance la monitorizaci\u00f3n es de vital importancia ya que no todos los usuarios disponen de acceso a este recurso. Ser\u00e1 recomendable que el usuario pertenezca al grupo administradores o al de Usuarios del registro de rendimiento, como ya se ha mencionado. Una vez guardado el conjunto, se podr\u00e1 acceder a \u00e9l en la secci\u00f3n Conjunto de recopilaciones de datos \u2192 Definido por el usuario. Desde aqu\u00ed es posible su activaci\u00f3n, detenci\u00f3n o edici\u00f3n, si ya no cumple con los objetivos para los que fue dise\u00f1ado.</p> <p>Otra de las caracter\u00edsticas interesantes de esta herramienta es la programaci\u00f3n de la ejecuci\u00f3n de los conjuntos de recopiladores de datos. En efecto es posible planificar la observaci\u00f3n de un determinado elemento del sistema en un intervalo de tiempo concreto donde se sospecha que se produce alg\u00fan error o para comprobar su rendimiento en plena carga, o para aquello para lo que haya sido dise\u00f1ada la observaci\u00f3n. La programaci\u00f3n se realiza a trav\u00e9s de las propiedades del Conjunto de recopiladores de datos, tal y como se muestra en la Figura 5. Desde all\u00ed se podr\u00e1 establecer una intervalo de fechas, una duraci\u00f3n m\u00e1xima de la observaci\u00f3n, o incluso ejecutar una tarea tras finalizar la observaci\u00f3n, si as\u00ed se requiere. El objeto final de estas observaciones es la recolecci\u00f3n de datos para su posterior an\u00e1lisis, por lo que prestar atenci\u00f3n a c\u00f3mo y d\u00f3nde se guardan estos datos es de vital importancia. Para poder modificar el modo en el que el Conjunto de recopiladores de datos guarda la informaci\u00f3n, hay que dirigirse al conjunto, seleccionarlo y acceder al men\u00fa Acci\u00f3n \u2192 Administrador de datos\u2026 Desde aqu\u00ed ser\u00e1 posible determinar aspectos como el espacio m\u00ednimo del sistema para que la tarea se ejecute, el n\u00famero m\u00e1ximo de subcarpetas que se crear\u00e1n de forma autom\u00e1tica, el nombre del archivo o archivos de informe que se genera, reserva de espacio, tama\u00f1o m\u00e1ximo y acciones a realizar si se superan estos l\u00edmites. Por ejemplo, una de estas reglas es que cuando del archivo supere el tama\u00f1o m\u00e1ximo determinado, \u00e9ste se copie en un fichero CAB (Cabinet, archivo que contiene los datos de registro sin procesar y comprimidos) o sea eliminado. Como siempre, depender\u00e1 de los objetivos de observaci\u00f3n que se persigan. 15.1.4 Consulta de los datos de rendimiento La creaci\u00f3n de estos conjuntos de observaci\u00f3n y los datos que generan tienen como objetivo la consulta y an\u00e1lisis de los datos para comprobar si todo funciona de forma correcta. Para esto, tambi\u00e9n se utiliza el Monitor de rendimiento. La primera tarea ser\u00e1 detener todas las recopilaciones de datos que est\u00e9n en marcha a trav\u00e9s del men\u00fa Conjuntos de recopiladores de datos \u2192 Detener. Tras esto, en la secci\u00f3n Informes \u2192 Definido por el usuario aparecer\u00e1n los conjuntos que se han definido y ser\u00e1 posible consultar los datos recopilados. 15.1.5 Conjuntos de recopilaciones de datos de sistema Adem\u00e1s de poder configurar las observaciones que el administrador del sistema cree oportunas, esta aplicaci\u00f3n tare consigo una serie de informes por defecto que se utilizan para la comprobaci\u00f3n de rendimiento y realizar diagn\u00f3sticos del sistema. En el men\u00fa Conjuntos de recopiladores de datos \u2192 Sistema se encuentran los informes que trae por defecto, como el System Diagnostics (Diagn\u00f3stico del sistema) y el System Performance (Rendimiento del sistema). No obstante, el n\u00famero de informes que aqu\u00ed aparezcan depender\u00e1 de los roles y caracter\u00edsticas de los que disponga el equipo. De este modo, en este equipo debe aparecer Active Directory Diagnostics ya que posee las herramientas para gestionar un servicio de directorio y ha sido promocionado. Para lanzar cual quiera de estos informes, es suficiente con resaltarlos y dirigirse al men\u00fa Acci\u00f3n \u2192 Iniciar. Cuando el informe est\u00e9 preparado, aparecer\u00e1 en la secci\u00f3n de Informes \u2192 Sistema \u2192 System Diagnostics. La duraci\u00f3n de la ejecuci\u00f3n del informe depender\u00e1 del informe elegido, pero oscila entre sesenta y trescientos segundos. El resultado es un informe completo del sistema mostrando aspectos tanto de hardware como de software y espec\u00edficamente en los dispositivos que m\u00e1s afectan al rendimiento: procesador, memoria principal y dispositivos de red. Aunque no de forma muy profusa,</p>"},{"location":"UD2/Actividades/","title":"Actividades de la UD2","text":""},{"location":"UD2/Actividades/#actividad-1-introduccion-terminal","title":"Actividad 1. Introducci\u00f3n Terminal","text":"<p>Accede al Moodle del m\u00f3dulo y realiza la RELACI\u00d3N 2-I de ejercicios de comandos que all\u00ed se detallan.</p>"},{"location":"UD2/Actividades/#actividad-2-desarrollo-de-la-terminal","title":"Actividad 2. Desarrollo de la terminal","text":"<p>Accede al Moodle del m\u00f3dulo y realiza la RELACI\u00d3N 2-II de ejercicios de comandos que all\u00ed se detallan. Escribir los comandos y enviarlos,a posteriori yo los corregir\u00e9. Para hacer este cuestionario ten\u00e9is s\u00f3 45 minutos.</p>"},{"location":"UD2/Actividades/#actividad-3-describe","title":"Actividad 3. Describe","text":"<p>Describe, de forma resumida, cu\u00e1les son las funciones de cada carpeta en el modelo Filesystem Hierarchy Standard utilizado por los sistemas operativos GNU/Linux, y su correlaci\u00f3n (si existiese) con los sistemas operativos de MIcrosoft.</p>"},{"location":"UD2/Actividades/#actividad-4-desarrollo","title":"Actividad 4. Desarrollo","text":"<ol> <li>Los servidores cuentan con varios discos duros instalados en la unidad anterior. En los segundos discos de los SOR, crea una tabla de partici\u00f3n MBR con tres particiones de aproximadamente el mismo tama\u00f1o cada una. En Microsoft Windows Server realiza esta tarea a trav\u00e9s de GUI y en Ubuntu Server con CLI y el comando <code>fdisk</code>.</li> <li>Asigna un sistema de ficheros adecuado a cada partici\u00f3n. Recuerda que en Ubuntu Server ser\u00e1 necesario realizar esta tarea a trav\u00e9s de CLI con el comando <code>mkfs</code>.</li> <li>Monta las particiones creadas en el punto anterior en las carpetas Datos, Perfiles y Cifrado. Crea las carpetas donde estimes oportuno. Esta configuraci\u00f3n se realizar\u00e1 tanto en GNU/Linux como en Microsoft Windows.</li> <li>Realiza los cambios necesarios para que las carpetas citadas en el ejercicio anterior se monten de forma autom\u00e1tica durante el arranque de Ubuntu Server. Para ello deber\u00e1s modificar el fichero fstab.</li> <li>Modifica el gestor de arranque del sistema operativo Ubuntu Desktop para que tan s\u00f3lo ofrezca dos opciones de arranque; Arrancar el sistema con Ubuntu y Prueba de memoria. Las opciones deben tener estos nombres por pantalla.</li> </ol>"},{"location":"UD2/Actividades/#actividad-5-dual","title":"Actividad 5. Dual","text":"<ol> <li> <p>En esta pr\u00e1ctica se van a instalar dos sistemas operativos en una misma m\u00e1quina virtual (y disco duro). Debemos crear un sistema de arranque que nos permita elegir el sistema operativo con el que deseamos arrancar nuestro equipo. Para ello, sigue los pasos que se describen a continuaci\u00f3n. 1. Crea una m\u00e1quina virtual denominada \u201cDual\u201d que tenga un disco duro virtual de 1 TB en expansi\u00f3n din\u00e1mica, y una memoria principal de 1024 MB:</p> </li> <li> <p>Particiona el disco para contener un sistema operativo cliente de Microsoft, uno basado en GNU/Linux y dos particiones de datos, con los nombres DOCUMENTOS y EXPEDIENTES que podr\u00e1n ser accedidas sea cual sea el sistema operativo que se arranque. Crea un esquema con las particiones, su tama\u00f1o y el sistema de archivos que se usar\u00e1 en cada caso. El particionado se realizar\u00e1 con el sistema MBR.</p> </li> <li> <p>Instala los sistemas operativos en el siguiente orden: Microsoft Windows 10 Professional o Microsoft Windows 7 Professional y Ubuntu Desktop.</p> </li> <li>Al finalizar la instalaci\u00f3n, debe quedar un men\u00fa de inicio con varios sistemas operativos. Recuerda que si pulsas la tecla ESC durante el arranque de la m\u00e1quina virtual, podr\u00e1s acceder al men\u00fa GRUB.</li> <li>Una vez instalados los sistemas operativos en el mismo disco duro, modifica el GRUB de para que el sistema operativo a iniciar por defecto sea el de Microsoft y que espere 15 segundos antes de iniciarlo. Realiza esta tarea en CLI.</li> </ol>"},{"location":"UD2/Actividades/#actividad-6-de-ampliacion","title":"Actividad 6. De Ampliaci\u00f3n","text":"<p>Conecta un nuevo disco duro a la m\u00e1quina que contiene el sistema operativo de red Ubuntu Server. Su tama\u00f1o ser\u00e1 de 1TB y de expansi\u00f3n din\u00e1mica. A trav\u00e9s del CLI, realiza las siguientes tareas:</p> <ul> <li>Crea dos particiones primarias; la primera con 700 GB y el resto con 300 GB de capacidad (valores aproximados)</li> <li> <p>Haz que la primera partici\u00f3n creada contenga los directorios personales de usuario. Para ello sigue este procedimiento:</p> </li> <li> <p>Crea un directorio temporal <code>/mnt/home_temporal</code> y monta en ella el primer volumen creado.</p> </li> <li>Copia todos los ficheros del <code>/home</code> actual al directorio temporal <code>/mnt/home_temporal</code>. Comprueba que la copia de los archivos se ha realizado correctamente, incluyendo los permisos correspondientes. Consulta la ayuda del comando cp para usar un modificador que mantenga los atributos de archivo.</li> <li>Desmonta el directorio temporal <code>/mnt/home_temporal</code></li> <li> <p>Edita el archivo fstab para incluir el nuevo punto de montaje de <code>/home</code></p> </li> <li> <p>Repite los pasos anteriores para la carpeta <code>/tmp</code> en la segunda partici\u00f3n. En esta ocasi\u00f3n no ser\u00e1 necesaria la copia de ficheros al tratarse de archivos temporales.</p> </li> </ul>"},{"location":"UD2/Actividades/#actividad-7-de-refuerzo","title":"Actividad 7. De Refuerzo","text":"<ol> <li> <p>En este ejercicio se va a crear un repositorio de almacenamiento para las publicaciones de la empresa que, m\u00e1s tarde, ser\u00e1 compartido a todos los usuarios del directorio. Para ello sigue los pasos que se detallan a continuaci\u00f3n:</p> </li> <li> <p>A\u00f1ade un nuevo disco duro a la m\u00e1quina virtual que contiene el sistema operativo UbuntuServer. Debe ser de 500 GB, de expansi\u00f3n din\u00e1mica y a\u00f1adido al controlador SATA.</p> </li> <li>Crea una partici\u00f3n primaria con el sistema GPT. Para esta tarea usa el comando <code>fdisk</code> y sigue las instrucciones que se detallan en el asistente. Una vez creada, asigna el sistema de ficheros ext4 con el comando mkfs. Consulta la ayuda de este comando si no recuerdas c\u00f3mo hacerlo.</li> <li>Crea la carpeta publicaciones en el directorio /mnt/Publicaciones. Para ello usa el comando <code>mkdir</code>. Recuerda que deber\u00e1s hacer estas tareas con una cuenta con permisos de administraci\u00f3n.</li> <li>Monta la partici\u00f3n reci\u00e9n creada en la carpeta /mnt/Publicaciones con el comando <code>mount</code>. Comprueba que tienes acceso.</li> <li>Edita el fichero fstab para que el montaje sea permanente. Para ello abre el fichero con el comando</li> </ol> <pre><code>sudo nano /etc/fstab/\n</code></pre> <p>y a\u00f1ade al final la l\u00ednea de texto</p> <pre><code>  /dev/sdc1 /mnt/Publicaciones ext4 defaults 0 2\n</code></pre> <p>Explica qu\u00e9 significa cada una de las palabras que has escrito en este fichero.</p> <ul> <li> <p>Reinicia el equipo y comprueba que la configuraci\u00f3n funciona de forma correcta con el comando <code>lsblk</code>.</p> </li> <li> <p>Edita el fichero /etc/default/grub de la m\u00e1quina virtual \u201cDual\u201d para realizar estos cambios:</p> </li> <li> <p>Abre el fichero con el editor de texto nano y busca la l\u00ednea GRUB_DEFAULT=0. Sustituye el cero por un 3. \u00bfQu\u00e9 significa esta configuraci\u00f3n?. \u00bfQu\u00e9 n\u00famero se deber\u00eda colocar para que el primer sistema operativo en arrancar sea el de Microsoft?.</p> </li> <li>Modifica la linea GRUB_TIMEOUT=10 por GRUB_TIMEOUT=5. \u00bfQu\u00e9 quiere decir esta configuraci\u00f3n?. \u00bfQu\u00e9 n\u00famero debo colocar si quisiera no esperar nada para el inicio de la secuencia de arranque?.</li> <li>Reinicia la m\u00e1quina y comprueba que los cambios han surtido efecto.</li> </ul> <p>Manera de entrega de las actividades</p> <p>Redacta una gu\u00eda de los pasos a seguir para realizar esta actividad y s\u00fabela al Moodle del m\u00f3dulo.   De tal forma que en cada uno de los pasos incluya una imagen que verifique que se ha realizado aquello que se pide en cada uno de los ejercicios. Como en las anteriores actividades</p> <p>Warning</p> <p>SOLO LAS ACTIVIDADES 1,2,3,4,5 SON OBLIGATORIAS.. No se puede utilizar comandos no vistos en la teor\u00eda a no ser que en el ejercicio lo indique.</p>"},{"location":"UD2/AdminMemoriaSecundaria/","title":"Administraci\u00f3n de la memoria secundaria","text":"<p>Tras el proceso de instalaci\u00f3n de un sistema operativo es necesario abordar la configuraci\u00f3n de la memoria secundaria. Es preciso conocer cual es la estructura f\u00edsica del sistema de almacenamiento de informaci\u00f3n, su manejo as\u00ed como el sistema de directorios y ficheros a utilizar.</p> <p>Cada sistema operativo posee su propia estructura de directorios l\u00f3gica y es conveniente estar familiarizado con ella para su correcta administraci\u00f3n. Tambi\u00e9n ser\u00e1 necesario conocer los diferentes sistemas de ficheros y adecuarlos a los diferentes usos del sistema.</p>"},{"location":"UD2/AdminMemoriaSecundaria/#sistemas-de-particionado","title":"Sistemas de particionado","text":"<p>Una vez comprobada la compatibilidad, es preciso configurar la memoria secundaria para que pueda contener los archivos del sistema operativo. Tanto si el disco duro utilizado es nuevo como si no, deberemos revisar las particiones de ese dispositivo.</p> <p>Los discos duros se dividen en \u00e1reas denominadas particiones. Cada partici\u00f3n es una unidad l\u00f3gica de almacenamiento que se puede formatear para almacenar informaci\u00f3n. Durante el proceso de instalaci\u00f3n, la mayor\u00eda de los sistemas operativos crean particiones del espacio disponible en el disco duro y lo formatean de forma autom\u00e1tica. Aunque siempre solicitando la autorizaci\u00f3n del usuario. La informaci\u00f3n c\u00f3mo est\u00e1n dividido este espacio se denomina tabla de particionado y su tratamiento depender\u00e1 del sistema gestor elegido.</p> <p>Un sistema operativo se almacena en una partici\u00f3n de disco y un disco con varias particiones puede almacenar varios sistemas operativos. Son dos los est\u00e1ndares de esquemas de partici\u00f3n m\u00e1s utilizados: MBR y GPT.</p>"},{"location":"UD2/AdminMemoriaSecundaria/#mbr-master-boot-record","title":"MBR (Master Boot Record)","text":"<p>Presentado en 1983, tiene 512 bytes de longitud y contiene el cargador de arranque y un programa ejecutable que permite al usuario elegir entre varios sistemas operativos. Adem\u00e1s contiene informaci\u00f3n de la partici\u00f3n activa. Se ha convertido en el est\u00e1ndar de facto, pero presenta ciertas limitaciones que se solucionaron en el sistema GPT. Se utiliza en ordenadores con firmware basado en BIOS, aunque tambi\u00e9n es compatible con el sistema UEFI. MBR posee diferentes tipos de particiones:</p> <ul> <li>partici\u00f3n primaria, que suelen contener los archivos del sistema operativo. No se pueden subdividir en secciones m\u00e1s peque\u00f1as pero s\u00ed se le puede asignar un sistema de archivos. En un disco duro tan s\u00f3lo pueden coexistir hasta cuatro particiones primarias. Si el sistema necesita de m\u00e1s particiones primarias, o bien instala otro disco duro, o bien utiliza una partici\u00f3n extendida.</li> <li>partici\u00f3n extendida, que se puede dividir hasta en 23 particiones, aunque no se le pueda asignar una sistema de archivos y tan s\u00f3lo se puede asignar una de estas particiones por disco. Cada una de las partes de una unidad extendida se denomina unidades l\u00f3gicas. Este tipo de particiones se crearon para superar el l\u00edmite de cuatro particiones primarias por disco.</li> <li>unidad l\u00f3gica, es una secci\u00f3n de una partici\u00f3n extendida a la que se le puede asignar un sistema de ficheros. Toda unidad l\u00f3gica se encuentra contenida en una partici\u00f3n extendida, y como m\u00ednimo, debe existir una unidad l\u00f3gica en una partici\u00f3n extendida para que un sistema operativo pueda usar ese espacio.</li> <li>partici\u00f3n activa, es la que se utiliza para almacenar y para iniciar un sistema operativo. S\u00f3lo una de las particiones primarias por disco se puede marcar como activa al mismo tiempo. Las particiones activas s\u00f3lo se encuentran en las unidades con tablas de partici\u00f3n de MBR.</li> </ul> <p>Una configuraci\u00f3n com\u00fan para el disco duro de un ordenador, es crear una partici\u00f3n primaria para el sistema operativo y permitir que una partici\u00f3n extendida ocupe el espacio restante. Cualquier partici\u00f3n adicional necesaria se puede crear dentro de la partici\u00f3n extendida, hasta un m\u00e1ximo de 23.</p>"},{"location":"UD2/AdminMemoriaSecundaria/#gpt-globally-unique-identifier-partition-table","title":"GPT (Globally Unique IDentifier Partition Table)","text":"<p>Sustituye el esquema de partici\u00f3n MBR y est\u00e1 basado en la creaci\u00f3n de un identificador \u00fanico para cada una de las particiones. En este sistema, al contrario que ocurre en MBR, tan s\u00f3lo existen particiones primarias. No presenta limitaciones a la hora de crear particiones m\u00e1s que las que le imponga el sistema operativo. Por ejemplo, los sistemas operativos de Microsoft admiten hasta 128 particiones, y \u00e9ste ser\u00e1 su l\u00edmite.</p> <p>Tambi\u00e9n mejora la capacidad de los discos duros que pasa de 2 TB en el sistema MBR a te\u00f3ricamente 9,4 ZB (no se existe todav\u00eda un disco duro con esta capacidad para poder comprobarlo). Otra de las ventajas reside en que la informaci\u00f3n de la tabla de particiones no s\u00f3lo se encuentra almacenada al inicio del disco, como en los sistemas MBR, sino que tiene una copia de dicha tabla fragmentada y repartida por todo el disco. De esta forma, es posible recuperarla tas su p\u00e9rdida.</p> MBR GPT M\u00e1ximo 4 particiones primarias M\u00e1ximo 128 particiones en Windows Tama\u00f1o m\u00e1ximo de partici\u00f3n 2 TB Tama\u00f1o m\u00e1xima de partici\u00f3n 9,4 ZB Sin copia de la tabla de partici\u00f3n Con copia de la tabla de la partici\u00f3n Datos de arranque en un lugar Datos de arranque repartido por el disco Cualquier PC soporta MBR PC basado en UEFI y de 64 bits <p>Durante el proceso de instalaci\u00f3n del sistema operativo se realiza el particionado del disco duro donde se instala, como m\u00ednimo. Es muy habitual que se necesite cambiar este particionado o editar nuevos discos. Se dispone para ello de varias utilidades propias del sistema operativo o de terceros.</p>"},{"location":"UD2/AdminMemoriaSecundaria/#creacion-de-particiones","title":"Creaci\u00f3n de particiones","text":"<p>Los sistemas operativos basados en GNU/Linux utilizan ficheros de dispositivo para referirse a los dispositivos de hardware. Todos estos ficheros se ubican en la carpeta del sistema <code>/dev</code>. Las unidades de almacenamiento no son una excepci\u00f3n y es aqu\u00ed donde se podr\u00e1n encontrar los ficheros que hacen referencia tanto a dispositivos de almacenamiento como a sus particiones. De este modo, el primer disco duro conectado en GNU/Linux se conoce como <code>/dev/hda</code>.</p> Listado de HD<pre><code>/dev/hda \u2013 Dispositivo maestro en la IDE 1 o SATA 0\n/dev/hdb \u2013 Dispositivo esclavo en la IDE 1 o SATA 1\n/dev/hdc \u2013 Dispositivo maestro en la IDE 2 o SATA 2\n/dev/hdd \u2013 Dispositivo esclavo en la IDE 2 o SATA 3\n</code></pre> <p>Si los discos duros en lugar de ser IDE son SCSI o SATA(cosa habitual en la actualidad), en lugar de indicar hda ser\u00eda nombrado <code>sda</code>.</p> <p>Cuando un disco se particiona, se utiliza un n\u00famero a continuaci\u00f3n del nombre del disco duro para representarla. As\u00ed, <code>/dev/hda2</code> se refiere a la segunda partici\u00f3n del disco duro maestro de IDE 1. Como en un disco duro no pueden existir m\u00e1s de cuatro particiones primarias, \u00e9stas reciben n\u00fameros del 1 al 4. Si creamos una partici\u00f3n extendida, \u00e9sta no recibe ning\u00fan numero (igual que en Microsoft Windows no se le asigna una letra) y a las unidades l\u00f3gicas que se crean dentro de dicha partici\u00f3n extendida se le asignan n\u00fameros a partir del 5.</p> <pre><code>/dev/hdb1\n</code></pre> <p>Primera partici\u00f3n primaria del disco duro 2 (esclavo en el primer canal IDE).</p> <pre><code>/dev/sda5\n</code></pre> <p>Primera unidad l\u00f3gica del disco duro cero (primer disco SATA).</p> <p>Ahora que se conoce el tratamiento que los sistemas operativos dan a las particiones, se proceder\u00e1 a su creaci\u00f3n a trav\u00e9s, tanto del terminal como de interfaz gr\u00e1fica.</p> <p>En l\u00ednea de comandos existe una aplicaci\u00f3n denominada <code>fdisk</code> que ofrece una gu\u00eda para elaborar el particionado. Este comando reconoce hasta 83 tipos de particiones diferentes y cuatro sistemas de particionado, aunque solo se trabajar\u00e1 con una peque\u00f1a parte de ellas. Al ejecutarlo, la aplicaci\u00f3n guiar\u00e1 al usuario a trav\u00e9s de men\u00fas que facilitar\u00e1n todas las tareas. Para lanzar la aplicaci\u00f3n es necesario usar esta estructura</p> Comando fdisk<pre><code>fdisk &lt;opciones&gt; &lt;disco&gt;\n</code></pre> <p>en donde <code>&lt;disco&gt;</code> utiliza la nomenclatura descrita en el apartado anterior. De esta forma, si se requiere mostrar la informaci\u00f3n de particionado de un disco duro se usar\u00e1</p> Listado de particiones<pre><code>fdisk -l /dev/sda\n</code></pre> <p>Es necesario tener presente que <code>fdisk</code> es un comando del sistema y requiere permisos de administraci\u00f3n para realizar su tarea. Es por esto que requiere ser ejecutado o con una cuenta que tenga los permisos adecuados o suplantando a dicho usuario. Como se trabaja en un entorno Ubuntu, es posible utilizar el comando sudo anteponi\u00e9ndolo de cualquier otro comando.</p> <p>Para realizar el particionado de un segundo disco que se acaba de conectar al sistema, se emplear\u00e1 el siguiente</p> Particionar<pre><code>fdisk /dev/sdb\n</code></pre> <p>Tras lanzar el comando y pulsar la letra m, se acceder\u00e1 a un completo men\u00fa con el que se podr\u00e1 realizar el particionado.</p> <p>Todas las opciones de esta herramienta son autoexplicativas. No obstante, si el disco instalado no ha tenido nunca una partici\u00f3n, es necesario seguir estos pasos:</p> <ul> <li>localiza el conjunto de opciones Crea una nueva etiqueta, indicando el tipo de tabla de partici\u00f3n. Habitualmente se trabajar\u00e1 con el antiguo modelo MBR (representado con la opci\u00f3n crea una nueva tabla de particiones DOS vac\u00eda), o con el recomendado GPT (opci\u00f3n g del men\u00fa).</li> <li>localiza el grupo de opciones General y particiona el disco en funci\u00f3n de las necesidades. El programa ir\u00e1 guiando al usuario a trav\u00e9s de men\u00fas. Si se elige un sistema de particionado MBR (DOS en el men\u00fa), es recomendable crear primero las particiones primarias, luego las extendidas y por \u00faltimo las unidades l\u00f3gicas.</li> <li>una vez terminado el particionado del disco, es necesario utilizar la opci\u00f3n escribe la tabla en el disco y sale, correspondiente a la letra w.</li> </ul> <p>Hay que tener en cuenta que, por defecto, fdisk expresa las unidades en sectores, algo a lo que el usuario no est\u00e1 acostumbrado. Es posible especificar el tama\u00f1o de las particiones con el siguiente c\u00f3digo: K para kilobytes, M para megabytes, G para gigabytes,T para terabytes y P para petabytes. Cuando el asistente pregunte el sector del final de la partici\u00f3n, si es necesario que esa partici\u00f3n tenga un tama\u00f1o de 100 gygabytes, bastar\u00e1 con especificar +100G o +100000M.</p>"},{"location":"UD2/AdminMemoriaSecundaria/#sistemas-de-ficheros","title":"Sistemas de ficheros","text":"<p>Tras la instalaci\u00f3n del sistema operativo es habitual que se requiera la instalaci\u00f3n de varias unidades de almacenamiento extra. Tan s\u00f3lo ser\u00e1 necesaria la conexi\u00f3n de esta unidad al puerto pertinente y encender el ordenador. Si el disco duro es nuevo o no posee informaci\u00f3n de particionado, ese dispositivo no podr\u00e1 ser utilizado por el sistema operativo. Hay que dotarlo de estructura de estructura l\u00f3gica, es decir, de un sistema de particionado y de un sistema de ficheros compatible con el sistema operativo utilizado. De forma muy resumida, los sistemas de archivos (file system) estructuran la informaci\u00f3n guardada en una unidad de almacenamiento. Cada sistema operativo utiliza su propio sistema de archivos, aunque los hay que son compatibles en diferentes versiones. El tipo de sistema de archivos se determina en el proceso de dar formato a cada una de las particiones. Todo sistema de ficheros debe permitir crear, borrar y modificar ficheros, permitir el acceso controlado a la informaci\u00f3n, el acceso a los ficheros mediante nombres simb\u00f3licos, optimizar el rendimiento, ofrecer soporte multiusuario y minimizar las p\u00e9rdidas de informaci\u00f3n, entre otras caracter\u00edsticas. Pero, \u00bfqu\u00e9 es un archivo o fichero?. Se trata de un mecanismo de abstracci\u00f3n que sirve como unidad l\u00f3gica de almacenamiento de informaci\u00f3n. El fichero agrupa una colecci\u00f3n de datos relacionados entre s\u00ed y definidas por su creador. A todo fichero le corresponde un nombre \u00fanico que lo identifique entre los dem\u00e1s ficheros.</p> <p>Cualquier sistema operativo distingue entre varios tipos b\u00e1sicos de ficheros:</p> <ul> <li>regulares o normales, ficheros que contienen datos (informaci\u00f3n).</li> <li>directorios, aquellos ficheros cuyo contenido es informaci\u00f3n sobre otros ficheros.</li> <li>de dispositivo, existen dispositivos cuya E/S se realiza como si fuesen ficheros, por lo tanto es razonable asociarles ficheros para simplificar y hacer m\u00e1s transparente el intercambio de informaci\u00f3n con dichos dispositivos.</li> <li> <p>de enlace, son ficheros que apuntan a otros ficheros. Habitualmente suelen existir enlaces simb\u00f3licos y f\u00edsicos o duros.</p> <ul> <li>f\u00edsicos, se refiere a un mismo archivo usando dos nombres distintos. El enlace duro apuntar\u00e1 al archivo original y guarda el mismo aspecto y comportamiento. Hay que tener en cuenta que no pueden existir enlaces duros entre dos archivos de particiones separadas, debido a limitaciones de su estructura f\u00edsica.</li> <li>simb\u00f3licos, utilizados para salvar la imposibilidad anterior. A diferencia de los enlaces duros, que apuntan a un archivo por su estructura f\u00edsica (i-nodo), un enlace simb\u00f3lico apunta a otro archivo por su nombre. Esto permite enlazar (apuntar) a otros archivos localizados en otras particiones, e incluso en otras unidades de red. En otro sistemas operativos se funcionan de forma similar a los accesos directos.</li> </ul> </li> </ul> <p>Existen diferentes tipos de sistemas de archivo:</p> <ul> <li>de disco, dise\u00f1ados exclusivamente para almacenar archivos en una unidad de disco conectada directamente al ordenador. Algunos de los sistemas de archivos m\u00e1s usuales de este tipo son ext4, Reiser, FAT32, NTFS, WINFS, ZFS.</li> <li>distribuidos o de red, son sistemas que acceden a sus archivos a trav\u00e9s de una red. Algunos de los m\u00e1s comunes son AFS, AppleShare, CIFS (tambi\u00e9n conocido como SMB o Samba, usado en redes Microsoft), NSS (para sistemas Novell Netware 5) o NFS. Permiten el acceso a recursos independientemente del sistema de archivos originario en el que se encuentre.</li> <li>transaccionales, es una clase especial de sistema de ficheros encargado de almacenar los eventos o transacciones. Se utilizan para asegurar la integridad del sistema comprobando que toda operaci\u00f3n debe estar acabada. En caso de que ocurra alg\u00fan error y una operaci\u00f3n quede a medias, queda reflejado en el journal (bit\u00e1cora o registro) y en el siguiente arranque se puede comprobar las operaciones no completadas y deshacerlas. Algunos sistemas de ficheros que implementan esta caracter\u00edstica son ReiserFs, ext3 y ext4.</li> <li>virtuales, se trata de una capa de abstracci\u00f3n encima de un sistema de archivos m\u00e1s concreto. El prop\u00f3sito de un VFS es permitir que las aplicaciones cliente tengan acceso a diversos tipos de sistemas de archivos concretos de una manera uniforme. Puede ser utilizada para tender un puente para poder utilizar sistemas de archivos de Windows, de Mac OS y Unix indistintamente.</li> <li>de prop\u00f3sito especial, son b\u00e1sicamente aquellos que no pueden clasificarse en ninguna de las dos formas anteriores. Algunos de ellos son CDFS (utilizado como sistema de archivos de CD-ROM), DEVFS (sistema de archivos virtual usado por Unix, cuyo prop\u00f3sito es controlar los archivos de dispositivos que se hallan almacenados en los directorios /sys y /dev de la estructura de archivos convencional) SWAP, utilizado en sistemas GNU/Linux para la zona de gesti\u00f3n de memoria virtual y de intercambio.</li> </ul> <p>La creaci\u00f3n de particiones y asignaci\u00f3n de un sistema de ficheros son tareas b\u00e1sicas que un administrador debe conocer. Estas tareas se pueden realizar a trav\u00e9s de interfaz gr\u00e1fica como en terminal.</p> <p>Una vez terminado el particionado del disco, para poder utilizarlo hay que dotarlo de un sistema de ficheros compatible con el sistema operativo que vaya a utilizar este dispositivo. En el terminal se dispone del comando mkfs con el se puede realizar esta tarea de forma simple</p> Creaci\u00f3n de sistema de ficheros<pre><code>mkfs &lt;opciones&gt; &lt; -t tipo_sistema_ficheros&gt; &lt;dispositivo&gt;\n</code></pre> <p>De esta forma el siguiente comando asignar\u00e1 el sistema de archivos ext4 a la primera partici\u00f3n primaria del segundo disco duro del sistema</p> Ejemplo creaci\u00f3n de sistema de ficheros<pre><code>mkfs -t ext4 /dev/sdb1\n</code></pre> <p>La herramienta mkfs soporta multitud de sistemas de ficheros. Los m\u00e1s utilizados, y los que con total seguridad ser\u00e1n necesarios para la administraci\u00f3n de cualquier sistema ser\u00e1n ext3, ext4, SWAP, vfat (para dispositivos USB extra\u00edbles), FAT32 y NTFS</p>"},{"location":"UD2/AdminMemoriaSecundaria/#puntos-de-montaje","title":"Puntos de montaje","text":"<p>GNU/Linux no utiliza letras para acceder a las particiones, as\u00ed que \u00bfc\u00f3mo es posible grabar un archivo por ejemplo en /dev/hdb6?. En Microsoft Windows se copiar\u00eda el archivo en D: o E: o la letra que asignemos a esa partici\u00f3n, pero esto no se hace de este modo en GNU/Linux. Cada dispositivo de almacenamiento (partici\u00f3n, disquete, CD) que se utilice debe ser montado sobre un punto de montaje.</p> <p>Recuerda que en GNU/Linux solo existe un espacio de almacenamiento, un \u00fanico \u00e1rbol que empieza en el ra\u00edz y que contiene todo lo que tenemos en nuestro sistema. Esto se consigue asociando cada partici\u00f3n a un directorio mediante un proceso denominado montaje. Montar una partici\u00f3n hace que su espacio de almacenamiento se encuentre disponible accediendo al directorio especificado (conocido como punto de montaje).</p> <p>Por ejemplo, si se monta la partici\u00f3n <code>/dev/sda5</code> en <code>/usr</code>, significa que todos los ficheros y directorios a partir de /usr se ubican f\u00edsicamente en <code>/dev/sda5</code>. Por lo tanto, el fichero <code>/usr/feo.txt</code> estar\u00e1 almacenado en <code>/dev/sda5</code>, cosa que no ocurre con el fichero <code>/home/FEO/otrofeo.txt.</code></p> <p>Continuando con el ejemplo, tambi\u00e9n es posible que uno o m\u00e1s directorios dentro de <code>/usr</code> sean puntos de montaje de otras particiones. Se puede montar la partici\u00f3n <code>/dev/sda7</code> en <code>/usr/local</code>, lo que significa que el fichero <code>/usr/local/fea.txt</code> estar\u00e1 en <code>/dev/sda7</code>, no en <code>/dev/sda5</code>.</p> <p>Cuando se conecta una unidad de almacenamiento o un lector \u00f3ptico, el sistema tiene que crear un punto de montaje para poderlo utilizar. Este punto de montaje en casos de dispositivo extra\u00edbles, como memorias USB, suele ser una carpeta que creamos manualmente en el sistema o se crea autom\u00e1ticamente en la carpeta denominada <code>/media</code>. Esto solo ocurre en distribuciones basadas en Ubuntu (salt\u00e1ndose la estructura FHS).</p> <p>El uso general del comando mount es el siguiente:</p> Comando mount<pre><code>mount -t &lt;tipo_de_dispotivo&gt; &lt;directorio_de_destino&gt;\n</code></pre> <p>Cuando se ejecuta el comando <code>mount</code> sin argumentos, mostrar\u00e1 un listado de lo que est\u00e1 montado en el sistema y la carpeta sobre la que lo hace.</p> Salida del comando mount<pre><code>mount\n/dev/sda1 on / type ext4 (rw,errors=remount-ro)\nproc on /proc type proc (rw,noexec,nosuid,nodev)\nsysfs on /sys type sysfs (rw,noexec,nosuid,nodev)\nnone on /sys/fs/fuse/connections type fusectl (rw)\nnone on /sys/kernel/debug type debugfs (rw)\nnone on /sys/kernel/security type securityfs (rw)\nudev on /dev type devtmpfs (rw,mode=0755)\ndevpts on /dev/pts type devpts (rw,noexec,nosuid,gid=5,mode=0620)\ntmpfs on /run type tmpfs (rw,noexec,nosuid,size=10%,mode=0755)\nnone on /run/lock type tmpfs (rw,noexec,nosuid,nodev,size=5242880)\nnone on /run/shm type tmpfs (rw,nosuid,nodev)\nnone on /run/user type tmpfs (rw,noexec,nosuid,nodev,size=104857600,mode=0755)\n/dev/sda5 on /home type ext4 (rw)\nbinfmt_misc on /proc/sys/fs/binfmt_misc type binfmt_misc (rw,noexec,nosuid,nodev)\n</code></pre> <p>De toda la informaci\u00f3n que nos ofrece el comando es importante prestar atenci\u00f3n a las particiones. En este caso existen dos particiones el <code>/home y /</code></p> <pre><code>/dev/sda1 on / type ext4 (rw,errors=remount-ro)\n/dev/sda5 on /home type ext4 (rw)\n</code></pre> <p>Con el siguiente comando se monta la segunda partici\u00f3n primaria del segundo disco SATA en la carpeta personal del usuario Feo</p> <pre><code>mount /dev/sdb2 /home/Feo/datos\n</code></pre> <p>Tras montar el volumen, a trav\u00e9s de la carpeta <code>/home/Feo/datos</code> acceder\u00e9 a la partici\u00f3n <code>/dev/sdb2</code>.</p> <p>Es posible dotar de diferentes puntos de montaje a una misma partici\u00f3n. Esto quiere decir que existir\u00e1n dos puertas de entrada. Esta configuraci\u00f3n es requerida cuando varios programas necesiten acceso a una misma partici\u00f3n. Es una situaci\u00f3n rara, pero llegado el caso es posible del siguiente modo.</p> <p>Se necesita un segundo punto de montaje en la misma partici\u00f3n del ejemplo anterior. Crear un segundo punto de montaje es tan sencillo como enlazar el existente a otra carpeta, para ello se usar\u00e1 el modificador <code>-B</code>:</p> <pre><code>mount -B /home/Feo/datos /home/MuyFeo/documentos\n</code></pre> <p>Cuando se monta una partici\u00f3n en una carpeta, por defecto se le asignan los permisos de escritura y lectura para el usuario que monta esa unidad. Es posible limitar esos permisos a\u00f1adiendo al final del comando el modificador <code>-r</code>:</p> <pre><code>mount /dev/sda5 /home/Feo/Escritorio/Datos -r\n</code></pre> <p>De este modo se monta la primera unidad l\u00f3gica del primer disco duro SATA en la carpeta Datos (situada en el escritorio del usuario Feo) con permisos de lectura (r de read en ingl\u00e9s).</p> <p>Tambi\u00e9n es habitual montar la unidad de CD-ROM en una carpeta para tener acceso a ella:</p> <pre><code>mount -t iso9660 -o ro /dev/cdrom /media/cdrom\n</code></pre> <p>Es muy \u00fatil desmontar estas unidades cuando se haya terminado con su uso. Para ello usaremos el comando umount y especificando la carpeta que se necesita desmontar</p> <pre><code>umount /home/Feo/Escritorio/Datos\n</code></pre> <p>Es posible desmontar varias unidades en un mismo comando umount si las separamos con espacios. Hay que tener cuidado con el desmontaje de unidades ya que es posible que alg\u00fan programa est\u00e9 utilizando un archivo de ese dispositivo. Si esto ocurriese, el sistema advierte que la partici\u00f3n est\u00e1 en uso y no proceder\u00e1 con el desmontaje. Podemos obligar al sistema operativo que cuando deje de estar utilizada, procesa con su desmontaje. Usaremos la opci\u00f3n -l para ello:</p> <pre><code>umount /home/Feo/Escritorio/Datos -l\n</code></pre> <p>Si existe certeza de que ning\u00fan fichero est\u00e1 usando el disco y tenemos que desmontarlo a pesar de las advertencias, se dispone del modificador <code>-f</code></p> <pre><code>umount -f /home/Feo/Escritorio/Datos\n</code></pre> <p>Lo que hay que tener muy en cuenta es que este montaje de carpetas es temporal, es decir, tan solo es v\u00e1lido mientras la sesi\u00f3n del usuario siga activa. Una vez esta sesi\u00f3n sea finalizada, por ejemplo reiniciando el equipo, todas estas particiones se perder\u00e1n, teniendo que volver a montarlas tras el reinicio de una nueva sesi\u00f3n.</p>"},{"location":"UD2/AdminMemoriaSecundaria/#montaje-automatico-con-fstab","title":"Montaje autom\u00e1tico con fstab","text":"<p>GNU/Linux ofrece la posibilidad de hacer esos montajes permanentes, o m\u00e1s bien que se monten de forma autom\u00e1tica al inicio de cada sesi\u00f3n. En realidad esta tarea ya la realiza el sistema operativo con las particiones del sistema, as\u00ed no hay que montar la partici\u00f3n del disco duro cada vez que iniciamos la sesi\u00f3n. Esta configuraci\u00f3n se hace a trav\u00e9s del fichero fstab.</p> <p>El fichero fstab (File System TABle) que se encuentra en el directorio <code>/etc</code>, es parte de la configuraci\u00f3n del sistema y muestra la lista de discos y particiones disponibles. Este fichero monta las particiones listadas al iniciar el equipo con las configuraciones que tenemos realizadas mediante <code>mount</code>. El uso b\u00e1sico es de esta forma:</p> Distibucion de cada una de las lineas<pre><code>dispositivo punto_de_montaje sistema_de_archivos opciones frecuencia_dump pass_num\n</code></pre> <p>Entre una secci\u00f3n y otra les separa una tabulaci\u00f3n. Cada opci\u00f3n significa:</p> <ul> <li>dispositivo, es el nombre del dispositivo y la localizaci\u00f3n del mismo, normalmente en /dev. En Ubuntu las entradas del fstab tambi\u00e9n pueden comenzar con el Universal unique Identifier (UUID) que se asignan al sistema de ficheros cuando se formatea.</li> <li>punto_de_montaje, que es el punto de montaje donde los datos se a\u00f1aden al sistema de ficheros.</li> <li> <p>sistema_de_archivos, que hace referencia al tipo de sistema de ficheros que puede ser uno de los siguientes:</p> <ul> <li>ext3/ext4, la mayor\u00eda de los sistemas hoy en d\u00eda lo usan. Se le denomina journaled lo que significa que si el sistema se apaga de forma anormal, no se pierden datos.</li> <li>swap, partici\u00f3n para la gesti\u00f3n de la memoria virtual.</li> <li>ntfs y vfat, particiones de Microsoft Windows y memorias USB.</li> <li>auto, detecci\u00f3n autom\u00e1tica del tipo de sistema de ficheros.</li> </ul> </li> <li> <p>opciones, son las opciones con las que se monta la unidad:</p> <ul> <li>auto/noauto, con auto la partici\u00f3n ser\u00e1 montada autom\u00e1ticamente en el arranque.</li> <li>exec/noexec, si es posible ejecutar binarios o no en esa partici\u00f3n.</li> <li>ro/rw, si se permite s\u00f3lo lectura ro y lectura escritura rw.</li> <li>user/nouser, si es posible que cualquier usuario monte esta unidad. Con nouser s\u00f3lo el usuario root tendr\u00e1 privilegios para montar una partici\u00f3n.</li> <li>sync/async, los ficheros pueden ser escritos de forma s\u00edncrona o as\u00edncrona. Las operaciones de escritura de los discos duros no son sincronizadas, la escritura empieza mucho despu\u00e9s de que se ejecute el comando. Si est\u00e1 configurada la forma as\u00edncrona los ficheros son escritos con \u00e9xito pero no lo estar\u00e1n f\u00edsicamente.</li> <li>defaults, configura las opciones por defecto, que son: rw, suid, dev, exev, auto, nouser y async</li> </ul> </li> <li> <p>frecuencia_error, indica la frecuencia con la que se realizar\u00e1 la de comprobaci\u00f3n de errores. Si es cero, es que no lo comprobar\u00e1 y si es uno, s\u00ed lo har\u00e1.</p> </li> <li>pass-num, controla el orden en el que fsck comprueba los errores de la partici\u00f3n en el arranque. Puede tomar como valores 0, 1 y 2. Siendo 1 la partici\u00f3n ra\u00edz, 2 otras particiones y 0 pero deshabilitar el chequeo</li> </ul> <p>Si es necesario montar una partici\u00f3n de inicio, ser\u00e1 obligatorio incluir una l\u00ednea al final del fichero fstab siguiendo el patr\u00f3n descrito. Para ello, ser\u00e1 necesario abrir el fichero /etc/fstab con permisos de administraci\u00f3n para poder editarlo:</p> <pre><code>  sudo nano /etc/fstab\n</code></pre> <p>Una vez abierto, a\u00f1adir esta l\u00ednea al final del fichero:</p> <pre><code>/dev/sda2 /media/datos auto rw,user,auto 0 0\n</code></pre> <p>Esta nueva estrada en el fichero fstab indica que al inicio de sesi\u00f3n montar\u00e1 la partici\u00f3n <code>/dev/sda2</code> en la carpeta <code>/media/datos</code>, detectar\u00e1 de forma autom\u00e1tica el sistema de ficheros, configurar\u00e1 las opciones de lectura escritura, cualquier usuario podr\u00e1 montar esta partici\u00f3n y se montar\u00e1 de forma autom\u00e1tica durante el inicio de sesi\u00f3n. Adem\u00e1s la b\u00fasqueda de errores est\u00e1 deshabilitada (el \u00faltimo cero es para indicar que no haga la comprobaci\u00f3n de ficheros de forma predeterminada).</p> <p>Aunque al principio pueda parecer una estrategia complicada, el uso de este sistema de montaje de particiones presenta muchas m\u00e1s ventajas que la asignaci\u00f3n de letras por partici\u00f3n. No en vano, Microsoft Windows ya hace tiempo que implementa este sistema en sus sistemas operativos, adem\u00e1s del uso de letras.</p>"},{"location":"UD2/AdminMemoriaSecundaria/#mantenimiento-de-discos","title":"Mantenimiento de discos","text":"<p>Una vez construida la estructura necesaria para un disco duro, dividiendo el disco en particiones, asign\u00e1ndole un sistema de ficheros y montando esa unidad, es importante vigilar la integridad y rendimiento de dicho dispositivo. Para ello se dispone de la herramienta fsck la cual corrige problemas de inconsistencia en discos duros. Para realizar esta comprobaci\u00f3n es muy recomendable que el disco se encuentre desmontado, ya que de otra forma podr\u00eda causar da\u00f1os al sistema de ficheros de la unidad de almacenamiento.</p> Sintaxis del comando fsck<pre><code>fsck &lt;opciones&gt; &lt;dispositivo&gt;\n</code></pre> <p>De esta forma, si se necesita comprobar la integridad de la segunda partici\u00f3n del tercer disco duro instalado, este ser\u00e1 el comando a ejecutar</p> Ejmplo de fsck<pre><code>fsck /dev/sdc2\n</code></pre> <p>Tambi\u00e9n posible la comprobaci\u00f3n de todas las particiones de un disco en una sola orden si tan s\u00f3lo se especifica el disco, lo cual simplifica la tarea</p> Ejmplo de fsck<pre><code>fsck /dev/sdc\n</code></pre> <p>Las opciones que <code>fsck</code> puede tomar, son las siguientes:</p> <ul> <li><code>-a</code> confirmar autom\u00e1ticamente los mensajes</li> <li><code>-c</code> comprobar bloques en el disco</li> <li><code>-f</code> forzar la verificaci\u00f3n aunque todo parezca normal</li> <li><code>-v</code> muestra m\u00e1s informaci\u00f3n</li> <li><code>-r</code> modo interactivo, espera nuestra respuesta ante cualquier mensaje</li> <li><code>-y</code> asume s\u00ed como respuesta predeterminada</li> </ul> <p>Otra de las tareas de mantenimiento que es recomendable llevar a cabo en los discos duros es su desfragmentaci\u00f3n. Cuando un archivo se guarda en un disco duro, \u00e9ste se divide en partes de igual tama\u00f1o que el bloque del disco. Este tama\u00f1o depende del sistema de ficheros que se utilice. Estos fragmentos de fichero no se guardan de forma contigua, sino que el sistema operativo los sit\u00faa de forma aleatoria mejorando as\u00ed la velocidad de escritura. No prevee una estrategia de ordenaci\u00f3n, sino que los guarda all\u00e1 donde exista un bloque libre.</p> <p>Esta circunstancia facilita la escritura, pero penaliza la velocidad de lectura. Al leer un archivo, el transductor del disco debe recorrer posiciones aleatorias, empleando m\u00e1s tiempo en esta tarea. El proceso de desfragmentaci\u00f3n recorre el disco buscando las partes que componen un fichero y las re\u00fane para que el proceso de lectura sea m\u00e1s r\u00e1pido. Dicho de otra manera, realiza el trabajo de planificaci\u00f3n que en el proceso de escritura no se ha realizado.</p> <p>Este problema afecta sobre todo a los sistemas de archivo basados en tablas de \u00edndices y en mucha menos medida a los basados en nodos-i. As\u00ed, los sistemas de fichero ext3 y ext4 no padecen de este problema, y s\u00ed FAT32, FAT16, vfat y NTFS. Este es el motivo por el cual se relaciona este problema con sistema operativos de la familia de Microsoft.</p> <p>La herramienta de desfragmentaci\u00f3n en Microsoft Windows se encuentra en Inicio \u2192 Herramientas administrativas de Windows \u2192 Desfragmentar y optimizar unidades.</p> <p></p>"},{"location":"UD2/EstructuraDirectorios/","title":"Estructura de directorios de sistemas operativos libres y propietarios","text":"<p>En los sistemas operativos basados en Microsoft Windows, asigna una letra a cada una de las particiones de un disco duro. Autom\u00e1ticamente esa letra indica el directorio ra\u00edz de esa partici\u00f3n. De ese modo, si disponemos de un fichero alojado en la carpeta <code>C:\\Usuarios\\Feo\\Escritorio</code>, gracias a la primera letra sabemos que est\u00e1 contenido en una partici\u00f3n mientras que el fichero <code>D:\\SteamLibrary\\steamapps\\common\\DARK SOULS III</code> lo est\u00e1 en otra partici\u00f3n. En este sistema las letras A: y B: se reservan hist\u00f3ricamente para las unidades de disquetes, ya en desuso. Es posible la asignaci\u00f3n de cualquier letra del alfabeto ingl\u00e9s a cualquier partici\u00f3n.</p> <p>Adem\u00e1s de este sistema de asignaci\u00f3n de letras, tambi\u00e9n existe otro sistema que es el de montar particiones en carpetas. Montar una partici\u00f3n implica dotarle de un punto de entrada a su espacio de almacenamiento, de esta forma es posible que la carpeta <code>D:\\Documentos</code> no se sit\u00fae en el mismo dispositivo f\u00edsico que la anterior carpeta. Este sistema, aunque parezca raro, presenta numerosas ventajas y es el m\u00e1s utilizado.</p> <p>Por lo que respecta a los sistemas basados en Unix, la estructura de los directorios as\u00ed como su contenido y funciones, viene definida en el denominado Filesystem Hierarchy Standard o FHS por sus siglas en ingl\u00e9s. En otras palabras es el est\u00e1ndar de jerarqu\u00eda para los sistemas de archivos en sistemas GNU/Linux y otros derivados de Unix. El FHS naci\u00f3 en 1994 y es actualmente mantenida por la Linux Foundation. Aun siendo un est\u00e1ndar, existen distribuciones GNU/Linux que se saltan estas normas, aunque en la mayor\u00eda de los casos son aceptadas.</p> <p>rm</p> <p><code>rm &lt;fichero&gt;</code> (remove) Elimina el/los ficheros pasado/s como par\u00e1metro.</p> <p>Antes de empezar a listar los diferentes directorios, es importante recordar que aunque todos ellos parten de una \u00fanica ra\u00edz com\u00fan, no significa que no puedan estar en particiones separadas. De hecho, en muchas distribuciones GNU/Linux es una pr\u00e1ctica muy com\u00fan el hecho de ubicar ciertos directorios en particiones separadas.</p> <p>Toda la estructura de directorios en los sistemas basados en Unix parte de un directorio ra\u00edz tambi\u00e9n llamado directorio root y que se simboliza por una barra inclinada o /. Desde este directorio inicial es donde nacen todo el resto de directorios, independientemente que est\u00e9n almacenados f\u00edsicamente en discos o particiones separadas.</p> <p>rmdir</p> <p><code>rmdir &lt;directorio&gt;</code> (remove directory), elimina el directorio pasado como par\u00e1metro.</p> <p>Cualquier direcci\u00f3n de archivo o carpeta en Linux empieza por el directorio ra\u00edz o /, seguido de todos los directorios y subdirectorios que que lo contienen, separados cada uno de ellos tambi\u00e9n por /. Todas las distribuciones GNU/Linux deben tener una estructura de directorios como indica la FHS, aunque existen algunas que han introducido algunos cambios menores que no afectar a su estructura.</p> Directorio Contenido <code>bin</code> Archivos binarios de usuario <code>boot</code> Archivos ejecutables necesarios para el arranque del sistema <code>dev</code> Archivos de informaci\u00f3n de dispositivos <code>etc</code> Archivos de configuraci\u00f3n del sistema y de aplicaciones <code>home</code> Directorio personal con los espacios personales de los usuarios <code>lib</code> Bibliotecas necesarias para la ejecuci\u00f3n de los archivos binarios <code>media</code> Directorio de montaje de vol\u00famenes extra\u00edbles <code>mnt</code> Carpeta de montaje de vol\u00famenes fijos <code>opt</code> Archivos de aplicaciones externas que no se integran en /usr <code>root</code> Carpeta personal del superusuario <code>sbin</code> Archivos binarios del sistema <code>srv</code> Archivos relativos a servicios <code>tmp</code> Carpeta de archivos temporales <code>usr</code> Archivos de programas"},{"location":"UD2/IntroTerminal/","title":"Introducci\u00f3n al terminal de comandos","text":"<p>Hasta hace bien poco, toda la gesti\u00f3n del sistema operativo GNU/Linux se basaba en la ejecuci\u00f3n de \u00f3rdenes en entrono de comandos a trav\u00e9s de un terminal. Actualmente se dispone de interfaces gr\u00e1ficas que facilitan la gesti\u00f3n, pero no poseen la potencia de los terminales. En un terminal es posible crear cualquier comando que el usuario necesite, incluso para las tareas m\u00e1s espec\u00edficas. Es buena pr\u00e1ctica que el administrador del sistema tenga conocimientos en el manejo del terminal as\u00ed como en la programaci\u00f3n de scripts.</p> <p>En general, el formato de las \u00f3rdenes de GNU/Linux es el siguiente:</p> <ul> <li>comando, que indica la acci\u00f3n que se va a ejecutar</li> <li>modificadores, que cambian el comportamiento est\u00e1ndar del comando para adaptarlo a las necesidades</li> <li>argumentos, elementos necesarios para realizar la acci\u00f3n del comando</li> </ul> <p>may\u00fasculas</p> <p>Un dato a tener en cuenta cuando se trabaja con un terminal, es que GNU/Linux distingue entre may\u00fasculas y min\u00fasculas, es decir, es case sesitive.</p> <p>Lo primero que se introduce es la orden seguida de los modificadores o par\u00e1metros y, tras ellos, los argumentos que requiera el comando. Existen muchos comandos que no requieren argumento alguno para realizar su funci\u00f3n:</p> <p><code>bash comando modificadores argumentos</code></p> <p>La forma de identificar que el sistema est\u00e1 preparado para recibir ordenes en el terminal se realiza a trav\u00e9s de una l\u00ednea de texto llamada prompt:</p> <p>Terminal</p> <p>Para abrir un terminal bastar\u00e1 con pulsar las teclas  Ctrl+Alt+T , o bien escribir la palabra \u201cterminal\u201d en el lanzador de Ubuntu. Para poder escribir la virgulilla pulsa AltGr+4 y despu\u00e9s la tecla Space.</p> <p>El prompt esta compuesto de varias partes. La primera es el nombre del usuario con el que se est\u00e1 trabajando, en este caso, el usuario es feo. La segunda parte, que esta despu\u00e9s de la arroba (@), es el nombre de la m\u00e1quina en la que se ejecuta el terminal. En el ejemplo anterior la m\u00e1quina se llama ubuntu. La tercera parte, que est\u00e1 despu\u00e9s de los dos puntos : , es el directorio actual de trabajo.</p> <p>Cuando aparece la virgulilla, o tilde Ctrl+Alt+Del de la letra e\u00f1e <code>~</code>, nos est\u00e1 indicando que el directorio actual de trabajo es el directorio personal del usuario, tambi\u00e9n conocido como directorio <code>home</code>.</p> <p>Y por \u00faltimo, al final del prompt puede aparecer o bien el s\u00edmbolo del d\u00f3lar <code>$</code>, lo que indica que se trabaja con un usuario con privilegios limitados, o la almohadilla <code>#</code>, con lo que el sistema indica que el usuario que ejecuta la terminal es el administrador, que en GNU/Linux se llama root.</p> <p>Para dar una orden al sistema, se escribe el comando que se va a ejecutar y pulsar la tecla enter</p> <pre><code> ls\n</code></pre> <p>Por ejemplo, en la l\u00ednea anterior se est\u00e1 ejecutando el comando <code>ls</code>, que permite ver un listado de subdirectorios y archivos del directorio actual de trabajo, que es el directorio personal del usuario porque aparece la virgulilla.</p> <p>A la mayor parte de los comandos se les pueden a\u00f1adir opciones (tambi\u00e9n se pueden llamar par\u00e1metros, modificadores o argumentos), que modifican su comportamiento. De este modo, el comando</p> <pre><code> ls -l -a\n</code></pre> <p>est\u00e1 utilizando opciones para que el comando ls muestre tambi\u00e9n los archivos ocultos e informaci\u00f3n adicional de cada subdirectorio o archivo que hay en el directorio actual. Para que el sistema diferencie el comando de las opciones o una opci\u00f3n de otra opci\u00f3n, los comandos y sus opciones se escriben utilizando el espacio para separarlos.</p> <p>Por lo general las opciones suelen ser un guion - y una letra, pero tambi\u00e9n es posible encontrar opciones que son palabras completas precedidas por dos guiones <code>--</code>. Es posible unir las opciones representadas por una letra para escribir un poco menos. La secuencia de opciones -l -a hace exactamente lo mismo que <code>-la</code>, de hecho <code>-la, -al, -l -a y -a -l</code> devuelven el mismo resultado.</p> <p>Clear</p> <p>Este comando se utiliza para limpia el texto de la pantalla del terminal. Dejar\u00e1 \u00fanicamente el prompt..</p> <pre><code> ls -la\n ls -al\n ls -l -a\n ls -a -l\n</code></pre> <p>Junto con los comandos, tambi\u00e9n es posible usar los metacar\u00e1cteres para seleccionar a qu\u00e9 ficheros se quiere afectar con el comando. Para eso utilizamos los siguientes caracteres:</p> <ul> <li>?, que representa cualquier car\u00e1cter una vez</li> <li>*, que representa cualquier car\u00e1cter cualquier n\u00famero de veces</li> <li>[ ], que representa un car\u00e1cter de los incluidos entre los corchetes</li> <li>!, que representa la ausencia de ese car\u00e1cter en el patr\u00f3n de filtrado</li> </ul> <p>As\u00ed, si es necesario listar los ficheros que comiencen con la letra \u201cf\u201d, se usar\u00e1 el siguiente comando</p> <pre><code> ls f*\n</code></pre> <p>o, por ejemplo, los ficheros o directorios que comiencen por la letras D o P</p> <pre><code>ls [DP]*\n</code></pre> <p>Para poder utilizar los caracteres ? y ! se deben asignar a un patr\u00f3n de b\u00fasqueda, que trataremos en lo sucesivo.</p>"},{"location":"UD2/IntroTerminal/#encadenar-los-comandos","title":"Encadenar los comandos","text":"<p>Puede ejecutar varios comandos en una sola l\u00ednea, unos tras otros. Para ello, basta con separarlos con un punto y coma.</p> Encadenar comandos<pre><code> date;pwd;cal\n</code></pre>"},{"location":"UD2/IntroTerminal/#obtencion-de-ayuda-en-un-terminal","title":"Obtenci\u00f3n de ayuda en un terminal","text":"<p>Exit</p> <p>Comando que cierra y sale del terminal actual. Si hay procesos iniciados desde el terminal, tambi\u00e9n se cerrar\u00e1n.</p> <p>Queda lejos de la intenci\u00f3n de esta unidad de trabajo la explicaci\u00f3n de todos los comandos del sistema GNU/Linux as\u00ed como de sus modificadores u opciones. Existen varios m\u00e9todos de obtener ayuda sobre un comando para no tener que recordar cientos de opciones de cada comando:</p> <ul> <li>usar el modificador <code>--help</code>, ofrecer\u00e1 una gu\u00eda r\u00e1pida de uso y de los modificadores m\u00e1s utilizados del comando.</li> <li>usar el comando <code>man</code>, el cual imprimir\u00e1 una gu\u00eda de uso del comando. Su uso es sencillo, basta con anteponer man al comando sobre el que se requiera informaci\u00f3n.</li> <li>Usar <code>info</code> es similar a <code>man</code>, pero las p\u00e1ginas est\u00e1n estructuradas, ofrecen v\u00ednculos, un \u00edndice, una jerarqu\u00eda o men\u00fas. Las p\u00e1ginas info pueden llamarse entre ellas y ofrecen frecuentemente una navegaci\u00f3n amigable.</li> </ul>"},{"location":"UD2/IntroTerminal/#el-manual-en-linea-man","title":"El manual en l\u00ednea. Man","text":"<p>Vamos a detenernos en este comando porque es uno de los m\u00e1s importante y tenemos que entenderlo para poder utilizar los comandos. Esta manual es est\u00e1ndar en todos los Unix, incluso Linux, y no importa cu\u00e1l sea el shell, ya que se trata de un comando externo. Al manual se accede con el comando y el nombre del comando que queramos ejemplo</p> <pre><code> man date\n</code></pre> <p>Y nos da como resultado:</p> <pre><code>DATE(1)                                                                                         User Commands                                                                                        DATE(1)\n\nNAME\n       date - print or set the system date and time\n\nSYNOPSIS\n       date [OPTION]... [+FORMAT]\n       date [-u|--utc|--universal] [MMDDhhmm[[CC]YY][.ss]]\n\nDESCRIPTION\n       Display the current time in the given FORMAT, or set the system date.\n\n       Mandatory arguments to long options are mandatory for short options too.\n\n       -d, --date=STRING\n              display time described by STRING, not 'now'\n\n       --debug\n              annotate the parsed date, and warn about questionable usage to stderr\n\n       -f, --file=DATEFILE\n              like --date; once for each line of DATEFILE\n\n       -I[FMT], --iso-8601[=FMT]\n              output  date/time  in  ISO  8601  format.   FMT='date'  for  date  only  (the  default),  'hours',  'minutes',  'seconds',  or  'ns'  for  date and time to the indicated precision.  Example:\n              2006-08-14T02:34:56-06:00\n</code></pre> <p>Una p\u00e1gina de manual se compone de varias secciones, entre las cuales est\u00e1n las siguientes, aunque no son todas obligatorias.</p> <ul> <li>Nombre: nombre y papel del comando.</li> <li>Sinopsis: sintaxis general, par\u00e1metros y argumentos aceptados.</li> <li>Descripci\u00f3n: instrucciones detalladas del funcionamiento del comando y de los argumentos principales.</li> <li>Opciones: descripci\u00f3n detallada de cada par\u00e1metro posible, en general en forma de lista.</li> <li>Ejemplos: el manual puede proporcionar ejemplos concretos de uso del comando.</li> <li>Entorno: el comando puede funcionar de manera diferente dependiendo de los valores que adopten algunas de las variables del shell.</li> <li>Conformidad: el comando se ajusta a unas recomendaciones o normas (por ejemplo, POSIX).</li> <li>Errores (bugs): el comando puede a veces funcionar mal en casos puntuales que se pueden enumerar en este sitio.</li> <li>Diagn\u00f3stico/retorno: el comando, seg\u00fan su resultado, puede devolver c\u00f3digos de errores significativos cuyo valor permite determinar el tipo de problema (archivo con argumento ausente, etc.). - Ver tambi\u00e9n: lista de los comandos relacionados con el programa que pueden interesar al usuario.</li> </ul>"},{"location":"UD2/IntroTerminal/#navegacion","title":"Navegaci\u00f3n","text":"<p>Se navega muy f\u00e1cilmente por la ayuda:</p> <ul> <li>La Space desplaza una p\u00e1gina completa.</li> <li>La ++Enter++ desplaza l\u00ednea por l\u00ednea.</li> <li>Las Up y Down desplazan una l\u00ednea arriba o abajo.</li> <li>Las teclas Page Down y Page Up desplazan media p\u00e1gina arriba o abajo.</li> <li>Las teclas Home y End hacen exactamente lo que se espera de ellas.</li> <li>La tecla / permite una b\u00fasqueda. <code>/ls</code> busca ls. En este caso, la tecla N busca la coincidencia siguiente, mientras que ++N++ busca la anterior.</li> <li>La tecla Q sale de la ayuda y vuelve al shell.</li> </ul>"},{"location":"UD2/IntroTerminal/#buscar-por-correspondencia","title":"Buscar por correspondencia","text":"<p>Si no sabemos que comando que debe utilizar o no recuerda su nombre, o si quiere conocer todos los comandos relacionados con una palabra, entonces utilice el par\u00e1metro <code>-k</code> de man:</p> <pre><code>man -k password\n</code></pre> <p>Y nos da como resultado:</p> <pre><code>apg (1)              - generates several random passwords\nchage (1)            - change user password expiry information\nchgpasswd (8)        - update group passwords in batch mode\nchpasswd (8)         - update passwords in batch mode\ncpgr (8)             - copy with locking the given file to the password or group file\ncppw (8)             - copy with locking the given file to the password or group file\ncracklib-check (8)   - Check passwords using libcrack2\ncreate-cracklib-dict (8) - Check passwords using libcrack2\nendpwent (3)         - get password file entry\nendspent (3)         - get shadow password file entry\nexpiry (1)           - check and enforce password expiration policy\nfgetpwent (3)        - get password file entry\nfgetspent (3)        - get shadow password file entry\nfgetspent_r (3)      - get shadow password file entry\ngetpass (3)          - get a password\ngetpw (3)            - reconstruct password line entry\n</code></pre> <p>Example</p> <p>Se deben conocer algunas secuencias de atajos de comandos:</p> <pre><code>- ++ctrl+C: interrupci\u00f3n del programa: se termina.\n- ++ctrl+Z: para el programa (ver los procesos).\n- ++ctrl+D: interrumpe una introducci\u00f3n de datos en un s\u00edmbolo del sistema &gt;.\n</code></pre>"},{"location":"UD2/IntroTerminal/#el-historial-de-comandos","title":"El historial de comandos","text":"<p>Le resultar\u00e1 muy \u00fatil poder volver a llamar a un comando que ya ejecut\u00f3 navegando por el historial de los comandos con las teclas Up y Down. La flecha arriba vuelve atr\u00e1s en el historial. Si ha tecleado los dos comandos anteriores (<code>date</code> y luego <code>pwd</code>), al presionar una primera vez en la flecha arriba se visualiza en la l\u00ednea de comandos pwd, y a la segunda se visualiza el comando date. La flecha abajo navega en el otro sentido hasta la l\u00ednea de origen. Si pulsa la tecla Enter vuelve a ejecutar el comando.</p> <p>Puede ver el contenido del historial con el comando <code>history</code>. El resultado siguiente est\u00e1 truncado de manera voluntaria, ya que la lista es demasiado larga.</p> Ejemplo de history<pre><code> history\n 1000  code\n 1001  code .\n 1002  [aula3]\n 1003  192.168.3.[1:22]\n 1004  [aula3:vars]\n 1005  ansible_network_os=aula3\n 1006  ansible-playbook  deploy.yml\n 1007  ping 192.168.1.113\n 1008  cd ansible-demo/\n</code></pre>"},{"location":"UD2/busquedaArchivos/","title":"B\u00fasqueda de ficheros en el sistema","text":"<p>Todos los sistemas de ficheros ofrecen la funci\u00f3n de b\u00fasqueda de archivos dentro del dispositivo o dispositivos que lo conforman. Habitualmente, los sistemas operativos disponen de una aplicaci\u00f3n GUI para realizar esta tarea y que no entra\u00f1a ninguna dificultad a la hora de su manejo. Adem\u00e1s de esto, los sistemas operativos basado en GNU/Linux disponen de una potente herramienta en el terminal.</p> <p>El comando <code>find</code>, uno de los legendarios de los sistemas Unix y por supuesto de las distribuciones GNU/Linux. Permite realizar todo tipo de b\u00fasquedas de ficheros tanto por su nombre como por cualquiera de sus atributos. Existen numerosas opciones de b\u00fasqueda y combinaciones posibles, pero para eso disponemos de la ayuda en el terminal. A\u00fan as\u00ed, se tratar\u00e1n algunas opciones m\u00e1s comunes.</p> <p>El uso gen\u00e9rico de <code>find</code> es el siguiente:</p> Buscar<pre><code>find [ruta] [expresi\u00f3n_de_b\u00fasqueda] [acci\u00f3n]\n</code></pre> <p>El comportamiento por defecto del comando find es buscar de forma recursiva a partir de la direcci\u00f3n establecida en su primer par\u00e1metro. Para limitar esos resultados se utiliza la opci\u00f3n -maxdepth. Por ejemplo, se limita la b\u00fasqueda en el directorio de primer nivel</p> Ejemplo de find<pre><code>find /srv/www/web -maxdepth 1 -name \"*.js\"\n</code></pre> <p>Se puede indicar a find que busque en varios directorios d\u00e1ndole cada uno de ellos como argumentos</p> Ejemplo de find<pre><code>find /home/feo /tmp/project -name \"feo\"\n</code></pre> <p>o utilizar metacaracteres para buscar archivos en caso de no conocer los nombres exactos</p> Ejemplo de find<pre><code>find . \u2013name \"\\*feo\"\n</code></pre> <p>Las opciones que ofrece <code>find</code> son numerosas, entre ellas destacan:</p> <p><code>-perm</code>: hace que se busquen archivos que tienen un patr\u00f3n particular de permisos representados en octal. Esto permite detectar archivos que no tienen los permisos que deber\u00edan y que pueden suponer una amenaza para la seguridad del sistema. Tambi\u00e9n se dispone de opciones m\u00e1s sencillas como <code>-readable</code>, <code>-writable</code> y <code>-executable</code>, aunque tambi\u00e9n es posible usar el par\u00e1metro <code>-perm</code> a partir del cual podemos establecer esos tres permisos a la vez, como ilustra el siguiente ejemplo:</p> Ejemplo de busqueda con permisos determinados<pre><code>find /home/Feo -type f -perm -110\n</code></pre> <p>Con este comando se obtendr\u00edan ficheros con el bit del permiso ejecutable activado para el usuario y el grupo. El s\u00edmbolo guion \u201c-\u201d le indica que ignore otros bits. No importa si el fichero es de lectura o de escritura, lo esencial es que aparezcan todos los que tienen ese bit de ejecuci\u00f3n. Si es necesario que espec\u00edficamente se busquen ficheros que tengan el bit ejecutable para usuario, se prescinde del guion \u201c-\u201c. <code>-user</code> ,<code>-uid</code>: restringe la b\u00fasqueda a archivos que pertenecen a un usuario en concreto. En este \u00faltimo caso requiere conocer el identificador de un usuario, algo poco usual. Adem\u00e1s se puede buscar ficheros que pertenecen a un usuario A o a un usuario B con el par\u00e1metro <code>-or</code>, con lo que escribir\u00edamos:</p> Ejemplo de busqueda con usuarios determinados<pre><code>find / -user root -or -user Feo\n</code></pre> <p>Tambi\u00e9n existen los operadores l\u00f3gicos -<code>and</code> y <code>-not</code> para realizar b\u00fasquedas m\u00e1s precisas. Adem\u00e1s de por usuario, tambi\u00e9n es posible buscar ficheros que pertenezcan a un determinado grupo a trav\u00e9s de la opci\u00f3n <code>-group</code>.</p> <p><code>-name &lt;expresi\u00f3n&gt;</code> permite especificar patrones para los nombres de los ficheros a buscar. <code>-iname &lt;expresi\u00f3n&gt;</code> permite especificar patrones para los nombres de los ficheros a buscar sin tener en cuenta may\u00fasculas y min\u00fasculas. <code>-type &lt;tipo&gt;</code> permite indicar el tipo de fichero a buscar. \u00c9ste puede ser d para directorios y f para ficheros regulares.</p> <p>Otra de las posibilidades que ofrece <code>find</code> es buscar ficheros por su fecha de creaci\u00f3n, acceso o modificaci\u00f3n. Por tiempo de acceso con <code>-atime</code>, por \u00faltima modificaci\u00f3n con <code>-mtime</code> o por el \u00faltimo cambio de fichero <code>-ctime</code>. Todas las cifras de b\u00fasqueda se expresan en d\u00edas. Por ejemplo, ficheros que hayan sido modificados en los dos \u00faltimos d\u00edas</p> Ejemplo de busqueda con par\u00e1metros de tiempo<pre><code>find /home/Feo -mtime -2\n</code></pre> <p>Es posible combinar las opciones y buscar ficheros en un rango, por ejemplo, ficheros que tengan entre 2 y 5 d\u00edas desde su \u00faltima modificaci\u00f3n</p> Ejemplo de busqueda con par\u00e1metros de tiempo<pre><code>find -mtime -2 -mtime +5\n</code></pre> <p>Tambi\u00e9n se dispone de opciones para buscar por fracciones temporales de minuto con <code>-amin, -cmin y -mmin,</code> an\u00e1logas a las anteriores.</p> <p><code>-size +/-&lt;n&gt;</code> permite indicar el tama\u00f1o m\u00e1ximo y/o m\u00ednimo de los ficheros a buscar. Por defecto el tama\u00f1o se expresa en bloques de 512 bytes, pero si se precede este por un car\u00e1cter c se referir\u00e1 a bytes, k a kilobytes, w a palabras de dos bytes y b a bloques.</p> Ejemplo de busqueda con par\u00e1metros de tama\u00f1o<pre><code>find /home/Feo -size 100k\n</code></pre> <p>Esto permitir\u00eda buscar ficheros con un tama\u00f1o exacto de 100 kilobytes. Es probable que lo que se requiera es encontrar ficheros con un tama\u00f1o superior o inferior a esa cifra en cuyo caso se usa el signo + para ficheros mayores y el signo \u2013 para menores. Es posible buscar en gigabytes, basta con poner 100G, o 100M para megabytes.</p> <p><code>-exec &lt;comando&gt;</code> pero si en donde find demuestra su potencial es poder combinarlo con otros comandos para construir sinergias y facilitar tiempo de administraci\u00f3n. Tras encontrar los ficheros, se realizar\u00e1 el comando especificado en la opci\u00f3n -exec, una vez por cada ocurrencia encontrada en la b\u00fasqueda. De este modo, por ejemplo, es posible modificar el propietario de los ficheros de una carpeta personal</p> Ejemplo de busqueda ejecutando un comando<pre><code>find /home/Feo -user root -exec chown Feo {} \\;\n</code></pre> <p>Este comando ejecuta el comando <code>chown Feo</code> por cada fichero encontrado. El s\u00edmbolo de llaves \u201c{}\u201d especifica el conjunto de los resultados obtenidos y sobre los que va a realizar la acci\u00f3n. Las llaves han de colocarse en la posici\u00f3n que ocupar\u00eda el fichero que recibe la acci\u00f3n, que depender\u00e1 del comando a utilizar.</p> <p>Con <code>find</code> es posible encontrar archivos con una mayor precisi\u00f3n que con cualquier software con interfaz gr\u00e1fica y adem\u00e1s permite la ejecuci\u00f3n de comandos accesorios, ampliando a\u00fan m\u00e1s si cabe su potencial.</p>"},{"location":"UD2/filtros/","title":"Filtros","text":""},{"location":"UD2/filtros/#filtros","title":"Filtros","text":"<p>Un filtro (o un comando filtro) es un programa que sabe escribir y leer datos por los canales est\u00e1ndares de entrada y salida. Modifica o trata si es preciso el contenido. <code>wc</code> es un filtro. Las herramientas no siempre se comportan como filtros. Permiten un determinado n\u00famero de acciones en archivos y su contenido, como, por ejemplo, dar formato o imprimir.</p>"},{"location":"UD2/filtros/#busqueda-de-lineas","title":"B\u00fasqueda de l\u00edneas","text":"<p>Se trata de extraer l\u00edneas de un archivo seg\u00fan varios criterios. Para ello, dispone de tres comandos: <code>grep, egrep</code>, que leen los datos o bien desde un archivo de entrada, o bien desde el canal de entrada est\u00e1ndar.</p>"},{"location":"UD2/filtros/#grep","title":"grep","text":"sintaxis de grep<pre><code>grep [Opciones] modelo [Archivo1...]\n</code></pre> <p>El modelo se compone de criterios de b\u00fasqueda. No hay que olvidar que se debe interpretar estos criterios con el comando grep, y no con el shell. Por lo tanto, hace falta cerrar todos los caracteres.</p> Ejemplo, b\u00fasqueda de l\u00edneas que comiencen por b o B<pre><code>cat fic4\nCerdo\nTernera\nBuey\nrata\nRata\nbuey\n\n grep \"\u02c6[bB]\" fic4\nBuey\nbuey\n</code></pre> <p>El comando grep tambi\u00e9n puede tomar algunas opciones interesantes.</p> <ul> <li><code>-v</code> efect\u00faa la b\u00fasqueda inversa: se visualizan todas las l\u00edneas que no corresponden a los   criterios.</li> <li><code>-c</code> s\u00f3lo devuelve el n\u00famero de l\u00edneas encontradas, sin mostrarlas.</li> <li><code>-i</code>no diferencia las may\u00fasculas de las min\u00fasculas.</li> <li><code>-n</code> indica el n\u00famero de l\u00ednea para cada l\u00ednea encontrada.</li> <li><code>-l</code> en el caso de archivos m\u00faltiples, indica en qu\u00e9 archivo se ha encontrado la l\u00ednea.</li> </ul> Ejemplo, con la opci\u00f3n -i<pre><code>$ grep -i \"\u02c6b\" fic4\nBuey\nbuey\n</code></pre>"},{"location":"UD2/filtros/#egrep","title":"egrep","text":"<p>El comando egrep extiende los criterios de b\u00fasqueda y puede aceptar un archivo de criterios en entrada. Equivale a un <code>grep -E</code>. Emplea como criterios expresiones regulares.</p> sintaxis de grep<pre><code>egrep -f archivo_criterio archivo_b\u00fasqueda\n</code></pre> Car\u00e1cter especial Significado <code>\\|</code> O l\u00f3gico, la expresi\u00f3n colocada antes o despu\u00e9s debe desaparecer. <code>(...)</code> Agrupaci\u00f3n de caracteres. <code>[...]</code> Un car\u00e1cter tiene esta posici\u00f3n entre los indicados. <code>. (punto)</code> Cualquier car\u00e1cter. <code>+</code> Repetici\u00f3n, el car\u00e1cter colocado antes debe aparecer al menos una vez. <code>*</code> Repetici\u00f3n, el car\u00e1cter colocado antes debe aparecer de cero a n veces. <code>?</code> El car\u00e1cter colocado antes debe aparecer una vez como m\u00e1ximo. <code>{n}</code> El car\u00e1cter colocado antes debe aparecer exactamente n veces. <code>{n,}</code> Aparece n veces o m\u00e1s. <code>{n,m}</code> Aparece entre n y m veces. <code>\u02c6</code> En principio de cadena. <code>$</code> En final de cadena. <p>\u00danicamente \"buenas tardes\" y \"buenas noches\" empezar\u00e1n por una may\u00fascula o una min\u00fascula si est\u00e1n solos en una l\u00ednea:</p> <pre><code>\u02c6[bB]uenas(tardes|noches)$\n</code></pre> <p>Verificaci\u00f3n muy escueta de la validez de una direcci\u00f3n IP:</p> Expresion regular para una IP<pre><code>echo $IP | egrep \u2019([0-9]{1,3}\\.){3}[0-9]{1,3}\u2019\n</code></pre> <p>Esta l\u00ednea se descompone de la manera siguiente:</p> <ul> <li><code>([0-9]{1,3}\\.){3}</code>: www.xxx.yyy.</li> <li><code>[0-9]</code>: un car\u00e1cter entre 0 y 9</li> <li><code>{1,3}</code>: repetido entre una y tres veces, por lo tanto: x, xx o xxx</li> <li><code>\\.</code>: seguido de un punto</li> <li><code>{3}</code>: el conjunto tres veces   Luego [0-9]{1,3}: .zzz</li> <li>[0-9]: un car\u00e1cter entre 0 y 9</li> <li>{1,3}: repetido entre una y tres veces</li> </ul>"},{"location":"UD2/filtros/#columnas-y-campos","title":"Columnas y campos","text":"<p>El comando <code>cut</code> permite seleccionar columnas y campos en un archivo.</p>"},{"location":"UD2/filtros/#columnas","title":"Columnas","text":"sintaxis del comando<pre><code>cut -cColumnas [fic1...]\n</code></pre> <p>Una columna es la posici\u00f3n de un car\u00e1cter en la l\u00ednea. Una l\u00ednea de 80 caracteres dispone de 80 columnas. La numeraci\u00f3n empieza en 1. Es el m\u00e9todo ideal para archivos planos y con formato fijo, donde cada campo empieza y termina con posiciones dadas. El formato de selecci\u00f3n de columna es el siguiente:</p> <ul> <li>una columna sola (p. ej. <code>-c2</code> para la columna 2);</li> <li>un intervalo (p. ej. <code>-c2-4</code> para las columnas 2, 3 y 4);</li> <li>una lista de columnas (p. ej. <code>-c1,3,6</code> para las columnas 1, 3 y 6);</li> <li>los tres a la vez (p. ej. <code>-c1-3,5,6,12-</code>).</li> </ul> Ejemplo de extraci\u00f3n de columnas<pre><code> cat lista\nProducto    precio   cantidades\nrat\u00f3n       30       15\ndisco       100      30\npantalla    300      20\nteclado     45       30\n$ cut -c1-5 lista\nProdu\nrat\u00f3n\ndisco\npanta\ntecla\n</code></pre>"},{"location":"UD2/filtros/#campos","title":"Campos","text":"<p>El comando cut tambi\u00e9n permite seleccionar campos. Se deben delimitar estos campos por defecto por una tabulaci\u00f3n, pero el par\u00e1metro <code>-d</code> permite seleccionar otro car\u00e1cter (espacio, ;). La selecci\u00f3n de los campos es id\u00e9ntica a la de las columnas.</p> <pre><code>cut -dc -fCampos [fic1...]\n</code></pre> <p>Note</p> <p>El car\u00e1cter separador debe ser \u00fanico.el separador por defecto es la tabulaci\u00f3n</p> Ejemplo<pre><code>cat lista\nProducto    precio   cantidades\nrat\u00f3n       30       15\ndisco       100      30\npantalla    300      20\nteclado     45       30\n\n$ cut -f1 lista\nProducto\nrat\u00f3n\nduro\ndisco\npantalla\nteclado\ntarjeta\n$ cut -f1,3 lista\nProducto cantidades\nrat\u00f3n 15\nduro 30\ndisco 30\npantalla 20\nteclado 30\ntarjeta 30\n</code></pre> <p>Si tenemos un delimitador diferente al tabulador como podemos observar en ejemplo.</p> <pre><code> cut -d: -f1,3 /etc/group\nat:25\naudio:17\navahi:106\nbeagleindex:107\nbin:1\ncdrom:20\nconsole:21\ndaemon:2\ndialout:16\ndisk:6\n</code></pre>"},{"location":"UD2/filtros/#recuento-de-lineas","title":"Recuento de l\u00edneas","text":"<p>El comando <code>wc</code> (word count) permite contar las l\u00edneas, las palabras y los caracteres.</p> sintaxis de comando<pre><code>wc [-l] [-c] [-w] [-w] fic1\n -l: cuenta el n\u00famero de l\u00edneas\n -c: cuenta el n\u00famero de bytes\n -w: cuenta el n\u00famero de palabras\n -m: cuenta el n\u00famero de caracteres\n</code></pre> Ejemplo<pre><code>$ wc lista\n12\n48\n234 lista\n</code></pre> <p>El archivo lista contiene 12 l\u00edneas, 48 palabras y 234 caracteres.</p>"},{"location":"UD2/filtros/#ordenacion-de-lineas","title":"Ordenaci\u00f3n de l\u00edneas","text":"<p>El comando <code>sort</code> permite ordenar las l\u00edneas. Por defecto, la ordenaci\u00f3n se hace sobre toda la tabla en orden creciente. La ordenaci\u00f3n es posible a partir de uno o varios campos. El separador de campos por defecto es la tabulaci\u00f3n o, al menos, un espacio. Si hay varios campos, el primero es el separador; los dem\u00e1s son caracteres del campo.</p> <p>La sintaxis de sort ha evolucionado desde hace varios a\u00f1os y Linux ha aplicado un est\u00e1ndar. Adem\u00e1s, ya no utiliza la antigua sintaxis basada en +/-. En su lugar, hay que utilizar el par\u00e1metro -k. La numeraci\u00f3n de los campos empieza con 1.</p> sintaxis del comando<pre><code>sort [opciones] [-k pos1[,pos2]] [fic1...]\n</code></pre> Ejemplo de utilizaci\u00f3n<pre><code>$ cat lista\nrat\u00f3n \u00f3ptico 30 15\nduro 30giga 100 30\nduro 70giga 150 30\ndisco zip  12  30\ndisco blando 10 30\npantalla 15 150 20\npantalla 17 300 20\npantalla 19 500 20\nteclado 105 45 30\nteclado 115 55 30\ntarjeta sonido 45 30\ntarjeta v\u00eddeo 145 30\n</code></pre> <p>A continuaci\u00f3n vemos c\u00f3mo ordenar por orden alfab\u00e9tico a partir de la primera columna:</p> Ejemplo.Ordenaci\u00f3n<pre><code>sort -k 1 lista\ndisco blando 10 30\ndisco zip 12 30\nduro 30giga 100 30\nduro 70giga 150 30\npantalla 15 150 20\npantalla 17 300 20\npantalla 19 500 20\nrat\u00f3n \u00f3ptico 30 15\ntarjeta sonido 45 30\ntarjeta v\u00eddeo 145 30\nteclado 105 45 30\nteclado 115 55 30\n</code></pre> <p>Algunos par\u00e1metros</p> Opci\u00f3n Funci\u00f3n <code>-d</code> Dictionnary sort (ordenaci\u00f3n de diccionario).S\u00f3lo toma como criterio de ordenaci\u00f3n las letras,las cifras y los espacios. <code>-n</code> Ordenaci\u00f3n num\u00e9rica, ideal para las columnas de cifras. <code>-b</code> Ignora los espacios al principio del campo. <code>-f</code> No hay diferencias entre may\u00fasculas y min\u00fasculas (conversi\u00f3n en min\u00fasculas y luego ordenaci\u00f3n). <code>-r</code> Reverse, ordenaci\u00f3n en orden decreciente. <code>-tc</code> Nuevo delimitador de campo c Ejemplo: ordenaci\u00f3n num\u00e9rica a partir de los precios por productos en orden decreciente<pre><code>sort -n -r -k 3 lista\n\npantalla 19 500 20\npantalla 17 300 20\npantalla 15 150 20\nduro 70giga 150 30\ntarjeta v\u00eddeo 145 30\nduro 30giga 100 30\nteclado 115 55 30\nteclado 105 45 30\ntarjeta sonido 45 30\nrat\u00f3n \u00f3ptico 30 15\ndisco zip 12 30\ndisco blando 10 30\n</code></pre> <p>Tambi\u00e9n es posible ejecutar la ordenaci\u00f3n desde un determinado car\u00e1cter de un campo. Para ello, debe especificar el <code>\".pos\": -k1.3</code> empezar\u00e1 la ordenaci\u00f3n a partir del tercer car\u00e1cter del campo 1.</p>"},{"location":"UD2/filtros/#eliminacion-de-las-lineas-repetidas","title":"Eliminaci\u00f3n de las l\u00edneas repetidas","text":"<p>El comando <code>uniq</code> permite suprimir las l\u00edneas repetidas en flujos de entrada o archivos ordenados. Por ejemplo, a continuaci\u00f3n se muestra c\u00f3mo sacar \u00fanicamente la lista de los GID realmente utilizados como grupo principal de usuarios:</p> Ejemplo. Eliminaci\u00f3n de l\u00edneas repetidas<pre><code>cut -d: -f4 /etc/passwd | sort -n | uniq\n0\n1\n2\n7\n8\n12\n13\n14\n25\n49\n</code></pre>"},{"location":"UD2/filtros/#sustitucion-de-caracteres","title":"Sustituci\u00f3n de caracteres","text":"<p>El comando <code>tr</code> permite sustituir unos caracteres con otros y s\u00f3lo acepta datos que provengan del canal de entrada est\u00e1ndar, no de los archivos.</p> Sintaxis de tr<pre><code>tr [opciones] original destino\n</code></pre> <p>El original y el destino representan uno o varios caracteres. Se sustituyen los caracteres originales con los de destino en el orden indicado. Los corchetes permiten definir intervalos.</p> sustituir la o por la e y la i por la a:<pre><code>cat lista | tr \"oi\" \"ea\"\n\nPredut ebjete precie cantadades\nraten  \u00e9ptaque 30 15\ndure 30gaga 100 30\ndure 70gaga 150 30\ndasce zap 12 30\ndasce blande 10 30\npantalla 15  150 20\npantalla 17  300 20\npantalla 19 500 20\nteclade 105 45 30\nteclade 115 55 30\ntarjeta senade 45 30\ntarjeta vadee 145 30\n</code></pre> Ejemplo. convertir una cadena en may\u00fasculas o en min\u00fasculas<pre><code> cat lista | tr \"[a-z]\" \"[A-Z]\"\nPRODUCTO OBJETO PRECIO CANTIDADES\nRAT\u00d3N \u00d3PTICO 30 15\nDURO 30GIGA 100 30\nDURO 70GIGA 150 30\nDISCO ZIP 12 30\nDISCO BLANDO 10 30\nPANTALLA 15 150 20\nPANTALLA 17 300 20\nPANTALLA 19 500 20\nTECLADO 105 45 30\nTECLADO 115 55 30\nTARJETA SONIDO 45 30\nTARJETA V\u00cdDEO 145 30\n</code></pre> <p>Sobre todo, <code>tr</code> admite dos par\u00e1metros,<code>-s (squeeze)</code> y <code>-d (delete)</code>, que permiten suprimir caracteres, duplicados o no.</p> <p>A continuaci\u00f3n damos un ejemplo pr\u00e1ctico en el cual se busca aislar la direcci\u00f3n IP de una m\u00e1quina.</p> Ejemplo.Aislar la direcci\u00f3n ip<pre><code>ip a\n\n2: enp7s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000\n    link/ether 8c:16:45:ec:03:2d brd ff:ff:ff:ff:ff:ff\n    inet 192.168.0.11/24 brd 192.168.0.255 scope global dynamic noprefixroute enp7s0\n       valid_lft 84531sec preferred_lft 84531sec\n    inet6 fe80::3ff2:8996:7beb:c511/64 scope link noprefixroute\n       valid_lft forever preferred_lft forever\n\n# Nos muestra esta salida, solo queremos la ip del interfaz correspondiente. Para ello vamos a realizar algunas transformaciones.\n\n# Como hacemos un filtro sobre el interfaz nos dan dos lineas por eso hay que convertirla en una linea quit\u00e1ndole el final de linea \\n.\n\nip a | grep enp7s0 |tr -s \"\\n\" \" \"|  tr -s \" \" \":\" |  cut -d: -f15\n</code></pre> <p>Otros comandos \u00fatiles en la sustituci\u00f3n de caracteres son: el comando <code>expand</code> convierte las tabulaciones en espacios y el comando <code>unexpand</code> convierte los espacios en tabulaciones. Aunque la acci\u00f3n de estos comandos se puede realizar con el comando tr. Sabiendo que, la tabulaci\u00f3n es '\\t'.</p>"},{"location":"UD2/gestionArchivos/","title":"Gesti\u00f3n de los Archivos","text":""},{"location":"UD2/gestionArchivos/#los-diferentes-tipos-de-archivos","title":"Los diferentes tipos de archivos","text":"<p>Distinguimos tres tipos de archivos: ordinarios, cat\u00e1logo, especiales.</p>"},{"location":"UD2/gestionArchivos/#los-archivos-ordinarios-o-regulares","title":"Los archivos ordinarios o regulares","text":"<p>Los archivos ordinarios se llaman tambi\u00e9n archivos regulares, ordinary files o regular files. Son</p> <p>archivos totalmente cl\u00e1sicos que contienen datos. Por datos se debe entender cualquier contenido:</p> <ul> <li>texto;</li> <li>imagen;</li> <li>audio;</li> <li>programa binario compilado</li> <li>etc..</li> </ul> <p>Por defecto, nada permite diferenciar unos de otros, salvo la utilizaci\u00f3n de algunas opciones de determinados comandos (ls -F por ejemplo) o el comando file.</p> <p>file nom_arch nom arch: 32 Bits ELF Executable Binary (stripped)</p> <p>Linux desconoce la noci\u00f3n de extensi\u00f3n de archivo como componente interno de la estructura del sistema de archivos. Se la considera simplemente como parte del nombre</p>"},{"location":"UD2/gestionArchivos/#los-catalogos","title":"Los cat\u00e1logos","text":"<p>Los archivos cat\u00e1logo son los directorios o carpetas. Los directorios permiten organizar el disco duro creando una jerarqu\u00eda. Un directorio puede contener archivos normales, archivos especiales y otros directorios de manera recursiva. Un directorio no es m\u00e1s que un archivo particular que contiene la lista de los propios archivos presentes en este directorio. Esta noci\u00f3n resultar\u00e1 muy \u00fatil cuando se trate el tema de los permisos.</p>"},{"location":"UD2/gestionArchivos/#los-archivos-especiales","title":"Los archivos especiales","text":"<p>El tercer tipo de archivos es el especial. Existen varios tipos de archivos especiales. Por ejemplo, los drivers de los perif\u00e9ricos est\u00e1n representados por archivos especiales de la carpeta <code>/dev</code> Son principalmente archivos que sirven de interfaz para los diversos perif\u00e9ricos. Se pueden utilizar, seg\u00fan el caso, como archivos normales. Cuando se accede en modo lectura o escritura a estos archivos se redirigen hacia el perif\u00e9rico (pasando por el driver asociado si existe).</p>"},{"location":"UD2/gestionArchivos/#nomenclatura-de-los-archivos","title":"Nomenclatura de los archivos","text":"<p>No se puede dar cualquier nombre a un archivo; hay que seguir unas simples reglas, v\u00e1lidas para todos los tipos de archivos.</p> <p>En los antiguos sistemas Unix, un nombre de archivo no pod\u00eda superar los 14 caracteres. En los sistemas actuales, Linux incluido, se puede llegar hasta 255 caracteres. La posible extensi\u00f3n est\u00e1 incluida en la longitud del nombre del archivo. Un punto extremamente importante: Linux respeta la distinci\u00f3n entre los nombres de archivos en min\u00fasculas y en may\u00fasculas. Pepito, PEPITO, PePito y pepito son nombres de archivos diferentes, con un contenido diferente. Esta distinci\u00f3n es intr\u00ednseca al tipo de sistema de archivos. En otros sistemas de tipo Unix (como Mac OS X) este comportamiento puede ser opcional. Se acepta la mayor\u00eda de los caracteres (las cifras, las letras, las may\u00fasculas, las min\u00fasculas, ciertos signos, los caracteres acentuados), incluido el espacio. Sin embargo, se deben evitar algunos caracteres, ya que tienen un significado particular dentro del shell: &amp; ; ( ) ~  \\ / | ` ? - (al principio del nombre). Los nombres siguientes son v\u00e1lidos: \u2022 Archivo1 \u2022 Paga.txt \u2022 123tratamiento.sh \u2022 Paga_junio_2002.xls \u2022 8 Los nombres siguientes, aunque v\u00e1lidos, pueden crear problemas: \u2022 Archivo* \u2022 Pago(diciembre) \u2022 Ben&amp;Nuts \u2022 Paga junio 2002.xls \u2022 -f"},{"location":"UD2/gestionArchivos/#rutas-de-acceso-a-ficheros","title":"Rutas de acceso a ficheros","text":"<p>Para poder desplazarse dentro de un sistema de ficheros hay que entender una serie de conceptos como directorio actual, padre y ra\u00edz:</p> <p>pwd</p> <p>(print working directory) Comando que imprime por pantalla el directorio actual de trabajo.</p> <ul> <li>directorio ra\u00edz, es la carpeta desde la cual cuelga todo el sistema de ficheros del GNU/Linux. Marca en inicio de todas las rutas absolutas a seguir.</li> <li>directorio actual, marca la posici\u00f3n actual en la que el usuario se encuentra. El archivo feo.txt ubicado en el escritorio del usuario feo, tendr\u00eda como direcci\u00f3n actual /home/feo/Escritorio, que tambi\u00e9n suele representase como un punto.</li> <li>directorio padre, identifica la carpeta inmediatamente anterior a la posici\u00f3n actual. En el ejemplo anterior, la carpeta padre del archivo feo.txt ser\u00eda /home/feo. Todas las direcciones de la estructura de directorios poseen un directorio padre, a excepci\u00f3n del directorio ra\u00edz.</li> </ul> <p>Adem\u00e1s de manejar estos conceptos con soltura, es necesario entender a qu\u00e9 se hace referencia cuando hablamos de la ruta de una archivo. Se trata de la direcci\u00f3n que, de forma un\u00edvoca, ubica al archivo dentro de la estructura de ficheros. En el caso del fichero feo.txt, tendr\u00eda dos formas de especificar su ruta:</p> <ul> <li>ruta absoluta, que contiene la direcci\u00f3n desde el inicio de la estructura de ficheros hasta el archivo. Este tipo de rutas dependen de s\u00ed mismas ya que ofrecen el camino completo para llegar al fichero. En el ejemplo anterior ser\u00eda <code>/home/feo/Escritorio/feo.txt</code>.</li> <li>ruta relativa, la cual indica la ruta hacia el fichero pero relativa a la posici\u00f3n en la que se encuentra el usuario. Por ejemplo, al iniciar un terminal, el sistema siempre ubica al usuario en su carpeta home. Si iniciamos un terminal con el usuario feo, la ruta hacia el fichero <code>feo.txt</code> ser\u00eda <code>./Escritorio/feo.txt</code>. El punto inicial indica la posici\u00f3n actual del usuario y, como se encuentra en su carpeta home, el punto se traduce como <code>/home/feo</code>. De este modo, si se suma la direcci\u00f3n actual con la relativa se obtiene la ruta completa al fichero.</li> </ul> <p>Para desplazarse a trav\u00e9s del \u00e1rbol de directorios disponemos del comando <code>cd (change directory)</code>, que curiosamente funciona de id\u00e9ntica forma tanto en el terminal de Microsoft Windows como en el de GNU/Linux. Para acceder a una carpeta tan s\u00f3lo ser\u00e1 necesario indicar su ruta, ya sea absoluta</p> <pre><code>cd /home/feo/Escritorio/ISO\n</code></pre> <p>o relativa al punto en el que el usuario se encuentra</p> <pre><code>cd ./Escritorio/ISO\n</code></pre> <p>mkdir</p> <p><code>mkdir &lt;nombre&gt;</code> (make directory) crea un directorio con el nombre especificado. Una opci\u00f3n interesante es <code>-p</code> que nos permite realizar una estructura de directorios.</p> <p>Tambi\u00e9n es posible salir de esa carpeta utilizando la representaci\u00f3n del directorio padre (dos puntos seguidos)</p> <pre><code>cd ..\n</code></pre> <p>esto desplaza al usuario a la carpeta padre de la posici\u00f3n actual en la que se encuentra. Si esa ubicaci\u00f3n es el escritorio del usuario, es decir <code>/home/feo/Escritorio</code>, la ubicaci\u00f3n del usuario cambiar\u00e1 a <code>/home/feo</code>.</p> <p>cp</p> <p><code>cp &lt;origen&gt; &lt;destino&gt;</code> (copy) Comando para copiar ficheros desde un origen a un destino indicado..</p> <p>Es de vital importancia que el administrador entienda y domine esta forma de desplazarse entre carpetas y a usar de forma correcta estas tipolog\u00edas de rutas. Ambas ser\u00e1n utilizadas en funci\u00f3n de las necesidades de la tarea a realizar.</p> <p>cat</p> <p><code>cat &lt;archivo&gt;</code>, muestra el contenido del archivo pasado como par\u00e1metro.</p> <p>touch</p> <p><code>touch &lt;fichero&gt;</code>, crea el fichero pasado como par\u00e1metro.</p>"},{"location":"UD2/gestorArranque/","title":"Gestores de arranque","text":"<p>Los gestores de arranque de un ordenador indican d\u00f3nde se encuentra el sistema operativo que se ha de cargar en memoria principal para que asuma el control del equipo. Pero antes de llegar a esta fase, el sistema realiza una serie de tareas y comprobaciones que se conocen como secuencia de arranque. A diferencia del arranque del sistema operativo, \u00e9sta es com\u00fan a todos los ordenadores y se compone de las siguientes fases:</p> <pre><code>- la secuencia de arranque comienza cuando el usuario pulsa el bot\u00f3n de encendido (arranque en fr\u00edo). La corriente llega a la placa base y desde all\u00ed al resto de componentes.\n- el procesador busca las instrucciones necesarias para el inicio de la BIOS o UEFI. \u00c9stas se encuentran en una memoria ROM asociada al procesador que contiene un salto hacia la ubicaci\u00f3n del firmware BIOS.\n- se carga la BIOS y lee la configuraci\u00f3n almacenada en la memoria **CMOS**. Tras esto, ejecuta la primera subrutina que es el POST (Power On Seft Test) y se trata en un conjunto de instrucci\u00f3n que comprueban si el estado del hardware es correcto. El **POST** env\u00eda la informaci\u00f3n mediante se\u00f1ales ac\u00fasticas para informar al usuario de los errores encontrados. Cada fabricante posee un c\u00f3digo de errores, por lo que ser\u00e1 necesario la consulta del manual de la placa para comprobar su equivalencia. Lo que s\u00ed parece un\u00e1nime es que al terminar la prueba de hardware, si no se han detectado errores, se produce un \u00fanico pitido corto. Si se detecta alg\u00fan error, el proceso de arranque se detiene.\n- la **BIOS/UEFI** busca el firmware de la tarjeta gr\u00e1fica y le cede el control de forma temporal para que inicie la interfaz gr\u00e1fica. A partir de este punto, toda la informaci\u00f3n del proceso de arranque ser\u00e1 ofrecida por pantalla.\n- una vez recuperado el control, continua con la carga del resto del hardware.\n- realiza una comprobaci\u00f3n de los componentes de memoria, tanto principal a trav\u00e9s del MemoryTest, como secundaria comprobando las interfaces IDE (si existiesen), SATA y PCI Express.\n- genera un resumen con toda la informaci\u00f3n detectada del hardware que muestra por pantalla.\n- finalmente localiza el gestor de arranque y pasa el testigo a \u00e9ste para que se prosiga con el inicio de la carga del sistema operativo.\n</code></pre> <p>Esta \u00faltima fase es diferente si el sistema tiene implementado BIOS o UEFI. Si se trata del segundo caso, el propio firmware de la placa base es capaz de iniciar el sistema operativo ahorrando tiempo de b\u00fasqueda. En realidad se siguen utilizando gestores de arranque por cuestiones de compatibilidad con sistemas operativos antiguos. A partir de aqu\u00ed el sistema de arranque del sistema operativo depender\u00e1 de cual est\u00e9 instalado en el ordenador, pero todos siguen el siguiente patr\u00f3n: </p> <ul> <li>el gestor de arranque usa la informaci\u00f3n de la BIOS/UEFI para buscar la partici\u00f3n de arranque.</li> <li>carga los archivos que constituyen el n\u00facleo del sistema operativo en memoria principal.</li> <li>lee los archivos del registro, elige un perfil de hardware y carga los controladores de dispositivos.</li> </ul> <p>En este momento, el kernel del sistema operativo toma control del proceso y comienza a cargar el resto de archivos del sistema operativo en memoria principal. Una vez terminada la carga, ofrece el control al usuario a trav\u00e9s de una interfaz, ya sea a trav\u00e9s de un terminal (CLI) o con interfaz gr\u00e1fica (GUI).</p>"},{"location":"UD2/gestorArranque/#modificacion-del-gestor-de-arranque","title":"Modificaci\u00f3n del gestor de arranque","text":"<p>Los sistemas operativos de Microsoft, tienen el gestor de arranque integrado en el sistema operativo. En Microsoft Windows 10, es posible acceder a \u00e9l desde el men\u00fa de Inicio \u2192 Aplicaciones \u2192 Herramientas Administrativas de Windows \u2192 Configuraci\u00f3n del Sistema. Aunque en todas las versiones se puede abrir esta configuraci\u00f3n usando la herramienta <code>msconfig</code> en la opci\u00f3n Inicio \u2192 Ejecutar.</p> <p>Cualquiera de estas dos acciones nos da acceso a la configuraci\u00f3n de arranque del sistema, pesta\u00f1a Arranque, desde la que podremos configurar el orden que aparecen los elementos en el men\u00fa, la duraci\u00f3n de la espera antes que el sistema inicie la opci\u00f3n por defecto, modificar la opci\u00f3n predeterminada, si se necesita arrancar en modo a prueba de errores o si es necesario el arranque en modo verbose, el cual ofrece informaci\u00f3n de arranque del sistema operativo paso a paso. </p> <p>Adem\u00e1s, el las opciones avanzadas podremos asignar recursos para un sistema operativo en concreto, o si es necesario su ejecuci\u00f3n en modo depuraci\u00f3n. Este modo ofrece informaci\u00f3n de cada uno de los pasos que realiza el sistema y resulta muy \u00fatil para la detecci\u00f3n de problemas.</p> <p>Por lo que respecta a GNU GRUB, tambi\u00e9n es posible modificar las opciones de arranque del sistema. Esta operaci\u00f3n es posible realizarla directamente desde el archivo de configuraci\u00f3n de grub situado en /boot/grub/grub.cfg. Hay que tener extremo cuidado cuando se edite un archivo del sistema. Como medida de seguridad siempre realizaremos una copia de los ficheros que se han de modificar. Hay numerosas formas de hacer esta copia y el siguiente comando es una buen ejemplo de ello:</p> Hacer una copia del fichero de configuraci\u00f3n<pre><code>sudo cat /boot/grub/grub.cfg &gt;&gt;/home/usuario/grub.cfg.copia\n</code></pre> <p>Para luego comenzar la edici\u00f3n del fichero de configuraci\u00f3n:</p> Editor nano para editar el archivo de configuraci\u00f3n<pre><code>sudo nano /boot/grub/grub.cfg\n</code></pre> <p>El archivo <code>grub.cfg</code> est\u00e1 dividido varias partes con las que podremos cambiar opciones del men\u00fa que aparece al iniciar el ordenador. De entre todo el c\u00f3digo que contiene este fichero,, las partes que imprimen las opciones del men\u00fa est\u00e1n contenidas entre l\u00edneas como estas:</p> <pre><code>###BEGIN /etc/grub.d/10_linux ###\nC\u00f3digo con las opciones de lanzamiento del sistema operativo\n### END /etc/grub.d/10_linux\n</code></pre> <p>Cada una de esta secci\u00f3n del c\u00f3digo contendr\u00e1 una entrada del men\u00fa. Hay que tener en cuenta que el texto \u201c10_linux\u201d hace referencia a una entrada espec\u00edfica del fichero <code>/etc/grub.d</code>, por lo que en cada l\u00ednea esta parte del c\u00f3digo ser\u00e1 diferente. Si se elimina todo el c\u00f3digo contenido entre estas l\u00edneas, ellas inclusive, la opci\u00f3n a la que se refiere desaparecer\u00e1 del men\u00fa de inicio.</p> <p>Eliminar c\u00f3digo de un archivo de configuraci\u00f3n nunca es una buena idea, as\u00ed que comentaremos estas l\u00edneas a\u00f1adiendo una almohadilla # como primer car\u00e1cter.</p> <p>Dentro de \u00e9ste c\u00f3digo se encontrar\u00e1 el texto mostrado por pantalla antecedido por la opci\u00f3n menuentry. Si lo que queremos es cambiar el texto que aparece en el men\u00fa, escribiremos el nuevo texto entre las comillas del c\u00f3digo. Otra l\u00ednea importante es la que hace referencia al sistema operativo predeterminado:</p> <pre><code>set default=\u201d4\u201d\n</code></pre> <p>Esta l\u00ednea indica que de forma predeterminada arrancar\u00e1 el sistema operativo n\u00famero cinco del listado que contiene el listado anterior. Si es necesario que arranque el primer sistema operativo del listado, tan solo hay que cambiar el cuatro por un cero. Recuerda que GNU/Linux comienza a numerar desde el cero, no desde el uno. Hay que tener en cuenta el orden en el que los sistemas operativos est\u00e1n ordenados en el fichero para obtener el resultado deseado.</p> <p>Por \u00faltimo, la duraci\u00f3n que aparece el men\u00fa en pantalla se puede modificar desde estas l\u00edneas:</p> <pre><code>if [ ${recordfail} = 1 ]; then\nset timeout=-1\nelse\nset timeout=10\nfi\n</code></pre> <p>Esta condici\u00f3n nos muestra el men\u00fa durante diez segundos. El tiempo que se puede ajustar es el que se encuentra en el else, ya que la primera opci\u00f3n ser\u00e1 ejecutada si algo ha ido mal. Modificando este sencillo fichero de texto es posible cambiar las opciones de arranque del sistema basado en GNU GRUB.</p> <p>Gracias a la comunidad, GNU GRUB dispone de una herramienta gr\u00e1fica que nos permite realizar estas acciones de una forma m\u00e1s sencilla. Esta aplicaci\u00f3n se llama Grub-Customizer y permite realizar todas estas configuraciones de un modo m\u00e1s seguro y eficiente, adem\u00e1s de ofrecer muchas m\u00e1s opciones de configuraci\u00f3n como la edici\u00f3n del estilo del men\u00fa o la inclusi\u00f3n de im\u00e1genes. Para instalarlo ser\u00e1 necesario configurar su repositorio, actualizarlo y proceder a su instalaci\u00f3n, tal y como detallan los siguientes comandos</p> instalaci\u00f3n de un paquete<pre><code>sudo add-apt-repository ppa:danielrichter2007/grub-customizer\nsudo apt-get update\nsudo apt-get install grub-customizer\n</code></pre>"},{"location":"UD2/gestorArranque/#arranque-dual","title":"Arranque dual","text":"<p>En ocasiones ser\u00e1 \u00fatil que se instalen dos o m\u00e1s sistemas operativos en un mismo ordenador. Nunca podr\u00e1n funcionar de forma simult\u00e1nea, pero existe la posibilidad e cargar uno durante el inicio del equipo. Cuando el gestor de arranque se inicie, mostrar\u00e1 al usuario la opci\u00f3n de elegir el sistema operativo que necesite. Si el usuario no selecciona uno, el gestor de arranque tiene configurado uno por defecto, y ser\u00e1 ese el sistema que inicie.</p> <p>A la hora de configurar un sistema de arranque dual, hay que tener presente que los sistemas operativos deben instalarse en particiones separadas. Muchos no son compatibles entre s\u00ed y la instalaci\u00f3n de uno eliminar\u00eda el anterior. Existe la excepci\u00f3n de Microsoft Windows, la cual dispone de varias versiones que s\u00ed permite instalarlas en la misma partici\u00f3n. A pesar de ello, esta pr\u00e1ctica no es recomendable. Una buena idea es dotar a cada uno de su propio espacio.</p> <p>Durante el proceso de instalaci\u00f3n, cada sistema operativo instala su gestor de arranque y, dependiendo de la versi\u00f3n, es posible que elimine el anterior. Esto suele ocurrir cuando el sistema operativo que se instala posteriormente es m\u00e1s antiguo que el instalado. Este problema es muy sensible en las versiones de Microsoft Windows, en donde es recomendable seguir un orden de instalaci\u00f3n comenzando desde la m\u00e1s antigua hasta la m\u00e1s reciente. Una vez concluida la instalaci\u00f3n de las versiones de Microsoft Windows, se recomienda instalar las de GNU/Linux.</p> <p>Este problema, el de eliminar el gestor de arranque anterior, no afecta a las distribuciones de GNU/Linux, ya que utiliza un gestor de arranque independiente del sistema operativo y, habitualmente, se utiliza GNU GRUB o Lilo (Linux Loader), aunque \u00e9ste \u00faltimo cada vez menos. GNU GRUB (GRand Unified Bootloader) recorre todas las particiones del disco duro en busca de ficheros de arranque de sistemas operativos. Los detecta y los incorpora a un men\u00fa que mostrar\u00e1 al usuario al iniciar el equipo. Por tanto, GNU GRUB permite la instalaci\u00f3n de cualquier sistema operativo en cualquier orden.</p>"},{"location":"UD2/permisosBasicos/","title":"Los permisos b\u00e1sicos","text":""},{"location":"UD2/permisosBasicos/#permisos-y-usuarios","title":"Permisos y usuarios","text":"<p>El papel de un sistema operativo es tambi\u00e9n el de asegurar la integridad y el acceso a los datos, lo que es posible gracias a un sistema de permisos. A cada archivo o directorio se le asignan unos privilegios que le son propios, as\u00ed como autorizaciones de acceso individuales. Al intentar acceder, el sistema comprueba si est\u00e1 autorizado.</p> <p>Cuando el administrador crea un usuario, le asigna un UID (User Identification) \u00fanico. Los usuarios quedan definidos en el archivo <code>/etc/passwd</code>. Del mismo modo, cada usuario se integra en, al menos,un grupo (grupo primario). Todos \u00e9stos tienen un identificador \u00fanico, el GID (Group Identification)y est\u00e1n definidos en el archivo <code>/etc/group</code>.</p> <p>El comando <code>id</code> permite obtener esta informaci\u00f3n. A nivel interno, el sistema trabaja \u00fanicamente con los UID y GID, y no con los propios nombres.</p> Ejemplo de uso del comando id<pre><code>id\nuid=1000(julio) gid=1000(julio) grupos=1000(julio),4(adm),20(dialout),24(cdrom),27(sudo),30(dip),46(plugdev),116(lpadmin),118(scanner),126(sambashare),129(vboxusers),998(docker)\n</code></pre> <p>Se asocian un UID y un GID a cada archivo que define su propietario y su grupo con privilegios. Usted asigna permisos al propietario, al grupo con privilegios y al resto de la gente. Se distinguen tres casos:</p> <ul> <li>UID del usuario id\u00e9ntico al UID definido para el archivo. Este usuario es propietario del archivo.</li> <li>Los UID son diferentes: el sistema comprueba si el GID del usuario es id\u00e9ntico al GID del archivo. Si es el caso, el usuario pertenece al grupo con privilegios del archivo.</li> <li>En los otros casos (ninguna correspondencia): se trata del resto de la gente (others), ni es el propietario, ni un miembro del grupo con privilegios.</li> </ul> Ejemplo de listado de un directorio<pre><code>drwxrwxr-x 2 julio julio 4096 sep 22 13:34 cuestionarios\n</code></pre> <p>En esta l\u00ednea, el directorio cuestionarios pertenece al usuario julio y al grupo julio, y posee los permisos <code>rwxrwxr-x</code>.</p>"},{"location":"UD2/permisosBasicos/#significado","title":"Significado","text":"Permiso Significado General r Readable (lectura). w Writable (escritura). x Executable (ejecutable como programa). Archivo normal r Se puede leer el contenido del archivo, cargarlo en memoria, listarlo y copiarlo. w Se puede modificar el contenido del archivo. Se puede escribir dentro. Modificar el contenido no significa poder eliminar el archivo (ver permisos en directorio). x Se puede ejecutar el archivo desde la l\u00ednea de comandos si se trata de un programa binario (compilado) o de un script (shell, perl...). Directorio r Se pueden listar (leer) los elementos del directorio (cat\u00e1logo). Sin esta autorizaci\u00f3n, ls y los criterios de filtro en el directorio y su contenido no ser\u00edan posibles. No obstante, puede seguir accediendo a un archivo si conoce su ruta de acceso. w Se pueden modificar los elementos del directorio (cat\u00e1logo),y es posible crear, volver a nombrar y suprimir archivos en w este directorio.Es este permiso el que controla el permiso de eliminaci\u00f3n de un archivo. x Se puede acceder al cat\u00e1logo por CD y se puede listar. Sin esta autorizaci\u00f3n, es imposible acceder al directorio y actuar en su contenido, que pasa a estar cerrado."},{"location":"UD2/permisosBasicos/#modificacion-de-los-permisos","title":"Modificaci\u00f3n de los permisos","text":"<p>Existen dos m\u00e9todos para modificar estos permisos: mediante s\u00edmbolos o mediante un sistema octal de representaci\u00f3n de permisos.</p>"},{"location":"UD2/permisosBasicos/#mediante-simbolos","title":"Mediante s\u00edmbolos","text":"Sinstaxis del comando chmod<pre><code>chmod modificaciones file1 [file2...]\n</code></pre> <p>Para a\u00f1adir permisos, se utiliza el car\u00e1cter +; para retirarlos, el car\u00e1cter -, y para no tener en cuenta los par\u00e1metros anteriores, el car\u00e1cter =.</p> Ejemplo del comando chmod<pre><code>-rw-rw-r-- 1 julio julio 0 sep 24 23:41 prueba\nchmod u=rwx,g=x,o=rw prueba\n-rwx--xrw- 1 julio julio 0 sep 24 23:41 prueba\nchmod o-r prueba\n-rwx--x-w- 1 julio julio 0 sep 24 23:41 prueba\n</code></pre>"},{"location":"UD2/permisosBasicos/#mediante-sistema-binario","title":"Mediante sistema binario","text":"<p>La sintaxis es id\u00e9ntica a la de los s\u00edmbolos. A cada permiso le corresponde un valor octal, posicional y acumulable. Mediante tres bits.</p> <p>| propietario | Grupo | Otros | | ----------- | ----- | ----- | --- | --- | --- | --- | --- | --- | | r           | w     | x     | r   | w   | x   | r   | w   | x   |</p> <ul> <li>0 = = 000</li> <li>1 = \u2013x = 001 (binario)</li> <li>2 = -w- =010</li> <li>3 = -wx =011</li> <li>4 = r- =100</li> <li>5 = r-x=101</li> <li>6 = rw-=110</li> <li>7 = rwx=111</li> </ul> <pre><code>chmod 777 prueba\n-rwxrwxrwx 1 julio julio 0 sep 24 23:41 prueba\n</code></pre>"},{"location":"UD2/permisosBasicos/#mascara-de-permisos","title":"M\u00e1scara de permisos","text":""},{"location":"UD2/permisosBasicos/#restringir-permisos-de-manera-automatica","title":"Restringir permisos de manera autom\u00e1tica","text":"<p>En el momento de la creaci\u00f3n de un archivo o de un directorio, se les asignan unos permisos autom\u00e1ticamente. Suele ser <code>rw-r--r-- (644)</code> para un archivo y <code>rwxr-xr-x (755)</code> para un directorio. Se puede modificar este comportamiento con el comando <code>umask</code>. Seg\u00fan su valor suprimir\u00e1 los permisos que se les den a la hora de crearlos.</p> <p>La m\u00e1scara por defecto es 002, o sea -------w-. Para obtener este valor, inserte umask sin par\u00e1metro.</p> obtenci\u00f3n del valor por defecto de la mascara<pre><code> umask\n0002\n</code></pre> <p>El c\u00e1lculo de m\u00e1scara:</p> <ul> <li>Para un archivo   Predeterminado rw-rw-rw- (666)   Retirar ----w--w- (022)   Resta rw-r--r-- (644)</li> <li>Para un directorio   Predeterminado rwxrwxrwx (777)   Retirar ----w--w- (022)   Resta rwxr-xr-x (755)</li> </ul> <p>Warning</p> <pre><code>una m\u00e1scara no es sustraer, sino suprimir permisos\n</code></pre>"},{"location":"UD2/permisosBasicos/#cambiar-de-propietario-y-de-grupo","title":"Cambiar de propietario y de grupo","text":"<p>Es posible cambiar el propietario y el grupo de un archivo gracias a los comandos chown (change owner) y chgrp (change group). El par\u00e1metro -R cambia la propiedad de manera recursiva.</p> sintaxis de los comando chown y chgrp<pre><code>chown usuario fic1 [Fic2...]\nchgrp grupo fic1 [Fic2...]\n</code></pre> <p>Warning</p> <p>S\u00f3lo root tiene permiso para cambiar el propietario de un archivo. Pero un usuario puede cambiar el grupo de un archivo si forma parte del nuevo grupo.</p>"},{"location":"UD2/redirecciones/","title":"Redirecciones","text":""},{"location":"UD2/redirecciones/#redirecciones","title":"Redirecciones","text":"<p>Las redirecciones son una de las m\u00e1s importantes posibilidades proporcionadas por el shell. Por redirecci\u00f3n se entiende la posibilidad de redireccionar la visualizaci\u00f3n de la pantalla hacia un archivo, una impresora o cualquier otro perif\u00e9rico, los mensajes de errores hacia otro archivo, de sustituir la introducci\u00f3n v\u00eda teclado por el contenido de un archivo.</p> <p>Note</p> <p>Cualquier flujo de datos en entrada o salida de comando pasa por un canal. Como sucede con el   agua, es posible desviar el curso de los datos hacia otro destino o desde otra fuente.</p> <p>Linux utiliza canales de entradas/salidas para leer y escribir sus datos. Por defecto, el canal de entrada es el teclado, y el canal de salida, la pantalla. Los errores, direccionados por defecto a la pantalla, son tratados como un canal especial.</p> <p>mv</p> <p><code>mv &lt;origen&gt; &lt;destino&gt;</code> (move). Comando para mover ficheros desde un origen a un destino especificado.</p> <p>Es posible redireccionar estos canales hacia archivos o flujo de texto de manera transparente para los comandos Linux.</p>"},{"location":"UD2/redirecciones/#de-salida","title":"De salida","text":"<p>Se puede utilizar el car\u00e1cter <code>&gt;</code> para redireccionar la salida est\u00e1ndar (la que va normalmente en la pantalla). Luego se indica el nombre del archivo donde se colocar\u00e1n los resultados de salida.</p> <pre><code>$ ls -l &gt; resultado.txt\n</code></pre> <p>El shell empieza primero por crear el archivo y luego ejecuta el comando.</p> <p>Warning</p> <p>Es un aspecto importante de las redirecciones: se interpretan las redirecciones de derecha a izquierda, y se instalan las redirecciones ANTES de la ejecuci\u00f3n de los comandos. Hay que crear el archivo antes de poder escribir en \u00e9l. De ah\u00ed que, incluso si el comando es falso, se crea o se \"chafa\" el archivo...</p> <p>Para a\u00f1adir datos a continuaci\u00f3n del archivo, o sea, sin sobreescribirlos, se utiliza la doble redirecci\u00f3n <code>&gt;&gt;</code>. Se a\u00f1ade el resultado del comando al final del archivo.</p> Ejemplo a\u00f1adir<pre><code>ls -l &gt; resultado.txt\n date &gt;&gt; resultado.txt\n</code></pre>"},{"location":"UD2/redirecciones/#en-entrada","title":"En entrada","text":"<p>Los comandos que esperan datos o par\u00e1metros desde el teclado pueden tambi\u00e9n recibirlos desde un archivo usando el car\u00e1cter &lt;. Un ejemplo con el comando <code>wc (word count)</code>, que permite contar el n\u00famero de l\u00edneas, de palabras y de caracteres de un archivo:</p> <pre><code> wc &lt; resultado.txt\n4 29 203\n</code></pre>"},{"location":"UD2/redirecciones/#los-canales-estandares","title":"Los canales est\u00e1ndares","text":"<p>Se puede considerar un canal como un archivo que posee su propio descriptor por defecto, y en el cual se puede leer o escribir.</p> <ul> <li>El canal de entrada est\u00e1ndar se llama stdin y lleva el descriptor 0.</li> <li>El canal de salida est\u00e1ndar se llama stdout y lleva el descriptor 1.</li> <li>El canal de error est\u00e1ndar se llama stderr y lleva el descriptor 2. Se puede redireccionar el   canal de error hacia otro archivo.</li> </ul> <pre><code>rmdir directorio2\nrmdir: `directorio2\u2019: No such file or directory\n rmdir directorio2 2&gt;error.log\n cat error.log\nrmdir: `directorio2\u2019: No such file or directory\n</code></pre> <p>Puede redireccionar los dos canales de salida a un \u00fanico archivo poni\u00e9ndolos en relaci\u00f3n. Para ello, se utiliza el <code>&gt;&amp;</code>. Tambi\u00e9n es importante saber en qu\u00e9 sentido el shell interpreta las redirecciones. El shell busca primero los caracteres <code>&lt;, &gt;, &gt;&gt;</code> al final de la l\u00ednea, ya que las redirecciones suelen estar al final de comando. Por lo tanto, si quiere agrupar los dos canales de salida y de error en un mismo archivo, hay que proceder como a continuaci\u00f3n.</p> En mismo archivo los errores y la salida est\u00e1ndar<pre><code>ls -l &gt; resultado.txt 2&gt;&amp;1\n</code></pre> <p>Se redirecciona la salida 2 hacia la salida 1; por lo tanto, los mensajes de error pasar\u00e1n por la salida est\u00e1ndar. Luego se redirecciona el resultado de la salida est\u00e1ndar del comando ls hacia el archivo resultado.txt. Este archivo contendr\u00e1, por lo tanto, a la vez la salida est\u00e1ndar y la salida de error.</p> <p>Puede utilizar los dos tipos de redirecci\u00f3n a la vez:</p> <pre><code>wc &lt; resultado.txt &gt; cuenta.txt\ncat cuenta.txt\n</code></pre>"},{"location":"UD2/redirecciones/#pipelinestuberias","title":"Pipelines/tuber\u00edas","text":"<p>Las redirecciones de entrada/salida como las que acaba de ver permiten redireccionar los resultados hacia un archivo. Luego se puede reinyectar en un filtro para extraerle otros resultados. Esto obliga a teclear dos l\u00edneas: una para la redirecci\u00f3n hacia un archivo, otra para redireccionar este archivo hacia el filtro. Las tuber\u00edas o pipes permiten redirigir el canal de salida de un comando hacia el canal de entrada de otro. El car\u00e1cter que lo permite <code>|</code> est\u00e1 accesible con la combinaci\u00f3n [AltGr] 1 de los teclados espa\u00f1oles.</p> <pre><code>ls -l &gt; resultado.txt\n wc &lt; resultado.txt\nse convierte en\n ls -l | wc\nEs posible colocar varios | en una misma l\u00ednea.\n ls -l | wc | wc\n1\n 3\n 24\n</code></pre> <p>El primer comando no tiene por qu\u00e9 ser un filtro. No es el caso m\u00e1s habitual. Lo importante es que se debe facilitar un resultado. \u00cddem para el \u00faltimo comando, que puede ser por ejemplo un comando de edici\u00f3n o impresi\u00f3n. Finalmente, el \u00faltimo comando puede ser objeto de una redirecci\u00f3n de salida.</p> <pre><code>ls -l | wc &gt; resultado.txt\n</code></pre>"},{"location":"UD3/Actividades/","title":"Actividades de la UD2","text":""},{"location":"UD3/Actividades/#actividad-1","title":"Actividad 1","text":"<ol> <li>Accede a Aules y realiza RELACI\u00d3N 3-I de ejercicios sobre tareas y procesos.</li> <li>Accede a Aules y realiza RELACI\u00d3N 3-II de ejercicios sobre instalaci\u00f3n.</li> <li>Accede a Aules y realiza RELACI\u00d3N 3-III de ejercicios sobre servicios</li> </ol>"},{"location":"UD3/Actividades/#actividad-2","title":"Actividad 2","text":"<ol> <li> <p>Ahora a instalar el programa Wine (Wine Is Not a Emulator). Se trata de un     emulador que permitir\u00e1 la ejecuci\u00f3n de software dise\u00f1ado para Microsoft     Windows en GNU/Linux. Para ello deberemos incluir una nueva fuente de datos     (repositorio). El nombre del repositorio lo encontraremos en su p\u00e1gina web     oficial, y es el siguiente: ppa:wine/wine-builds     \u00bfC\u00f3mo puedo consultar los repositorios de los que dispongo?. \u00bfC\u00f3mo puedo eliminar el repositorio de Wine de mi lista?.</p> </li> <li> <p>Deshabilita los siguientes servicios en Microsoft Windows10 Professional:</p> <ul> <li>servicio Informe de errores de Microsoft Windows</li> <li>servicio de seguimiento de diagn\u00f3sticos</li> <li>servicio Asistente para la compatibilidad de programas</li> <li>registro remoto</li> <li>servicios de Geolocalizaci\u00f3n</li> <li>administrador de mapas descargados</li> </ul> <p>Comprueba que los servicios no se arrancan una vez reiniciado el sistema haciendo capturas de los servicios modificados.</p> </li> <li> <p>Crea un contenedor de ubuntu LXC e instala ngix desde los repositorios \u00bfCu\u00e1l el nombre del servicio?. El servidor web se inicia durante el inicio del sistema de forma predeterminada y escucha en el puerto 80. Cambie la configuraci\u00f3n de <code>systemd</code> para este servicio para que no se inicie autom\u00e1ticamente durante el inicio del sistema. Reinicie el sistema y verifique que el servidor web no se haya iniciado</p> </li> <li> <p>En los sistemas operativos cliente, tanto con sistema operativo GNU/Linux como Microsoft Windows, programa la ejecuci\u00f3n de un comando (con crontab) que realice una copia de los ficheros situados en la carpetas Datos, situada en la primera partici\u00f3n del disco, a Respaldo, situada en la segunda (deber\u00e1s usar el comando <code>copy</code> y <code>cp</code>). Por ejemplo, la carpetas C:\\Datos se copiar\u00e1 a la carpeta D:\\Respaldo. Recuerda que en GNU/Linux se deber\u00e1 montar estos vol\u00famenes antes de hacer la copia (edita el fichero /etc/fstab para que se haga de forma autom\u00e1tica si no lo hiciste). La tarea ser\u00e1 programada para realizarse cada hora y con el usuario de mayores privilegios en el sistema. Recuerda que estos sistemas no ten\u00edan ninguna partici\u00f3n</p> </li> <li>En el sistema operativo cliente de linux, crea un directorio en el directorio personal que se llama <code>copia de seguridad</code>. Ahora tienes que crear con <code>systemd</code> una copia de seguridad de los archivos contenidos en <code>/var/log</code> que se agreguen a al archivo backup.tar.gz todos los d\u00edas (puede elegir la hora a la que esto ocurre diariamente). El archivo backup.tar.gz esta creado con el comando <code>tar</code>. Este comando empaqueta (tar) y comprime (gz) , busca ayuda en el manual.</li> <li> <p>Accede a las m\u00e1quinas virtuales que contienen los sistemas operativos de red y configura las actualizaciones para que se realicen de forma desatendida (tan s\u00f3lo las actualizaciones de seguridad). Recuerda que en Ubuntu Server ser\u00e1 necesario la instalaci\u00f3n de paquetes adicionales.</p> </li> <li> <p>Configura las entradas de registro de Microsoft Windows 10 Professional de este modo (recuerda realizar     capturas de pantalla antes y despu\u00e9s del cambio):</p> <ul> <li>deshabilita las notificaciones del Control de Cuentas de Usuario.</li> <li>agrega el programa notepad.exe al inicio de Microsoft Windows.</li> <li>cambiar la ubicaci\u00f3n predeterminada de las carpetas especiales en Microsoft Windows a la partici\u00f3n del disco duro donde no est\u00e9 instalado el sistema operativo (recuerda que durante el proceso de instalaci\u00f3n se crearon varias particiones en el disco).</li> <li>deshabilitar los dispositivos USB. Es una buena pr\u00e1ctica de seguridad.</li> </ul> <p>comprueba que los cambios han surtido efecto.</p> </li> </ol>"},{"location":"UD3/Actividades/#actividades-3-de-refuerzo","title":"ACTIVIDADES 3. De refuerzo","text":"<ol> <li> <p>Accede a Moodle y descarga en el escritorio de una m\u00e1quina cliente con Ubuntu Desktop la versi\u00f3n rpm de Mozilla Firefox. Ahora deber\u00e1s convertirla a un paquete deb con la aplicaci\u00f3n Alien. pare ello, sigue estos pasos:</p> <ul> <li>abre un terminal y accede al escritorio. Escribe el siguiente comando:   <code>sudo alien -d nombre_del_paquete.rpm</code>   \u00bfPor qu\u00e9 es necesario realizar esta conversi\u00f3n entre el formato de paquetes?</li> <li>una vez convertido, utiliza Alien para instalar el paquete con el comando:   <code>sudo alien -i nombre_del_paquete.deb</code>   \u00bfEs posible instalar este paquete de alguna otra forma?. \u00bfCu\u00e1les?.</li> </ul> </li> <li> <p>Utiliza el script que encontrar\u00e1s en Moodle para realizar esta tarea. Desc\u00e1rgalo en un cliente con Ubuntu Desktop y mu\u00e9velo a la carpeta /home del usuario actual. A\u00f1ade el permiso de ejecuci\u00f3n al usuario con el comando <code>chmod 777 script.sh</code>. Una vez modificado, programa una tarea a trav\u00e9s de los siguientes pasos:</p> <ul> <li>Abre el fichero de configuraci\u00f3n de programaci\u00f3n de tareas con el comando:   <code>sudo crontab -e</code></li> <li>a\u00f1ade al final del archivo el siguiente texto y guarda los cambios: <code>\\* \\* \\* \\* \\* ~/Escritorio/script.sh</code></li> <li>\u00bfQu\u00e9 significa cada uno de los asteriscos de esta configuraci\u00f3n?. Comprueba que el script funciona.</li> <li>modifica las l\u00edneas del fichero crontab para que esta tarea se ejecute todos los minutos de las horas comprendidas entre las 8 y las 20 de todos los d\u00edas del mes en curso, sea cual sea el d\u00eda de la semana</li> </ul> </li> </ol> <p>Manera de entrega de las actividades</p> <p>Redacta una gu\u00eda de los pasos a seguir para realizar esta actividad y s\u00fabela al Moodle del m\u00f3dulo.   De tal forma que en cada uno de los pasos incluya una imagen que verifique que se ha realizado aquello que se pide en cada uno de los ejercicios. Como en las anteriores actividades</p> <p>Warning</p> <p>SOLO LAS ACTIVIDADES 1,2 SON OBLIGATORIAS.</p>"},{"location":"UD3/GestiServicios/","title":"Gesti\u00f3n de los servicios y demonios","text":"<p>Para que el sistema operativo realice su trabajo, en ocasiones es necesario que disponga de programas que se ejecutan en segundo plano gestionando un recurso. Estos programas, conocidos como servicios o demonios en el entorno GNU/Linux, se mantienen a la espera a que alg\u00fan proceso solicite uno de los servicios que ofrece. Por ejemplo, el servicio de red se sit\u00faa entre la NIC y el proceso que necesite salir a Internet. En la mayor\u00eda de ocasiones, estos programas se ejecutan durante la carga del sistema operativo y son fundamentales para la gesti\u00f3n de los recursos que ofrece el sistema operativo, ya sean hardware o software.</p> <p>Los sistemas operativos de Microsoft disponen de una herramienta gr\u00e1fica para la gesti\u00f3n de los servicios. Se accede a ella en Inicio  \u2192 Herramientas administrativas \u2192 Servicios o escribiendo la palabra servicio en el buscador.</p> <p></p> <p>Cada uno de estos servicios puede configurarse de cuatro formas diferentes:</p> <ul> <li>Deshabilitado, no es posible iniciar el servicio a trav\u00e9s de otro servicio</li> <li>Manual, no se inicia con el sistema, debe ser arrancado de forma manual</li> <li>Autom\u00e1tico, se inicia durante el proceso de arranque del sistema.</li> <li>Autom\u00e1tico (inicio retrasado), se inicia despu\u00e9s de que todos los servicios del sistema se hayan cargado en memoria principal.</li> </ul> <p>A trav\u00e9s de esta herramienta ser\u00e1 posible controlar el estado del servicio, el fichero ejecutable que lo inicia, sus dependencias si las tuviera o qu\u00e9 acciones hay que realizar si el servicio fallase durante su inicio.</p> <p>Adem\u00e1s de este completo software, Microsoft Windows 10 Professional dispone de una utilidad para la gesti\u00f3n de los servicios de inicio retrasado, aquellos que se inician cuando todos los servicios del sistema han sido cargados en memoria principal. Estos servicios suelen estar asociados a software instalado con posterioridad al sistema y que ejecutan una tarea muy espec\u00edfica. A trav\u00e9s de la pesta\u00f1a Inicio de la herramienta Administrador de tareas se controlan este tipo de servicios, aunque tambi\u00e9n es posible realizar esta configuraci\u00f3n desde la herramienta anterior.</p> <p></p> <p></p> <p>En los sistemas operativos basados en GNU/Linux se dispone de varias herramientas basadas en CLI para realizar la administraci\u00f3n de servicios, denominados demonios en terminolog\u00eda Unix. Cuando se configura un demonio en GNU/Linux se crean scripts para controlar su carga y descarga de memoria principal.</p> <p>Hay diferentes sistemas de arranque seg\u00fan la distribuci\u00f3n, como init System V, upstart y el sistema de arranque de Mac OS X, pero systemd es el que se est\u00e1 imponiendo en todas ellas.</p> <p>En systemd, los antiguos niveles de ejecuci\u00f3n (runlevels) de System V se sustituyen por objetivos (<code>*.target</code>). Equivalencias habituales: - Runlevel 0 \u2192 <code>poweroff.target</code> - Runlevel 1 \u2192 <code>rescue.target</code> - Runlevel 2 \u2192 <code>multi-user.target</code> (sin red en algunas distros heredadas) - Runlevel 3 \u2192 <code>multi-user.target</code> - Runlevel 4 \u2192 reservado/definido por el administrador (<code>multi-user.target</code> personalizado) - Runlevel 5 \u2192 <code>graphical.target</code> - Runlevel 6 \u2192 <code>reboot.target</code></p> <p>Para preservar la compatibilidad, systemd crea enlaces simb\u00f3licos como <code>runlevel3.target</code> apuntando a sus objetivos hom\u00f3logos y sigue interpretando los scripts heredados de <code>/etc/rc?.d</code> cuando una unidad lo solicita. As\u00ed, utilidades cl\u00e1sicas como <code>telinit 3</code> contin\u00faan funcionando aunque internamente se gestione todo mediante objetivos.</p> Ejemplos pr\u00e1cticos con runlevels y objetivos<pre><code>systemctl get-default                        # Mostrar el objetivo (runlevel) configurado por defecto\nsudo systemctl set-default graphical.target  # Equivalente a fijar runlevel 5 en el arranque\nsudo systemctl isolate multi-user.target     # Cambiar al runlevel 3 sin reiniciar\nsudo systemctl isolate rescue.target         # Cambiar al runlevel 1 (modo rescate)\nsudo systemctl list-dependencies graphical.target  # Ver servicios implicados en el modo gr\u00e1fico\ntelinit 3                                    # Comando heredado que sigue siendo aceptado por systemd\n</code></pre>"},{"location":"UD3/GestiServicios/#unidades-objetivo-y-servicios","title":"Unidades objetivo y servicios","text":"<p>El componente b\u00e1sico de systemd es la unidad o unit. Cada tipo de unidad describe una pieza concreta del sistema:</p> <ul> <li><code>*.service</code>: procesos o demonios que se gestionan como servicios de larga duraci\u00f3n.</li> <li><code>*.socket</code>: sockets que activan servicios bajo demanda cuando se produce actividad.</li> <li><code>*.target</code>: colecciones l\u00f3gicas de unidades que permiten sincronizar dependencias y runlevels.</li> <li><code>*.timer</code>: programadores que sustituyen a <code>cron</code> para ejecutar servicios seg\u00fan un calendario.</li> <li><code>*.mount</code> y <code>*.automount</code>: puntos de montaje y reglas autom\u00e1ticas para sistemas de archivos.</li> </ul> <p>Los objetivos (<code>*.target</code>) o servicios (<code>*.service</code>) que deben gestionarse durante el arranque se referencian en <code>/etc/systemd/system</code>, normalmente como enlaces simb\u00f3licos hacia los archivos proporcionados por los paquetes en <code>/lib/systemd/system</code>. De este modo, <code>/etc/systemd/system</code> alberga la personalizaci\u00f3n local que se activa cuando el sistema arranca.</p> <p>Los servicios terminan con el sufijo .service. Vamos a ver el contenido de uno de estos ficheros y qu\u00e9 aporta cada secci\u00f3n (<code>[Unit]</code>, <code>[Service]</code>, <code>[Install]</code>):</p> contenido de ficheros.service<pre><code>/etc/systemd/system$ cat syslog.service\n[Unit]\nDescription=System Logging Service\nRequires=syslog.socket\nDocumentation=man:rsyslogd(8)\nDocumentation=https://www.rsyslog.com/doc/\n\n[Service]\nType=notify\nExecStart=/usr/sbin/rsyslogd -n -iNONE\nStandardOutput=null\nRestart=on-failure\n\n# Increase the default a bit in order to allow many simultaneous\n# files to be monitored, we might need a lot of fds.\nLimitNOFILE=16384\n\n[Install]\nWantedBy=multi-user.target\nAlias=syslog.service\n</code></pre> <p>Si nos fijamos en la l\u00ednea que tiene WantedBy, veremos que indica el objetivo al que se vincular\u00e1 el servicio cuando se ejecute <code>systemctl enable</code>. En este caso se habilita para multi-user.target, objetivo que equivale al runlevel 3 del antiguo init System V.</p> <p>Ahora vamos a ver el fichero .target de un objetivo.</p> Fichero .target<pre><code>cat poweroff.target\n#  SPDX-License-Identifier: LGPL-2.1+\n#\n#  This file is part of systemd.\n#\n#  systemd is free software; you can redistribute it and/or modify it\n#  under the terms of the GNU Lesser General Public License as published by\n#  the Free Software Foundation; either version 2.1 of the License, or\n#  (at your option) any later version.\n\n[Unit]\nDescription=Power-Off\nDocumentation=man:systemd.special(7)\nDefaultDependencies=no\nRequires=systemd-poweroff.service\nAfter=systemd-poweroff.service\nAllowIsolate=yes\nJobTimeoutSec=30min\nJobTimeoutAction=poweroff-force\n\n[Install]\nAlias=ctrl-alt-del.target\n</code></pre> <p>Nos fijamos en Requires y After. La primera directiva obliga a que <code>systemd-poweroff.service</code> tambi\u00e9n est\u00e9 activo, mientras que la segunda asegura que la unidad actual se ejecute despu\u00e9s de \u00e9l. Completar la lectura con directivas como Wants (dependencia recomendada) o Before (orden de arranque anterior a otra unidad) ayuda a entender c\u00f3mo se modelan dependencias l\u00f3gicas y temporales dentro de los objetivos.</p>"},{"location":"UD3/GestiServicios/#acciones","title":"Acciones","text":"<p>El comando <code>systemctl</code> permite controlar la ejecuci\u00f3n de servicios.</p> Ejemplos pr\u00e1cticos de administraci\u00f3n con systemctl<pre><code>systemctl status ssh.service         # Consultar el estado y los \u00faltimos logs del servicio SSH\nsudo systemctl enable apache2.service# Habilitar Apache para que arranque autom\u00e1ticamente\nsudo systemctl disable cups.service  # Deshabilitar el servicio de impresi\u00f3n en el arranque\nsudo systemctl restart NetworkManager.service # Reiniciar el servicio de red\nsudo systemctl mask bluetooth.service          # Evitar que un servicio pueda iniciarse\nsudo systemctl unmask bluetooth.service        # Rehabilitar un servicio previamente bloqueado\n</code></pre> Ejemplo, listado de unidades<pre><code>systemctl\n  UNIT                                                                                      LOAD   ACTIVE     SUB       JOB   DESCRIPTION                    &gt;\n  proc-sys-fs-binfmt_misc.automount                                                         loaded active     running         Arbitrary Executable File Forma&gt;\n  sys-bus-pci-drivers-nvidia.device                                                         loaded active     plugged         /sys/bus/pci/drivers/nvidia    &gt;\n  sys-devices-pci0000:00-0000:00:02.0-drm-card0-card0\\x2deDP\\x2d1-intel_backlight.device    loaded active     plugged         /sys/devices/pci0000:00/0000:00&gt;\n  sys-devices-pci0000:00-0000:00:14.0-usb1-1\\x2d14-1\\x2d14:1.0-bluetooth-hci0.device        loaded active     plugged         /sys/devices/pci0000:00/0000:00&gt;\n  sys-devices-pci0000:00-0000:00:14.3-net-wlp0s20f3.device\n</code></pre> Ejemplo, acciones de systemctl<pre><code>Parada y reinicio de unidades\n#\n systemctl\n stop cups.service\n#\n systemctl\n start cups.service\n#\n systemctl\n restart cups.service\n#\n systemctl\n reload cups.service\n</code></pre> <p>El siguiente comando indica cu\u00e1les son las unidades objetivo activas:</p> Ejemplo, unidades target<pre><code>systemctl list-units --type=target\n  UNIT                    LOAD   ACTIVE   SUB    JOB   DESCRIPTION\n  basic.target            loaded active   active       Basic System\n  bluetooth.target        loaded active   active       Bluetooth\n  cryptsetup.target       loaded active   active       Local Encrypted Volumes\n  getty-pre.target        loaded active   active       Login Prompts (Pre)\n  getty.target            loaded active   active       Login Prompts\n  graphical.target        loaded inactive dead   start Graphical Interface\n  local-fs-pre.target     loaded active   active       Local File Systems (Pre)\n  local-fs.target         loaded active   active       Local File Systems\n  multi-user.target       loaded inactive dead   start Multi-User System\n  network-online.target   loaded active   active       Network is Online\n  network.target          loaded active   active       Network\n  nss-lookup.target       loaded active   active       Host and Network Name Lookups\n  nss-user-lookup.target  loaded active   active       User and Group Name Lookups\n  paths.target            loaded active   active       Paths\n  remote-fs.target        loaded active   active       Remote File Systems\n  slices.target           loaded active   active       Slices\n  snapd.mounts-pre.target loaded active   active       Mounting snaps\n  snapd.mounts.target     loaded active   active       Mounted snaps\n  sockets.target          loaded active   active       Sockets\n  sound.target            loaded active   active       Sound Card\n  swap.target             loaded active   active       Swap\n  sysinit.target          loaded active   active       System Initialization\n  time-set.target         loaded active   active       System Time Set\n  time-sync.target        loaded active   active       System Time Synchronized\n  timers.target           loaded active   active       Timers\n\nLOAD   = Reflects whether the unit definition was properly loaded.\nACTIVE = The high-level unit activation state, i.e. generalization of SUB.\nSUB    = The low-level unit activation state, values depend on unit type.\nJOB    = Pending job for the unit.\n\n25 loaded units listed. Pass --all to see loaded but inactive units, too.\nTo show all installed unit files use 'systemctl list-unit-files'.\n</code></pre>"},{"location":"UD3/InstaLinux/","title":"Instalaci\u00f3n en Linux","text":""},{"location":"UD3/InstaLinux/#instalaciondesinstalacion-de-software-en-gnulinux","title":"Instalaci\u00f3n/desinstalaci\u00f3n de software en GNU/Linux","text":"<p>Los sistemas basados en GNU/Linux tambi\u00e9n disponen de varias formas de administrar software; desde repositorios a trav\u00e9s de Internet, desde los gestores de aplicaciones de cada distribuci\u00f3n (muy parecidas a la Tienda de Microsoft) o directamente desde un paquete de instalaci\u00f3n.</p> <p>Al contrario que en Microsoft Windows, en las distribuciones basadas en GNU/Linux el software se distribuye en paquetes. Se debe tener en cuenta que los paquetes son dependientes de la distribuci\u00f3n en la que se est\u00e9n usando. Actualmente existen dos grandes conjuntos de paquetes, aunque tambi\u00e9n existen distribuciones que poseen su propio sistema de paquetes:</p> <ul> <li>deb (nombre proviene de Deborah Murdock, ex-esposa del fundador de la distribuci\u00f3n Debian Ian Murdock), contiene todos los ficheros de un paquete preparado para ejecutarse en las distribuciones basadas en Debian, como por ejemplo Ubuntu, Kubuntu, Linux Mint o ZorisOS entre otras. Este tipo de paquetes posee la particularidad de carecer de actualizaci\u00f3n. Si existe una revisi\u00f3n de una aplicaci\u00f3n, se instalar\u00e1n todos los paquetes que la componen, y no tan solo los modificados.</li> <li>rpm (Redhat Package Manager), son paquetes que se usan en las distribuciones Red Hat, Fedora y OpenSUSE entre otras. Este sistema de paqueter\u00eda no tiene el problema de actualizaci\u00f3n, y no es necesario la inclusi\u00f3n de los paquetes que no han sido modificados. Esto genera ficheros de menor tama\u00f1o.</li> <li>Ebuild, paquete usado exclusivamente por la distribuci\u00f3n Gentoo y contiene un script ejecutable.</li> </ul> <p>A pesar de la incompatibilidad entre ellos, existen herramientas para convertir entre los diferentes tipos de paquetes, como Alien Package Converter. En la mayor\u00eda de los casos los desarrolladores de software ofrecen sus programas contenidos en varios tipos de paquetes.</p> <p>En los sistemas basados en GNU/Linux, los programas se comportan como portables, lo que permite al sistema operativo no acarrear con carga extra que no sea la suya propia.</p> <p>Aunque esta t\u00e9cnica resulta m\u00e1s econ\u00f3mica en cuanto a recursos del sistema operativo y memoria principal, no lo es con la memoria secundaria ya que tiene que contener m\u00e1s informaci\u00f3n, a veces informaci\u00f3n duplicada en varios de estos programas.</p> <p>Algo que hay que tener en cuenta en el software que acompa\u00f1a a GNU/Linux son las dependencias. Hay aplicaciones que utilizan a otras como punto de partida para su desarrollo o parte de ellos. Esto provoca que la segunda dependa de la primera y para que pueda funcionar sea necesario instalar la primera. Eso se gestiona a trav\u00e9s de los paquetes de software, un concepto que no existe en sistemas operativos de Microsoft. Un programa est\u00e1 compuesto por uno o varios de estos paquetes, y para que la aplicaci\u00f3n sea funcional, todos los paquetes que componen una aplicaci\u00f3n deben estar instaladas. A esta circunstancia hace referencia las dependencias.</p> <p>Afortunadamente, se dispone de instaladores que resuelven estas dependencias de paquetes por s\u00ed solas, siendo el usuario un mero espectador en la instalaci\u00f3n.</p> <p></p> <p>Son los gestores de paquetes y cada distribuci\u00f3n posee una distinta. Los gestores obtienen los programas desde los repositorios instalados en el sistema operativo. Estos repositorios son conjuntos de aplicaciones a los que se puede acceder a trav\u00e9s de Internet. Tan s\u00f3lo tendremos que buscar el software necesario y proceder con su instalaci\u00f3n.</p> <p>Los repositorios que GNU/Linux utiliza se configuran a trav\u00e9s de PPA (Personal Package Archive) los cuales permiten a los desarrolladores distribuir software sin necesidad de esperar a que se actualicen los propios de cada distribuci\u00f3n. Existen dos formas de a\u00f1adir uno del que descargar software:</p> <ul> <li>en modo GUI (Guide User Interface) a trav\u00e9s del Gestor de Paquetes a\u00f1adiendo el nuevo repositorio en Origenes de software.</li> <li>en modo CLI (Command Line Interface) con la aplicaci\u00f3n apt-get.</li> </ul> <p>Se centrar\u00e1 la explicaci\u00f3n en la segunda forma ya que la primera es autoexplicativa.</p> <p><code>apt-get</code> es un sistema de gesti\u00f3n de software basado en CLI pero que utiliza repositorios de software en l\u00ednea para descargar e instalar programas. Resulta muy sencillo la gesti\u00f3n del software con esta aplicaci\u00f3n ya que no s\u00f3lo es posible su instalaci\u00f3n/desinstalaci\u00f3n, sino que tambi\u00e9n es posible mantener actualizado todos los programas con una sola orden en el terminal. Adem\u00e1s, permite actualizar el sistema operativo con la misma facilidad. Hay que recordar que apt-get modifica el sistema, por lo que ser\u00e1 necesario ejecutarlo con permisos de administrador a trav\u00e9s del comando sudo.</p> <p>Este programa se usa de una forma muy intuitiva</p> Sintaxis de apt-get<pre><code> apt-get &lt;opciones&gt; acci\u00f3n &lt;paquete1&gt; [&lt;paquete2&gt;... &lt;paquete N&gt;]\n</code></pre> <p>En donde algunas de las opciones m\u00e1s importantes son:</p> <ul> <li><code>-s</code> simula una acci\u00f3n</li> <li><code>-d</code> s\u00f3lo descarga</li> <li><code>-y</code> no pregunta al usuario y asume que s\u00ed a todas las preguntas</li> <li><code>-f</code> intenta continuar si las dependencias fallan</li> <li><code>-m</code> intenta continuar si los archivos no son localizables</li> <li><code>-b</code> construye el paquete fuente despu\u00e9s de obtenerlo</li> <li><code>-V</code> muestra n\u00fameros de versi\u00f3n detallados</li> <li><code>-q</code> realiza una instalaci\u00f3n sin mostrar ning\u00fan mensaje en pantalla</li> <li><code>-u</code> muestra los paquetes a actualizar</li> </ul> <p>Y las acciones que es posible realizar son:</p> <ul> <li><code>update</code> actualiza el \u00edndice de paquetes listados en los repositorios</li> <li><code>upgrade</code> actualiza el software m\u00e1s reciente en los repositorios</li> <li><code>install</code> instala la aplicaci\u00f3n o aplicaciones especificadas</li> <li><code>remove</code> desinstala los paquetes especificados</li> <li><code>purge</code> desinstala y elimina cualquier configuraci\u00f3n de usuario</li> <li><code>build</code>-dep satisface las dependencias del paquete al instalarlo</li> <li><code>download</code> descarga el paquete en el directorio actual</li> </ul> <p>El uso del comando es sencillo e intuitivo. Por ejemplo, para instalar un paquete</p> Ejemplo de apt-get<pre><code>apt-get install libreoffice-base\n</code></pre> <p>o para desinstalar un paquete determinado. Si queremos quitar tambi\u00e9n su configuraci\u00f3n se utiliza la accion <code>purge</code></p> Ejemplo de apt-get<pre><code>apt-get remove chrome\n</code></pre> <p>Los repositorios que usa esta aplicaci\u00f3n se encuentran en un fichero ubicado en /etc/apt/sources.list. El directorio /etc/apt/sources.list.d ofrece una manera de a\u00f1adir entradas de \u00absources.list\u00bb en ficheros separados.</p> <p>Cuando <code>apt-get</code> recibe una orden de instalaci\u00f3n, buscar el nombre del programa entre los repositorios y pregunta al usuario si lo desea instalar. Una de las problemas que posee esta aplicaci\u00f3n es que se debe conocer el nombre exacto de la aplicaci\u00f3n, esto depende del nombre que el desarrollador haya utilizado, y a veces suelen complicar estos nombres de forma innecesaria.</p> <p>Si se conoce parte del nombre, es posible buscar entre todos los repositorios los paquetes que lo contengan usando este comando</p> Ejemplo de apt-cache<pre><code>apt-cache search firefox\n</code></pre> <p>Cada distribuci\u00f3n de GNU/Linux posee un repositorio, pero existe la posibilidad de a\u00f1adir un repositorio personal de cualquier desarrollador. Para esta tarea se usar\u00e1 el siguiente comando</p> Ejemplo de  add-apt-repository<pre><code>add-apt-repository ppa:danielrichter2007/grub-customizer\n</code></pre> <p>Con esta instrucci\u00f3n se a\u00f1ade el repositorio a la lista. Cuando se necesite la instalaci\u00f3n de un software al programa de instalaci\u00f3n buscar\u00e1, adem\u00e1s, tambi\u00e9n en este repositorio. Si lo que se necesita es eliminar un repositorio, se usar\u00e1 la opci\u00f3n <code>\u2013-remove</code> de la siguiente manera</p> Ejemplo de  add-apt-repository<pre><code>add-apt-repository --remove ppa:danielrichter2007/grub-customizer\n</code></pre> <p>Al final de cualquiera de estas instrucciones es conveniente actualizar la informaci\u00f3n de los repositorios</p> Actualizaci\u00f3n de los paquetes disponibles<pre><code>sudo apt-get update\n</code></pre> <p><code>apt</code> no es s\u00f3lo un comando, sino un conjunto de aplicaciones que permiten la gesti\u00f3n del software de forma eficaz. As\u00ed <code>apt-file</code> permite buscar un determinado fichero entre los paquetes del repositorio, <code>apt-cache</code> que gestiona la informaci\u00f3n contenida en la base de datos interna de apt, o apt-show usado para mostrar toda la informaci\u00f3n de los paquetes instalados.</p> <p>Adem\u00e1s de estos dos modos, GNU/Linux dispone de una tercera forma de instalaci\u00f3n que se realiza a trav\u00e9s de un paquete de software descargado, por lo que no ser\u00e1 necesario la conexi\u00f3n a Internet. Esto se realiza con la aplicaci\u00f3n <code>dpkg</code>, y al igual que ocurre con apt no se trata s\u00f3lo de un comando, sino de una serie de aplicaciones que conviene conocer, aunque no sea el prop\u00f3sito de este manual. El uso de <code>dpkg</code> es realmente sencillo</p> Sintaxis de dpkg<pre><code>dpkg &lt;opciones&gt; &lt;acci\u00f3n&gt; &lt;fichero-paquete&gt;\n</code></pre> <p>Las acciones que son posibles a trav\u00e9s de este comando son:</p> <ul> <li><code>-i</code> instalar un paquete</li> <li><code>-r</code> elimina el paquete pero deja intacta la configuraci\u00f3n</li> <li><code>-P</code> elimina el paquete y la configuraci\u00f3n de usuario</li> <li><code>-l</code> muestra los paquetes instalados coincidentes con el patr\u00f3n</li> </ul> <p>De este modo, para instalar un programa usamos el comando <code>dpkg</code> de la siguiente manera:</p> Ejemplo de dpkg<pre><code>  dpkg -i nombre-paquete.deb\n</code></pre> <p>Para desinstalar un paquete</p> Ejemplo de dpkg<pre><code>dpkg -r nombre-paquete.deb\n</code></pre> <p>Pero tambi\u00e9n podremos consultar el software instalado en nuestro sistema de la siguiente forma</p> Ejemplo de dpkg<pre><code>dpkg -l\n</code></pre> <p>Este comando genera un listado debidamente formateado en columnas que indicar\u00e1n el estado del programa (si est\u00e1 instalado o requiere de alguna acci\u00f3n a\u00f1adida), el nombre, la versi\u00f3n, la arquitectura y una breve descripci\u00f3n del mismo.</p>"},{"location":"UD3/InstaWindow/","title":"Instalaci\u00f3n en Windows","text":"<p>Instalaci\u00f3n/desinstalaci\u00f3n de aplicaciones en Microsoft Windows</p> <p>La instalaci\u00f3n y desinstalaci\u00f3n de programas en los sistemas operativos Microsoft Windows no presenta misterio alguno, debido a que la mayor\u00eda vienen acompa\u00f1adas de un asistente que dirige los pasos del usuario a trav\u00e9s del proceso. En numerosas ocasiones, los programas cuentan con un desinstalador que lanza otro asistente para la eliminaci\u00f3n del software. Si no es as\u00ed, Microsoft Windows cuenta con la utilidad Configuraci\u00f3n \u2192 Aplicaciones, la cual permite la desinstalaci\u00f3n de software.  Otro m\u00e9todo implementado en la versi\u00f3n de Microsoft Windows 10 es la instalaci\u00f3n de aplicaciones integradas en la Tienda de Microsoft. Esta nueva opci\u00f3n permite la descarga e instalaci\u00f3n autom\u00e1tica de aplicaciones en cualquier dispositivo conectado a trav\u00e9s de una cuenta de Microsoft.</p> <p>Hay que tener en cuenta el modo de instalaci\u00f3n de estas aplicaciones que, en general, cualquier sistema operativo de Microsoft lo realiza en tres pasos:</p> <ul> <li>copia los archivos del software a la carpeta indicada por el usuario.</li> <li>introduce en el registro informaci\u00f3n necesaria para el correcto funcionamiento de la aplicaci\u00f3n. Informaci\u00f3n como el origen del software, la versi\u00f3n, ubicaci\u00f3n de los accesos directos en los diferentes men\u00fas de Microsoft Windows 10 entre otra.</li> <li>registra los archivos DLL (Dinamic Library Link) que la aplicaci\u00f3n debe utilizar.</li> </ul> <p>Cuando se instala una aplicaci\u00f3n en Microsoft Windows 10 queda \u201cligada\u201d al sistema y no es posible copiar la carpeta de instalaci\u00f3n y llevarla a otro equipo, ya que necesitar\u00eda el resto informaci\u00f3n contenida en el registro o ficheros DLL espec\u00edficos.</p> <p>Desde hace alg\u00fan tiempo existe una tendencia a crear aplicaciones desvinculadas del sistema operativo, conteniendo toda la informaci\u00f3n necesaria en la carpeta en la que se ubica el programa. Son los denominados programas portables y muchos de ellos usan tecnolog\u00eda de virtualizaci\u00f3n para emular ciertas caracter\u00edsticas del sistema operativo, pero sin interferir en \u00e9l.</p>"},{"location":"UD3/actuSisOp/","title":"Actualizaci\u00f3n de sistemas operativos. Parches de seguridad","text":"<p>Mantener al d\u00eda el software del sistema inform\u00e1tico es fundamental para su buen funcionamiento y seguridad. Es evidente que no todo el software tiene la misma prioridad y son los sistemas operativos lo que deben ir por delante en cuestiones de actualizaci\u00f3n.</p> <p>Las tareas de actualizaci\u00f3n y seguridad son similares en ambos tipos de sistemas operativos, pero se prestar\u00e1 especial atenci\u00f3n a los SOR.</p> <p>En la familia de Windows todos los sistemas operativos poseen una herramienta que los mantiene actualizados y esa es Windows Update. Se accede a ella a trav\u00e9s de Configuraci\u00f3n \u2192 Sistema \u2192 Actualizaci\u00f3n y Seguridad \u2192 Windows Update y desde all\u00ed se pueden activar las actualizaciones autom\u00e1ticas, configurar qu\u00e9 actualizaciones se deben instalar, a qu\u00e9 hora y la opciones de reinicio si fuese necesario. </p> <p>Hay que tener en cuenta que un SOR no se puede reiniciar a la ligera, ya que de \u00e9l depende el buen funcionamiento del sistema inform\u00e1tico. Es conveniente que exista un servidor de backup que recoja el testigo en cuanto el principal se reinicie, o realizar esta parada en un horario poco sensible.</p> <p>Con m\u00e1s o menos diferencias, todas las versiones modernas de los sistemas operativos de Microsoft tienen habilitada esta caracter\u00edstica por defecto. Es conveniente revisar la configuraci\u00f3n de estas actualizaciones para dar prioridad a las que Microsoft cataloga como cr\u00edticas ante cualesquieras otras.</p> <p>En Ubuntu Server tambi\u00e9n se dispone de una herramienta similar a \u00e9sta pero que se gestiona a trav\u00e9s del terminal. Una vez m\u00e1s se deber\u00e1 acceder a un fichero de texto y modificarlo. Este fichero es <code>/etc/apt/apt.d.conf.d/10perodic</code> y tendr\u00e1 el siguiente contenido:</p> Contenido del fichero 10periodic<pre><code>APT::Periodic::Update-Package-Lists \u201c1\u201d;\nAPT::Periodic::Download-Upgradeable-Packages \u201c0\u201d;\nAPT::Periodic::AutocleanInterval \u201c7\u201d;\n</code></pre> <p>Para activar las actualizaciones autom\u00e1ticas ser\u00e1 necesario modificar la l\u00ednea <code>APT::Periodic::Download-Upgradeable-Packages</code> cambiando el 0 por un 1. Con esto se activar\u00e1n las actualizaciones autom\u00e1ticas en Ubuntu Server.</p> <p>Pero esta configuraci\u00f3n descargar\u00e1 todos los paquetes disponibles en el repositorio de Ubuntu, y tal vez no sea buena idea colapsar al servidor con actualizaciones de escaso inter\u00e9s. Existe una aplicaci\u00f3n que permite seleccionar las actualizaciones que son necesarias instalar y cuales no. Es necesario instalar la aplicaci\u00f3n unattended-upgrades</p> Instalaci\u00f3n de unattended-upgrades<pre><code>sudo apt-get install unattended-upgrades\n</code></pre> <p>Tras la instalaci\u00f3n se dispondr\u00e1 de un nuevo fichero de configuraci\u00f3n que permitir\u00e1 administrar los repositorios desde los cuales se van a recibir actualizaciones as\u00ed como los paquetes que es necesario instalar. A estos \u00faltimos se los denomina Blacklist (lista negra). Se dispondr\u00e1 por tanto de gran flexibilidad para determinar qu\u00e9 paquetes y de d\u00f3nde se deben instalar de forma desatendida. Aparece este fichero <code>/etc/apt/apt.conf.d/50unattended-upgrades</code>, el cual contiene, entre otro, el siguiente texto:</p> Contenido del fichero de configuraci\u00f3n<pre><code>// Automatically upgrade packages from these (origin:archive) pairs\nUnattended-Upgrade::Allowed-Origins {\n\u201c${distro_id}:${distro_codename}-security\u201d;\n// \u201c${distro_id}:${distro_codename}-updates\u201d;\n// \u201c${distro_id}:${distro_codename}-proposed\u201d;\n// \u201c${distro_id}:${distro_codename}-backports\u201d;\n};\n</code></pre> <p>Estas l\u00edneas hacen referencia a diferentes tipos de actualizaciones. Para descargar e instalar de forma desatendida alguno de estos tipos de actualizaciones, bastar\u00e1 con descomentar la l\u00ednea eliminando la doble barra al inicio de la misma.</p> <p>Tanto <code>${distro_id} como ${distro_codename}</code> son variables de entorno del sistema Ubuntu de esta forma se crea un \u00fanico fichero de configuraci\u00f3n para cualquier versi\u00f3n del kernel.</p> <p>Es buena pr\u00e1ctica instalar por defecto todas las actualizaciones que los desarrolladores del sistema operativo marquen como de seguridad o cr\u00edticas, dejando a la elecci\u00f3n del administrador del sistema inform\u00e1tico el resto de actualizaciones.</p>"},{"location":"UD3/documeConfigSistema/","title":"Documentaci\u00f3n de la configuraci\u00f3n del sistema inform\u00e1tico","text":"<p>Al igual que cuando se programa es habitual olvidar comentar el c\u00f3digo, uno de los aspectos que m\u00e1s se descuidan cuando se procede a implantar un sistema inform\u00e1tico es la documentaci\u00f3n del proceso y configuraci\u00f3n del mismo. No es ocioso encarecer que un SOR es algo vivo que ir\u00e1 creciendo y adapt\u00e1ndose a las necesidades del entorno en el que se encuentra. Cuanto m\u00e1s precisa sea la documentaci\u00f3n que se genere, menos problemas existir\u00e1n para retomar el trabajo de instalaci\u00f3n o configuraci\u00f3n un tiempo despu\u00e9s de haberlo dado por concluido.</p> <p>En este sentido, una de las primeras cuestiones que hay que resolver es la nomenclatura. Es buena idea asignar a cada equipo de nuestra red un identificativo \u00fanico que puede estar relacionado con la funci\u00f3n que realiza, su ubicaci\u00f3n dentro de la empresa, \u00e1rea en la que se emplea o ambas. El objetivo es poder referirnos a cada elemento de la red de una forma abreviada y c\u00f3moda.</p> <p>Una vez identificados los equipos y resto del hardware del sistema (impresoras, dispositivos de interconexi\u00f3n, esc\u00e1neres, c\u00e1maras, etc\u00e9tera), es buena idea disponer de un documento con el perfil de la instalaci\u00f3n para cada uno de los equipos incluidos en el sistema. En esta documentaci\u00f3n deber\u00eda constar, adem\u00e1s del identificador, los siguientes datos:</p> <ul> <li>datos de hardware, su ubicaci\u00f3n dentro del sistema, funci\u00f3n, el tipo de procesador que incorpora, el tipo y cantidad de memoria principal y secundaria, tarjeta de red, tarjeta gr\u00e1fica. Es buena pr\u00e1ctica reflejar los dispositivos conectados al equipo, como impresoras y esc\u00e1neres entre otros.</li> <li>descripci\u00f3n del sistema operativo, que incluir\u00e1 su nombre y versi\u00f3n, la fecha y la hora de instalaci\u00f3n, el usuario que act\u00faa como administrador y su contrase\u00f1a y las licencias instaladas en \u00e9l. Cuando el sistema inform\u00e1tico utiliza sistemas operativos privativos es de vital importancia, sobre todo para posteriores operaciones de actualizaci\u00f3n, la clave de producto. Se trata de la secuencia de n\u00fameros y letras, normalmente organizadas en grupos y separadas por guiones, que suele venir adherida al embalaje del medio de almacenamiento en el que se distribuye el producto.</li> <li>parches y actualizaciones de los sistemas operativos, especialmente en los de Microsoft Windows. Es buena praxis incluir la fecha de la instalaci\u00f3n y una descripci\u00f3n de su objetivo.</li> <li>configuraci\u00f3n de la red, aunque lo m\u00e1s probable es que se trabaje con un servicio DHCP, es buena idea registrar tambi\u00e9n los datos que conforman la red en la que est\u00e1 inmerso el equipo, especialmente si existen subredes: IP del equipo, m\u00e1scara de subred, puerta de enlace, el servidor DNS, el nombre del dominio y subdominio en el que se integra el equipo.</li> <li>software instalado, informaci\u00f3n \u00fatil para comprobar si las versiones que se usan en el sistema se encuentran actualizadas o si, por el contrario, es necesario desactualizarlas. En ciertos ambientes mantener el software a la \u00faltima versi\u00f3n no es conveniente.</li> </ul> <p>El modo de almacenar y obtener toda esta informaci\u00f3n debe permitir la actualizaci\u00f3n de los datos de una forma \u00f3ptima, eso, por supuesto, descarta la opci\u00f3n de disponer de este documento impreso en papel. Es conveniente toda la informaci\u00f3n de la implementaci\u00f3n est\u00e9 contenida en una base de datos de f\u00e1cil y r\u00e1pido acceso. Existen numerosas aplicaciones tanto para sistemas operativos de Microsoft como de GNU/Linux que permiten la recolecci\u00f3n y administraci\u00f3n de esta informaci\u00f3n como Network Inventory Advisor, Spiceworks Inventory, Open-Audit o GLPI. Todas ellas trabajan utilizando el modelo cliente-servidor implementado en la red. De este modo se instala una aplicaci\u00f3n servidor encargada de recolectar la informaci\u00f3n de forma centralizada, junto con una aplicaci\u00f3n cliente en cada ordenador del sistema.</p> <p>A pesar de contar con estas aplicaciones, los sistemas operativos poseen herramientas para la recolecci\u00f3n de datos, aunque no se comportan de forma tan eficiente. En Microsoft Windows se dispone de la herramienta de diagn\u00f3stico de DirectX denominada dxdialog, la cual muestra toda esta informaci\u00f3n por pantalla.</p> <p>En GNU/Linux se dispone de varias herramientas que, a trav\u00e9s del terminal ofrecen la informaci\u00f3n detallada del sistema. Comandos como <code>uname, who, ifconfig, df, top, fdisk, apt, hwinfo, mount o free</code> son s\u00f3lo algunos. Como administradores es buena pr\u00e1ctica realizar informes peri\u00f3dicos del estado del sistema con estos comandos. Lo ideal es que se programe un shellscript que genere un informe con esta documentaci\u00f3n del sistema, actividad que se tratar\u00e1 en lo sucesivo.</p> <p>Es necesario, por tanto, recopilar, guardar y actualizar la informaci\u00f3n de un sistema inform\u00e1tico para poder diagnosticar de manera precisa en estado del mismo y que acciones son necesarias para su mantenimiento. Hay que tener muy presente que un sistema operativo es un ente vivo que cambia con cada inicio.</p> <p></p>"},{"location":"UD3/procesosLinux/","title":"Los procesos","text":"<p>Un proceso representa un programa en curso de ejecuci\u00f3n y, al mismo tiempo, todo su entorno de ejecuci\u00f3n (memoria, estado, identificaci\u00f3n, propietario, padre...).</p> <p>El entorno viene marcado por:</p> <ul> <li>Un n\u00famero de proceso \u00fanico PID (Process ID)</li> <li>Un n\u00famero de proceso padre PID (Parent Process ID). Todos los procesos tienen un PPID salvo el proceso 0, que es un seudoproceso que representa el inicio del sistema (crea el 1 init).</li> <li>Un n\u00famero de usuario y uno de grupo: corresponde al UID y al GID de la cuenta de usuario que inicia el proceso.</li> <li>Duraci\u00f3n y prioridad del proceso. No todos los procesos tienen la misma prioridad para ser ejecutados por el procesador.</li> <li>Directorio de Trabajo. . desde que directorio se ha lanzado el proceso.</li> <li>Archivos abiertos por el proceso.</li> </ul> <p>Un proceso pasa por distintos estados durante la ejecuci\u00f3n del mismo:</p> <ul> <li>en espera E/S (waiting)</li> <li>dormido (sleeping)</li> <li>listo para la ejecuci\u00f3n (runnable)</li> <li>dormido en el swap (memoria virtual)</li> <li>nuevo proceso</li> <li>fin de proceso</li> <li>(zombie). Cuando un padre termina sus hijos terminan. Pero, cuando algunos de sus hijos queda ejecut\u00e1ndose y su padre termina se le denomina de esa manera.</li> </ul> <p>Adem\u00e1s se pueden ejecutar de dos formas:</p> <ul> <li>ejecuci\u00f3n en modo usuario (user mode)</li> <li>ejecuci\u00f3n en modo n\u00facleo (kernel mode)</li> </ul>"},{"location":"UD3/procesosLinux/#ejecucion-en-segundo-plano","title":"Ejecuci\u00f3n en segundo plano.","text":"<p>En entornos multitarea hay muchos procesos en ejecuci\u00f3n o un estado que hemos comentado anteriormente. El shell es un programa que provoca un proceso y cuando se ejecuta alg\u00fan comando se produce un proceso hijo. Hasta que no termine el este proceso no se puede ejecutar otro. Pero, este comportamiento lo podemos cambiar mediante el <code>&amp;</code>. En este caso, el shell y el comando iniciado funcionar\u00e1n en paralelo.</p> Ejemplo de ejecuci\u00f3n en segundo plano<pre><code>ls -R / &gt; ls.txt 2&gt;/dev/null &amp;\n[2] 55351\n# No da los siguiente trabajos  mediante el comando jobs\n jobs\n[1]-  Ejecutando              ls --color=auto -R / 2/dev/null &gt; ls.txt &amp;\n[2]+  Ejecutando              ls --color=auto -R / &gt; ls.txt 2&gt; /dev/null &amp;\n</code></pre> <p>Podemos parar un proceso de forma temporal con Ctrl + Z. Lo lleva a segundo plano y se para, como podemos ver en el siguiente ejemplo:</p> Parada y puesta en segundo plano<pre><code>sleep 100\n^Z\n\n[1]+  Detenido                sleep 100\n</code></pre> <p>Para reanudar el proceso lo tenemos que poner en primer plano con el comando <code>fg</code></p> A primer plano<pre><code>fg\nsleep100\n</code></pre> <p>Con el comando <code>bg</code> un job parado para iniciarlo de nuevo en segundo plano.</p> Ejemplo de bg<pre><code>jobs\n# listo los trabajos\n[1]+  Detenido                sleep 100\n# Ejecuto en segundo plano el trabajo con el n\u00famero 1\n bg 1\n[1]+ sleep 100 &amp;\n</code></pre>"},{"location":"UD3/procesosLinux/#lista-de-los-procesos","title":"Lista de los procesos","text":"<p>El comando <code>ps (process status)</code> permite obtener informaci\u00f3n sobre los procesos en curso.</p> Ejemplo de ps con las opciones ef<pre><code>ps -ef\nUID          PID    PPID  C STIME TTY          TIME CMD\nroot           1       0  0 19:12 ?        00:00:06 /sbin/init splash\nroot           2       0  0 19:12 ?        00:00:00 [kthreadd]\n</code></pre> <p>Nos muestra una salida de todos los procesos <code>(-e)</code> y con m\u00e1s informaci\u00f3n sobre ellos <code>(-f)</code>. Si queremos toda la informaci\u00f3n deberemos utilizar la opci\u00f3n <code>-l</code>.</p> Ejemplo de ps con la opci\u00f3n u<pre><code>ps -u root\n    PID TTY          TIME CMD\n      1 ?        00:00:06 systemd\n</code></pre> <p>Nos muestra informaci\u00f3n de los procesos pertenecientes a root. Como podemos ver, no nos muestra tantas columnas.</p>"},{"location":"UD3/procesosLinux/#parada-de-un-procesosenales","title":"Parada de un proceso/se\u00f1ales","text":"<p>El comando kill no es obligatoriamente destruir o terminar un proceso, sino mandar se\u00f1ales a los procesos.</p> Sintaxis de kill<pre><code>kill [-l] -Num_se\u00f1al PID [PID2...]\n</code></pre> <p>Cuando se manda una se\u00f1al a un proceso, \u00e9ste debe interceptarla y reaccionar en consecuencia.</p> Ejemplo de kill<pre><code>kill -l     (lista todas las posibles se\u00f1ales que pueden enviarse a un proceso)\n 1) SIGHUP       2) SIGINT       3) SIGQUIT      4) SIGILL\n 5) SIGTRAP      6) SIGABRT      7) SIGBUS       8) SIGFPE\n 9) SIGKILL     10) SIGUSR1     11) SIGSEGV     12) SIGUSR2\n13) SIGPIPE     14) SIGALRM     15) SIGTERM     16) SIGSTKFLT\n17) SIGCHLD     18) SIGCONT     19) SIGSTOP     20) SIGTSTP\n21) SIGTTIN     22) SIGTTOU     23) SIGURG      24) SIGXCPU\n25) SIGXFSZ     26) SIGVTALRM   27) SIGPROF     28) SIGWINCH\n29) SIGIO       30) SIGPWR      31) SIGSYS      34) SIGRTMIN\n35) SIGRTMIN+1  36) SIGRTMIN+2  37) SIGRTMIN+3  38) SIGRTMIN+4\n39) SIGRTMIN+5  40) SIGRTMIN+6  41) SIGRTMIN+7  42) SIGRTMIN+8\n43) SIGRTMIN+9  44) SIGRTMIN+10 45) SIGRTMIN+11 46) SIGRTMIN+12\n47) SIGRTMIN+13 48) SIGRTMIN+14 49) SIGRTMIN+15 50) SIGRTMAX-14\n51) SIGRTMAX-13 52) SIGRTMAX-12 53) SIGRTMAX-11 54) SIGRTMAX-10\n55) SIGRTMAX-9  56) SIGRTMAX-8  57) SIGRTMAX-7  58) SIGRTMAX-6\n59) SIGRTMAX-5  60) SIGRTMAX-4  61) SIGRTMAX-3  62) SIGRTMAX-2\n63) SIGRTMAX-1  64) SIGRTMAX\n</code></pre> <p>En el anterior ejemplo nos muestra todas las se\u00f1ales que podemos mandar, por defecto manda la 15 (SIGTERM). Pide al proceso terminar con normalidad.</p> Ejemplo de se\u00f1ales<pre><code>sleep 100&amp;\n[1] 62497\n kill 62497\n jobs\n[1]+  Terminado               sleep 100\n sleep 100&amp;\n[1] 62642\n kill -9 62642\n jobs\n[1]+  Terminado (killed)      sleep 100\n</code></pre>"},{"location":"UD3/programaTareas/","title":"Programaci\u00f3n de tareas","text":"<p>En cualquier sistema operativo existen tareas recurrentes que conviene automatizar para liberar al equipo de administraci\u00f3n. Copias de seguridad, limpieza de temporales o la recopilaci\u00f3n de informes son ejemplos t\u00edpicos. Para facilitar este trabajo, cada plataforma ofrece herramientas capaces de programar dichas tareas y delegar su ejecuci\u00f3n en el propio sistema.</p> <p>En Microsoft Windows Server la herramienta principal es el Programador de tareas. Se accede desde Administrador del servidor \u2192 Herramientas \u2192 Programador de tareas. Desde el men\u00fa Acci\u00f3n es posible crear nuevas tareas mediante la opci\u00f3n Crear tarea b\u00e1sica\u2026 (asistente guiado) o Crear tarea\u2026 (configuraci\u00f3n avanzada). La ventana de configuraci\u00f3n se organiza en cinco pesta\u00f1as:</p> <ul> <li>General: permite asignar nombre y descripci\u00f3n, elegir la cuenta con la que se ejecutar\u00e1 la tarea y definir el contexto de seguridad. Es recomendable marcar Ejecutar tanto si el usuario inici\u00f3 sesi\u00f3n como si no para que la tarea no dependa de una sesi\u00f3n interactiva.</li> <li>Desencadenadores: determina qu\u00e9 eventos activan la tarea (programaci\u00f3n, inicio de sesi\u00f3n, registro de un evento, conexi\u00f3n de un usuario espec\u00edfico, etc.). Las opciones disponibles dependen del tipo de desencadenador elegido.</li> <li>Acciones: especifica qu\u00e9 se har\u00e1 cuando se dispare el desencadenador. Lo habitual es ejecutar un script o un programa, pero se puede abrir cualquier aplicaci\u00f3n. El proceso heredar\u00e1 los permisos de la cuenta indicada en la pesta\u00f1a General, por lo que conviene extremar las precauciones.</li> <li>Condiciones: define requisitos extra para que la tarea se inicie, como que el equipo est\u00e9 en corriente alterna, que exista conectividad de red o que el equipo est\u00e9 inactivo.</li> <li>Configuraci\u00f3n: a\u00f1ade par\u00e1metros de control adicionales (reintentos, detenci\u00f3n tras un tiempo m\u00e1ximo, manipulaci\u00f3n de tareas en ejecuci\u00f3n, etc.).</li> </ul> <p>Adem\u00e1s de crear tareas, el programador permite revisar qu\u00e9 tareas est\u00e1n activas desde Acci\u00f3n \u2192 Mostrar todas las tareas en ejecuci\u00f3n, lo que resulta \u00fatil para diagnosticar ejecuciones prolongadas o bloqueos.</p> <p>En los sistemas operativos basados en GNU/Linux la programaci\u00f3n peri\u00f3dica recae en el demonio <code>cron</code>, que cada minuto revisa si debe lanzar alguna tarea. A diferencia del Programador de tareas de Windows, <code>cron</code> no ofrece interfaz gr\u00e1fica: las tareas se definen mediante comandos o scripts de consola.</p>"},{"location":"UD3/programaTareas/#directorios-gestionados-automaticamente","title":"Directorios gestionados autom\u00e1ticamente","text":"<p>Muchas distribuciones proporcionan directorios especiales que <code>cron</code> recorre con la utilidad <code>run-parts</code>. Cualquier script ejecutable que se coloque en ellos se lanzar\u00e1 con la periodicidad indicada:</p> <ul> <li><code>/etc/cron.hourly</code></li> <li><code>/etc/cron.daily</code></li> <li><code>/etc/cron.weekly</code></li> <li><code>/etc/cron.monthly</code></li> </ul> <p>Algunos sistemas a\u00f1aden <code>/etc/cron.d/</code> para agrupar archivos con el mismo formato que <code>/etc/crontab</code>. Este enfoque facilita instalar paquetes que introducen sus propias tareas programadas sin modificar el fichero principal.</p>"},{"location":"UD3/programaTareas/#archivo-etccrontab-y-sintaxis","title":"Archivo <code>/etc/crontab</code> y sintaxis","text":"<p>El fichero <code>/etc/crontab</code> controla la planificaci\u00f3n global. Un ejemplo t\u00edpico es:</p> Fichero de configuraci\u00f3n de cron<pre><code>SHELL=/bin/bash\nPATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin\n\n# m  h  dom mon dow usuario  comando\n17  *  *   *   *  root      run-parts /etc/cron.hourly\n25  6  *   *   *  root      run-parts /etc/cron.daily\n47  6  *   *   7  root      run-parts /etc/cron.weekly\n52  6  1   *   *  root      run-parts /etc/cron.monthly\n</code></pre> <p>Las dos primeras l\u00edneas definen variables de entorno:</p> <ul> <li><code>SHELL</code> indica el int\u00e9rprete usado para ejecutar los comandos. Si no se declara, se emplea el definido para el usuario que lanza la tarea.</li> <li><code>PATH</code> establece los directorios donde se buscar\u00e1n los ejecutables. Puede diferir del <code>PATH</code> interactivo del usuario.</li> </ul> <p>Cada l\u00ednea posterior describe una tarea. Se compone de cinco campos de tiempo, el usuario que ejecutar\u00e1 la orden y el comando propiamente dicho:</p> Campo Descripci\u00f3n Minuto Valor entre 0 y 59. Indica el minuto exacto en el que se inicia la tarea. Hora Valor entre 0 y 23. Usa formato de 24 horas (0 corresponde a medianoche). D\u00eda del mes Valor entre 1 y 31. Determina el d\u00eda del mes en el que se ejecuta la tarea. Mes Valor entre 1 y 12 o abreviatura en ingl\u00e9s (<code>jan</code>, <code>feb</code>, <code>mar</code>, ...). D\u00eda de la semana Valor entre 0 y 7 (0 y 7 representan el domingo) o abreviatura en ingl\u00e9s (<code>mon</code>, <code>tue</code>, <code>wed</code>, ...). Usuario Cuenta con la que se ejecutar\u00e1 el comando (solo en <code>/etc/crontab</code> y en los ficheros de <code>/etc/cron.d</code>). Comando Orden o script a ejecutar. Puede incluir tuber\u00edas, redirecciones y rutas absolutas. <p>El car\u00e1cter <code>*</code> significa \u201ccualquier valor\u201d en ese campo. Para aclarar la lectura, a continuaci\u00f3n se muestran algunas combinaciones frecuentes (separadas por espacios para resaltar los siete campos):</p> Ejemplos de ejecuciones programadas<pre><code>1   *   *   *   *   root  /usr/local/bin/rotar_logs.sh           # Minuto 1 de cada hora\n15  8   *   *   *   root  /usr/local/bin/backup.sh               # Cada d\u00eda a las 08:15\n0   17  *   *   0   root  /usr/local/bin/revision_semana.sh      # Domingos a las 17:00\n*/5 5-7 *   *   1-5 root  /usr/local/bin/reporte_red.sh          # Cada 5 min entre las 05:00 y las 07:59 de lunes a viernes\n30  9   20  7   *   root  /usr/local/bin/felicitacion.sh         # 20 de julio a las 09:30, sin importar el d\u00eda de la semana\n0   12  1   */2  *   root  /usr/local/bin/auditoria.sh          # D\u00eda 1 de cada mes par al mediod\u00eda\n</code></pre>"},{"location":"UD3/programaTareas/#listas-rangos-e-incrementos","title":"Listas, rangos e incrementos","text":"<p>Los campos de tiempo admiten varias sintaxis combinables:</p> <ul> <li>Listas separadas por comas: <code>0,15,30,45</code> ejecuta a los minutos 0, 15, 30 y 45.</li> <li>Rangos con guiones: <code>1-5</code> equivale de lunes a viernes en el campo \u201cd\u00eda de la semana\u201d.</li> <li>Incrementos con la barra <code>/</code>: <code>*/10</code> significa \u201ccada diez unidades del campo\u201d.</li> </ul> Ejemplos con listas y saltos<pre><code>59 11  *   jan-mar mon-fri  root  /usr/local/bin/cierre_trimestral.sh\n45 *   10-25 *     sat,sun   root  /usr/local/bin/respaldo_fechas.sh\n*/15 10-14 *  *     *        root  /usr/local/bin/informe_mediodia.sh\n0  12  1-10/2 feb,aug *      root  /usr/local/bin/auditoria_extra.sh\n</code></pre> <p>Todos los criterios se eval\u00faan con un AND: la tarea solo se ejecuta cuando se cumplen simult\u00e1neamente las cinco condiciones temporales.</p>"},{"location":"UD3/programaTareas/#gestionar-cron-por-usuario-con-crontab","title":"Gestionar cron por usuario con <code>crontab</code>","text":"<p><code>cron</code> es multiusuario. Adem\u00e1s del fichero global, cada cuenta puede mantener su propio listado con <code>crontab</code>. Los archivos individuales se almacenan (seg\u00fan la distribuci\u00f3n) en <code>/var/spool/cron/crontabs/usuario</code>.</p> <p>Comandos b\u00e1sicos:</p> <ul> <li><code>crontab -e</code>: abre el editor de texto configurado (por defecto <code>vi</code>) para modificar la tabla del usuario actual.</li> <li><code>crontab -l</code>: muestra la programaci\u00f3n vigente.</li> <li><code>crontab -r</code>: elimina la programaci\u00f3n del usuario (conviene usarlo con precauci\u00f3n).</li> </ul> <p>Los ficheros de usuario omiten el campo \u201cusuario\u201d, por lo que solo incluyen los cinco campos de tiempo y el comando. Si se definen tareas personales, el demonio <code>cron</code> leer\u00e1 tanto la tabla del sistema como la del usuario, adem\u00e1s de cualquier archivo en <code>/etc/cron.d/</code>. Los archivos <code>/etc/cron.allow</code> y <code>/etc/cron.deny</code>, cuando existen, permiten restringir qui\u00e9n puede usar <code>crontab</code>.</p>"},{"location":"UD3/programaTareas/#systemd-timers","title":"Systemd timers","text":"<p><code>systemd</code> ofrece una alternativa moderna a <code>cron</code> mediante unidades de tipo timer. Permiten reutilizar toda la infraestructura de dependencias y registros de <code>systemd</code>, adem\u00e1s de soportar expresiones de calendario m\u00e1s legibles (<code>OnCalendar=</code>, <code>OnActiveSec=</code>, etc.).</p>"},{"location":"UD3/programaTareas/#ejemplo-registrar-la-fecha-cada-10-minutos","title":"Ejemplo: registrar la fecha cada 10 minutos","text":"<p>Con <code>cron</code> bastar\u00eda con crear una entrada como la siguiente, que a\u00f1adir\u00e1 la fecha al archivo <code>/tmp/date</code> cada diez minutos:</p> Ejemplo con crontab<pre><code>*/10 * * * * /usr/bin/date &gt;&gt; /tmp/date\n</code></pre> <p>La versi\u00f3n con <code>systemd</code> separa la l\u00f3gica en dos archivos: una unidad de servicio que realiza la acci\u00f3n y una unidad de temporizador que define la frecuencia.</p> <ol> <li>Crear el servicio <code>/etc/systemd/system/date.service</code>:</li> </ol> Contenido de date.service<pre><code>[Unit]\nDescription=Guardar la fecha actual en /tmp/date\n\n[Service]\nType=oneshot\nExecStart=/usr/bin/env sh -c '/usr/bin/date &gt;&gt; /tmp/date'\n</code></pre> <ol> <li>Crear el temporizador <code>/etc/systemd/system/date.timer</code>:</li> </ol> Contenido de date.timer<pre><code>[Unit]\nDescription=Ejecuta date.service cada 10 minutos\n\n[Timer]\nOnCalendar=*:0/10\nAccuracySec=1min\n\n[Install]\nWantedBy=timers.target\n</code></pre> <ol> <li>Recargar la configuraci\u00f3n y habilitar el temporizador para que se inicie autom\u00e1ticamente:</li> </ol> Activar y comprobar el temporizador<pre><code>sudo systemctl daemon-reload\nsudo systemctl enable --now date.timer\nsystemctl list-timers --all | grep date\njournalctl -u date.service --since \"1 hour ago\"\n</code></pre> <p>La salida de <code>systemctl list-timers</code> muestra los temporizadores activos con su \u00faltima y pr\u00f3xima ejecuci\u00f3n, lo que facilita la comprobaci\u00f3n de la planificaci\u00f3n. Si se desea desactivar la tarea se puede ejecutar <code>sudo systemctl disable --now date.timer</code>.</p>"},{"location":"UD3/registroWindow/","title":"Registro del sistema en Microsoft Windows","text":"<p>En la familia de Microsoft Windows, cobra especial importancia una base de datos jer\u00e1rquica gestionada por el propio sistema operativo y que almacena todos los datos de configuraci\u00f3n tanto del hardware, software como de los usuarios. Esta base de datos no es otra que el Registro de Windows y es una pieza fundamental en los sistemas operativos de Microsoft.</p> <p>Se introdujo por primera vez con Microsoft Windows 3.1 con el prop\u00f3sito de guardar informaci\u00f3n basados en COM (Component Object Mode de Microsoft). A partir de Microsoft Windows 95 se ampliaron las caracter\u00edsticas almacenadas en el registro, pauta que se sigui\u00f3 versi\u00f3n tras versi\u00f3n hasta la actualidad. Antes de su existencia, la configuraci\u00f3n del software se almacenaba en ficheros de configuraci\u00f3n INI (Windows Initialization File) contenidos en la carpeta de usuario. En un ambiente multiusuario toda la informaci\u00f3n de la configuraci\u00f3n del software estaba repartida en demasiados archivos de este tipo. La b\u00fasqueda de un dato se realiza de forma m\u00e1s r\u00e1pida en un ambiente estructurado y no recorriendo el disco en busca de los ficheros INI.</p> <p>Esta base de datos jer\u00e1rquica est\u00e1 compuesta por dos elementos b\u00e1sicos:</p> <ul> <li>claves, contenedores de valores que tienen un comportamiento similar a las carpetas, que a su vez pueden contener subclaves. Los nombres de esta claves no pueden contener barras, caracteres especiales y no distinguen entre may\u00fasculas y min\u00fasculas.</li> <li> <p>valores, el contenido de cada una de las claves. Este contenido es fuertemente tipado y debe pertenecer a alguno de estos tipos de datos:</p> <ul> <li>REG_BINARY, contiene datos binarios</li> <li>REG_DWORD, n\u00famero entero positivo de 32 bits</li> <li>REG_LINK, enlace simb\u00f3lico a otra clave de registro</li> <li>REG_MULTI_SZ, valor de cadena m\u00faltiple (lista ordenada de cadenas)</li> <li>REG_SZ, cadena de texto en formato UTF-16</li> <li>REG_NONE, datos sin ning\u00fan tipado</li> </ul> </li> </ul> <p>El registro se divide en varias secciones l\u00f3gicas o \u00e1rboles cada una destinada a contener la informaci\u00f3n espec\u00edfica de un \u00e1rea del equipo. De esta forma, si es necesario la obtenci\u00f3n de un dato de configuraci\u00f3n del software, no buscar\u00e1 en la rama de usuario, ni en la de hardware. Esta distinci\u00f3n en ramas limita el espectro de b\u00fasqueda y lo hace m\u00e1s \u00f3ptimo. Actualmente son seis las claves del registro:</p> <ul> <li>HKEY_LOCAL_MACHINE (HKLM), almacena configuraciones espec\u00edficas del equipo local. Este \u00e1rbol se almacena en memoria principal al arrancar el sistema y es all\u00ed donde se modifica la informaci\u00f3n. Durante el proceso de apagado, esta informaci\u00f3n se escribe en memoria no vol\u00e1til.</li> <li>HKEY_CLASSES_ROOT (HKCR), contiene la informaci\u00f3n sobre aplicaciones, asociaciones de archivos e identificadores de clases de objetos OLE (Object Linking and Embedding).</li> <li>HKEY_USERS (HKU), alberga la informaci\u00f3n de todos los perfiles de usuario locales presentes en el sistema.</li> <li>HKEY_CURRENT_USER (HKCU), posee la informaci\u00f3n referida al usuario con la sesi\u00f3n iniciada en estos momentos. En los sistemas NT (New Technology) de Microsoft, esta informaci\u00f3n se copia en los ficheros NTUSER.DAT y USRCLASS.DAT, y se ubica en la carpeta personal de cada usuario. Si los perfiles se han configurado como m\u00f3viles, esta informaci\u00f3n viaja al equipo en el que se inicie sesi\u00f3n.</li> <li>HKEY_PERFONMANCE_DATA, este \u00e1rbol no aparece en el registro, aunque puede ser accedida a trav\u00e9s de la API (Application Programming Interface) de Windows. Esta clave proporciona informaci\u00f3n en tiempo de ejecuci\u00f3n del rendimiento del sistema. Los datos son proporcionados por el kernel, controladores, programas y servicios en funcionamiento.</li> <li>HKEY_DYN_DATA, clave que tan s\u00f3lo est\u00e1 presente en los sistemas de Microsoft Windows 95, Microsoft Windows 98 y Microsoft Windows ME. Contiene informaci\u00f3n sobre los dispositivos de hardware y de red. Esta rama no se guarda en el registro ya que es creada en tiempo real y destruida cuando se apaga el ordenador. Durante su existencia se almacena en la memoria principal.</li> </ul> <p>Pr\u00e1cticamente cualquier configuraci\u00f3n se guarda en este registro y es modificable a trav\u00e9s del programa RegEdit.exe, una herramienta que permite explorar, importar y modificar los valores del registro. Es necesario prestar especial atenci\u00f3n a esta herramienta, ya que los cambios se producen sin solicitar confirmaci\u00f3n y de forma persistente, lo que puede conducir a errores irreversibles. Es altamente recomendable realizar una copia del registro antes de proceder a su modificaci\u00f3n.</p> <p>Existen dos formas de edici\u00f3n del registro:</p> <p>\u2022 manual, a trav\u00e9s de la aplicaci\u00f3n RegEdit.exe, que mostrar\u00e1 la base de datos jerarquizada a trav\u00e9s de la cual se podr\u00e1 navegar hasta la clave necesaria para modificar all\u00ed su valor. \u2022 autom\u00e1tica, a trav\u00e9s de ficheros de configuraci\u00f3n con extensi\u00f3n reg. Estos archivos contienen texto con una estructura espec\u00edfica que permite a\u00f1adir o eliminar datos en el registro:</p> <pre><code>versi\u00f3nEditorRegistro\nl\u00ednea en blanco\n[rutaRegistro1]\n\"nombreDato1\"=\"tipoDatos1:valorDatos1\"\n\"nombreDato2\"=\"tipoDatos2:valorDatos2\"\nl\u00ednea en blanco\n[rutaRegistro2]\n\"nombreDato3\"=\"tipoDatos3:valorDatos3\"\n</code></pre> <p>En donde:</p> <ul> <li>versi\u00f3nEditorRegistro, indica la versi\u00f3n del editor a utilizar. A partir de Microsoft Windows Server 2003 y Microsoft Windows XP se utiliza la versi\u00f3n 5.0, por lo que ser\u00e1 conveniente especificar siempre esta versi\u00f3n.</li> <li>rutaRegistro, es la ruta de la clave que se va a importar al registro. Se escribe entre corchetes y utilizando la barra inversa para separar los niveles de jerarqu\u00eda.</li> <li>nombreDato, nombre del dato que se necesita modificar. Si esta entrada existe en el registro se modifica su valor, en caso contrario se crea una nueva entrada con los datos proporcionados.</li> <li>tipoDatos, el tipo de dato del valor que se introducir\u00e1 en la entrada. Es necesario recordar que el registro es una base de datos fuertemente tipada, por lo que es necesario indicar siempre el tipo de dato.</li> <li>valorDato, el valor que se introduce en el registro. Huelga decir que sebe ser un valor compatible con el tipo de dato especificado en tipoDato.</li> </ul> <p>Para ilustrar el funcionamiento de estos ficheros, se crear\u00e1 un registro que a\u00f1ada los datos de una aplicaci\u00f3n en todos los ordenadores del sistema inform\u00e1tico. Para realizar esta tarea la opci\u00f3n m\u00e1s pr\u00e1ctica es crear un fichero REG que se ejecutar\u00e1 en cada uno de los ordenadores. Con posterioridad descubriremos que un SOR permite realizar esta tarea de una forma infinitamente m\u00e1s pr\u00e1ctica.</p> <p>El fichero REG ser\u00e1 el siguiente:</p> El fichero REG<pre><code>Windows Registry Editor Version 5.00\n\n[HKEY_CURRENT_USER\\software\\MiAplicacion]\n\"Titulo\"=\"Mi Aplicaci\u00f3n v 1.0\"\n\"VersionInicial\"=dword:00001024\n</code></pre> <p>Si se ejecuta este fichero, se a\u00f1adir\u00e1 una nueva clave denominada MiAplicacion que contendr\u00e1 dos registros (Titulo y VersionInicial) con los valores de cada uno de ellos. N\u00f3tese que los valores del tipo REG-SZ se introducen sin tipo de datos, pero siempre entre comillas dobles. Adem\u00e1s, el fichero de registro debe terminar siempre con una l\u00ednea en blanco.</p> <p>A trav\u00e9s de los archivos REG tambi\u00e9n existe la posibilidad de eliminar claves o valores. Si se elimina una clave del registro, \u00e9sta desaparecer\u00e1 del \u00e1rbol al que pertenece. Sin embargo, si se elimina un valor, la clave a la que pertenece ese valor continuar\u00e1 existiendo. Para eliminar elementos del registro es necesario colocar un guion en lugar del valor que se requiere suprimir y si se trata de una clave, anteponer este guion a la ruta de la clave.</p> El fichero REG<pre><code>\"Titulo\"=-\n\"VersionInicial\"=-\n</code></pre> <p>Si se ejecuta este fichero REG, eliminar\u00e1 los valores de Titulo y VersionInicial, pero mantendr\u00e1 las claves en el registro.</p> El fichero REG<pre><code>[-HKEY_CURRENT_USER\\software\\MiAplicaci\u00f3n]\n</code></pre> <p>En esta ocasi\u00f3n se quita la clave entera MiAplicacion, por lo que desaparecer\u00e1n tanto las claves que la contienen como sus valores.</p> <p>Esta alteraci\u00f3n del registro tambi\u00e9n se puede realizar desde el terminal de comandos facilitando la automatizaci\u00f3n de estas modificaciones. Para ello se utiliza el comando REG, que permite la adici\u00f3n, eliminaci\u00f3n, consulta, copia, restauraci\u00f3n y exportaci\u00f3n de contenido del registro. Se puede obtener toda la informaci\u00f3n de este comando a trav\u00e9s de su ayuda en el terminal:</p> Ejemplo del comando reg<pre><code>reg /?\n</code></pre> <p>Si lo que se pretende es a\u00f1adir informaci\u00f3n al registro se usar\u00e1 la opci\u00f3n reg add del comando de la siguiente manera:</p> Ejemplo del comando reg<pre><code>reg add Clave /v NombreValor /t TipoDato /d Dato\n</code></pre> <p>As\u00ed, se podr\u00eda introducir la informaci\u00f3n del ejemplo anterior del siguiente modo:</p> Ejemplo del comando reg<pre><code>reg add hkcu\\software\\MiAplicacion /v Titulo /t REG_SZ /d \u201cMi aplicaci\u00f3n v 1.0\u201d\n</code></pre> <p>Y la segunda clave:</p> Ejemplo del comando reg<pre><code>reg add hkcu\\software\\MiAplicacion /v VersionInicial /t REG_DWORD /d 1024\n</code></pre> <p>Para acortar la ruta de acceso a la clase, es posible utilizar las abreviaturas de los \u00e1rboles para simplificar los comandos. As\u00ed <code>hkcu</code> corresponder\u00eda con el \u00e1rbol HKEY_CURRENT_USER.</p> <p>Si se requiere borrar una entrada, se utilizar\u00e1 la opci\u00f3n reg delete de la siguiente manera: reg delete hkcu\\software\\MiAplicacion /v</p> <p>Para conocer lo que es capaz de realizar este comando, as\u00ed como todas sus opciones, es buena idea consultar su ayuda en el terminal. Aunque parezca una forma un tanto inc\u00f3moda de editar el registro, en los sucesivo se trabajar\u00e1 con scripts Powershell que se pueden programar para realizar este tipo de configuraciones de forma aromatizada, la cual ahorrar\u00e1 mucho tiempo y trabajo.</p>"},{"location":"UD4/Actividades/","title":"Actividades de la UD4","text":""},{"location":"UD4/Actividades/#actividad-1","title":"Actividad 1","text":"<p>Antes de abordar la configuraci\u00f3n los servicios de directorio, crea una empresa imaginaria. Debes especificar nombre, direcci\u00f3n, actividad, debe disponer de varias sedes f\u00edsicas y establece una estructura en departamentos basada en estas premisas:</p> <ol> <li>un departamento encargado de la gerencia de la empresa. Habitualmente suelen tener acceso a toda la informaci\u00f3n de la empresa, pero no a los pormenores de la configuraci\u00f3n del sistema</li> <li>otro de encargar\u00e1 de la administraci\u00f3n de la empresa. En normal que ante la amplitud de tareas que este departamento posee se divida en varios, como por ejemplo uno encargado de las finanzas, otro de las n\u00f3minas o de la contabilidad.</li> <li>la empresa que dise\u00f1as se encarga de la fabricaci\u00f3n y venta, por lo que un departamento encargado de la gesti\u00f3n de estos menesteres ser\u00e1 necesario. Es posible que requieras controlar las compras, las ventas as\u00ed como la gesti\u00f3n de inventario.</li> <li>otra de las actividades que seguro necesitar\u00e1s en tu empresa ser\u00e1 la gesti\u00f3n de recursos humanos, as\u00ed como la de controlar la mercadot\u00e9cnica de tus productos.</li> <li>adem\u00e1s, debes contar con un buen servicio t\u00e9cnico que realice las tareas de dise\u00f1o, implementaci\u00f3n y mantenimiento de la infraestructura inform\u00e1tica.</li> </ol> <p>Haz un peque\u00f1o organigrama y descripci\u00f3n de tu empresa.</p>"},{"location":"UD4/Actividades/#actividad-2","title":"Actividad 2","text":"<ol> <li>Configura los adaptadores de red de los equipos con un sistema operativo de Microsoft Windows con una direcci\u00f3n IP fija. Recuerda que se encuentran dentro de una Red Interna NAT que se cre\u00f3 en la UT02. Usa un rango de IPv4 privadas de tipo C. En los clientes configura las DNS para que apunten a la IP del servidor Windows Server.</li> <li> <p>Configura los adaptadores de red a trav\u00e9s de CLI de los equipos con un sistema operativo GNU/Linux con una direcci\u00f3n IP fija. Recuerda que estos equipos tambi\u00e9n est\u00e1n ubicados dentro de una Red Interna NAT. Usa un rango de IPv4 privadas del tipo B. En los clientes configura las DNS para que apunten a la IP del servidor Ubuntu Server. Redacta un documento con los pasos que sigues para realizar esta tarea.</p> </li> <li> <p>Cambia el nombre de los equipos seg\u00fan este listado:</p> <ul> <li>ServidorWindows para Microsoft Windows Server</li> <li>CW10XX para Microsoft Windows 10 Professional</li> </ul> <p>Las XX representan el n\u00famero de equipos que se van introduciendo en el directorio, siendo 01 el primero y aumentando de uno en uno.</p> </li> <li> <p>Cambia el nombre de los equipos seg\u00fan este listado:</p> <ul> <li>ServidorUbuntu para Ubuntu Server</li> <li>CU18XX para Ubuntu Desktop</li> </ul> <p>Las XX representan el n\u00famero de equipos que se van introduciendo en el directorio, siendo 01 el primero y aumentando de uno en uno.</p> </li> <li> <p>Instala los servicios de directorio en Microsoft Windows Server con los siguientes datos:</p> <ul> <li>nombre de dominio, el de tu empresa con la extensi\u00f3n .local, por ejemplo, miempresafea.local. Recuerda que no es buena pr\u00e1ctica utilizar esta extensi\u00f3n si es necesario usar los servicios de un ISP p\u00fablico.</li> <li>debe ser servidor principal de DNS, como ya se ha explicado.</li> <li>la contrase\u00f1a para la cuenta administrador del dominio debe ser P4ssw0rd##, en todos los servidores que conformen el directorio.</li> </ul> </li> <li> <p>Instala un servicio de directorio en Ubuntu Server a trav\u00e9s del CLI. Utiliza los mismos datos que en el caso anterior.</p> </li> </ol>"},{"location":"UD4/Actividades/#actividad-3-de-refuerzo","title":"Actividad 3. De refuerzo","text":"<ol> <li> <p>Configura la red del equipo UbuntuServer para que su IP sea fija y, ademas, sea la 10.0.0.1 Para ello deber\u00e1s seguir estos pasos:</p> </li> <li> <p>genera un fichero de configuraci\u00f3n con el comando:       <pre><code>sudo netplan generate\n</code></pre></p> </li> <li> <p>edita el fichero yaml que se acaba de generar</p> <pre><code>sudo nano /etc/netplan/01-netcfg.yaml\n</code></pre> </li> <li> <p>el contenido que debe tener el fichero ser\u00e1 el siguiente (presta atenci\u00f3n al nombre del NIC):</p> <pre><code>enp0s3:\ndhcp4: no\naddresses: [10.0.0.1, ]\ngateway4: 10.0.0.1\nnameservers:\naddresses: [8.8.8.8, 8.8.4.4]\n</code></pre> <p>\u00bfQu\u00e9 quiere decir esta configuraci\u00f3n?. Describe cada una de las l\u00edneas que compone esta configuraci\u00f3n.</p> </li> <li> <p>aplica el nuevo plan con el comando</p> </li> </ol> <pre><code>sudo netplan apply\n</code></pre> <p>Comprueba que todo ha funcionado bien y redacta un documento con el resultado del comando <code>ifconfig</code> para que muestre la configuraci\u00f3n de la red.</p> <ol> <li>En el manual del m\u00f3dulo encontrar\u00e1s una gu\u00eda que detalla paso a paso c\u00f3mo instalar y configurar un servicio de directorio en Ubuntu Server con Samba. Sigue la con detenimiento y crea un documento con los resultados que obtienes de la instalaci\u00f3n de cada servicio. Una vez terminada la instalaci\u00f3n de todos los servicios, realiza una captura al resultado del comando:</li> </ol> <pre><code>   samba-tool domain level show\n</code></pre>"},{"location":"UD4/Actividades/#actividad-3-de-ampliacion","title":"Actividad 3. De Ampliaci\u00f3n","text":"<ol> <li>Investiga el concepto de \u201cSitio\u201d en los servicios de directorio y planifica su creaci\u00f3n as\u00ed como la asignaci\u00f3n de una subred para cada sitio planificado. Elabora una peque\u00f1a gu\u00eda con los datos y las herramientas de las que disponen los SOR para crear estos objetos.</li> <li> <p>Es interesante que en dominio exista un segundo servidor por si el primero tuviese alg\u00fan problema. Este segundo controlador se mantendr\u00e1 en la sombra hasta que el primero tenga alg\u00fan problema, ser\u00e1 entonces cuando cobre protagonismo. Configura un servidor de backup en el dominio controlado con Windows Server siguiendo estos pasos:</p> </li> <li> <p>haz una clonaci\u00f3n enlazada del clon de la m\u00e1quina que contiene el sistema operativo de red de Microsoft.</p> </li> <li>configura la red de forma adecuada y c\u00e1mbiale el nombre a ServidorRespaldo.</li> <li>Instala las herramientas necesarias para que se convierta en controlador de dominio de igual modo que hiciste con el servidor principal.</li> <li> <p>promociona este equipo a servidor de respaldo.</p> </li> <li> <p>Repite los pasos del ejercicio anterior para crear un servidor de respaldo para ServidorUbuntu. Tendr\u00e1s que realizar todo este proceso a trav\u00e9s de CLI. Anota cada uno de los pasos que necesitas para hacer esta tarea en un documento.</p> </li> </ol> <p>Manera de entrega de las actividades</p> <p>Redacta una gu\u00eda de los pasos a seguir para realizar esta actividad y s\u00fabela al Moodle del m\u00f3dulo.   De tal forma que en cada uno de los pasos incluya una imagen que verifique que se ha realizado aquello que se pide en cada uno de los ejercicios. Como en las anteriores actividades</p> <p>Warning</p> <p>SOLO LAS ACTIVIDADES 1,2 SON OBLIGATORIAS.</p>"},{"location":"UD4/IP/","title":"Configuraci\u00f3n del protocolo TCP/IP","text":"<p>Antes de iniciar el proceso de instalaci\u00f3n de un servicio de directorio, es necesario realizar la configuraci\u00f3n adecuada del protocolo TCP/IP (Transmission Control Protocol/Internet Protocol). La funci\u00f3n del protocolo TCP es la de generar una conexi\u00f3n virtual entre dos elementos de la red, a trav\u00e9s de la cual fluye la informaci\u00f3n. Antes de iniciar la comunicaci\u00f3n, este protocolo, configura una \u201ccamino\u201d seguro entre el origen y el destino de la conexi\u00f3n. Tras esto, establece los par\u00e1metros de calidad m\u00ednima de la conexi\u00f3n y ofrece el resultado a las capas superiores. La configuraci\u00f3n de esta ruta virtual ocupa un tiempo de proceso, pero que tras \u00e9l, la comunicaci\u00f3n se realiza de forma segura y r\u00e1pida.</p> <p>El protocolo UDP (User Datagram Protocol), tambi\u00e9n situado en la capa de transporte, tiene un funcionamiento sensiblemente diferente. Al contrario que su compa\u00f1ero de capa, \u00e9ste no establece un \u201ccamino\u201d ni unas condiciones de calidad previas de conexi\u00f3n. Divide el archivo en datagramas y los env\u00eda a su destino sin establecer ninguna confirmaci\u00f3n de entrega. Evitar todas estas comprobaciones hace que este protocolo sea m\u00e1s r\u00e1pido que TCP, pero menos confiable. Los protocolos como DNS (Domain Name Server) y DHCP (Dynamic Host Configuration Protocol) utilizan este protocolo para enviar sus mensajes.</p> <p>Por otro lado, el protocolo IP (Internet Protocol), se encarga de transmitir datos de forma bidireccional a trav\u00e9s de distintas redes f\u00edsicas previamente enlazadas. Este protocolo se dise\u00f1\u00f3 suponiendo que la entrega de paquetes no ser\u00eda confiable, as\u00ed que se le dot\u00f3 de t\u00e9cnicas de encaminamiento para encontrar el destino final de paquete. Para ello establece una identificaci\u00f3n un\u00edvoca de cada componente de red pertenezca a esta comunicaci\u00f3n asignando direcciones IP distintas a cada host de la red. Existen diferentes versiones de este protocolo, siendo la m\u00e1s utilizada la IPv4 para entornos LAN.</p> <p>Subredes</p> <p>Las subredes son redes segmentadas por el administrador de la red para suministrar una estructura de enrutamiento jer\u00e1rquica. Permiten un mayor aprovechamiento de las redes, brinda contenci\u00f3n de difusi\u00f3n.</p> <p>Una direcci\u00f3n IPv4 esta compuesta por cuatro octetos separados por un punto y divididos en dos partes, una que identifica la red a la que pertenece el equipo, y otra que identifica el equipo en esa red. En funci\u00f3n de como se distribuyan estas dos partes tendremos diferentes tipos de direccionamiento IP, como se indica en la siguiente tabla.</p> <p></p> <p>Todos estos conceptos ya son conocidos y no se profundizar\u00e1n en ellos. Resulta evidente que son conocimientos necesarios para construir una infraestructura de red de forma adecuada y que el administrador ha de poseer las destrezas necesarias para controlar de forma adecuada esta terminolog\u00eda as\u00ed como su implantaci\u00f3n.</p> <p>Antes de realizar cualquier configuraci\u00f3n, es necesario realizar un an\u00e1lisis detallado de los requerimientos de la red y realizar una previsi\u00f3n del direccionamiento IP. Es fundamental una buena previsi\u00f3n para no tener que realizar costosas reconfiguraciones en el futuro.</p> <p></p> <p>De este modo, este an\u00e1lisis previo debe tener en cuenta aspectos como:</p> <ul> <li>dimensionar de forma holgada los equipos y dispositivos de conexi\u00f3n de la red, as\u00ed como si es necesario realizar subredes.</li> <li>reservar una serie de direcciones para los servidores y configurar \u00e9stos como IP fija. Los servidores deben estar localizables en todo momento, por lo que es imprescindible que sus direcciones sean fijas.</li> <li>elegir en consecuencia un tipo de IP v\u00e1lida A, B o C. En la mayor\u00eda de casos la elecci\u00f3n correcta para instaurar una red es el tipo B, ya que la C tiene serias limitaciones de expansi\u00f3n de hosts y las A en redes.</li> <li>reservar conjuntos de direcciones para dispositivos comunes. En efecto un buen m\u00e9todo de trabajo es asignar conjunto de direcciones para agrupar los equipos con caracter\u00edsticas similares. Por ejemplo, es buena pr\u00e1ctica limitar un conjunto de IP para los equipos de una determinada \u00e1rea o departamento o colocar todas las impresoras en un rango de IP reservado para ellas.</li> <li>holgar la reserva de direcciones IP, de este modo en caso de expandir la red, ser\u00e1 muy sencillo asignar direcciones a los nuevos dispositivos.</li> </ul> <p>Una vez dise\u00f1ada la arquitectura l\u00f3gica de la red es preciso configurar esa direcci\u00f3n en el servidor para que est\u00e9 accesible al resto de equipos. Esta configuraci\u00f3n se realizar\u00e1 a trav\u00e9s de Inicio \u2192 Configuraci\u00f3n \u2192 Red e Internet \u2192 Cambiar opciones del adaptador. Esta ventana mostrar\u00e1 los NIC (Network Interface Card) que el sistema tiene disponibles. Con un doble click sobre la NIC \u2192 Propiedades que se necesita configurar se acceder\u00e1 a su pantalla de configuraci\u00f3n de las funciones de red. Ser\u00e1 necesario entrar en la opci\u00f3n denominada Protocolo de Internet versi\u00f3n 4 (TCP/IPv4) y asignar una direcci\u00f3n v\u00e1lida a este equipo.</p> <p>Adem\u00e1s, en de asignar una IP, ser\u00e1 necesario especificar otra informaci\u00f3n como:</p> <ul> <li>la m\u00e1scara de subred, utilizada para crear subredes dentro de una misma red y para delimitar los dominios de colisi\u00f3n.</li> <li>puerta de enlace predeterminada, que indicar\u00e1 la direcci\u00f3n del dispositivo encargado de unir dos redes diferentes. Lo habitual es que esta direcci\u00f3n sea la del servidor que gobierne la red, pero eso depender\u00e1 de la arquitectura de red utilizada.</li> <li>direcciones del servidor DNS que usar\u00e1 cualquier dispositivo para obtener informaci\u00f3n sobre los dispositivos de la red, como se ver\u00e1 detalladamente con posterioridad. Es recomendable especificar una direcci\u00f3n de DNS preferido, al que se le preguntar\u00e1 en primera instancia y uno alternativo, al que se consulta si el primero falla.</li> </ul>"},{"location":"UD4/IP/#configuracion-de-red-alternativa-personalizada","title":"Configuraci\u00f3n de red alternativa personalizada","text":"<p>En algunas ocasiones los equipos se mueven entre varias redes dentro de la misma organizaci\u00f3n o incluso fuera de ella (por ejemplo equipos port\u00e1tiles). Resulta muy c\u00f3modo la configuraci\u00f3n de una red secundaria que el sistema probar\u00e1 si falla la configuraci\u00f3n inicial.</p> <p>Esta configuraci\u00f3n no ser\u00e1 necesaria si se dispone de un servicio DHCP funcionando en la red, ya que ser\u00e1 \u00e9ste el que asigne los datos necesarios para configurar el equipo, lo que suele ser habitual. No obstante es conveniente conocer que se dispone de esta configuraci\u00f3n alternativa de red.</p> <p>En el sistema operativo Ubuntu Server la configuraci\u00f3n de las IP de los NIC se realizar\u00e1 durante el proceso de instalaci\u00f3n o a posteriori. La diferencia es que no se dispondr\u00e1 de una GUI para realizarla, por lo que habr\u00e1 que recurrir al CLI.</p>"},{"location":"UD4/IP/#ficheros-de-configuracion-de-red-en-gnulinux","title":"Ficheros de configuraci\u00f3n de red en GNU/Linux","text":"<p>Desde la versi\u00f3n 17.04 de Ubuntu Server, la configuraci\u00f3n de las interfaces de red se realiza a trav\u00e9s de <code>netplan</code>. Este nuevo m\u00e9todo est\u00e1 basado en la configuraci\u00f3n de la red con ficheros YAML (YAML Aint\u2019s Markup Language) que <code>netplan</code> aplica a los NIC. Es un sistema en el que intervienen un menor n\u00famero de archivos de configuraci\u00f3n y ofrece una mayor compatibilidad con dispositivos virtuales. No obstante, y debido a que los dos sistemas han de coexistir durante un tiempo, es esta unidad se tratar\u00e1n los dos sistemas de forma pormenorizada.</p>"},{"location":"UD4/IP/#distribuciones-de-ubuntu-server-anteriores-a-1610-inclusive","title":"Distribuciones de Ubuntu Server anteriores a 16.10 (inclusive)","text":"<p>Los archivos necesarios para la configuraci\u00f3n de red de los NIC en GNU/Linux se encuentra en <code>/etc/network/interfaces</code>. Existen varias entradas por cada tarjeta de red. El contenido de este fichero es:</p> Contenido del fichero de Configuraci\u00f3n<pre><code># This file describes the network interfaces available on your system\n\n# and how to activate them. For more information, see intercfaces(5)\n\n# The loopback network interface\n\nauto lo\niface lo inet loopback\n\n# The primary network interface\n\nauto enp0s3\niface enp0s3 inet dhcp\n</code></pre> <p>El fichero muestra dos configuraciones de NIC. La primera es la de loopback, de ah\u00ed su nombre \u201clo\u201d. El dispositivo NIC principal es enp0s3 y como se aprecia en la \u00faltima l\u00ednea del archivo, est\u00e1 configurado de modo autom\u00e1tico. Espera encontrar alg\u00fan servicio de DHCP que le ofrezca una IP.</p> <p>Esta configuraci\u00f3n para un cliente es muy v\u00e1lida, pero para un servidor es muy recomendable que la IP sea fija.</p> <p>Cuando se realiza un cambio de configuraci\u00f3n en un NIC, ser\u00e1 necesario desactivar y activar el servicio que la gestiona para que los cambios surjan efecto. Es posible realizar esta tarea sin reiniciar el servidor a trav\u00e9s del comando ifconfig:</p> Activar servicio de red<pre><code>sudo ifconfig enp0s3 up\n</code></pre> <p>para activar (levantar) el NIC, o</p> Desctivar interfaz<pre><code>sudo ifconfig enp0s3 down\n</code></pre> <p>para descativar (bajar) la NIC.</p> <p>Antes de editar este archivo, es necesario comprobar cual es la configuraci\u00f3n actual de la red. Se utiliza el comando <code>ifconfig</code> o <code>ip</code> en un terminal y devuelve la siguiente informaci\u00f3n:</p> salida del comando ip a<pre><code>enp0s3 Link encap:Ethernet direcci\u00f3nHW 08:00:27:40:65:bd\n Direc. inet:10.0.2.15 Difus.:10.0.2.255 M\u00e1sc:255.255.255.0\nDirecci\u00f3n inet6: fe80::a00:27ff:fe40:65bd/64 Alcance:Enlace\nACTIVO DIFUSI\u00d3N FUNCIONANDO MULTICAST MTU:1500 M\u00e9trica:1\nPaquetes RX:0 errores:0 perdidos:0 overruns:0 frame:0\nPaquetes TX:22 errores:0 perdidos:0 overruns:0 carrier:0\ncolisiones:0 long.colaTX:1000\nBytes RX:0 (0.0 B) TX bytes:2792 (2.7 KB)\n\nlo Link encap:Bucle local\n Direc. inet:127.0.0.1 M\u00e1sc:255.0.0.0\nDirecci\u00f3n inet6: ::1/128 Alcance:Anfitri\u00f3n\nACTIVO BUCLE FUNCIONANDO MTU:65536 M\u00e9trica:1\nPaquetes RX:20 errores:0 perdidos:0 overruns:0 frame:0\nPaquetes TX:20 errores:0 perdidos:0 overruns:0 carrier:0\ncolisiones:0 long.colaTX:1\nBytes RX:1792 (1.7 KB) TX bytes:1792 (1.7 KB)\n</code></pre> <p>La informaci\u00f3n que hay que tener en cuenta se encuentra en las dos primeras l\u00edneas de del NIC enp0s3:</p> <ul> <li>direcci\u00f3nHW, hace referencia a la direcci\u00f3n de red f\u00edsica de la NIC.</li> <li>Direc. inet, hace referencia a la IP actual del servidor, en este caso la que le ha facilitado el servidor DHCP</li> <li>Difus, muestra la direcci\u00f3n de broadcast de la red</li> <li>M\u00e1sc, indica la m\u00e1scara de subred</li> </ul> <p>Direcciones</p> <p>Es necesario recordar que en todo rango de direcciones de IP hay dos direcciones que no pueden ser asignadas a ning\u00fan dispositivo; la primera y la \u00faltima del rango. La primera se usa como identificador de la red y la \u00faltima como direcci\u00f3n de difusi\u00f3n, es decir, un paquete enviado a esta IP ser\u00e1 transmitido al resto de equipos pertenecientes a su red (o subred).</p> <p>Salvo la direcci\u00f3n f\u00edsica, ser\u00e1 necesario incluir el resto de informaci\u00f3n de forma manual si este equipo tiene que tener una IP fija. Estos datos ser\u00e1n introducidos en fichero <code>/etc/network/interfaces</code> por lo que se abrir\u00e1 con permisos de superusuario:</p> Edici\u00f3n del archivo<pre><code>sudo vim /etc/network/interfaces\n</code></pre> <p>Se editar\u00e1 el archivo de la siguiente manera:</p> Fichero editado<pre><code># This file describes the network interfaces available on your system\n\n# and how to activate them. For more information, see intercfaces(5)\n\n# The loopback network interface\n\nauto lo\niface lo inet loopback\n\n# The primary network interface\n\nauto enp0s3\niface enp0s3 inet static\naddress 192.168.1.50\ngateway 192.168.1.1\nnetmask 255.255.255.0\nnetwork 192.168.1.0\nbroadcast 192.168.1.255\n</code></pre> <p>A tener en cuenta:</p> <ul> <li>se ha configurado la NIC enp0s3 como static en lugar de dhcp. Ya no aceptar\u00e1 una configuraci\u00f3n de red que no sea la que figura en las siguientes l\u00edneas.</li> <li>hay que especificar la address (direcci\u00f3n IP del equipo), gateway (puerta de enlace predeterminada) y la netmask (m\u00e1scara de subred).</li> <li>de forma opcional, se identifica a IP de red y la de broadcast.</li> </ul> <p>Una vez guardado el fichero de configuraci\u00f3n, ser\u00e1 necesario reiniciar el servicio de red para que reconozca la nueva configuraci\u00f3n:</p> reinicio del servico<pre><code>sudo systemctl restart NetworkManager.service\n</code></pre> <p>A este archivo se pueden a\u00f1adir las configuraciones de las NIC que sean necesarias para el correcto funcionamiento del servidor. Si se prefiere, en lugar de reiniciar el servicio es posible reiniciar el sistema con el comando reboot o shutdown. Siempre es preferible el reinicio del servicio afectado por la configuraci\u00f3n y no la totalidad del sistema. Reiniciar un servidor puede suponer problemas en la administraci\u00f3n de la red.</p>"},{"location":"UD4/IP/#distribuciones-de-ubuntu-server-1710-y-posteriores","title":"Distribuciones de Ubuntu Server 17.10 y posteriores","text":"<p>Para configurar una NIC con <code>netplan</code>, es necesario dirigirse a la carpeta <code>/etc/netplan</code> en donde se encontrar\u00e1n los ficheros de configuraci\u00f3n de red. Estos fichero est\u00e1n basados en el formato YAML que posee su propia sintaxis de lenguaje de marcas.</p> <p>El primer paso es generar un fichero de texto con extensi\u00f3n yaml y situado en la carpeta <code>/etc/netplan</code>. Es posible que el sistema operativo ya disponga de uno si durante la instalaci\u00f3n ha encontrado una NIC. En tal caso, es preferible usar ese fichero</p> crear un fichero de configuraci\u00f3n<pre><code>sudo vi /etc/netplan/01-netcfg.yaml\n</code></pre> <p>Ahora toca editar este fichero y dotarle de la informaci\u00f3n de red necesaria.</p> Con esta informaci\u00f3n<pre><code>network:\n    version: 2 # versi\u00f3n del documento\n        ethernets: # tipo de red a configurar\n            enp0s3: # dispositivo a configurar\n            dhcp4: no # servicio dhcp desactivado\n            addresses: [192.168.100.100/24] # direcci\u00f3n de red\n            gateway4: 192.168.100.100 # puerta de enlace\n            nameservers: # servicios de DNS\n                addresses: [192.168.100.100] # principal\n                search: [8.8.8.8] # de b\u00fasqueda o secundario\n            optional: true\n</code></pre> <p>La informaci\u00f3n que se desprende de la lectura de este archivo resulta evidente a poco que se conozca un m\u00ednimo de teor\u00eda de redes. Con las etiquetas networks, ethernets y enp0s3 se est\u00e1 acotando el NIC que se configurar\u00e1. Las siguientes etiquetas hace referencia a la configuraci\u00f3n de red de ese dispositivo. Todo bastante intuitivo.</p> <p>Es posible configurar diferentes redes y dispositivos de red a trav\u00e9s de uno de estos ficheros yaml, tan s\u00f3lo hay que estructurar la informaci\u00f3n en etiquetas del mismo modo que en el ejemplo expuesto. Una vez que el fichero est\u00e9 debidamente configurado, se deber\u00e1 aplicar esta configuraci\u00f3n con el comando.</p> Aplicar los cambios<pre><code>sudo netplay apply\n</code></pre> <p>Si se consulta la configuraci\u00f3n de red, <code>netplan</code> habr\u00e1 configurado de forma correcta la interfaz (o interfaces) configuradas en el fichero yaml. Recuerda que siempre en buena idea consultar la ayuda de un comando.</p>"},{"location":"UD4/IP/#resolucion-de-problemas-de-conectividad-en-sistemas-operativos-en-red","title":"Resoluci\u00f3n de problemas de conectividad en sistemas operativos en red","text":"<p>Los problemas que un ordenador pueda tener en su hardware o software quedan adscritos a sus componentes o a la configuraci\u00f3n del sistema operativo. Un problema de red puede saltar estar fronteras y a\u00f1ade una nueva dimensi\u00f3n al problema: la propia red y sus componentes. Es vital dise\u00f1ar una buena estrategia de acci\u00f3n para que el t\u00e9cnico encargado de diagnosticar el problema no emplee demasiado tiempo y esfuerzo en el diagn\u00f3stico. Existe una metodolog\u00eda en seis fases que se ha demostrado \u00fatil:</p> <ul> <li>identificar el problema, tarea que puede ser complicada pero que se puede intuir con ayuda del historial de eventos del sistema operativo, o una breve entrevista con el usuario del ordenador utilizando preguntas abiertas o cerradas que ayuden a identificar el problema.</li> <li>establecer una teor\u00eda de causas probables.</li> <li>poner a prueba la teor\u00eda para determinar la causa. Si no es posible demostrar la teor\u00eda, se reformular\u00e1 hasta dar con la causa.</li> <li>establecer un plan de acci\u00f3n, tras la confirmaci\u00f3n del problema, se hace necesario un listado de tareas para solucionar el problema e implementar una soluci\u00f3n.</li> <li>verificar la funcionalidad del sistema e implementaci\u00f3n de medidas preventivas, es recomendable que no vuelva a ocurrir.</li> <li>documentar el problema, las soluciones planteadas y los resultados.</li> </ul> <p>A continuaci\u00f3n se muestran los problemas de red m\u00e1s comunes y algunas soluciones a implementar:</p> <p>Las luces de la NIC no est\u00e1n encendidas.</p> Causas probables Soluciones posibles El cable de red est\u00e1 desconectado o est\u00e1 da\u00f1ado. Reemplazar el terminal RJ-45 o cambiar el cable. La NIC est\u00e1 da\u00f1ada. Reemplazar la NIC <p>Los ordenadores port\u00e1tiles no pueden detectar la red inal\u00e1mbrica.</p> Causas probables Soluciones posibles El router o el punto de acceso inal\u00e1mbrico se configur\u00f3 con un protocolo distinto. Reconfigurar el protocolo de comunicaci\u00f3n del router. No se transmite el SSID. Configurar el router inal\u00e1mbrico para que transmita la SSID. La NIC inal\u00e1mbrica est\u00e1 deshabilitada. Habilitar la NIC inal\u00e1mbrica del ordenador. <p>El ordenador tiene una direcci\u00f3n IP 169.254.X.X.</p> Causas probables Soluciones posibles El cable de red est\u00e1 desconectado. Conectar el cable de red. El router est\u00e1 apagado o la conexi\u00f3n es defectuosa. Comprobar la conexi\u00f3n del router y el servicio DHCP. La NIC est\u00e1 da\u00f1ada. Reemplazar la NIC. <p>Un dispositivo remoto no responde a una solicitud de ping.</p> Causas probables Soluciones posibles El firewall de Microsoft Windows est\u00e1 configurado para deshabilitar el ping de manera predeterminada. Configurar el firewall para que acepte el comando ping. El dispositivo remoto est\u00e1 configurado para no responder a solicitudes de ping. Configurar el dispositivo remoto para que acepte solicitudes de ping. <p>Un usuario puede acceder a la red local, pero no puede acceder a Internet.</p> Causas probables Soluciones posibles La direcci\u00f3n de la puerta de enlace no es correcta. Establecer una direcci\u00f3n de puerta de enlace correcta. El proveedor de Internet est\u00e1 teniendo problemas. Ponerse en contacto con el proveedor. <p>Un equipo conectado a una red no es capaz de ver los recursos compartidos.</p> Causas probables Soluciones posibles El nombre del grupo de trabajo no es correcto. Cambiar el nombre del grupo de trabajo. La ubicaci\u00f3n de red es incorrecta. Cambiar la ubicaci\u00f3n de red por la adecuada. La detecci\u00f3n de redes y el uso compartido de archivos est\u00e1n desactivados (s\u00f3lo Microsoft Windows). Activar la detecci\u00f3n de redes y el uso compartido de archivos (s\u00f3lo Microsoft Windows). <p>Esta es una peque\u00f1a muestra de los problemas y las posibles soluciones espec\u00edficas de red. El espectro de posibles problemas y soluciones es mucho m\u00e1s amplio.</p>"},{"location":"UD4/IP/#como-vamos-a-trabajar","title":"\u00bfC\u00f3mo vamos a trabajar?","text":"<p>Voy a explicar el modo m\u00e1s dif\u00edcil que es en Linux. Vamos a disponer de la siguiente configuraci\u00f3n.</p> <p></p> <p>Si observamos, tenemos dos interfaces de red en la m\u00e1quina virtual de Ubuntu server. La primera interfaz adaptador puente (en el primer tema est\u00e1 explicado) la utilizaremos para configurar y manipular el Servidor ubuntu mediante ssh. La segunda interfaz, vamos a utilizar una red Nat que nos crea una red privada con salida a Internet.</p> <p>Vamos a configurar el servidor Ubuntu la red NAT . Previamente debe estar creada y configurada en Virtual Box.</p> <p>.</p> <p>Como vemos en la siguiente imagen he creado una red nat llamada NATlinux. Con un rango de IPS , en el que se ha deshabilitado el DHCP. Que supone esta configuraci\u00f3n que en el interfaz de red que se crea en la maquina virtual asociado a esta configuraci\u00f3n, pues que no se le puede asignar una IP fuera de ese rango y tampoco se asigna una IP de forma autom\u00e1tica.</p> configuraci\u00f3n de los ficheros de red<pre><code>ad@ServidorUbuntu:/etc/netplan$ sudo cat 01-netcfg.yaml\n[sudo] password for ad:\n     network:\n       version: 2\n       ethernets:\n         enp0s3: # Interfaz para realizar una red con el cliente y crear poder salir a internet\n           dhcp4: false\n           addresses:\n             - 10.0.3.3/24 # Direcci\u00f3n que se le pone al host\n           routes:\n             - to: default #Esto cambia con la anterior configuraci\u00f3n\n               via: 10.0.3.1\n           nameservers:\n             search: [ ejemplo.local ]\n             addresses:\n               - 8.8.8.8\n               - 8.8.4.4\n         enp0s8: #Interfaz para comunicarnos con el ordenador anfitri\u00f3n mediante ssh y facilitarnos su configuraci\u00f3n\n           dhcp4: true (el router asignar\u00e1 una ip, es decir como si estuviera en la red)\n</code></pre> <p>Puede ser que dentro de <code>/etc/netplan/</code> haya varios fichero. Estos vienen marcados con un n\u00famero en su nombre que va a dar la prioridad. Como configuramos el cliente que se va a conectar con ubuntu server.</p> configuraci\u00f3n de los ficheros de red del cliente Ubuntu<pre><code>sudo cat /etc/netplan/01-network-manager-all.yaml\n\n# Let NetworkManager manage all devices on this system\nnetwork:\n  version: 2\n  renderer: NetworkManager\n  ethernets:\n    enp0s3:\n        dhcp4: no (# No tenemos DHCP, si no fuera true y lo de bajo no valdr\u00eda)\n        addresses:\n          - 10.0.3.5/24\n        routes:\n            - to: default\n              via: 10.0.3.1\n        nameservers:\n          search: [example.local]\n          addresses:\n            - 10.0.3.3\n</code></pre>"},{"location":"UD4/instaServDirectorio/","title":"Instalaci\u00f3n de servicio de directorio","text":"<p>Una vez realizadas las configuraciones previas y antes de comenzar con el proceso de instalaci\u00f3n, es necesario aclarar una serie de conceptos que se usar\u00e1n en lo sucesivo. Se trata de servicios necesarios para el correcto funcionamiento del directorio:</p> <ul> <li> <p>Kerberos, es un protocolo de seguridad creado por el MIT (Massachusetts Institute of Technology) que usa cifrado de claves sim\u00e9tricas para validar usuarios de red. Esta validaci\u00f3n frustra los intentos de acceso a la red de usuarios no autorizados.   Usa tickets para la validaci\u00f3n de usuarios. Estos tickets los facilita el centro de distribuci\u00f3n de claves o KDC (Key Distribution Center). Una vez que el usuario se ha autenticado,el KDC le env\u00eda un ticket espec\u00edfico para esa sesi\u00f3n a la m\u00e1quina del usuario. De esta manera cualquier servicio buscar\u00e1 el ticket en la m\u00e1quina en lugar de preguntarle al usuario que se autentique usando una contrase\u00f1a.   Kerberos tiene su propia terminolog\u00eda para definir varios aspectos del servicio:</p> </li> <li> <p>real, red que usa Kerberos compuesto de uno o varios KDC.</p> </li> <li>principal, es el nombre \u00fanico de un usuario o servicio que puede autenticar mediante el uso de Kerberos.</li> <li> <p>ticket, son datos cifrados que el servidor facilita a los clientes para su autenticaci\u00f3n y que son almacenados durante la sesi\u00f3n. Existen diferentes tipos:</p> <ul> <li>TGT (Ticket Granting Ticket), usado para la autenticaci\u00f3n de un usuario en la red y que se solicita al iniciar la sesi\u00f3n. Habitualmente los TGT tienen una validez de 10 horas.</li> <li>TGS (Ticket Granting Service): solicitado por un usuario para autenticarse frente a un servicio de red.</li> </ul> </li> <li> <p>SAMBA, es una implementaci\u00f3n de c\u00f3digo abierto de los protocolos de ficheros compartidos SMB/CIFS para sistemas de tipo Unix. Permite la interoperatividad entre servidores GNU/Linux y clientes basados en Microsoft Windows. Tambi\u00e9n proporciona servicios de archivos e impresi\u00f3n y puede integrarse en Active Directory, ya sea como controlador de dominio principal o como miembro del dominio. Ser\u00e1 esta la caracter\u00edstica que se explotar\u00e1 en este manual.</p> </li> <li> <p>SMB/CIFS, Server Message Block y Common Internet File System son protocolos de red desarrollados para compartir archivos e impresoras entre nodos de una red. El protocolo SMB fue desarrollado originalmente por IBM y posteriormente ampliado renombrado a CIFS por Microsoft. Sin embargo, desde una perspectiva funcional, ambos son protocolos muy similares y utilizados por SAMBA.</p> </li> <li>NTP (Network Time Protocol), es un protocolo de Internet usado para sincronizar los relojes del sistema del ordenador a una fuente de tiempo de referencia.   </li> </ul> <p>Al margen de esta nueva terminolog\u00eda, se utilizar\u00e1 otra como LDAP, DNS o DHCP que ya resulta familiar. Todos estos servicios se han de instalar y configurar durante el proceso de instalaci\u00f3n del directorio. Existen varias formas de realizar esta tarea:</p> <ul> <li>asistida, en donde un asistente guiar\u00e1 el proceso de instalaci\u00f3n y tan solo detendr\u00e1 el proceso cuando requiera informaci\u00f3n necesaria para continuar con ella.</li> <li>manual, en la que se deber\u00e1 instalar cada uno de los servicios por separado y configurarlos para que funcionen en conjunto.</li> </ul> <p>En este manual se tratar\u00e1 de forma pormenorizada ambas formas. Antes de iniciar cualquiera de ellas, hay que realizar varias comprobaciones:</p> <ul> <li>que el nombre del equipo sea el adecuado, cambiarlo una vez instalado el servicio de directorio puede ser una tarea complicada para algunos servicios.</li> <li>que la tarjeta de red que apunta a la red interna (si el servidor dispone de varias), disponga de una IP fija.</li> <li>que el usuario del administrador tenga una contrase\u00f1a v\u00e1lida.</li> <li>que el sistema operativo est\u00e9 actualizado con los paquetes de seguridad m\u00e1s recientes instalados.</li> </ul> <p>Si todo esto es correcto, se proceder\u00e1 con la instalaci\u00f3n de los servicios de directorio. Recuerda que esta instalaci\u00f3n se realiza sobre un SOR previamente instalado en un equipo.</p>"},{"location":"UD4/instaServDirectorio/#instalacion-de-servicios-de-directorio-en-microsoft-windows-server","title":"Instalaci\u00f3n de servicios de directorio en Microsoft Windows Server","text":"<p>Se trata de una instalaci\u00f3n casi desatendida. El proceso de instalaci\u00f3n se inicia a trav\u00e9s de un asistente el cual gu\u00eda al usuario durante el proceso de instalaci\u00f3n. Durante el proceso, este asistente instalar\u00e1 todos los servicios necesarios y los configurar\u00e1 en funci\u00f3n de los datos que el usuario facilite durante la ejecuci\u00f3n del asistente. Este proceso se realizar\u00e1 en dos fases:</p> <ul> <li>la primera, dotar de las herramientas necesarias al servidor para actuar como controlador de dominio.</li> <li>la segunda, promocionarlo a una funci\u00f3n espec\u00edfica dentro del dominio. En esta ocasi\u00f3n a controlador principal ya que no existe otro controlador en la red.</li> </ul> <p>En versiones anteriores de Microsoft Windows Server, la instalaci\u00f3n de los servicios de directorios se realizaba a trav\u00e9s del comando <code>dcpromo</code>. Desde hace algunas versiones, esta caracter\u00edstica es tratada como un rol del sistema. Los roles y las caracter\u00edsticas son funcionalidades de las que se va a dotar al servidor, como por ejemplo que sea un servidor de archivos, de impresi\u00f3n, que controle las DNS o que asigne IP de manera autom\u00e1tica. Cada una de estas caracter\u00edsticas se instalan y configuran de forma pormenorizada.</p> <p>Desde Inicio \u2192 Administrador del servidor se accede a la configuraci\u00f3n del servidor as\u00ed como a la configuraci\u00f3n del todo el Dominio. Desde aqu\u00ed se iniciar\u00e1 el proceso de instalaci\u00f3n de los servicios de directorio. Tambi\u00e9n desde aqu\u00ed es posible comprobar el nombre del ordenador y la IP del mismo a trav\u00e9s de las opciones Servidor local \u2192 Nombre de equipo y Servidor local \u2192 Ethernet.</p> <p>Una vez correctamente configurado se accede a Panel \u2192 Agregar roles y caracter\u00edsticas. Se selecciona una instalaci\u00f3n basada en roles y caracter\u00edsticas. Tras esto, se selecciona el servidor al cual se debe dotar de las herramientas necesarias y se asigna el rol de Servicios de dominio de Active Directory de entre todos los disponibles. Al seleccionar esta opci\u00f3n el sistema informa que es necesario agregar una serie de dependencias (caracter\u00edsticas requeridas) para que el sistema funcione de forma correcta. Se aceptar\u00e1n estas caracter\u00edsticas requeridas.</p> <p>Tras la instalaci\u00f3n de los roles necesarios, se mostrar\u00e1 una pantalla para seleccionar las caracter\u00edsticas adicionales que el servidor debe disponer. En este momento de la instalaci\u00f3n no ser\u00e1 necesario especificar ninguna de ellas.</p> <p>Con posterioridad se instalar\u00e1n una a una las necesarias. Cuando termine el asistente de configuraci\u00f3n, se procede a la instalaci\u00f3n desde el bot\u00f3n Instalar.</p> <p>Una vez finalizado el proceso, el servidor ya posee las herramientas para convertirse en un controlador de domino, pero todav\u00eda no lo es. Para ello se debe especificar qu\u00e9 funci\u00f3n realizar\u00e1 este equipo en el directorio, a trav\u00e9s del bot\u00f3n Promover este servidor a controlador de dominio. Se trata del primer controlador de la red, por lo que es necesario agregar un nuevo bosque y para ello especificar el nombre del dominio ra\u00edz. En el caso del ejemplo se usar\u00e1 el nombre miempresafea.local, pero recuerda utilizar el nombre de la empresa que has dise\u00f1ado.</p> <p>Lo siguiente que es necesario especificar es el nivel funcional tanto del bosque como del dominio. Este nivel nos marca el conjunto de caracter\u00edsticas de las que el dominio va a disponer. Si se dispone controladores con varios tipos de sistemas operativos en ella, es preciso que se encuadre un mismo nivel de funciones entre ellos. De este modo, si contamos con un controlador instalado en Microsoft Windows Server 2008, el nivel funcional del directorio es conveniente que se reduzca a este sistema operativo de red. En el caso que se describe en este manual, se instalar\u00e1 un segundo controlador de dominio basado en Microsoft Windows Server 2016, por lo tanto ser\u00e1 \u00e9ste el nivel funcional del bosque como del dominio.</p> <p>Este equipo tambi\u00e9n actuar\u00e1 como servicio de DNS y contendr\u00e1 el cat\u00e1logo global. Tambi\u00e9n es necesario especificar una contrase\u00f1a para el modo de restauraci\u00f3n de los servicios de directorio. Se utilizar\u00e1 \u201cRestaura#2019\u201d.</p> <p>La instalaci\u00f3n del servicio de nombres es necesario realizarla en este servidor al tratarse del primero en el bosque. Como todav\u00eda no existe este servicio, es imposible que se pueda delegar a otro servidor.</p> <p>En la pantalla de opciones adicionales el propio sistema recomienda un nombre NetBIOS que dejaremos intacto. En lo referente a las rutas de acceso, se recomienda usar las sugeridas por el sistema. En esta rutas de guardar\u00e1n los scripts de inicio de los clientes, las configuraciones de pol\u00edticas de grupo y seguridad as\u00ed como la base de datos del cat\u00e1logo global.</p> <p>Tras mostrar un resumen de la configuraci\u00f3n, el asistente realiza una comprobaci\u00f3n de los requisitos del sistema para poder promocionar el servicio. Si se ha elegido un nivel funcional diferente a Microsoft Windows Server 2016, es posible que aparezcan varias alertas que ser\u00e1n solucionadas con posterioridad. Una vez m\u00e1s, pulsando en el bot\u00f3n Instalar dotar\u00e1 a este equipo las caracter\u00edsticas necesarias para convertirse en controlador de domino principal.</p> <p>Al finalizar el proceso de instalaci\u00f3n y tras el reinicio, en el panel de administraci\u00f3n del servidor se puede apreciar como existen tres nuevos roles para este servidor, como el rol de dominio de Active Directory, el rol de DNS y el de servicios de archivos y de almacenamiento. \u00c9ste \u00faltimo hace referencia a la creaci\u00f3n y administraci\u00f3n de los recursos compartidos del sistema, que ser\u00e1 tratado con posterioridad.</p>"},{"location":"UD4/instaServDirectorio/#instalacion-de-servicios-de-directorio-en-ubuntu-server","title":"Instalaci\u00f3n de servicios de directorio en Ubuntu Server","text":"<p>El proceso de instalaci\u00f3n en sistemas basados en GNU/Linux es mucho m\u00e1s descriptivo e interesante. Los servicios se han de instalar uno a uno y conectarse entre s\u00ed. Esta instalaci\u00f3n ofrece una nueva visi\u00f3n del proceso mucho m\u00e1s cercana y con menos capas de abstracci\u00f3n, lo que se traduce en un aumento de las complicaciones para el administrador. A pesar de ello, este sistema permite un mayor control sobre los componentes y una visi\u00f3n m\u00e1s clara de como funciona el servicio de directorio al completo.</p> <p>Antes de iniciar la instalaci\u00f3n de Samba y convertir el equipo en un controlador de dominio, es recomendable actualizar los repositorios de apt-get y revisar las actualizaciones del sistema operativo. As\u00ed se asegurar\u00e1 que se utiliza la \u00faltima versi\u00f3n del software.</p> Actualizaci\u00f3n de la base de datos y de los paquetes<pre><code>sudo apt-get update\nsudo apt-get upgrade\n</code></pre> <p>La primera comprobaci\u00f3n que hay que realizar el que el nombre del equipo sea el correcto. Para ello comprobamos el fichero <code>/etc/hostname</code>, en el caso de este ejemplo el nombre del equipo es ServidorUbuntu. Si es necesario cambiar el nombre, es posible modificando el nombre en este fichero. Los cambios aparecer\u00e1n tras el reinicio de la sesi\u00f3n. Tambi\u00e9n podemos cambiar el nombre del servidor mediante el comando:</p> <p><code>sudo hostnamectl set-hostname ServidorUbuntu</code></p> <p>Otro fichero que se ha de configurar es el <code>/etc/hosts</code>, que nos permite relacionar la IP y el nombre del equipo. Se establecer\u00e1 la correspondencia entre la IP del servidor, el nombre de equipo y el FQDN (Fully Qualified Domain Name) de este modo: ServidorUbuntu.miempresafea.local.</p> <p>Recuerda hacer una copia del fichero antes de su modificaci\u00f3n:</p> Copia de seguridad<pre><code>cp /etc/hosts /etc/hosts.copia\n</code></pre> <p>El fichero debe quedar de este modo:</p> Fichero de configuraci\u00f3n<pre><code>127.0.0.1 localhost\nX.X.X.X (**Nota: tendr\u00e9is que cambiarlo, ya que esta es mi IP**) ServidorUbuntu.miempresafea.local ServidorUbuntu\n# The following lines are desirable for IPv6 capable hosts\n\n::1 localhost ip6-localhost ip6-loopback\nff02::1 ip6-allnodes\nff02::2 ip6-allrouters\n</code></pre> <p>Vamos a comprobar el nombre del dominio completo(FQDN) del servidor con el siguiente comando</p> <p><code>hostname -f</code></p> <p>Ahora vamos a verificar que resuelve la direcci\u00f3n IP</p> <p><code>ping -c2 ServidorUbuntu.miempresafea.local</code></p> <p>Tambi\u00e9n es necesario asegurarse de que las consultas DNS usen el DC. En lugar de desactivar <code>systemd-resolved</code> y fijar un <code>resolv.conf</code> inmutable, vamos a mantenerlo activo y decirle qu\u00e9 DNS usar. Asegura primero que la IP del servidor es fija y que eliges la interfaz correcta (la que est\u00e1 en la red del cliente); en las pr\u00e1cticas suele ser <code>enp0s3</code> o similar, conf\u00edrmala con <code>ip -br link</code>.</p> Configurar DNS con systemd-resolved<pre><code># Sustituye enp0s3 por tu interfaz y X.X.X.X por la IP fija del DC (o la propia si el DNS corre local)\nsudo resolvectl dns enp0s3 X.X.X.X\nsudo resolvectl domain enp0s3 ~MIEMPRESAFEA.LOCAL\nresolvectl status   # verifica que solo aparece la IP del DC y el dominio correcto\n</code></pre> <p>Con esto, <code>/etc/resolv.conf</code> seguir\u00e1 apuntando al stub 127.0.0.53 pero <code>systemd-resolved</code> dirigir\u00e1 las consultas del dominio al DC. Si necesitas usar otra interfaz, repite los comandos ajustando el nombre de la interfaz: es cr\u00edtico no equivocarse para que los clientes alcancen al servicio.</p>"},{"location":"UD4/instaServDirectorio/#instalacion-de-samba","title":"Instalaci\u00f3n de SAMBA","text":"<p>Ya est\u00e1 todo listo para instalar Samba en el servidor. Para variar, la instalaci\u00f3n se realiza a trav\u00e9s del siguiente comando:</p> Instalaci\u00f3n SAMBA<pre><code>sudo apt install samba krb5-config winbind smbclient acl attr libpam-winbind libnss-winbind libpam-krb5 krb5-user dnsutils net-tools\n</code></pre> <p>Con este comando se est\u00e1n instalando varios paquetes:</p> <ul> <li>samba, que contiene todas las herramientas para la creaci\u00f3n de un servicio de directorio en este equipo.</li> <li>smbclient, que permitir\u00e1 gestionar los clientes que pertenezcan a este servicio</li> <li>winbind, conjunto de herramientas que permitir\u00e1n a los sistemas operativos basados en Microsoft Windows acceder a este servicio.</li> <li>krb5-config, que instalar\u00e1 el servicio Kerberos para la autentificaci\u00f3n de los usuarios</li> </ul> <p>El \u00fanico que requiere atenci\u00f3n en esta parte de la instalaci\u00f3n es el de Kerberos, el cual realizar\u00e1 varias preguntas:</p> <ul> <li>el reino en el que se van a ofrecer los tickets de autentificaci\u00f3n, en el ejemplo ser\u00e1 MIEMPRESAFEA.LOCAL</li> <li>el host que contendr\u00e1 el servidor de Kerberos, en este caso es el mismo que contiene el dominio, que ser\u00e1 ServidorUbuntu.miempresafea.local</li> <li>y por \u00faltimo, el host que contendr\u00e1 el servidor Kerberos con fines administrativos, que ser\u00e1 el mismo que en el caso anterior: ServidorUbuntu.miempresafea.local</li> </ul> <p>Antes de pasar a configurar samba, es conveniente hacer una copia del fichero de configuraci\u00f3n original, por si hubiera que retomar la instalaci\u00f3n desde este punto:</p> Copia de seguridad de los archivos de seguridad<pre><code>sudo mv /etc/samba/cmb.conf /etc/samba/smb.conf.copia\n</code></pre> <p>A continuaci\u00f3n es necesario detener varios servicios instalados con anterioridad y que ahora ser\u00e1n gestionados a trav\u00e9s de Samba. Se paran y se deshabilitan (dejamos <code>systemd-resolved</code> activo porque acabamos de configurarlo como resolver).</p> deshabilitan servicios no necesarios<pre><code>sudo systemctl stop smbd nmbd winbind\nsudo systemctl disable smbd nmbd winbind\n</code></pre> <p>Ahora desenmascaramos el servicio que se encargar\u00e1 de las tareas de los que se acaban de desactivar</p> Desbloquear el servicio<pre><code>sudo systemctl unmask samba-ad-dc\nsudo systemctl enable samba-ad-dc\n</code></pre> <p>Ahora s\u00ed, lanzamos el la configuraci\u00f3n del servicio:</p> Configuraci\u00f3n de Samba<pre><code>sudo samba-tool domain provision\n</code></pre> <p>Al lanzar el asistente confirma que el dominio se crea sobre la interfaz correcta (la que ve a los clientes, p.ej. <code>enp0s3</code>). Si necesitas fijarla, puedes a\u00f1adir opciones como <code>--option=\"interfaces=lo enp0s3\"</code> y <code>--option=\"bind interfaces only = yes\"</code> para evitar que el servicio quede escuchando en una interfaz equivocada.</p> <p>Una vez lanzado el asistente, ir\u00e1 preguntando los datos necesarios para la configuraci\u00f3n. Muchos de ellos ya han sido configurados con anterioridad y los mostrar\u00e1 entre corchetes. Si estos valores son correctos, no ser\u00e1 necesaria su modificaci\u00f3n:</p> <ul> <li>Realm \u2192 MIEMPRESAFEA.LOCAL</li> <li>Domain \u2192 MIEMPRESAFEA</li> <li>Server Role \u2192 dc</li> <li>DNSbackend \u2192 SAMBA_INTERNAL</li> <li>DNSforwarder IP address \u2192 8.8.8.8 (este dato s\u00ed hay que cambiarlo ya que de este modo podremos salir a otras redes. Para ello usamos el servicio DNS de Google).</li> <li>Administrator password \u2192 P4ssw0rd (durante el proceso de creaci\u00f3n del directorio se crea al administrador que recibe el nombre de administrator, en ingl\u00e9s.)</li> </ul> <p>La opci\u00f3n elegida en la l\u00ednea DNS backend, es la SAMBA_INTERNAL. Esto quiere decir que ser\u00e1 el propio Samba el que gestionar\u00e1 el servicio de resoluci\u00f3n de nombres. Esta es la opci\u00f3n m\u00e1s f\u00e1cil de implementar, aunque es posible instalar otro servicio de DNS como Bind 9. En esta configuraci\u00f3n se dejar\u00e1 la opci\u00f3n por defecto.</p> <p>Tras la instalaci\u00f3n se mostrar\u00e1 un resumen en la pantalla de las caracter\u00edsticas del directorio creado. Pero es recomendable consultar el nuevo fichero de configuraci\u00f3n que se ha creado el cual debe tener el siguiente aspecto:</p> Fichero de configuraci\u00f3n Samba<pre><code># Global parameters\n\n[global]\nworkgroup = MIEMPRESAFEA\nrealm = MIEMPRESAFEA.LOCAL\nnetbios name = SERVIDORUBUNTU\nserver role = active directory domain controller\ndns forwarder = 8.8.8.8\n\n[netlogon]\npath = /var/lib/samba/sysvol/miempresafea.local/scripts\nread only = No\n\n[sysvol]\npath = /var/lib/samba/sysvol\nread only = No\n</code></pre> <p>El dominio se ha creado con \u00e9xito y el servidor ha sido configurado como controlador de dominio de Active Directory. Esto quiere decir que este controlador puede integrarse en un directorio junto con otros controladores. Esta integraci\u00f3n resulta fundamental ya que este tipo de directorios son los m\u00e1s utilizados en el \u00e1mbito empresarial, y siempre es buena idea contar con una alternativa a la omnipresencia de los sistemas operativos de Microsoft. Para lograr esta compatibilidad se ha generado tres bloques en el fichero de configuraci\u00f3n.</p> <ul> <li>global, muestra la configuraci\u00f3n del dominio junto con los roles para los que se ha creado.</li> <li>netlogon, se ha creado de forma autom\u00e1tica la carpeta para los scripts de inicio de sesi\u00f3n de los clientes.</li> <li>sysvol, es responsable de la difusi\u00f3n las pol\u00edticas de grupo aplicadas en el editor de directivas de grupo. Todos los cambios son replicados a trav\u00e9s de este recurso compartido.</li> </ul> <p>La conexi\u00f3n entre los servicios de Samba y el de Kerberos (para autientificar a los usuarios), se realiza a trav\u00e9s de un archivo de configuraci\u00f3n generado durante la instalaci\u00f3n de Kerberos. Tan s\u00f3lo ser\u00e1 necesario copiarlo</p> Copia de configuraci\u00f3n<pre><code>sudo mv /var/lib/samba/private/krb5.conf /etc/\n</code></pre> <p>Si todo ha ido de forma correcta, el terminal responder\u00e1 con este mensaje</p> Mensaje<pre><code>Removed /etc/systemd/system/samba-ad-dc.service\n</code></pre> <p>Para m\u00e1s informaci\u00f3n. Mira este link</p> <p>Ya est\u00e1 todo listo para activar el servicio de Samba</p> Comienzo del Servicio<pre><code>sudo systemctl start samba-ad-dc\n</code></pre> <p>Adem\u00e1s, ser\u00e1 conveniente hacer que el sistema lo inicie en cada reinicio</p> Activaci\u00f3n cuando se reinicie<pre><code>sudo systemctl enable samba-ad-dc\n</code></pre> <p>Tras esto, se comprueba que el equipo ofrece el servicio de Active Directory y en qu\u00e9 nivel funcional lo har\u00e1</p> <pre><code>sudo samba-tool domain level show\n</code></pre> <p>comando que mostrar\u00e1 la siguiente informaci\u00f3n</p> Informaci\u00f3n del anterior comando<pre><code>Domain and forest function level for domain 'DC=miempresafea,DC=local'\n\nForest function level: (Windows) 2008\nDomain function level: (Windows) 2008\nLowest function level of a DC: (Windows) 2008\n</code></pre> <p>Un detalle a tener en cuenta es que, a diferencia de Microsoft Windows Server, este sistema s\u00ed admite usuarios locales en el equipo. No es nada relevante ya este equipo se dedicar\u00e1 \u00fanicamente a la gesti\u00f3n del controlador de dominio, pero se puede comprobar como los usuarios locales no han desparecido de la m\u00e1quina.</p> <p>En este punto del manual se dispone de dos controladores de dominio; uno configurado en Microsoft Windows Server y otro en Ubuntu Server. A partir de estas l\u00edneas se realizar\u00e1n configuraciones en ambos servidores pero en dos redes distintas, de ese modo es posible practicar la administraci\u00f3n de servicios de directorio desde GUI y desde CLI.</p>"},{"location":"UD4/sistemaRedes/","title":"Sistema de organizaci\u00f3n de redes","text":"<p>Si no se concibe un ordenador sin sistema operativo que lo administre, tampoco debe existir una red de cierta entidad sin sistema operativo de red que la gestione. \u00c9ste ser\u00e1 el encargado de gestionar los elementos que componen la red a trav\u00e9s de una serie de herramientas y capacidades que los sistemas operativos clientes, los vistos hasta el ahora, no disponen. Ofrecen y administran recursos y servicios al resto de ordenadores que componen la red vigilando el acceso y uso de los mismos.</p> <p>En definitiva, un sistema operativo de red (SOR en lo sucesivo), est\u00e1 dise\u00f1ado para administrar redes y todos los elementos que la componen. Sus tareas m\u00e1s importantes son la gesti\u00f3n centralizada de los recursos, ofrecer servicios a los clientes, proporcionar acceso seguro a esos recursos y monitorizar todo lo que pasa en la red. Tareas que se ir\u00e1n viendo en profundidad en las siguientes unidades.</p>"},{"location":"UD4/sistemaRedes/#administracion-de-una-red-entre-iguales-estructura-trabajo-en-grupo","title":"Administraci\u00f3n de una red entre iguales. Estructura trabajo en grupo","text":"<p>Una red plana, entre iguales o punto a punto, es aquella en la ninguno de los equipos realiza tareas de administraci\u00f3n de la red, sino tan s\u00f3lo de s\u00ed mismo. No existe un equipo que haga las veces de administrador, por lo que en realidad, todos los clientes se convierten en administradores de los recursos que ofrecen a la red. Por ejemplo, si un cliente decide compartir un recuso, \u00e9ste estar\u00e1 disponible para todos los miembros de la red sin distinci\u00f3n. Si es necesario limitar el acceso a un subconjunto de usuarios, habr\u00e1 que establecer una contrase\u00f1a y hac\u00e9rsela llegar a trav\u00e9s de un medio seguro.</p> <p></p> <p>Si cada uno de los usuarios empieza a compartir recursos sin control, su localizaci\u00f3n puede ser una tarea complicada, ya que los usuarios de la red deben conocer en todo momento su distribuci\u00f3n y configuraci\u00f3n. La localizaci\u00f3n puede suponer un grave problema. Microsoft introdujo en sus sistemas operativos la posibilidad de crear grupos de trabajo que divid\u00edan la red en subconjuntos. De este modo, si se sabe a qu\u00e9 grupo pertenece el equipo que comparte un recurso ser\u00e1 m\u00e1s sencillo su localizaci\u00f3n. Estas divisiones se realizaban por funciones, por ubicaci\u00f3n f\u00edsica o por cualquier otro criterio de la empresa. Resultaba m\u00e1s sencillo localizar recursos, pero no solucionaban el problema de acceso. Adem\u00e1s de la nula administraci\u00f3n de los recursos, este sistema de organizaci\u00f3n de red presenta numerosos problemas de seguridad. Cada usuario puede tomar sus propias decisiones a la hora de compartir, las cuales no tienen por que coincidir con las de otros usuarios. Esto provoca que se deban conocer diferentes t\u00e9cnicas de seguridad para tener acceso a los recursos. Es evidente que no se trata de una forma \u00f3ptima de trabajar.</p> <p></p>"},{"location":"UD4/sistemaRedes/#estructura-cliente-servidor-servidores-independientes","title":"Estructura cliente-servidor. Servidores independientes","text":"<p>Se trata de un modelo de aplicaci\u00f3n distribuida en el que las tareas se dividen entre los proveedores de recursos o servicios. A estas m\u00e1quinas se las conoce como servidores y a los equipos que demandan estos servicios se les conoce como clientes. Cuando un cliente necesita un servicio ofrecido por un servidor, el primero realiza una petici\u00f3n que ser\u00e1 respondida por el segundo. Es una separaci\u00f3n l\u00f3gica, es decir, el que ofrece los servicios no necesariamente debe situarse en una sola m\u00e1quina ni es necesariamente un s\u00f3lo programa. Adem\u00e1s, esta divisi\u00f3n l\u00f3gica no es estricta, ya que un servidor puede actuar como cliente de otro proveedor de servicios. Esta configuraci\u00f3n l\u00f3gica de red est\u00e1 basada en la terminal tonta o cliente ligero. Dispon\u00edan de un teclado como dispositivo de entrada y un monitor como dispositivo de salida. No presentaban capacidad de c\u00f3mputo ni de almacenamiento, siendo \u00e9stas capacidades prestadas por un superordenador o mainframe al que se conectaban varios de estos terminales. Fruto de esta arquitectura f\u00edsica surge la organizaci\u00f3n l\u00f3gica de redes cliente-servidor.</p> <p></p> <p>Es una red en la que los clientes est\u00e1n conectados a un servidor en el que se centralizan los recursos y servicios con que se cuenta la red. El servidor es el encargado de ponerlos a disposici\u00f3n de los clientes cada vez que estos son solicitados. Por lo tanto, todas las gestiones que se realizan se concentran en el servidor, lo que facilita la localizaci\u00f3n de los recurso de una forma sencilla.</p> <p>Sin embargo, agregar un segundo servidor puede complicar las cosas de manera significativa. El problema surge porque cada servidor individual mantiene su propia lista de usuarios y recursos. El servidor A ofrece alojamiento a aplicaciones, el servidor B al correo electr\u00f3nico y las aplicaciones de contabilidad y la base de datos se encuentran en el servidor C. Los usuarios que requieren acceso a la base de datos y utilizar las aplicaciones, necesitan una cuenta en dos se los tres servidores. Cada una de esas cuentas de usuarios debe ser creada y mantenida de manera separada. Es f\u00e1cil para los servidores perder sincron\u00eda cuando deben ser actualizados manualmente.</p> <p></p> <p>La situaci\u00f3n tambi\u00e9n se complica desde el punto de vista de usuario, pues debe conectarse y mantener una contrase\u00f1a en cada uno de los servidores. Aunque este proceso puede ser automatizado, suele ser propenso a errores. Este tipo de redes siguen siendo adecuadas en situaciones simples, donde s\u00f3lo existe un servidor y tiene unas funciones muy delimitadas.</p> <p></p> <p>A pesar de plantear soluci\u00f3n a la ubicaci\u00f3n de los recursos del sistema, todav\u00eda quedan problemas por resolver relacionados con la asignaci\u00f3n de permisos a los recursos o la sincronizaci\u00f3n de la informaci\u00f3n. Estas y otras cuestiones ser\u00e1n resueltas con el siguiente modo de organizaci\u00f3n de red.</p>"},{"location":"UD4/sistemaRedes/#servicios-de-directorio","title":"Servicios de directorio","text":"<p>Con el anterior sistemas de organizaci\u00f3n de redes se ha dado un paso hacia la gesti\u00f3n \u00f3ptima de los elementos de una red, no obstante todav\u00eda quedan ciertos problemas por resolver. La dispersi\u00f3n de la informaci\u00f3n platea un problema de accesibilidad y control. Aqu\u00ed es donde se hacen \u00fatiles los servicios de directorios, que son un conjunto de aplicaciones que guardan y administran toda la informaci\u00f3n sobre los elementos de una red. Cada recurso de la red se considera como un objeto, donde su informaci\u00f3n se almacena como atributos. Para la gesti\u00f3n de esta informaci\u00f3n, el servicio de directorio establece una serie de permisos de acceso y condiciones de seguridad que la salvaguardan esta informaci\u00f3n. Un servicio del directorio ofrece una infraestructura para localizar, manejar, administrar, y organizar los componentes y recursos comunes de una red. Cada uno de estos recursos pueden ser vol\u00famenes, carpetas, archivos, impresoras, usuarios, grupos, dispositivos, n\u00fameros de tel\u00e9fono y un largo etc\u00e9tera. Un servicio del directorio es un componente fundamental del SOR ya que es la herramienta que los diferencia de los sistemas operativos clientes. Los servicios de directorios contienen diferentes objetos relacionados entre s\u00ed, y que ser\u00e1 conveniente familiarizarse con ellos:</p> <ul> <li>directorio, es un repositorio \u00fanico para la informaci\u00f3n relativa a los objetos de una organizaci\u00f3n.</li> <li>dominio, es una colecci\u00f3n de objetos dentro de un directorio.</li> <li> <p>objeto, cualquiera de los elementos que forman parte del directorio. Pueden ser recursos, usuarios, equipos, relaciones de confianza, servidores, unidades organizativas entre otros. En general todos estos objetos se clasifican en tres categor\u00edas:</p> <ul> <li>usuarios, identificados a trav\u00e9s del binomio nombre/contrase\u00f1a y que pueden organizarse en grupos.</li> <li>recursos, elementos que los usuarios pueden usar para el correcto desarrollo de su actividad.</li> <li>servicios, que son funciones a los que el usuario tienen acceso como el correo electr\u00f3nico, copias de seguridad en la nube, conexi\u00f3n Internet entre otros.</li> </ul> </li> <li> <p>unidad organizativa, es un contendedor de objetos que permite organizarlos en subconjuntos de forma jer\u00e1rquica. Facilita la organizaci\u00f3n de los dominios.</p> </li> <li>grupo, conjunto de objetos usuario. Al igual que las unidades organizativas, facilitan la organizaci\u00f3n y administraci\u00f3n de los objetos, los grupos lo hacen con objetos tipo usuario.</li> <li>controlador de dominio, equipo que contiene la base de datos de objetos para un determinado dominio, incluida la informaci\u00f3n de seguridad y la responsabilidad de la autenticaci\u00f3n de objetos de su \u00e1mbito de gobierno.</li> <li>cat\u00e1logo global, base de datos con la informaci\u00f3n de todos los objetos que contiene el directorio. Esta informaci\u00f3n habitualmente se divide entre los controladores de dominio siendo \u00e9stos responsables del mantenimiento de su parte de esta informaci\u00f3n.</li> <li>maestro de operaciones, existen un conjunto de operaciones que deben estar centralizadas para mantener la consistencia del sistema. El equipo encargado de esas operaciones obtiene este rol espec\u00edfico. Seg\u00fan el caso puede ser un equipo independiente que controle estas operaciones o asignar estas tareas a un equipo existente.</li> <li>\u00e1rbol, un conjunto de dominios dependientes de una ra\u00edz com\u00fan y que tienen una estructura jer\u00e1rquica. Se caracterizan por tener un espacio de nombres com\u00fan (un servidor DNS propio). El objetivo de esta fragmentaci\u00f3n de la estructura es replicar s\u00f3lo la informaci\u00f3n necesaria y disminuir el tr\u00e1fico de red.</li> <li>bosque, se trata del mayor contenedor l\u00f3gico dentro del directorio, conteniendo a todos los \u00e1rboles dentro de su \u00e1mbito. Cada uno de estos contenedores posee su propio espacio de nombres y una forma de relacionarse con el resto de bosques.</li> <li>esquema, se refiere a la estructura de los objetos que forman la base de datos. Usa la t\u00e9cnica clase/objeto para definir la estructura de un objeto. Si se crean dos objetos usuarios, ambos tendr\u00e1n los mismos atributos (estructura), pero diferentes atributos. -sitio, conjunto de objetos equipo que se encuentran relacionados de una forma l\u00f3gica, geogr\u00e1fica o t\u00e9cnica particular y que necesitan un subconjunto de normas diferentes al resto. -relaciones de confianza, son un m\u00e9todo de comunicaci\u00f3n segura entre dominios, \u00e1rboles y bosques, que permiten a los usuarios autentificarse en otra parte del directorio a la que no pertenece.</li> </ul> <p>Este listado pretende ser un resumen de los diferentes componentes que conforman un directorio. Se tratar\u00e1n con mayor profundidad todos estos conceptos en otras unidades.</p> <p>Para nombrar a todos estos objetos que componen la red, los servicios de directorio definen un espacio de nombres un\u00edvoco, e identifican a cada uno de estos objetos con un nombre \u00fanico en todo el directorio. De esta forma ser\u00e1 sencillo acceder a los objetos ya que tan s\u00f3lo hay que conocer su nombre. Una vez accedido, es posible obtener todos los atributos de ese objeto.</p> <p>La tecnolog\u00eda utilizada para crear este espacio de nombres es la DNS (Domain Name Server), y su funcionamiento es similar al de Internet. Cada uno de los objetos del directorio posee un DN (Distinguished Name) que lo identifica de forma un\u00edvoca del resto de elementos del directorio.</p> <p>Otro aspecto importante de los servicios de directorio, es que ofrecen una capa de abstracci\u00f3n para facilitar el acceso a los objetos. Se debe indicar una \u00fanica ubicaci\u00f3n en donde se dirigir\u00e1n las peticiones de informaci\u00f3n. No importa si la informaci\u00f3n solicitada se encuentra o no en ese emplazamiento, el servicio de directorio dar\u00e1 servida cuenta de las solicitudes que le lleguen. Si se permite el s\u00edmil, es el Google del sistema inform\u00e1tico que se gestiona. Es posible que toda la informaci\u00f3n no est\u00e9 contenida en un \u00fanico equipo por cuestiones de rendimiento, escalabilidad o idiosincrasia del sistemas inform\u00e1tico. En estos casos crear un subconjunto de la informaci\u00f3n contenida en los servicios de directorio parece una buena opci\u00f3n y dotarlos de las herramientas necesarias para su gesti\u00f3n aut\u00f3noma. A pesar de esta autonom\u00eda, todos los objetos de este subconjunto pertenecen al conjunto global y deben comportarse como tales.</p> <p>Existen multitud de servicios de directorio pero en este manual se van a tratar los siguientes:</p> <ul> <li>Active Directory, ideado por Microsoft e implementado desde su versi\u00f3n Microsoft Windows 2000 que usaba tecnolog\u00eda propietaria, para m\u00e1s tarde adaptar el protocolo LDAP a su servicio</li> <li>OpenLDAP, recibe el nombre del protocolo hom\u00f3nimo que gestiona el intercambio de informaci\u00f3n. Es uno de los m\u00e1s usados en sistemas basados en GNU/Linux.</li> <li>SambaLDAP, un servicio compuesto por un conjunto de protocolos (OpenLDAP, Kerberos y Samba) que permite la f\u00e1cil coexistencia de entre sistemas operativos diferentes.</li> </ul> <p>Otros servicios de directorio que implementan este protocolo de acceso a datos son el Novell Directory Services, Red Hat Directory Server o Apache Directory Server entre otros.</p> <p>En resumen, un servicio de directorio ofrece toda la informaci\u00f3n de los recursos de la red a trav\u00e9s de una \u00fanica ubicaci\u00f3n. Para ello convierte cada recurso en un objeto y almacena su informaci\u00f3n en una base de datos jer\u00e1rquica y, opcionalmente, distribuida. La gesti\u00f3n de estos datos se realiza a trav\u00e9s de un protocolo determinado por la versi\u00f3n del servicio de directorio escogido.</p> <p></p>"},{"location":"UD4/sistemaRedes/#protocolo-ldap","title":"Protocolo LDAP","text":"<p>El LDAP (Lightweight Directory Access Protocol) es un protocolo a nivel de aplicaci\u00f3n que da acceso a un servicio de directorio ordenado y distribuido para la b\u00fasqueda de la informaci\u00f3n de un entrono de red.</p> <p>En la d\u00e9cada de los 80, la especificaci\u00f3n de directorio X.500 vio la luz. El protocolo que daba acceso a la informaci\u00f3n contenida en \u00e9l, fue DAP (Directory Access Protocol) y estaba basado en la pila de protocolos OSI (Open Systems Interconexion). Gracias al auge de Internet, la pila de protocolos TCP/IP cobraron especial protagonismo y su uso fue generalizado en cualquier infraestructura de red, incluidas las LAN.</p> <p>Ante esta situaci\u00f3n, en 1993 se implement\u00f3 el protocolo LDAP que utilizaba la pila de protocolos TCP/IP para el acceso a la informaci\u00f3n contenido en un servicio de directorio. El funcionamiento de LDAP es relativamente simple: un cliente se inicia una sesi\u00f3n en un servidor LDAP solicitando alguna informaci\u00f3n. Esta solicitud es transmitida al servidor, devuelta al protocolo LDAP y enviada al cliente. Salvo en contadas excepciones, el cliente no ha de esperar la respuesta del servidor para realizar la siguiente petici\u00f3n.</p>"},{"location":"UD5/Actividades/","title":"Actividades de la UD5","text":""},{"location":"UD5/Actividades/#actividad-1","title":"Actividad 1","text":"<ol> <li>Accede al servicio DNS de ServidorWindows, accede a la zona directa existente y crea una nueva entrada tipo host (A) para cada equipo del dominio (clientes y servidores). Recuerda que, de momento, las IP de los equipos son fijas.</li> <li> <p>En ServidorUbuntu crea una zona de b\u00fasqueda inversa. Recuerda que por defecto Samba no crea esta caracter\u00edstica.</p> </li> <li> <p>Crea los siguientes alias (CNAME) en ServidorWindows:</p> <ul> <li>uno denominado \u201cwww\u201d que apunte al servidor,</li> <li>otro\u201cftp\u201d que apunte a uno de los clientes,</li> <li>y un \u00faltimo \u201ccorreo\u201d que apunte a un equipo que no existe (IP inventada).</li> </ul> <p>Una vez creados ve al cliente y prueba las entradas que acabas de crear con los comandos <code>ping</code> y <code>nslookup</code>. \u00bfQu\u00e9 ocurre en cada caso?. \u00bfTodo est\u00e1 funcionando como debiera?.</p> </li> </ol>"},{"location":"UD5/Actividades/#actividad-2","title":"Actividad 2","text":"<ol> <li> <p>Instala el rol de DHCP en ServidorWindows (no configures nada durante la instalaci\u00f3n del servicio). Una vez terminada la instalaci\u00f3n, configura el servicio de la siguiente manera:</p> <ol> <li>crea un nuevo \u00e1mbito con todas las IP de la red</li> <li>crea dos reservas; una con las 10 primeras IP de la red y otra con las 10 \u00faltimas</li> <li>excluye de la asignaci\u00f3n la IP del servidor</li> <li>la duraci\u00f3n de la concesi\u00f3n debe ser de 15 horas</li> </ol> </li> <li> <p>Instala el rol de DHCP en ServidorUbuntu y configura el servicio de la siguiente manera:</p> <ol> <li>crea dos \u00e1mbitos: uno con el tercer byte de la direcci\u00f3n de tipo B a 0, y el otro con el resto de las direcciones disponibles.</li> <li>crea dos reservas; una con las 5 primeras IP de la red y otra con las 5 \u00faltimas</li> <li>reserva de la asignaci\u00f3n la IP del servidor</li> <li>la duraci\u00f3n de la concesi\u00f3n debe ser de 15 horas, al igual que en el caso anterior</li> </ol> </li> </ol>"},{"location":"UD5/Actividades/#actividad-3","title":"Actividad 3","text":"<ol> <li> <p>Introduce el cliente CW1001 en el dominio controlado por ServidorWindows. Recuerda que deber\u00e1s realizar algunas configuraciones previas en los clientes.</p> <p>IMPORTANTE: Antes de continuar esta pr\u00e1ctica, realiza una clonaci\u00f3n enlazada de los clientes CW10XX las veces que necesites en lugar de crear m\u00e1quinas nuevas. Recuerda que deber\u00e1s cambiar el nombre del equipo, la MAC de la NIC y la IP si es fija.</p> </li> <li> <p>Clona de forma enlazada el cliente CU1801 y m\u00e9telo en el domino controlado por ServidorUbuntu. Recuerda que deber\u00e1s realizar algunas configuraciones previas en los clientes</p> <p>IMPORTANTE: Al igual que en el caso anterior, realiza una clonaci\u00f3n enlazada de los clientes CU18XX las veces que necesites en lugar de crear m\u00e1quinas nuevas. Recuerda que deber\u00e1s cambiar el nombre del equipo, la MAC de la NIC y la IP si es fija.</p> </li> </ol>"},{"location":"UD5/Actividades/#actividad-3-bis-cliente-ubuntu-en-active-directory-pasos-menos-explicados-y-con-otros-paquetes","title":"Actividad 3 bis. Cliente Ubuntu en Active Directory (pasos menos explicados y con otros paquetes.)","text":"<p>Objetivo: unir un cliente Ubuntu al dominio de Active Directory y comprobar que se pueden ejecutar acciones con usuarios de dominio.</p> <ol> <li>Prepara la red del cliente Ubuntu: establece el nombre de host y configura el DNS apuntando al controlador de dominio de Windows.</li> <li>Instala los paquetes de integraci\u00f3n:    <pre><code>sudo apt update\nsudo apt install realmd sssd-ad sssd-tools adcli samba-common-bin oddjob-mkhomedir packagekit\n</code></pre></li> <li>Descubre el dominio y \u00fanete con una cuenta que tenga permisos de uni\u00f3n:    <pre><code>realm discover MIDOMINIO.LOCAL\nsudo realm join MIDOMINIO.LOCAL -U Administrador\nrealm list\n</code></pre></li> <li>Habilita la creaci\u00f3n autom\u00e1tica del home y permite el acceso al grupo de usuarios del dominio:    <pre><code>sudo systemctl enable --now oddjobd\nsudo pam-auth-update --enable mkhomedir\nsudo realm permit --groups \"Domain Users\"\n</code></pre></li> <li>Concede privilegios de administraci\u00f3n al grupo Domain Admins en el cliente Ubuntu:    <pre><code>echo \"%domain\\\\ admins ALL=(ALL) ALL\" | sudo tee /etc/sudoers.d/domain-admins\n</code></pre></li> <li>Valida el acceso con un usuario de dominio:</li> <li>Comprueba identidad y ticket Kerberos: <code>id usuario@midominio.local</code> y <code>klist</code>.</li> <li>Inicia sesi\u00f3n por consola o SSH con el usuario del dominio y confirma que se crea su directorio <code>/home/DOMINIO/usuario</code>.</li> <li>Ejecuta un comando con <code>sudo</code> para verificar los permisos.</li> <li>Documenta los pasos y captura evidencias (uni\u00f3n correcta, <code>realm list</code>, <code>id</code>, <code>klist</code>, creaci\u00f3n de home y uso de <code>sudo</code>).</li> </ol>"},{"location":"UD5/Actividades/#actividad-4","title":"Actividad 4","text":"<ol> <li>Instala la aplicaci\u00f3n RSAT en el cliente CW1001 y conecta con ServidorWindows para administrarlo.</li> <li>Configura el programa Open SSH Client en el cliente CW1002 y trata de establecer una conexi\u00f3n con ServidorUbuntu. Realiza alguna operaci\u00f3n con permisos de administraci\u00f3n para comprobar que todo funciona de forma correcta.</li> <li>Instala la aplicaci\u00f3n SSH en el CU1801, si es necesario, y abre una sesi\u00f3n de administraci\u00f3n en ServidorUbuntu. Trata de hacer alguna tarea que requiera permisos de administrador para comprobar que funciona la conexi\u00f3n.</li> </ol>"},{"location":"UD5/Actividades/#actividad-5de-refuerzo","title":"Actividad 5.DE REFUERZO","text":"<ol> <li>Crearemos una serie de entradas en nuestro servicio DNS de ServidorWindows para hacer algunas pruebas. Sigue estos pasos:<ol> <li>abre la herramienta de DNS a trav\u00e9s de Herramientas \u2192 DNS y selecciona Zonas de b\u00fasqueda directa. Navega hasta el nombre de tu dominio y en el panel de la derecha pulsa el bot\u00f3n derecho y elige la opci\u00f3n Alias nuevo (CNAME)\u2026</li> <li>introduce \u201cPublicaciones\u201d como nombre de alias y como nombre de dominio completo el de tu servidor (puedes buscarlo con el bot\u00f3n Examinar\u2026)</li> <li>crea un host nuevo con la opci\u00f3n Host nuevo (A o AAA)\u2026 y coloca una IP que no est\u00e9 asignada a ning\u00fan equipo del dominio, es decir, que no exista. De este modo comprobaremos lo que ocurre cuando el DNS falla</li> <li>a\u00f1ade un nuevo alias denominado \u201cProxy\u201d que apunte al nuevo host que acabas de crear</li> <li>desde un cliente conectado al dominio, haz pruebas de conexi\u00f3n a ambos alias con el comando <pre><code>nslookup publicaciones.tu_nombre_de_servidor.com\n</code></pre> Recuerda poner tu nombre de dominio despu\u00e9s del nombre del alias. \u00bfQu\u00e9 resultados obtienes?. \u00bfSon l\u00f3gicos?.</li> </ol> </li> <li>Configura ahora un \u00e1mbito nuevo como respaldo del primero, para realizar tareas de mantenimiento y no dejar a los clientes sin conexi\u00f3n de red. Para ello sigue los pasos siguientes:<ol> <li>pulsa con el bot\u00f3n derecho sobre el servidor DHCP y elige \u00c1mbito nuevo\u2026. Define como nombre de \u00e1mbito Segundo. El rango de direcciones ser\u00e1n las 30 \u00faltimas del \u00e1mbito (excepto la \u00faltima, recuerda que es la de broadcast).</li> <li>define la exclusi\u00f3n de la \u00faltima IP del \u00e1mbito. \u00bfQu\u00e9 significa esta configuraci\u00f3n?</li> <li>duraci\u00f3n de concesiones 8 horas. \u00bfQu\u00e9 quiere decir esto?</li> <li>configura la puerta de enlace predeterminada de tu red como la direcci\u00f3n IP del servidor. Para ello accede a la opci\u00f3n Opciones de \u00e1mbito.</li> <li>desactiva el \u00e1mbito anterior, si es que se encuentra activo</li> <li>activa el \u00e1mbito, prepara a los clientes para que obtengan IP autom\u00e1tica (Configuraci\u00f3n de red)</li> <li>comprueba la IP que se le ha asignado al equipo tras el reinicio.</li> </ol> </li> <li> <p>Es necesario la administraci\u00f3n de los clientes de la red, y estos es posible que tengan diferentes sistemas operativos. Para poder realizar esta administraci\u00f3n entre ellos se configurar\u00e1 Open SSH client y server en los clientes con un sistema operativo Microsoft Windows. Para ello sigue estos pasos:</p> <ol> <li>accede a Aplicaciones y Caracter\u00edsticas \u2192 Administrar funciones adicionales \u2192 Agregar una caracter\u00edstica e instala la caracter\u00edstica Servidor OpenSHH. Comprueba que tanto el cliente como el servidor de Open SSH est\u00e1n instalados en el equipo</li> <li>ser\u00e1 necesario crear una regla en el Cortafuegos de Windows para poder utilizar esta aplicaci\u00f3n. Para ello abre un terminal PowerShell como administrador e introduce este comando:     <pre><code>netsh advfirewall firewall add rule name=\"SSHD Port\" dir=in action=allow protocol=TCP localport=22\n</code></pre></li> <li>ahora se va a conectar a este equipo desde un cliente con GNU/Linux. Primero ser\u00e1 necesario instalar el cliente:     <pre><code>sudo apt-get install openssh-client\n</code></pre></li> <li> <p>es preciso disponer de varios datos para realizar la conexi\u00f3n; el puerto por el que escucha el servicio (ser\u00e1 el 22), la IP del equipo, el nombre y la contrase\u00f1a de usuario con el que se requiere conectar. Con estos datos se establece la conexi\u00f3n con el siguiente comando:</p> <pre><code>ssh -p 22 nombre_usuario@ip_equipo\n</code></pre> <p>donde ser\u00e1 necesario sustituir los datos de usuario y la IP del equipo. Preguntar\u00e1 la contrase\u00f1a del usuario al realizar la conexi\u00f3n</p> </li> <li> <p>Ahora instala en servidor OpenSHH en el cliente con GNU/Linux y realiza la conexi\u00f3n en sentido contrario, es decir, desde Microsoft Windows a GNU/Linux. Para ello ser\u00e1 necesario la instalaci\u00f3n del software a trav\u00e9s de este comando:</p> <pre><code>  sudo apt install openssh-server\n</code></pre> <p>recuerda revisar la configuraci\u00f3n del archivo <code>/etc/ssh/sshd_config</code> para comprobar si el servicio est\u00e1 escuchando a trav\u00e9s del puerto 22.</p> </li> </ol> </li> </ol>"},{"location":"UD5/Actividades/#actividad-6de-ampliacion","title":"Actividad 6.DE AMPLIACI\u00d3N","text":"<ol> <li>\u00bfQu\u00e9 es un super\u00e1mbito en los servicios DHCP?. Explica en qu\u00e9 consiste y configura uno a partir de dos nuevos \u00e1mbitos que deber\u00e1s crear; uno para el departamento de Contabilidad y otro para el de TIC. Usa los rangos de IP que estimes oportunos</li> <li>Introduce el cliente CU1801 en el dominio controlado por ServidorUbuntu y su clon enlazado en el dominio controlado por ServidorWindows. Utiliza para ello la aplicaci\u00f3n LikeWise-Open o SSSD que deber\u00e1s instalar.</li> <li>Instala la aplicaci\u00f3n RSAT en el cliente CW1001 (clonado) y conecta con ServidorUbuntu para administrarlo.</li> </ol> <p>Manera de entrega de las actividades</p> <p>Redacta una gu\u00eda de los pasos a seguir para realizar esta actividad y s\u00fabela al Moodle del m\u00f3dulo.   De tal forma que en cada uno de los pasos incluya una imagen que verifique que se ha realizado aquello que se pide en cada uno de los ejercicios. Como en las anteriores actividades</p> <p>Warning</p> <p>SOLO LAS ACTIVIDADES 1,2,3,4 SON OBLIGATORIAS.</p>"},{"location":"UD5/adminRemota/","title":"Administraci\u00f3n remota","text":"<p>Una de las recomendaciones en todo directorio es la de habilitar un sistema para la administraci\u00f3n de los servidores de forma remota. Habitualmente, el acceso a los servidores suele estar restringido y puede resultar inc\u00f3modo el trabajar con ellos, ya que suelen estar en salas bajo llave, controles de acceso, climatizaci\u00f3n no apta para mam\u00edferos, entre otros problemas.</p> <p>Aprovechando que los clientes deben conectarse a los servidores para solicitar datos y realizar acciones, es buena idea habilitar a \u00e9stos para que, desde ellos, se realicen gestiones de administraci\u00f3n remota. La forma de hacerlo depender\u00e1 del tipo de servidor que gobierne la red.</p>"},{"location":"UD5/adminRemota/#gestion-desde-sistemas-operativos-cliente-de-microsoft","title":"Gesti\u00f3n desde sistemas operativos cliente de Microsoft","text":"<p>Microsoft dispone de una herramienta gratuita que permite esta tarea: Remote Server Administration Tools, en lo sucesivo RSAT. Se trata de una aplicaci\u00f3n cuyo objetivo es administrar el servidor pensada para instalarse en clientes que replica las herramientas disponibles en el controlador del dominio. Este software est\u00e1 idealmente pensado para servidores tipo CORE en los que no existe una GUI y toda su administraci\u00f3n queda adscrita a un terminal. El consumo de recursos de la GUI queda traspasada al cliente, utilizando el servidor estos recursos para otros menesteres.</p> <p>La configuraci\u00f3n ha de realizarse en dos fases: la configuraci\u00f3n del servidor y la del cliente. En el primer caso ser\u00e1 necesario activar, por un lado la Administraci\u00f3n Remota desde el Administraci\u00f3n del servidor \u2192 Servidor local \u2192 Administraci\u00f3n remota. Esta configuraci\u00f3n habilita una regla en el Cortafuegos de Windows que permite el acceso a estos servicios desde el exterior.</p> <p></p> <p>Una vez configurado el servidor, toca el turno al cliente. Es preciso se\u00f1alar que cualquier usuario con permiso para instalar software podr\u00e1 realizar estas acciones, pero en ning\u00fan caso administrar el servidor.</p> <p>Para poder utilizar RSAT ser\u00e1 necesario iniciar sesi\u00f3n como administrador del dominio o una cuenta que disponga de permisos suficientes. No obstante, por coherencia del proceso, se realizar\u00e1 todo con la cuenta de administrador de dominio.</p> <p>Se inicia sesi\u00f3n en el cliente con la cuenta de administrador de dominio, descargar la versi\u00f3n correcta y se instala el programa. En realidad lo que hace este programa es a\u00f1adir una herramienta al sistema operativo, como si de una actualizaci\u00f3n del mismo se tratase.</p> <p>Tras el proceso de instalaci\u00f3n y el pertinente reinicio, se comprueba que en el men\u00fa de Inicio existe una nueva aplicaci\u00f3n denominada Administrador del servidor y que la interfaz gr\u00e1fica de esta herramienta es exactamente igual que la de Microsoft Windows Server. De esta forma ser\u00e1 m\u00e1s sencillo el cambio entre una y otra forma de administrar el servidor.</p> <p>El siguiente paso es conectar esta herramienta con el servidor que se debe administrar. Si en la infraestructura de red existe m\u00e1s de uno, es posible tener una de estas herramientas para cada uno, eso s\u00ed, en diferentes clientes. Para enlazar esta herramienta con el servidor se pulsa el bot\u00f3n derecho sobre la opci\u00f3n Todos los servidores \u2192 Agregar servidores del panel de la izquierda.</p> <p></p> <p>A partir de este momento toda la gesti\u00f3n realizada en esta herramienta tendr\u00e1 su efecto en el controlador de dominio configurado.</p>"},{"location":"UD5/adminRemota/#gestion-desde-sistemas-operativos-cliente-gnulinux","title":"Gesti\u00f3n desde sistemas operativos cliente GNU/Linux","text":"<p>En los sistemas operativos basados en GNU/Linux se dispone de la herramienta SSH (Secure Shell). SSH es un protocolo seguro para la administraci\u00f3n remota de servidores, routers, switches y un largo etc\u00e9tera de equipos. Permite manejar por completo el servidor o dispositivo de red mediante un int\u00e9rprete de comandos.</p> <p>Adem\u00e1s, es posible ejecutar programas gr\u00e1ficos a trav\u00e9s de la propia sesi\u00f3n SSH e incluso el uso de la herramienta PowerShell de Microsoft a trav\u00e9s de este protocolo.</p> <p>Tambi\u00e9n permite la transferencia de datos de manera segura a trav\u00e9s del protocolo SFTP (SSH File Transfer Protocol).</p> <p>El protocolo SSH es fundamental en el \u00e1mbito de las redes y administraci\u00f3n de sistemas ya que dispone de una amplia gama de opciones para dotar a nuestro sistema de la m\u00e1xima seguridad posible. Proporciona:</p> <ul> <li>confidencialidad, los datos van cifrados de extremo a extremo de la comunicaci\u00f3n</li> <li>autenticaci\u00f3n, se requiere para poder usar el servicio. Es posible identificarse con usuario/clave o con criptograf\u00eda de clave p\u00fablica</li> <li>integridad, si los datos se modifican o los modifica un usuario malintencionado se podr\u00e1 detectar, ya que usa HMAC (Hashing for Message Authentication) para comprobar la integridad de todos y cada uno de los datos.</li> </ul> <p>Existen dos versiones de SSH, la versi\u00f3n 1 no se recomienda usarla, de hecho, por defecto siempre se utiliza la versi\u00f3n SSHv2 de este protocolo. Por defecto SSH utiliza el protocolo TCP de la capa de transporte y el puerto 22, aunque es posible modificar este comportamiento. Para la configuraci\u00f3n de SSH se usar\u00e1 el programa OpenSSH que ofrece servicios tanto de cliente como de servidor. Como es obvio el proceso de instalaci\u00f3n del servicio se realizar\u00e1 en dos fases; la del servidor y la del cliente.</p> <p>Para instalar en servicio de OpenSHH es necesario la instalaci\u00f3n de algunos paquetes, si no est\u00e1n instalados ya en el sistema</p> <pre><code>sudo apt install openssh-server\n</code></pre> <p>se arranca el servicio</p> <pre><code>sudo /etc/init.d/ssh start\n</code></pre> <p>Uno de los ficheros que hay que tener en cuenta cuando se usa este servicio es <code>/etc/ssh/sshd_config</code> el cual contiene su configuraci\u00f3n. Desde aqu\u00ed es posible configurar los intentos de conexi\u00f3n, el n\u00famero de conexiones simult\u00e1neas, el modo de autenticaci\u00f3n, el puerto de escucha, restringir la direcci\u00f3n de conexi\u00f3n y otras muchas opciones. Est\u00e1 fuera de este apartado explicar todas y cada una de ellas. Es recomendable consultar la ayuda y visitar su p\u00e1gina web si se requiere alguna configuraci\u00f3n m\u00e1s de las que se detallan a continuaci\u00f3n.</p> <ul> <li>Port 22, el servicio ssh se comunica a trav\u00e9s del puerto 22 por defecto. Un ataque a este servicio siempre se realiza a trav\u00e9s del puerto 22 y al usuario root. Cambiar estas configuraciones puede ser buena pr\u00e1ctica si se sospecha de alguna intrusi\u00f3n.</li> <li>PermitRootLogin no, permite deshabilitar el login del usuario root para dotar al sistema de mayor seguridad.</li> <li>LoginGraceTime, tiempo necesario para introducir la contrase\u00f1a.</li> <li>MaxAuthTries, intentos permitidos para introducir la contrase\u00f1a.</li> <li>MaxStartups, n\u00famero de login abiertas desde una IP, se evita que se puedan utilizar varias sesiones de forma simult\u00e1nea.</li> <li>AllowUsers, lista blanca que permite configurar los usuarios que podr\u00e1n conectarse. Una medida muy restrictiva pero a la vez muy segura ya que bloquear\u00e1 todas las conexiones de los usuarios que no est\u00e9n en el listado.</li> </ul> <p>OpenSSH permite varias formas de autenticaci\u00f3n en el servidor. La m\u00e1s com\u00fan es utilizar el binomio usuario/contrase\u00f1a, pero tambi\u00e9n es posible utilizar claves criptogr\u00e1ficas, usar One Time Password generados por aplicaciones externas entre otros. El sistema inform\u00e1tico que se est\u00e1 construyendo se encuentra dentro de una red confiable, por lo que todas estas medidas de seguridad no ser\u00e1n necesarias. A\u00fan as\u00ed, es interesante que el administrador conozca la existencia de estas t\u00e9cnicas de seguridad extra.</p> <p>Para que un cliente pueda conectarse al servidor a trav\u00e9s de SSH tan s\u00f3lo ser\u00e1 necesario utilizar el comando ssh utilizando el nombre del equipo o bien la direcci\u00f3n IP</p> <pre><code>ssh administrador@ubuntuserver.miempresafea.local\n</code></pre> <p>Cuando la conexi\u00f3n se haya establecido aparecer\u00e1 un mensaje como este</p> <pre><code>The authenticity of host 'ubuntuserver.miempresafea.local' can't be established.\nDSA key fingerprint is 94:68:3a:3a:bc:f3:9a:9b:01:5d:b3:07:38:e2:11:0c.\nAre you sure you want to continue connecting (yes/no)?\n</code></pre> <p>Al contestar <code>yes</code> se establece una conexi\u00f3n y se le preguntar\u00e1 la contrase\u00f1a especificada al usuario. En este momento se dispone de un terminal abierto en el servidor con el usuario administrador.</p>"},{"location":"UD5/conxClientesLinux/","title":"Conexi\u00f3n de clientes a un controlador de dominio en GNU/Linux","text":"<p>Un controlador de dominio configurado con Samba 4 posee los mismos protocolos que uno configurado a trav\u00e9s de Microsoft Windows Server . Cuando el cliente se conecta a un servicio de directorio, no distingue si detr\u00e1s de esos protocolos existe un sistema operativo de Microsoft o basado en GNU/Linux. Esta configuraci\u00f3n es transparente al cliente por eso el m\u00e9todo de conexi\u00f3n a diferentes servicios de directorio es el mismo. Los \u00fanicos cambios que ser\u00e1 necesario realizar en el proceso de instalaci\u00f3n, ser\u00e1n los datos del dominio y el nombre de host, el resto de necesidades, instalaciones y configuraciones ser\u00e1n id\u00e9nticas.</p>"},{"location":"UD5/conxClientesLinux/#union-de-un-cliente-ubuntu-a-active-directory-realmd-sssd","title":"Uni\u00f3n de un cliente Ubuntu a Active Directory (realmd + SSSD)","text":"<p>En equipos Ubuntu recientes la forma m\u00e1s estable de integrarse con Active Directory es usando <code>realmd</code> y <code>sssd</code>, que delegan la autenticaci\u00f3n en Kerberos/LDAP y crean cuentas de dominio al vuelo.</p> <p>Pasos recomendados:</p> <ol> <li>Preparaci\u00f3n de red: fija el nombre de host (<code>/etc/hostname</code>) y apunta el DNS del cliente al controlador de dominio.</li> <li>Paquetes:    <pre><code>sudo apt update\nsudo apt install realmd sssd-ad sssd-tools adcli samba-common-bin oddjob-mkhomedir packagekit\n</code></pre>    El servicio <code>oddjob-mkhomedir</code> permite crear el directorio personal la primera vez que entra un usuario del dominio.</li> <li>Descubrir el dominio:    <pre><code>realm discover midominio.local\n</code></pre></li> <li>Unir el equipo (usa la cuenta con permisos de uni\u00f3n en el dominio):    <pre><code>sudo realm join midominio.local -U Administrador\n</code></pre>    Verifica con <code>realm list</code> que el cliente qued\u00f3 unido.</li> <li>Configurar creaci\u00f3n de home autom\u00e1tica:    <pre><code>sudo systemctl enable --now oddjobd\nsudo pam-auth-update --enable mkhomedir\n</code></pre></li> <li>Permisos y sudo (ejemplo: permitir iniciar sesi\u00f3n a un grupo y darle sudo):    <pre><code>sudo realm permit --groups \"Domain Users\"\necho \"%domain\\\\ admins ALL=(ALL) ALL\" | sudo tee /etc/sudoers.d/domain-admins\n</code></pre></li> <li>Probar inicio de sesi\u00f3n con un usuario del dominio:    <pre><code>id usuario@midominio.local\nklist\nssh usuario@midominio.local@clienteubuntu\n</code></pre>    Debe crearse el home en <code>/home/DOMINIO/usuario</code> y recibir un ticket Kerberos v\u00e1lido.</li> </ol> <p>Si se cambia el controlador de dominio o el sufijo, recuerda actualizar el DNS y volver a ejecutar <code>realm join</code> para reestablecer la confianza.</p>"},{"location":"UD5/conxClientesWindows%20copy%20antiguo/","title":"Conexi\u00f3n de clientes a un controlador de dominio","text":""},{"location":"UD5/conxClientesWindows%20copy%20antiguo/#clientes-microsoft-windows","title":"Clientes Microsoft Windows","text":"<p>Un controlador de dominio sin objetos que controlar ser\u00eda un caro objeto de decoraci\u00f3n. Cuando un cliente pasa a formar parte del dominio, \u00e9ste queda adscrito a un \u00e1mbito con unas normas muy bien definidas y que se va a ver en la obligaci\u00f3n de cumplir. Sin embargo, tambi\u00e9n va a tener acceso a una serie de recursos que, de ninguna otra manera, podr\u00eda haber tenido acceso antes de la pertenencia al dominio.</p> <p>Todo cliente que quiera pertenecer a un dominio debe cumplir los requisitos exigidos por \u00e9ste, que depender\u00e1n de los objetivos que persiga. Adem\u00e1s, se deben seguir los siguientes pasos:</p> <ul> <li>configurar la red del cliente de forma adecuada para que coincidan con las del dominio</li> <li>ajustar el nombre del equipo del cliente si existen alguna nomenclatura especificada o cumpliendo las restricciones impuestas por el dominio</li> <li>unir el equipo cliente al dominio</li> <li>iniciar sesi\u00f3n con la cuenta de usuario especificada</li> </ul> <p>Una vez preparado el cliente, se detallan a continuaci\u00f3n los pasos a seguir para unir un cliente con Microsoft Windows 10 Professional al dominio.</p> <p>El primer paso es comprobar que la configuraci\u00f3n de red del cliente sea compatible. Es posible utilizar una IP fija, pero si el servidor dispone de un servicio DHCP es posible dejar la configuraci\u00f3n autom\u00e1tica para que el cliente solicite una antes de la la inclusi\u00f3n al dominio. Este es una pr\u00e1ctica recomendable para los clientes, de esta forma la administraci\u00f3n de las direcciones queda centralizada.</p> <p>Para que la asignaci\u00f3n autom\u00e1tica funcione es preciso que el cliente tenga claro a quien preguntar d\u00f3nde se ubican el resto de elementos de la red. Para ello se utiliza el DNS, por lo que la \u00fanica informaci\u00f3n que el cliente necesita ser\u00e1 la direcci\u00f3n de IP del servicio de DNS, que habitualmente ser\u00e1 la misma que la del servidor que presta el servicio.</p> <p>Es necesario comprobar que todo funciona de forma correcta, por lo que se abrir\u00e1 un terminal en el cliente <code>cmd.exe</code> y se realizar\u00e1 un ping al servidor</p> <p><code>ping miempresafea.local</code></p> <p>Si se utiliza el nombre del servidor en lugar de su direcci\u00f3n IP, no s\u00f3lo se comprobar\u00e1 que el equipo cliente est\u00e1 en la misma red que el servidor, sino tambi\u00e9n que la configuraci\u00f3n DNS del cliente es correcta y que el servidor DNS del controlador de dominio est\u00e1 funcionando de forma adecuada.</p> <p></p> <p>El segundo paso ser\u00e1 ajustar el nombre del equipo para adaptarlo a las reglas de dominio. Para comprobar el nombre actual del equipo, se accede a trav\u00e9s de bot\u00f3n derecho sobre Inicio \u2192 Sistema. En la parte inferior, adem\u00e1s de algunos detalles sobre el hardware del equipo, se encuentra su nombre (tanto el nombre NetBIOS como el nombre DNS), la descripci\u00f3n y el nombre del grupo de trabajo o dominio al que pertenece. El nombre del equipo es el que asigna Microsoft Windows de forma autom\u00e1tica durante el proceso de instalaci\u00f3n. Tambi\u00e9n pertenece a un grupo de trabajo (WORKGROUP), incluido en todos los equipos de la marca de Redmond desde las primeras versiones con soporte de trabajo en red.</p> <p>Desde esta pantalla es posible proceder al cambio de nombre, no obstante se realizar\u00e1 mediante de la ventana de Sistema, ya que el m\u00e9todo com\u00fan en todos los sistemas operativos de Microsoft. Se accede a trav\u00e9s del Panel de Control \u2192 Sistema y Seguridad \u2192 Sistema \u2192 Cambiar Configuraci\u00f3n. En la nueva ventana que aparece, se pulsar\u00e1 sobre el bot\u00f3n Cambiar\u2026. Se escribe el nombre al cliente seg\u00fan especificaciones del dominio y se marcar\u00e1 la opci\u00f3n Domino, procediendo despu\u00e9s a poner el nombre del dominio al que se va a acceder en el recuadro inferior.</p> <p>El cliente se conectar\u00e1 y solicitar\u00e1 las credenciales de alg\u00fan usuario del dominio con permisos suficientes para realizar esta acci\u00f3n. Recuerda que para estas acciones se necesitan ciertos privilegios que las cuentas normales no poseen. Al aceptar los datos, la ventana de autenticaci\u00f3n se cierra y en su lugar aparece un mensaje indicando que el equipo se ha unido correctamente al dominio. Tras este cambio el sistema operativo solicitar\u00e1 un reinicio para terminar con la configuraci\u00f3n.</p> <p></p> <p>Tras el reinicio el sistema operativo, el cliente ofrece una nueva forma de inicio de sesi\u00f3n. Ahora es posible acceder a la sesi\u00f3n local, de igual forma que se hac\u00eda hasta el momento, pero se a\u00f1ade la posibilidad de hacerlo tambi\u00e9n en el domino al que se acaba de unir. Para acceder a uno u otro, hay que tener en cuenta varias cosas:</p> <ul> <li>lugar de inicio de sesi\u00f3n, ahora es posible hacer lo forma local, especificando el nombre del equipo, o en el dominio, especificando el nombre del mismo,</li> <li>usuario que inicia la sesi\u00f3n, si la ubicaci\u00f3n de acceso es el equipo local, habr\u00e1 que especificar un usuario de ese \u00e1mbito. Si por el contrario se requiere entrar en el dominio, habr\u00e1 que utilizar un usuario del dominio creado en el servidor con anterioridad.</li> </ul> <p>Huelga decir que dependiendo de la ubicaci\u00f3n elegida para el inicio de sesi\u00f3n ser\u00e1 posible acceder a unos recursos u otros. Para comprobar que todo ha ido como debiera, se iniciar\u00e1 sesi\u00f3n en el dominio con un usuario del domino (en estos momentos tan s\u00f3lo se dispone de la cuenta de administrador) y se comprueban los valores de Nombre de equipo y Miembro del que ofrece ahora la ventana de propiedades del sistema.</p>"},{"location":"UD5/conxClientesWindows%20copy%20antiguo/#clientes-gnulinux","title":"Clientes GNU/Linux","text":"<p>La conexi\u00f3n de un cliente GNU/Linux a un entorno Active Directory no es complicada, el problema es que estos clientes no vienen preparados por defecto para su integraci\u00f3n. Esto obliga al administrador a realizar algunos pasos extra que alargan el proceso, aunque mucho de ellos es posible automatizarlos a trav\u00e9s de un shellscript, como se ver\u00e1 en lo sucesivo. Este proceso se realizar\u00e1 en varias fases:</p> <ul> <li>configurar las caracter\u00edsticas de red y nombre del cliente</li> <li> <p>instalar el software necesario</p> <ul> <li>Kerberos, para poder recibir tickets de validaci\u00f3n por parte del servidor.</li> <li>Samba, para controlar las acciones con Active Directory</li> <li>SSSD (System Security Services Daemon), permitir\u00e1 la autenticaci\u00f3n de los usuarios contra la base de datos Active Directory. Durante la instalaci\u00f3n del servidor Samba en apartados anteriores, se us\u00f3 Winbind para realizar esta tarea. Esto se debe a que en el servidor instalado en GNU/Linux se conectar\u00e1n equipos de Microsoft y Winbind ofrece una mejor compatibilidad.</li> <li>NTP (Network Time Protocol), responsable de sincronizar el funcionamiento del reloj del sistema con el servidor</li> </ul> </li> <li> <p>a\u00f1adir el nombre del equipo al host</p> </li> <li>autenticaci\u00f3n en el dominio</li> </ul> <p>El primer paso consisten en cambiar el nombre al equipo. A pesar de que durante la instalaci\u00f3n se configur\u00f3, es muy probable que no sea de utilidad para la inclusi\u00f3n en una estructura de dominio. Lo primero que tenemos que hacer es :</p> cambiar nombre mediante comandos<pre><code>sudo hostnamectl set-hostname cliente-ubuntu01\n</code></pre> <p>Adem\u00e1s de este fichero, es necesario modificar el /etc/hosts. Aqu\u00ed es el primer lugar en donde busca el sistema para resolver un nombre de dominio. Se edita el fichero a\u00f1adiendo a la direcci\u00f3n loopback el nombre del equipo seguida del nombre del equipo que tendr\u00e1 en el dominio, tal y como aparece en el siguiente ejemplo</p> <pre><code>127.0.0.1 localhost\n127.0.1.1 cliente-ubuntu01 cliente-ubuntu01.miempresafea.local\n10.0.3.3(#Cambiarla por la de tu servidor) ServidorUbuntu.miempresafea.local ServidorUbuntu\n10.0.3.3 (#Cambiarla por la de tu servidor)  miempresafea.local miempresafea\n\n# The following lines are desirable for IPv6 capable hosts\n\n::1 ip6-localhost ip6-loopback\nfe00::0 ip6-localnet\nff00::0 ip6-mcastprefix\nff02::1 ip6-allnodes\nff02::2 ip6-allrouters\n</code></pre>"},{"location":"UD5/conxClientesWindows%20copy%20antiguo/#si-no-disponemos-de-un-dhcp-instalado-en-el-servidor","title":"Si NO disponemos de un DHCP instalado en el servidor.","text":"<p>En este caso, hay que configurar manualmente la configuraci\u00f3n IP. Ten\u00e9is que ver el tema anterior.</p>"},{"location":"UD5/conxClientesWindows%20copy%20antiguo/#si-disponemos-de-un-dhcp-instalado-en-el-servidor","title":"Si disponemos de un DHCP instalado en el servidor.","text":"<p>Por lo que respecta a la direcci\u00f3n de red, se accede a trav\u00e9s de la configuraci\u00f3n de red, y se configurar\u00e1 de la siguiente manera:</p> <ul> <li>m\u00e9todo de obtenci\u00f3n de IP en autom\u00e1tico, ya que se dispone de DHCP.</li> <li>en servidores DNS hay que colocar la IP del servidor y a\u00f1adir el secundario 8.8.8.8</li> </ul> <p></p> <p>El siguiente paso es configurar la resoluci\u00f3n de nombres. Por defecto cuando Ubuntu tiene que resolver un nombre primero mira en el fichero <code>/etc/host</code> para hacerlo. Si la resoluci\u00f3n no es satisfactoria busca en el servidor de DNS. Esta configuraci\u00f3n no es la adecuada para un equipo que constantemente va a solicitar datos a un controlador de dominio. Adem\u00e1s, esta configuraci\u00f3n puede ocasionar alg\u00fan problema que obstaculice la traducci\u00f3n.</p> <p>Para cambiar el orden de consulta y que lo haga primero al servicio de DNS disponible en la red, se accede al fichero <code>/etc/nsswitch.conf</code> y se edita cambiando el orden de los elementos que aparecen en la l\u00ednea que comienza con la palabra host. La l\u00ednea inicial es esta</p> <pre><code>  hosts: files mdns4_minimal [NOT FOUND=return] dns\n</code></pre> <p>que modificamos de la siguiente manera</p> <pre><code>hosts: files dns mdns4_minimal [NOT FOUND=return]\n</code></pre> <p>De esta forma cambiamos el orden de consulta del sistema por defecto. Para comprobarlo, se hace un ping al servidor de DNS</p> <pre><code>ping ServidorUbuntu.miempresafea.local\n</code></pre>"},{"location":"UD5/conxClientesWindows%20copy%20antiguo/#instalacion-del-software-necesario","title":"Instalaci\u00f3n del software necesario","text":"<p>Hora de instalar los paquetes necesarios. Es posible que algunos de \u00e9stos ya se encuentren instalados en el equipo, en ese caso apt saltar\u00e1 la instalaci\u00f3n de ese paquete.</p> <pre><code>sudo apt install sssd-ad sssd-tools realmd adcli\n</code></pre> <p>Aqu\u00ed ten\u00e9is un [link] (https://documentation.ubuntu.com/server/how-to/sssd/with-active-directory/?_gl=1ml0eoq_gcl_au*MTkwMTQwNjgzMi4xNzM3NjM1MzU3&amp;_ga=2.145475508.104790640.1738153494-1149087011.1715791238) de donde he sacado estos apuntes.</p> <p>Durante la instalaci\u00f3n de Kerberos, se preguntar\u00e1 el reino (realm) al que se unir\u00e1. En realidad, se refiere al nombre del dominio, que debe ser escrito en may\u00fasculas. En el ejemplo: MIEMPRESAFEA.LOCAL</p> <p>Una vez instalados los paquetes con sus dependencias, se proceder\u00e1 a su configuraci\u00f3n, empezando con Kerberos. Con la informaci\u00f3n especificada durante la instalaci\u00f3n, el nombre del dominio, o reino en la terminolog\u00eda Kerberos, deber\u00eda ser suficiente. Sin embargo, es recomendable a\u00f1adir un par de datos a su configuraci\u00f3n para que se comporte de forma adecuada en el dominio:</p> <ul> <li>ticket_lifetime: indica el tiempo durante el que ser\u00e1 v\u00e1lida la autenticaci\u00f3n obtenida mediante el servidor Kerberos.</li> <li>renew_lifetime: indica el tiempo durante el que se puede pedir la renovaci\u00f3n de una autenticaci\u00f3n anterior. Si el tiempo indicado aqu\u00ed es mayor que el expresado en ticket_lifetime, ser\u00e1 posible renovar la concesi\u00f3n antes de la sesi\u00f3n caduque, sin tener que volver a iniciar sesi\u00f3n.</li> </ul> <p>Esta informaci\u00f3n se va incluir en el archivo /etc/krb5.conf</p> <pre><code>sudo vim /etc/krb5.conf\n</code></pre> <p>Hay que asegurar que el reino coincide con el dominio comprobando esta secci\u00f3n del fichero</p> <pre><code>[libdefaults]\ndefault_realm = MIEMPRESAFEA.LOCAL\nAdem\u00e1s, se a\u00f1aden los dos valores anteriores, quedando esta secci\u00f3n de la siguiente manera\n[libdefaults]\ndefault_realm = MIEMPRESAFEA.LOCAL\nticket_lifetime = 24h #\nrenew_lifetime = 5d\n</code></pre> <p>Se establece que la concesi\u00f3n del ticket es de 24 horas y que es posible renovarlo durante 5 d\u00edas. Se guardan los cambios y se cierra la ventana del editor.</p> <p>Turno de Samba, requisito necesario para poder comunicarse con Active Directory. El archivo de configuraci\u00f3n es <code>/etc/samba/smb.conf</code> que se editar\u00e1 como de costumbre. Hay que localizar la secci\u00f3n [global] del fichero y realizar los siguientes cambios</p> <pre><code>[global]\n\n## Browsing/Identification\n\n# Change this to the workgroup/NT-domain namo your Samba server will part of\n\n    workgroup = MIEMPRESAFEA\n    client singing = yes\n    client use spnego = yes\n    Kerberos method = secrets and keytab\n    realm = MIEMPRESAFEA.LOCAL\n    security = ads\n</code></pre> <p>No es ocioso encarecer que tanto el workgroup (nombre NetBIOS) y el realm (nombre de domino) se deben adaptar a cada proyecto.</p> <p>Por \u00faltimo, ser\u00e1 necesaria la configuraci\u00f3n del servidor SSSD, pero en este caso, habr\u00e1 que crear un archivo de configuraci\u00f3n desde cero. Hay que tener en cuenta que los permisos y el propietario de este fichero ser\u00e1n del usuario que lo ha creado, y no es el servicio que lo va a usar. Por este motivo, una vez terminada su edici\u00f3n, habr\u00e1 que dotarlo de los permisos y propiedad adecuados, los del usuario root</p> <pre><code>sudo chown root:root /etc/sssd/sssd.conf\nsudo chmod 600 /etc/sssd/sssd.conf\n</code></pre> <p>Pero mejor empezar por el principio y crear el archivo en la ubicaci\u00f3n /etc/sssd/sssd.conf</p> <p>Ahora s\u00f3lo es necesario completarlo con la siguiente configuraci\u00f3n</p> <pre><code>[sssd]\nservices = nss, pam\nconfig_file_version = 2\ndomains = MIEMPRESAFEA.LOCAL\n\n[domain/MIEMPRESA.LOCAL]\nid_provider = ad\naccess_provider = ad\noverride_homedir = /home/%d/%u\n</code></pre> <p>Un detalle importante es que al conectarse a un dominio con una cuenta de usuario, \u00e9ste no va a disponer de una carpeta /home en el sistema, o al menos no de la forma tradicional. En la \u00faltima l\u00ednea del archivo de configuraci\u00f3n se especifica que las carpetas de usuario que inicien sesi\u00f3n usando este servicio, van a estar almacenadas en la carpeta <code>/home/MIEMPRESAFEA.LOCAL/nombreusuario</code>, separ\u00e1ndolas del resto de usuarios locales. Algo similar ocurre en los sistemas operativos de la familia de Microsoft, ya que a\u00f1aden el nombre del dominio a la carpeta de usuario. Ser\u00e1 necesario cambiar los permisos al fichero antes de continuar.</p> <p>Por \u00faltimo, es necesario revisar el fichero <code>/etc/nsswitch.conf</code></p> <pre><code>passwd: compat sss\ngroup: compat sss\nshadow: compat sss\n\u2026\nservices: db files sss\n\u2026\nnetgroup: nis sss\nsudoers: files sss\n</code></pre> <p>Este archivo es el que indica el orden de la resoluci\u00f3n de nombres, por lo que el nuevo servicio instalado debe figurar en \u00e9l. Si no es as\u00ed se ha de revisar la configuraci\u00f3n antes de continuar ya que, si no es correcta, no usar\u00e1 el servicio SSSD para autentificar al usuario, buscar\u00e1 en los archivos locales, no lo encontrar\u00e1 y devolver\u00e1 un error de inicio de sesi\u00f3n.</p> <p>Como siempre que se modifica un fichero de configuraci\u00f3n de un servicio, ser\u00e1 necesario su reinicio para que los cambios surtan efecto</p> <pre><code>sudo systemctl restart ntp\nsudo systemctl restart smbd nmbd\nsudo systemctl restart sssd\n</code></pre>"},{"location":"UD5/conxClientesWindows%20copy%20antiguo/#unir-el-equipo-al-dominio","title":"Unir el equipo al dominio","text":"<p>Antes de unirse al dominio es recomendable comprobar si el servidor Kerberos valida el equipo de forma correcta, ya que si no es as\u00ed no se dispondr\u00e1 de ticket alguno y no se podr\u00e1 utilizar ninguno de los servicios del controlador de domino. Para ello se utilizar\u00e1 la cuenta Administrador (la \u00fanica disponible por ahora)</p> <pre><code>sudo kinit administrador\n</code></pre> <p>El comando <code>kinit</code> permite la solicitud de un ticket al servicio Kerberos de un usuario determinado. Es posible que no se produzca salida alguna por el terminal, lo cual indica que el proceso de identificaci\u00f3n ha sido el correcto. A\u00fan as\u00ed, se utilizar\u00e1 el comando klist, el cual permite comprobar la informaci\u00f3n que posee el ticket de autentificaci\u00f3n.</p> <pre><code>sudo klist\n</code></pre> <p>el cual produce una salida parecida a esta</p> <pre><code>ticket cache: FILE:/tmp/krb5cc_0\nDefault principal: Administrador@MIEMPRESAFEA.LOCAL\n\nValid starting Expires Service principal\n20/03/19 21:15:38 21/03/19 07:15:38 krbtgt/MIEMPRESAFEA.LOCAL@MIEMPRESAFEA.LOCAL\nrenew until 25/03/19 21:15:23\n</code></pre> <p>Una vez obtenido el ticket que valida el uso de los servicios de controlador de dominio, tan s\u00f3lo queda unir el equipo al dominio</p> <pre><code>sudo net ads join -k\n</code></pre> <p>Aparecer\u00e1 un mensaje indicando que el equipo se ha unido de forma satisfactoria. No obstante, muestra un aviso que hace referencia a un fallo en la actualizaci\u00f3n del servicio de DNS. A pesar de esta advertencia, si en estos momentos se comprueba el controlador de dominio Microsoft Windows Server, se podr\u00e1 comprobar que el equipo cliente ya aparece en el contenedor Computers.</p>"},{"location":"UD5/conxClientesWindows%20copy%20antiguo/#habilitar-inicio-de-sesion-en-modo-grafico","title":"Habilitar inicio de sesi\u00f3n en modo gr\u00e1fico","text":"<p>Es probable que al iniciar el cliente, en la interfaz gr\u00e1fica de inicio de sesi\u00f3n tan s\u00f3lo permita la entrada al equipo con usuarios locales o la sesi\u00f3n de invitado. Una vez m\u00e1s, para evitar esta circunstancia es necesario editar dos ficheros</p> <pre><code>sudo vim  /usr/shared/lightdm/lightdm.conf.d/50-unity-greeter.conf\n</code></pre> <p>y a\u00f1adir al final del fichero</p> <pre><code>greeter-show-manual-login=true\n</code></pre> <p>Ahora se edita el fichero de configuraci\u00f3n gr\u00e1fica</p> <pre><code>sudo nano /etc/pam.d/common-session\n</code></pre> <p>Se localizan la siguiente l\u00ednea</p> <pre><code>session required pam_unix.so\n</code></pre> <p>y se escribe encima de ella la siguiente opci\u00f3n, que lanzar\u00e1 la interfaz gr\u00e1fica para conectar con el dominio</p> <pre><code>session [success=ok default=ignore] pam_lsass.so\n</code></pre> <p>Ahora es posible iniciar sesi\u00f3n en m\u00e1s ubicaciones que en modo local. </p>"},{"location":"UD5/conxClientesWindows/","title":"Conexi\u00f3n de clientes a un controlador de dominio","text":""},{"location":"UD5/conxClientesWindows/#clientes-microsoft-windows","title":"Clientes Microsoft Windows","text":"<p>Un controlador de dominio sin objetos que controlar ser\u00eda un caro objeto de decoraci\u00f3n. Cuando un cliente pasa a formar parte del dominio, \u00e9ste queda adscrito a un \u00e1mbito con unas normas muy bien definidas y que se va a ver en la obligaci\u00f3n de cumplir. Sin embargo, tambi\u00e9n va a tener acceso a una serie de recursos que, de ninguna otra manera, podr\u00eda haber tenido acceso antes de la pertenencia al dominio.</p> <p>Todo cliente que quiera pertenecer a un dominio debe cumplir los requisitos exigidos por \u00e9ste, que depender\u00e1n de los objetivos que persiga. Adem\u00e1s, se deben seguir los siguientes pasos:</p> <ul> <li>configurar la red del cliente de forma adecuada para que coincidan con las del dominio</li> <li>ajustar el nombre del equipo del cliente si existen alguna nomenclatura especificada o cumpliendo las restricciones impuestas por el dominio</li> <li>unir el equipo cliente al dominio</li> <li>iniciar sesi\u00f3n con la cuenta de usuario especificada</li> </ul> <p>Una vez preparado el cliente, se detallan a continuaci\u00f3n los pasos a seguir para unir un cliente con Microsoft Windows 10 Professional al dominio.</p> <p>El primer paso es comprobar que la configuraci\u00f3n de red del cliente sea compatible. Es posible utilizar una IP fija, pero si el servidor dispone de un servicio DHCP es posible dejar la configuraci\u00f3n autom\u00e1tica para que el cliente solicite una antes de la la inclusi\u00f3n al dominio. Este es una pr\u00e1ctica recomendable para los clientes, de esta forma la administraci\u00f3n de las direcciones queda centralizada.</p> <p>Para que la asignaci\u00f3n autom\u00e1tica funcione es preciso que el cliente tenga claro a quien preguntar d\u00f3nde se ubican el resto de elementos de la red. Para ello se utiliza el DNS, por lo que la \u00fanica informaci\u00f3n que el cliente necesita ser\u00e1 la direcci\u00f3n de IP del servicio de DNS, que habitualmente ser\u00e1 la misma que la del servidor que presta el servicio.</p> <p>Es necesario comprobar que todo funciona de forma correcta, por lo que se abrir\u00e1 un terminal en el cliente <code>cmd.exe</code> y se realizar\u00e1 un ping al servidor</p> <p><code>ping miempresafea.local</code></p> <p>Si se utiliza el nombre del servidor en lugar de su direcci\u00f3n IP, no s\u00f3lo se comprobar\u00e1 que el equipo cliente est\u00e1 en la misma red que el servidor, sino tambi\u00e9n que la configuraci\u00f3n DNS del cliente es correcta y que el servidor DNS del controlador de dominio est\u00e1 funcionando de forma adecuada.</p> <p></p> <p>El segundo paso ser\u00e1 ajustar el nombre del equipo para adaptarlo a las reglas de dominio. Para comprobar el nombre actual del equipo, se accede a trav\u00e9s de bot\u00f3n derecho sobre Inicio \u2192 Sistema. En la parte inferior, adem\u00e1s de algunos detalles sobre el hardware del equipo, se encuentra su nombre (tanto el nombre NetBIOS como el nombre DNS), la descripci\u00f3n y el nombre del grupo de trabajo o dominio al que pertenece. El nombre del equipo es el que asigna Microsoft Windows de forma autom\u00e1tica durante el proceso de instalaci\u00f3n. Tambi\u00e9n pertenece a un grupo de trabajo (WORKGROUP), incluido en todos los equipos de la marca de Redmond desde las primeras versiones con soporte de trabajo en red.</p> <p>Desde esta pantalla es posible proceder al cambio de nombre, no obstante se realizar\u00e1 mediante de la ventana de Sistema, ya que el m\u00e9todo com\u00fan en todos los sistemas operativos de Microsoft. Se accede a trav\u00e9s del Panel de Control \u2192 Sistema y Seguridad \u2192 Sistema \u2192 Cambiar Configuraci\u00f3n. En la nueva ventana que aparece, se pulsar\u00e1 sobre el bot\u00f3n Cambiar\u2026. Se escribe el nombre al cliente seg\u00fan especificaciones del dominio y se marcar\u00e1 la opci\u00f3n Domino, procediendo despu\u00e9s a poner el nombre del dominio al que se va a acceder en el recuadro inferior.</p> <p>El cliente se conectar\u00e1 y solicitar\u00e1 las credenciales de alg\u00fan usuario del dominio con permisos suficientes para realizar esta acci\u00f3n. Recuerda que para estas acciones se necesitan ciertos privilegios que las cuentas normales no poseen. Al aceptar los datos, la ventana de autenticaci\u00f3n se cierra y en su lugar aparece un mensaje indicando que el equipo se ha unido correctamente al dominio. Tras este cambio el sistema operativo solicitar\u00e1 un reinicio para terminar con la configuraci\u00f3n.</p> <p></p> <p>Tras el reinicio el sistema operativo, el cliente ofrece una nueva forma de inicio de sesi\u00f3n. Ahora es posible acceder a la sesi\u00f3n local, de igual forma que se hac\u00eda hasta el momento, pero se a\u00f1ade la posibilidad de hacerlo tambi\u00e9n en el domino al que se acaba de unir. Para acceder a uno u otro, hay que tener en cuenta varias cosas:</p> <ul> <li>lugar de inicio de sesi\u00f3n, ahora es posible hacer lo forma local, especificando el nombre del equipo, o en el dominio, especificando el nombre del mismo,</li> <li>usuario que inicia la sesi\u00f3n, si la ubicaci\u00f3n de acceso es el equipo local, habr\u00e1 que especificar un usuario de ese \u00e1mbito. Si por el contrario se requiere entrar en el dominio, habr\u00e1 que utilizar un usuario del dominio creado en el servidor con anterioridad.</li> </ul> <p>Huelga decir que dependiendo de la ubicaci\u00f3n elegida para el inicio de sesi\u00f3n ser\u00e1 posible acceder a unos recursos u otros. Para comprobar que todo ha ido como debiera, se iniciar\u00e1 sesi\u00f3n en el dominio con un usuario del domino (en estos momentos tan s\u00f3lo se dispone de la cuenta de administrador) y se comprueban los valores de Nombre de equipo y Miembro del que ofrece ahora la ventana de propiedades del sistema.</p>"},{"location":"UD5/conxClientesWindows/#clientes-gnulinux","title":"Clientes GNU/Linux","text":"<p>La conexi\u00f3n de un cliente GNU/Linux a un entorno Active Directory no es complicada, el problema es que estos clientes no vienen preparados por defecto para su integraci\u00f3n. Esto obliga al administrador a realizar algunos pasos extra que alargan el proceso, aunque mucho de ellos es posible automatizarlos a trav\u00e9s de un shellscript, como se ver\u00e1 en lo sucesivo. Este proceso se realizar\u00e1 en varias fases:</p> <ul> <li>configurar las caracter\u00edsticas de red y nombre del cliente</li> <li> <p>instalar el software necesario (stack SSSD + realmd)</p> <ul> <li>Kerberos, para poder recibir tickets de validaci\u00f3n por parte del servidor.</li> <li>SSSD (System Security Services Daemon), permitir\u00e1 la autenticaci\u00f3n de los usuarios contra la base de datos Active Directory. En el servidor Samba anterior se us\u00f3 Winbind, pero en el cliente nos quedamos con SSSD+realmd para que funcione igual con AD de Windows o con Samba.</li> <li>NTP (Network Time Protocol), responsable de sincronizar el funcionamiento del reloj del sistema con el servidor</li> </ul> </li> <li> <p>a\u00f1adir el nombre del equipo al host</p> </li> <li>autenticaci\u00f3n en el dominio</li> </ul> <p>El primer paso consisten en cambiar el nombre al equipo. A pesar de que durante la instalaci\u00f3n se configur\u00f3, es muy probable que no sea de utilidad para la inclusi\u00f3n en una estructura de dominio. Lo primero que tenemos que hacer es :</p> cambiar nombre mediante comandos<pre><code>sudo hostnamectl set-hostname cliente-ubuntu01\n</code></pre> <p>Adem\u00e1s de este fichero, es necesario modificar el /etc/hosts. Aqu\u00ed es el primer lugar en donde busca el sistema para resolver un nombre de dominio. Se edita el fichero a\u00f1adiendo a la direcci\u00f3n loopback el nombre del equipo seguida del nombre del equipo que tendr\u00e1 en el dominio, tal y como aparece en el siguiente ejemplo. La resoluci\u00f3n real debe venir del DNS del controlador de dominio (Windows o Samba); /etc/hosts solo sirve de apoyo local.</p> <pre><code>127.0.0.1 localhost\n127.0.1.1 cliente-ubuntu01 cliente-ubuntu01.miempresafea.local\n\n\n# The following lines are desirable for IPv6 capable hosts\n\n::1 ip6-localhost ip6-loopback\nfe00::0 ip6-localnet\nff00::0 ip6-mcastprefix\nff02::1 ip6-allnodes\nff02::2 ip6-allrouters\n</code></pre>"},{"location":"UD5/conxClientesWindows/#si-no-disponemos-de-un-dhcp-instalado-en-el-servidor","title":"Si NO disponemos de un DHCP instalado en el servidor.","text":"<p>En este caso, hay que configurar manualmente la configuraci\u00f3n IP. Ten\u00e9is que ver el tema anterior.</p>"},{"location":"UD5/conxClientesWindows/#si-disponemos-de-un-dhcp-instalado-en-el-servidor","title":"Si disponemos de un DHCP instalado en el servidor.","text":"<p>Por lo que respecta a la direcci\u00f3n de red, se accede a trav\u00e9s de la configuraci\u00f3n de red, y se configurar\u00e1 de la siguiente manera:</p> <ul> <li>m\u00e9todo de obtenci\u00f3n de IP en autom\u00e1tico, ya que se dispone de DHCP.</li> <li>en servidores DNS hay que colocar la IP del servidor y a\u00f1adir el secundario 8.8.8.8</li> </ul> <p></p> <p>El siguiente paso es configurar la resoluci\u00f3n de nombres. Por defecto cuando Ubuntu tiene que resolver un nombre primero mira en el fichero <code>/etc/hosts</code> para hacerlo. Si la resoluci\u00f3n no es satisfactoria busca en el servidor de DNS. Esta configuraci\u00f3n no es la adecuada para un equipo que constantemente va a solicitar datos a un controlador de dominio. Adem\u00e1s, esta configuraci\u00f3n puede ocasionar alg\u00fan problema que obstaculice la traducci\u00f3n.</p> <p>Para cambiar el orden de consulta y que lo haga primero al servicio de DNS disponible en la red, se accede al fichero <code>/etc/nsswitch.conf</code> y se edita cambiando el orden de los elementos que aparecen en la l\u00ednea que comienza con la palabra host. La l\u00ednea inicial es esta</p> <pre><code>  hosts: files mdns4_minimal [NOT FOUND=return] dns\n</code></pre> <p>que modificamos de la siguiente manera</p> <pre><code>hosts: files dns mdns4_minimal [NOT FOUND=return]\n</code></pre> <p>De esta forma cambiamos el orden de consulta del sistema por defecto. Para comprobarlo, se hace un ping al servidor de DNS</p> <pre><code>ping ServidorUbuntu.miempresafea.local\n</code></pre>"},{"location":"UD5/conxClientesWindows/#instalacion-del-software-necesario","title":"Instalaci\u00f3n del software necesario","text":"<p>Hora de instalar los paquetes necesarios. Es posible que algunos de \u00e9stos ya se encuentren instalados en el equipo, en ese caso apt saltar\u00e1 la instalaci\u00f3n de ese paquete. Usaremos el stack SSSD con realmd/adcli, sin Winbind ni smbd en el cliente.</p> <pre><code>sudo apt install sssd-ad sssd-tools realmd adcli krb5-user ntp\n</code></pre> <p>Aqu\u00ed ten\u00e9is un link de donde he sacado estos apuntes.</p> <p><code>realm</code> genera la configuraci\u00f3n de SSSD autom\u00e1ticamente al unir el equipo, pero si hay que revisarla o ajustarla debe conservar permisos 600 y propiedad root:root:</p> <pre><code>sudo chown root:root /etc/sssd/sssd.conf\nsudo chmod 600 /etc/sssd/sssd.conf\n</code></pre> <p>Un ejemplo de configuraci\u00f3n v\u00e1lida (realm la crea) es:</p> <pre><code>[sssd]\nservices = nss, pam\nconfig_file_version = 2\ndomains = MIEMPRESAFEA.LOCAL\n\n[domain/MIEMPRESAFEA.LOCAL]\nid_provider = ad\naccess_provider = ad\nfallback_homedir = /home/%u@%d\nuse_fully_qualified_names = True\nldap_id_mapping = True\ncache_credentials = True\n</code></pre> <p>Un detalle importante es que al conectarse a un dominio con una cuenta de usuario, \u00e9ste no va a disponer de una carpeta /home en el sistema, o al menos no de la forma tradicional. En la \u00faltima l\u00ednea del archivo de configuraci\u00f3n se especifica que las carpetas de usuario que inicien sesi\u00f3n usando este servicio, van a estar almacenadas en la carpeta <code>/home/usuario@dominio</code>, separ\u00e1ndolas del resto de usuarios locales. Algo similar ocurre en los sistemas operativos de la familia de Microsoft, ya que a\u00f1aden el nombre del dominio a la carpeta de usuario. Ser\u00e1 necesario cambiar los permisos al fichero antes de continuar.</p> <p>Por \u00faltimo, es necesario revisar el fichero <code>/etc/nsswitch.conf</code></p> <pre><code>passwd: compat sss\ngroup: compat sss\nshadow: compat sss\n\u2026\nservices: db files sss\n\u2026\nnetgroup: nis sss\nsudoers: files sss\n</code></pre> <p>Este archivo es el que indica el orden de la resoluci\u00f3n de nombres, por lo que el nuevo servicio instalado debe figurar en \u00e9l. Si no es as\u00ed se ha de revisar la configuraci\u00f3n antes de continuar ya que, si no es correcta, no usar\u00e1 el servicio SSSD para autentificar al usuario, buscar\u00e1 en los archivos locales, no lo encontrar\u00e1 y devolver\u00e1 un error de inicio de sesi\u00f3n.</p> <p>Como siempre que se modifica un fichero de configuraci\u00f3n de un servicio, ser\u00e1 necesario su reinicio para que los cambios surtan efecto</p> <pre><code>sudo systemctl restart ntp\nsudo systemctl restart sssd\n</code></pre>"},{"location":"UD5/conxClientesWindows/#unir-el-equipo-al-dominio","title":"Unir el equipo al dominio","text":"<p>Comprobamos primero que el dominio se descubre por DNS (sirve igual para un AD en Windows Server o en Samba):</p> <pre><code>sudo resolvectl status  # verifica que el DNS apunta al DC\nsudo realm -v discover miempresafea.local\n</code></pre> <p>Si la salida es correcta, unimos el equipo:</p> <pre><code>sudo realm join miempresafea.local\n</code></pre> <p>El comando pedir\u00e1 credenciales con permisos para unir equipos al dominio y generar\u00e1 autom\u00e1ticamente <code>/etc/sssd/sssd.conf</code>, fragmentos de Kerberos y los m\u00f3dulos PAM/NSS necesarios.</p>"},{"location":"UD5/conxClientesWindows/#habilitar-inicio-de-sesion-en-modo-grafico","title":"Habilitar inicio de sesi\u00f3n en modo gr\u00e1fico","text":"<p>Es probable que al iniciar el cliente, en la interfaz gr\u00e1fica de inicio de sesi\u00f3n tan s\u00f3lo permita la entrada al equipo con usuarios locales o la sesi\u00f3n de invitado. Una vez m\u00e1s, para evitar esta circunstancia es necesario editar dos ficheros</p> <pre><code>sudo vim /usr/share/lightdm/lightdm.conf.d/50-unity-greeter.conf\n</code></pre> <p>y a\u00f1adir al final del fichero</p> <pre><code>greeter-show-manual-login=true\n</code></pre> <p>Ahora se comprueba el fichero de configuraci\u00f3n PAM de sesi\u00f3n</p> <pre><code>sudo nano /etc/pam.d/common-session\n</code></pre> <p>La pila de PAM para sesi\u00f3n debe incluir SSSD. Normalmente ya existe la l\u00ednea</p> <pre><code>session optional pam_sss.so\n</code></pre> <p>Si no estuviera, a\u00f1\u00e1dela encima de <code>session required pam_unix.so</code> para que los usuarios de dominio puedan crear sesi\u00f3n mediante SSSD. Para crear autom\u00e1ticamente el /home de los usuarios de dominio, ejecuta:</p> <pre><code>sudo pam-auth-update --enable mkhomedir\n</code></pre>"},{"location":"UD5/conxClientesWindows/#verificar-acceso-y-kerberos","title":"Verificar acceso y Kerberos","text":"<ul> <li>Consultar un usuario del dominio en NSS:</li> </ul> <pre><code>getent passwd usuario@miempresafea.local\n</code></pre> <ul> <li>Ver grupos:</li> </ul> <pre><code>groups usuario@miempresafea.local\n</code></pre> <ul> <li>Comprobar ticket Kerberos (si instalaste <code>krb5-user</code>):</li> </ul> <pre><code>klist\n</code></pre> <p>Ahora es posible iniciar sesi\u00f3n en el dominio desde la interfaz gr\u00e1fica adem\u00e1s de las cuentas locales. </p>"},{"location":"UD5/dhcp/","title":"Instalaci\u00f3n y configuraci\u00f3n del servicio DHCP","text":"<p>Todo elemento contenido en una red debe estar identificado a trav\u00e9s de una direcci\u00f3n IP un\u00edvoca. En redes peque\u00f1as, esta asignaci\u00f3n puede ser controlada por el administrador de la red, pero a poco que crezca el n\u00famero de dispositivos, esta tarea se convertir\u00e1 en un quebradero de cabeza.</p> <p>El servicio DHCP (Dynamic Host Configuration Protocol) ofrece el control de este proceso de una manera aut\u00f3noma. El administrador establece unas pautas de asignaci\u00f3n y este servicio se encarga de aplicar esas directrices a la asignaci\u00f3n de IP. DHCP ofrece tres ventajas clave en la planificaci\u00f3n, dise\u00f1o y mantenimiento de una red:</p> <ul> <li>administraci\u00f3n centralizada, se elimina la necesidad de configurar de forma manual cada componente de la red, espec\u00edficamente equipos cliente. Es muy conveniente que tanto los equipos servidores, dispositivos de interconexi\u00f3n y algunos otros dispositivos sensibles como NAS (Network Attached Storage) o impresoras, tengan una IP fija. Esto permitir\u00e1 una   localizaci\u00f3n m\u00e1s r\u00e1pida (depende) y sencilla de estos dispositivos</li> <li>configuraci\u00f3n sencilla y r\u00e1pida, es necesario establecer unas pautas de asignaci\u00f3n. Con estas reglas el servicio asignar\u00e1 las IP de forma desatendida.</li> <li>flexibilidad, permite modificar las pautas de asignaci\u00f3n de una forma r\u00e1pida y f\u00e1cil. Tras cambiar los criterios se produce una reasignaci\u00f3n de IP autom\u00e1tica y transparente al usuario.   </li> </ul>"},{"location":"UD5/dhcp/#funcionamiento-del-dhcp","title":"Funcionamiento del DHCP","text":"<p>La primera vez que un equipo arranca necesita una direcci\u00f3n IP para poder interactuar con el resto de componentes, a este proceso se le denomina obtenci\u00f3n de una concesi\u00f3n inicial:</p> <p>La primera vez que un equipo arranca necesita una direcci\u00f3n IP para poder interactuar con el resto de componentes, a este proceso se le denomina obtenci\u00f3n de una concesi\u00f3n inicial:</p> <ul> <li>El cliente difunde por la red un mensaje DHCPDiscover para descubrir un servidor de DHCP. Como el cliente todav\u00eda no tiene IP, realiza una solicitud por difusi\u00f3n en \u00e1rea local a trav\u00e9s de ARP.</li> <li>El servidor recibe esta solicitud y env\u00eda un paquete DHCPOffer a la direcci\u00f3n MAC del solicitante ofreciendo una IP v\u00e1lida. Si existen m\u00e1s de un servidor DHCP en la red, el cliente recibir\u00e1 varios de estos paquetes quedando a su criterio la elecci\u00f3n de uno u otro.</li> <li>Si el cliente acepta esta concesi\u00f3n ofrecida por el servidor, env\u00eda a \u00e9ste un DHCPRequest confirmando la validez de la asignaci\u00f3n.</li> <li>Una vez asignada esa direcci\u00f3n, el servidor env\u00eda un DHCPAck al cliente con la confirmaci\u00f3n y con el resto de informaci\u00f3n necesaria para establecer la conexi\u00f3n.</li> </ul> <p></p> <p>Las asignaciones de IP a trav\u00e9s de DHCP suelen tener fecha de caducidad por motivos de seguridad. Este tiempo de renovaci\u00f3n lo marca el administrador y es similar al TTL (Time To Live) de la cach\u00e9 de DNS. Cuando es necesaria una renovaci\u00f3n se realiza de la siguiente manera:</p> <ul> <li>El cliente env\u00eda un mensaje de solicitud DHCPRequest.</li> <li>El servidor comprueba la posibilidad de mantener esa IP al equipo. Si es posible env\u00eda un DHCPAck que confirma su mantenimiento. Si no es posible enviar\u00e1 un DHCPOffer y se renovar\u00e1 la concesi\u00f3n.   </li> </ul> <p>En determinadas circunstancias el cliente puede perder la conexi\u00f3n con el servicio de DHCP. Si el cliente no es capaz de localizar ning\u00fan servidor para renovar su concesi\u00f3n, \u00e9ste env\u00eda una difusi\u00f3n de ARP (Address Resoluci\u00f3n Protocol). Si esta solicitud se resuelve correctamente, el cliente de DHCP supone que se encuentra situado en la misma red donde obtuvo su concesi\u00f3n actual, y la contin\u00faa usando. Si la difusi\u00f3n de ARP no recibe respuesta, el cliente supone que se ha trasladado a una red que no dispone actualmente de servicios de DHCP. En este caso se autoconfigura mediante APIPA (Automatic Private IP Addressing) que asigna una IP dentro del rango 169.254.0.0 y 169.254.255.255. Tras esta configuraci\u00f3n el cliente intentar\u00e1 localizar un servidor de DHCP de forma peri\u00f3dica, ya que con la IP asignada no es posible la comunicaci\u00f3n con el resto de elementos de la red. Este proceso se realizar\u00e1 de la siguiente forma:</p> <ul> <li>El cliente env\u00eda un mensaje de renovaci\u00f3n DHCPRequest.</li> <li>El servidor no puede determinar la identidad del solicitante o ya que o pertenece a otra red o subred o sencillamente ha perdido su asignaci\u00f3n. El servidor env\u00eda un paquete de rechazo de solicitud DHCPNak.</li> <li>El cliente inicia el proceso para conseguir una concesi\u00f3n inicial.   </li> </ul>"},{"location":"UD5/dhcp/#configuracion-del-servicio-dhcp","title":"Configuraci\u00f3n del servicio DHCP","text":"<p>Antes de configurar un servicio de DHCP se ha de tener una previsi\u00f3n de qu\u00e9 direcciones IP ser\u00e1n asignadas de manera autom\u00e1tica, si hay que reservarlas para futuras ampliaciones o si se realizar\u00e1n rangos de asignaci\u00f3n a determinaros equipos. Con esa informaci\u00f3n disponible es necesario conocer los diferentes elementos que configuran un servidor DHCP:</p> <ul> <li>\u00e1mbito, conjunto de IP que el DHCP gestionar\u00e1. Normalmente est\u00e1 compuesto por todas las IP direccionables de una red o subred.</li> <li>exclusiones, conjunto de IP que no se asignar\u00e1n de forma autom\u00e1tica ya que lo han sido de forma manual.</li> <li>reservas, grupo de IP que no se asignar\u00e1n a pesar de no estar asignadas. Se trata de direcciones que se reservan para futuras ampliaciones de red.</li> </ul>"},{"location":"UD5/dhcp/#instalacion-en-microsoft-windows-server","title":"Instalaci\u00f3n en Microsoft Windows Server","text":"<p>Para la instalaci\u00f3n del servicio DHCP en Microsoft Windows Server , es necesario a\u00f1adir el rol adecuado al servidor. Desde el Administrador del servidor \u2192 Administrar \u2192 Agregar roles y caracter\u00edsticas, se puede lanzar el asistente para a\u00f1adir roles. Tras preguntar que tipo de instalaci\u00f3n y seleccionar el servidor en donde se va a crear el servicio, se elegir\u00e1 la opci\u00f3n \u201cServidor DHCP\u201d que iniciar\u00e1 el proceso. Una vez configurada la instalaci\u00f3n ser\u00e1 necesario configurar el servicio con los datos que antes se ha previsto. Pulsando en \u201cCompletar configuraci\u00f3n de DHCP\u201d se podr\u00e1 indicar con qu\u00e9 credenciales es posible administrar el servicio de DHCP. Es recomendable usar al usuario administrador ya que de esa forma no se necesitar\u00e1 alternar entre sesiones de varios usuarios.</p> <p>Una vez autorizado, aparecer\u00e1 una nueva herramienta con la que se podr\u00e1 administrar el servicio. El uso de esta herramienta es muy intuitivo y, teniendo claro los conceptos especificados al inicio, no habr\u00e1 problema alguno durante su configuraci\u00f3n. Una vez finalizada, cada vez que un equipo se conecte a la red, preguntar\u00e1 al DHCP por una IP para poder navegar a trav\u00e9s de la red.</p> <p>En un equipo el cual tiene asignado una direcci\u00f3n IP a trav\u00e9s de DHCP, puede liberar, renovar o verificar la concesi\u00f3n sin esperara a que el servidor lo haga. En redes peque\u00f1as al liberar la IP de un cliente y su reasignaci\u00f3n, se encontrar\u00e1 que la IP es la misma. Esta situaci\u00f3n es pol\u00edtica del servidor DHCP que trata de asignar la misma IP que la concesi\u00f3n inicial, si es posible.</p> <p>Para liberar una concesi\u00f3n asignada por el servidor</p> <p><code>ipconfig /release</code></p> <p>A partir de este momento el cliente se queda sin asignaci\u00f3n de IP y fuera de la red hasta que se produzca una nueva asignaci\u00f3n.</p> <p>Para renovar una concesi\u00f3n</p> <p><code>ipconfig /renew</code></p> <p>El servidor reasigna una IP si no posee ya una asignada.</p>"},{"location":"UD5/dhcp/#instalacion-en-ubuntu-server","title":"Instalaci\u00f3n en Ubuntu Server","text":"<p>Como viene siendo habitual, ates de instalar un servicio es recomendable comprobar si existen nuevas actualizaciones de software en apt-get.</p> Actualizar el sistema<pre><code>sudo apt upgrade\nsudo apt update\n</code></pre> <p>Tras esto, se proceder\u00e1 a la instalaci\u00f3n de los paquetes requeridos para implementar el servicio de DHCP.</p> Instalar DHCP<pre><code>sudo apt-get install isc-dhcp-server\n</code></pre> <p>Una vez instalado, se editar\u00e1 el archivo de configuraci\u00f3n del servicio con los datos de la planificaci\u00f3n previa. El archivo a editar est\u00e1 situado en <code>/etc/dhcp/dhcpd.conf</code>. Es muy recomendable realizar una copia de seguridad de este fichero antes de continuar.</p> <p>El archivo <code>dhcpd.conf</code> posee numerosas l\u00edneas comentadas, pero tan solo interesan las que hacen referencia al nombre de dominio (domain-name), a las direcciones de los servidores DNS (domain-name-servers) y la configuraci\u00f3n de TTL (default-lease-time). Estas l\u00edneas se completar\u00e1n con la informaci\u00f3n de la que se dispone</p> Configuraci\u00f3n<pre><code># option definitions common to all supported networks...\noption domain-name \"miempresafea.local\";\noption domain-name-servers 192.168.100.100, 8.8.8.8;\n\ndefault-lease-time 600;\nmax-lease-time 7200;\n</code></pre> <p>Tambi\u00e9n en necesario indicar los datos comunes a todos los equipos a los que se le asignar\u00e1 una direcci\u00f3n de IP, es decir, la m\u00e1scara de red, la direcci\u00f3n de difusi\u00f3n y la puerta de enlace.</p> Configuraci\u00f3n<pre><code>option subnet-mask 255.255.255.0;\noption broadcast-address 192.168.100.255;\noption routers 192.168.100.1;\n</code></pre> <p>Una vez hecho, es necesario especificar el rango o rangos disponibles para la asignaci\u00f3n de IP.</p> Configuraci\u00f3n<pre><code>subnet 192.168.100.0 netmask 255.255.255.0 {\nrange 192.168.100.10 192.168.100.100;\nrange 192.168.100.200 192.168.1.250;\n}\n</code></pre> <p>Estas l\u00edneas de texto establecen un \u00e1mbito nuevo (subnet) que ocupa toda la red ya que la m\u00e1scara de subred es 255.255.255.0 en una direcci\u00f3n tipo C. Es posible crear diferentes subredes de asignaci\u00f3n de IP a\u00f1adiendo m\u00e1s l\u00edneas como esta. Adem\u00e1s de establecer el \u00e1mbito de direcciones IP, crea dos rangos de asignaci\u00f3n; el primero desde la IP 10 hasta la 100, y el segundo desde la 200 hasta la 250. Cualquier equipo que solicite una direcci\u00f3n IP a este servidor ofrecer\u00e1 una de cualquiera de estos dos rangos.</p> <p>Por \u00faltimo, para poder reservar IP para un equipo en concreto, al igual que en Microsoft Windows Server 2016, es necesario especificar la direcci\u00f3n MAC (Media Acces Control) junto con su nombre de host y la IP reservada. La direcci\u00f3n del servidor debe ser est\u00e1tica y no debe ser asignada a ning\u00fan otro equipo de la red.</p> <pre><code>host servidorubuntu {\nhardware ethernet 08:00:27:2F:0B:E6\nfixed-address 192.168.100.100\n}\n</code></pre> <p>Si es necesario la reserva de varias IP en este \u00e1mbito, se deber\u00e1 crear varias l\u00edneas como esta con la informaci\u00f3n pertinente. Una vez configurado este fichero, ser\u00e1 necesario reiniciar el servicio DHCP para que los cambios surtan efecto.</p> <pre><code>sudo systemctl isc-dhcp-server (busca el nombre del servicio) restart\n</code></pre> <p>Tambi\u00e9n se pueden utilizar las acciones stop y start para detener e iniciar el servicio respectivamente. Al igual que clientes de Microsoft, desde Ubuntu Server tambi\u00e9n es posible tanto liberar como renovar una direcci\u00f3n IP asignada a trav\u00e9s de DHCP.</p> <pre><code>sudo dhclient -r\nsudo dhclient\n</code></pre> <p>Ejecutando estos comandos en un cliente, el primero liberar\u00e1 la IP asignada y el segundo solicitar\u00e1 al servidor una nueva IP, es decir, la renovar\u00e1.</p>"},{"location":"UD5/dns/","title":"Configuraci\u00f3n de la resoluci\u00f3n de nombres DNS","text":"<p>Todos los equipos configurados con el protocolo TCP/IP tienen una direcci\u00f3n de IP un\u00edvoca que se utiliza para la comunicaci\u00f3n con otros equipos de la red. Para facilitar una comunicaci\u00f3n efectiva y eficiente, los usuarios deben poder referirse a los equipos por un nombre y permitir que su equipo use su direcci\u00f3n de IP de forma transparente ya que es mucho m\u00e1s sencillo de recordar un nombre de equipo que una combinaci\u00f3n de n\u00fameros.</p> <p>En los inicios de ARPANET, el antecesor de la Internet actual, s\u00f3lo exist\u00eda un peque\u00f1o n\u00famero de equipos conectados entre s\u00ed. El Centro de Informaci\u00f3n de Red, ubicado en el Instituto de Investigaciones de Stanford, era el responsable de completar en un \u00fanico archivo denominado hosts.txt los nombres y direcciones de todos los equipos. Los administradores deb\u00edan mandar un mensaje al administrador del archivo, quien actualizaba este fichero. A continuaci\u00f3n, los usuarios de ARPANET deb\u00edan descargar la nueva versi\u00f3n del archivo para poder identificar a los equipos.</p> <p>Resultaba obvio que este m\u00e9todo no permit\u00eda crecer apropiadamente la red ya que cada vez que un equipo se un\u00eda a la red o se produc\u00eda un cambio de nombre, era obligatorio la actualizaci\u00f3n y distribuci\u00f3n del fichero hosts.txt. Otro factor a tener en cuenta es que, al crecer el n\u00famero de equipos, crece el riesgo de a\u00f1adir nombres duplicados, as\u00ed como la dificultad de intentar un control centralizado.</p> <p>La naturaleza de la red estaba cambiando. Los grandes equipos mainframes con que se hab\u00eda construido ARPANET se estaban viendo desplazados por estaciones de trabajo m\u00e1s peque\u00f1as y numerosas que necesitaban un nombre de equipo \u00fanico. Resultaba imposible controlar de forma centralizada de una forma \u00f3ptima.</p> <p>Nacieron las RFC (Request For Comment) 882 y 883, donde se describe el dise\u00f1o de un sistema de nombres de dominio. \u00c9ste estaba basado en una base de datos distribuida que contiene informaci\u00f3n generalizada de recursos. Este dise\u00f1o evolucion\u00f3 al servicio de DNS que se usa en la actualidad.</p> <p>En lo referente a servicios de directorio, el DNS se utiliza para crear un espacio de nombres, que define las reglas para asignar un nombre a un elemento del directorio y c\u00f3mo se resuelve (traduce) un nombre en una direcci\u00f3n IP. Este espacio de nombres est\u00e1 organizado como una base de datos jer\u00e1rquica que, en un servicio de directorio, puede estar o no distribuida.</p> <p>Cada entrada de DNS lleva asociada una determinada informaci\u00f3n. Existen numerosos tipos de registros de recursos definidos en las RFC 1035, 1036 y posteriores, pero la mayor\u00eda de estos registros ya no se usan. Los que ata\u00f1en al servicio de directorio son:</p> <ul> <li>A (Adress) la cual contiene un registro que hace corresponder un nombre de dominio de DNS con una direcci\u00f3n de IPv4 de 32 bits.</li> <li>CNAME (canonical name) que permite a los administradores de red crear un alias de otro nombre de dominio. Por ejemplo, si es necesario cambiar el nombre de intranet.serviciofeo.net a www.serviciofeo.com por cuestiones de legibilidad, se crear\u00eda una entrada CNAME para intranet.serviciofeo.net que apuntase a www.serviciofeo.com. De esta forma un \u00fanico recurso A puede tener diferentes nombres que hacen referencia a una \u00fanica IP.</li> <li>PTR (Pointer Reverse), usado para los mensajes de b\u00fasqueda inversa, conozco la IP del recurso pero no su nombre. Con este tipo de solicitudes el dato devuelto no es la IP, si no el nombre asociado.</li> </ul> <p>Como servicio, se pueden realizar diferentes operaciones:</p> <ul> <li> <p>operaci\u00f3n de solicitud de informaci\u00f3n, un cliente solicita al servicio la informaci\u00f3n sobre un registro. Por ejemplo, cual es el registro A del dominio llamado http://www.dominiofeo.net. El DNS responde a esa solicitud ofreciendo toda la informaci\u00f3n requerida.   </p> </li> <li> <p>solicitud inversa, se produce cuando un cliente solicita el registro de dominio de una cierta direcci\u00f3n IP. Para que el DNS pueda resolver este tipo de solicitudes se debe crear una zona b\u00fasqueda inversa en el servicio. Estas solicitudes no son muy comunes y la creaci\u00f3n de un PTR no es obligatoria.</p> </li> <li>operaci\u00f3n de actualizaci\u00f3n, un cliente env\u00eda una petici\u00f3n al servicio para actualizar, a\u00f1adir o eliminar alguno de los registros de informaci\u00f3n de esa entrada.</li> </ul>"},{"location":"UD5/dns/#cache-dns","title":"Cach\u00e9 DNS","text":"<p>La informaci\u00f3n contenida en este servicio no suele variar en el tiempo. En efecto, los datos de nombres de un directorio no suelen modificarse con demasiada regularidad. Por ese motivo, y con el objetivo de reducir el tr\u00e1fico de red, cada uno de los clientes posee una cach\u00e9 de DNS. En esta cach\u00e9 cada cliente guardar\u00e1 todas las solicitudes que ha ido realizando para evitar volver a realizarlas. Cada informaci\u00f3n solicitada posee un atributo denominado TTL (Time To Live), que indica la duraci\u00f3n que este registro permanece en la cach\u00e9 del cliente. Transcurridos los segundos indicados en este registro, esa informaci\u00f3n se elimina.</p> <p>Del mismo modo, existe una cach\u00e9 negativa encargada de almacenar los intentos fallidos de solicitud de informaci\u00f3n. Si se vuelve a demandar informaci\u00f3n sobre el mismo registro en un tiempo menor que el TTL, ser\u00e1 resuelta de forma autom\u00e1tica por la cach\u00e9 negativa sin consultar al servicio de DNS.</p> <p>Muchos de los errores de resoluci\u00f3n de DNS son producidos por que los datos de la cach\u00e9 de DNS no est\u00e1n actualizados. Quiz\u00e1s se ha producido un error a la hora de guardar un registro en la cach\u00e9 o sencillamente la relaci\u00f3n nombre-IP ha cambiado y todav\u00eda no se ha reflejado en la cach\u00e9, ya que no se ha cumplido el TTL. En estas ocasiones ser\u00e1 recomendable actualizarla o simplemente eliminarla para obligar al cliente a volver a solicitar la informaci\u00f3n al servidor.</p> <p>El comando a usar en sistemas operativos de la familia de Microsoft es ipconfig, con las siguientes opciones: \u2022 <code>/displaydns</code>, muestra la informaci\u00f3n que reside en la cach\u00e9 del cliente. \u2022 <code>/registerdns</code>, renueva la informaci\u00f3n de la cach\u00e9 as\u00ed como la concesi\u00f3n DHCP. \u2022 <code>/flushdns</code>, encargada de eliminar toda informaci\u00f3n contenida en la cach\u00e9, lo que obliga a preguntar de nuevo al servidor de DNS.</p> <p>En los sistemas operativos GNU/Linux, el comando a utilizar para comprobar la configuraci\u00f3n de la cach\u00e9 DNS es <code>nscd</code>. Por desgracia no en todas las distribuciones se instala por defecto, y Ubuntu Server es una de ellas. Este software permite gestionar no s\u00f3lo la cach\u00e9 del servicio DNS, sino cualquier cach\u00e9 que el cliente est\u00e9 manejando; servicios, contrase\u00f1as cifradas, informaci\u00f3n de grupos de usuarios locales y de red. Se instala a trav\u00e9s del siguiente comando:</p> Instalaci\u00f3n de paquete nscd<pre><code>sudo apt install nscd\n</code></pre> <p>Una vez instalado, estas son las opciones que ata\u00f1en a esta secci\u00f3n:</p> <ul> <li><code>-g</code>, muestra la informaci\u00f3n de todos los tipos de cach\u00e9 que gestiona esta aplicaci\u00f3n.</li> <li><code>-i</code> hosts, elimina la informaci\u00f3n de cach\u00e9 DNS del cliente.</li> </ul>"},{"location":"UD5/dns/#configuracion-del-servicio-dns","title":"Configuraci\u00f3n del servicio DNS","text":"<p>Durante la creaci\u00f3n del directorio, se ha de crear como m\u00ednimo un espacio de nombres el cual debe ser controlado por un servicio de DNS. Para que las solicitudes se resuelvan de forma correcta ser\u00e1 necesario la configuraci\u00f3n de dos zonas de b\u00fasqueda:</p> <ul> <li>una zona de b\u00fasqueda directa, la cual devuelve una direcci\u00f3n IP cuando se les proporciona un nombre DNS. Estas zonas se crean autom\u00e1ticamente cuando instalamos el controlador de dominio.</li> <li>una zona de b\u00fasqueda inversa que asigna un nombre DNS a una direcci\u00f3n IP. Es importante destacar que estas zonas no se crean autom\u00e1ticamente en algunas versiones de servicios de directorio, y si es necesaria su creaci\u00f3n, habr\u00e1 que hacerlo de forma manual.</li> </ul> <p>La configuraci\u00f3n de estas zonas, as\u00ed como la creaci\u00f3n de nuevas, est\u00e1n disponibles a trav\u00e9s de la herramienta Administrador del servidor \u2192 Herramientas \u2192 DNS</p> <p>Para crear nuevas zonas de b\u00fasqueda, ser\u00e1 necesario navegar hasta el lugar donde se requiera la creaci\u00f3n de la nueva entrada y pulsar el bot\u00f3n derecho o bien a trav\u00e9s del men\u00fa Acci\u00f3n. Cualquiera de estas opciones dan acceso a crear nuevos host (A), alias (CNAME), intercambio de correo (si se dispusiera del servicio de correo), una nueva delegaci\u00f3n o dominio, entre otras acciones.</p> <p>Salvo en condiciones especiales, ser\u00e1 el propio controlador de dominio el que se encargue de gestionar el servicio de DNS. Cada vez que se actualiza la informaci\u00f3n del directorio, se a\u00f1aden, modifican o eliminan las entradas en el DNS. Se dejar\u00e1 la tarea de gesti\u00f3n en manos del servidor por tanto. No obstante es recomendable conocer el procedimiento para gestionar este servicio.</p>"},{"location":"UD5/dns/#uso-de-dns-en-entornos-ad-windows-o-samba","title":"Uso de DNS en entornos AD (Windows o Samba)","text":"<ul> <li>El DC (Windows o Samba AD DC) debe ser el servidor DNS principal para s\u00ed mismo y para los clientes. No pongas 8.8.8.8 como primario; si necesitas salida a Internet, define reenviadores en el propio DC.</li> <li>En el DC Samba: usa su DNS interno y config\u00faralo como reenviador hacia los DNS externos. En <code>/etc/samba/smb.conf</code>, secci\u00f3n <code>[global]</code>, a\u00f1ade por ejemplo <code>dns forwarder = 1.1.1.1</code>.</li> <li>En el propio DC Ubuntu apunta el DNS a s\u00ed mismo: en <code>/etc/netplan/*.yaml</code> (o NetworkManager) define <code>nameservers: [127.0.0.1]</code> o la IP interna del DC. En la UD4 se desactiva <code>systemd-resolved</code> y se fija <code>/etc/resolv.conf</code>; si sigues ese esquema, usa 127.0.0.1 y la IP del DC, pero evita que un DNS p\u00fablico quede primero. Alternativamente, puedes dejar <code>systemd-resolved</code> activo apuntando al DC.</li> <li>En clientes Ubuntu que se unan al dominio (SSSD/realmd): apunta el DNS al DC (Windows o Samba) y comprueba con <code>resolvectl status</code> y <code>dig _ldap._tcp.tu-dominio SRV</code> antes de <code>realm join</code>.</li> </ul> <p>Ejemplo de netplan (sustituye la interfaz y la IP del DC):</p> <pre><code>network:\n  version: 2\n  ethernets:\n    ens33:\n      addresses: [10.0.3.3/24]\n      gateway4: 10.0.3.1\n      nameservers:\n        addresses: [10.0.3.3]   # IP del DC (o 127.0.0.1 si es el propio DC)\n</code></pre>"},{"location":"UD5/dns/#notas-sobre-etcresolvconf-e-inmutabilidad","title":"Notas sobre <code>/etc/resolv.conf</code> e inmutabilidad","text":"<ul> <li>Si cambias <code>/etc/resolv.conf</code> a mano, netplan o systemd-resolved lo reescriben. Por eso en la UD4 se marcaba inmutable. Alternativa m\u00e1s limpia: deja el enlace simb\u00f3lico de <code>/etc/resolv.conf</code> al stub de systemd-resolved y configura los DNS en netplan apuntando al DC; as\u00ed persiste sin necesidad de <code>chattr +i</code>.</li> <li><code>dns forwarder</code> en <code>smb.conf</code> debe apuntar a un DNS externo (ISP, 1.1.1.1, 8.8.8.8) que el DC usar\u00e1 como reenviador para dominios fuera del AD. No pongas aqu\u00ed la IP del DC ni de otros DC del mismo dominio.</li> </ul> <p>En Ubuntu Server la gesti\u00f3n se realiza a trav\u00e9s de <code>samba-tool dns</code>.</p> Comando<pre><code>samba-tool dns serverinfo miempresafea.local\n</code></pre> <p>se puede acceder a la informaci\u00f3n del servidor. De este mismo modo se dispone de modificadores para la gesti\u00f3n del mismo. Recuerda consultar la ayuda del comando para obtener m\u00e1s informaci\u00f3n, en concreto, esta:</p> Ayuda del comando<pre><code>samba-tool dns \u2013help\nUsage: samba-tool dns &lt;subcommand&gt;\n\nDomain Name Service (DNS) management.\n\n\nOptions:\n  -h, --help  show this help message and exit\n\n\nAvailable subcommands:\n  add         - Add a DNS record\n  delete      - Delete a DNS record\n  query       - Query a name.\n  roothints   - Query root hints.\n  serverinfo  - Query for Server information.\n  update      - Update a DNS record\n  zonecreate  - Create a zone.\n  zonedelete  - Delete a zone.\n  zoneinfo    - Query for zone information.\n  zonelist    - Query for zones.\nFor more help on a specific subcommand, please type: samba-tool dns &lt;subcommand&gt; (-h|--help)\n</code></pre> <p>Por ejemplo, es posible obtener informaci\u00f3n de las zonas creadas con el siguiente comando:</p> zonas creadas<pre><code>samba-tool dns zonelist miempresafea.local\n2 zone(s) found\n\n  pszZoneName      : miempresafea.local\n  Flags            : DNS_RPC_ZONE_DSINTEGRATED DNS_RPC_ZONE_UPDATE_SECURE\n  ZoneType         : DNS_ZONE_TYPE_PRIMARY\n  Version          : 50\n  dwDpFlags        : DNS_DP_AUTOCREATED DNS_DP_DOMAIN_DEFAULT DNS_DP_ENLISTED\n  pszDpFqdn        : DomainDnsZones.miempresafea.local\n   pszZoneName      : _msdcs.miempresafea.local\n  Flags            : DNS_RPC_ZONE_DSINTEGRATED DNS_RPC_ZONE_UPDATE_SECURE\n  ZoneType         : DNS_ZONE_TYPE_PRIMARY\n  Version          : 50\n  dwDpFlags        : DNS_DP_AUTOCREATED DNS_DP_FOREST_DEFAULT DNS_DP_ENLISTED\n  pszDpFqdn        : ForestDnsZones.miempresafea.local\n</code></pre> <p>Por defecto, Samba no crea la zona de b\u00fasqueda inversa. Es posible crear esa zona gracias al siguiente comando:</p> b\u00fasqueda inversa<pre><code>samba-tool dns zonecreate miempresafea.local 0.0.10.in-addr.arpa\n</code></pre> <p>Si todo ha ido de forma correcta, al volver a listar las zonas disponibles en nuestro servidor, la informaci\u00f3n mostrar\u00e1 una nueva</p> Zonas disponibles<pre><code>samba-tool dns zonelist miempresafea.local\n  3 zone(s) found\n\n  pszZoneName      : 0.0.10.in-addr.arpa\n  Flags            : DNS_RPC_ZONE_DSINTEGRATED DNS_RPC_ZONE_UPDATE_SECURE\n  ZoneType         : DNS_ZONE_TYPE_PRIMARY\n  Version          : 50\n  dwDpFlags        : DNS_DP_AUTOCREATED DNS_DP_DOMAIN_DEFAULT DNS_DP_ENLISTED\n  pszDpFqdn        : DomainDnsZones.miempresafea.local\n\n  pszZoneName      : miempresafea.local\n  Flags            : DNS_RPC_ZONE_DSINTEGRATED DNS_RPC_ZONE_UPDATE_SECURE\n  ZoneType         : DNS_ZONE_TYPE_PRIMARY\n  Version          : 50\n  dwDpFlags        : DNS_DP_AUTOCREATED DNS_DP_DOMAIN_DEFAULT DNS_DP_ENLISTED\n  pszDpFqdn        : DomainDnsZones.miempresafea.local\n\n  pszZoneName      : _msdcs.miempresafea.local\n  Flags            : DNS_RPC_ZONE_DSINTEGRATED DNS_RPC_ZONE_UPDATE_SECURE\n  ZoneType         : DNS_ZONE_TYPE_PRIMARY\n  Version          : 50\n  dwDpFlags        : DNS_DP_AUTOCREATED DNS_DP_FOREST_DEFAULT DNS_DP_ENLISTED\n  pszDpFqdn        : ForestDnsZones.miempresafea.local\n</code></pre> <p>De este modo es posible administrar los elementos que conforman el servidor DNS de Samba. Es conveniente familiarizarse con las acciones de a\u00f1adir, eliminar o actualizar la informaci\u00f3n de este servicio.</p>"},{"location":"UD6/Actividades/","title":"Actividades de la UD6","text":""},{"location":"UD6/Actividades/#actividad-1","title":"Actividad 1","text":"<ol> <li>Es hora de retomar la empresa que creaste en una unidad pasada. Crea las cuentas de usuario necesarias para gestionarla en ServidorWindows. Deber\u00e1s crear una cuenta de usuario por departamento, que actuar\u00e1 como responsable de ese departamento. Utiliza datos inventados para la informaci\u00f3n personal. Puedes usar esta web para obtener datos personales ficticios: https://www.generatedata.com. Haz pruebas de inicio de sesi\u00f3n en alg\u00fan cliente para comprobar que las cuentas funcionan. Redacta un documento con los pasos que sigues ara realizar esta tarea, tan s\u00f3lo ser\u00e1 necesario la descripci\u00f3n de un usuario.</li> <li>Crea esa estructura de usuarios en ServidorUbuntu pero en esta ocasi\u00f3n a trav\u00e9s de CLI con el comando samba-tool user. Crea tan s\u00f3lo las cuentas de los usuarios responsables de cada departamento. Prueba que las cuentas funcionan de forma correcta. Anota los pasos y los comandos necesarios para realizar esta tarea (es suficiente con detallar la creaci\u00f3n de un usuario de cada tipo de cuenta).</li> </ol>"},{"location":"UD6/Actividades/#actividad-2","title":"Actividad 2","text":"<ol> <li>Crea el resto de cuentas de usuario necesarias para gestionar tu empresa. Utiliza plantillas de usuario para crear tres empleados por departamento en ServidorWindows. Las cuentas creadas deben tener las siguientes caracter\u00edsticas:<ol> <li>todas las cuentas deben cambiar su contrase\u00f1a al primer inicio</li> <li>la mitad de los departamentos (a tu discreci\u00f3n) s\u00f3lo podr\u00e1n iniciar sesi\u00f3n en CW1001 y la otra mitad en CW1002</li> <li>la mitad de los departamentos tendr\u00e1 horario de ma\u00f1ana (de 8 a 15) y la otra mitad en horario de tarde (de 15 a 22)</li> <li>el departamento de TIC tendr\u00e1 acceso a cualquier equipo en cualquier horario</li> <li>Prueba a iniciar sesi\u00f3n con diferentes usuarios en diferentes clientes.</li> </ol> </li> <li>Desde la directiva de contrase\u00f1as en ServidorWindows (en el panel de control de GPO) configura las contrase\u00f1as para que:<ol> <li>el historial de contrase\u00f1as sea de tres contrase\u00f1as guardadas</li> <li>que la vigencia m\u00e1xima de contrase\u00f1a sea de 10 d\u00edas y la m\u00ednima sea de 3 d\u00edas</li> <li>la longitud m\u00ednima de la contrase\u00f1a sea de 5 caracteres</li> <li>las contrase\u00f1as no deben cumplir los requerimientos de complejidad</li> </ol> </li> <li>Configura las cuentas de usuario de responsables de departamento en ServidorWindows para que al inicio de sesi\u00f3n se ejecute el script <code>inicio.bat</code>. De nuevo, deber\u00e1s modificar la plantilla necesaria. El script lo encontrar\u00e1s en el Moodle del m\u00f3dulo.</li> <li>Configura las cuentas de usuario de responsables de departamento en ServidorUbuntu para que al inicio de sesi\u00f3n se ejecute el script <code>inicio.sh</code>.</li> <li>Tambi\u00e9n desde el panel de control de GPO, cambia las directivas de bloqueode este modo:<ol> <li>el umbral de bloqueo de cuentas a tres</li> <li>la duraci\u00f3n del bloqueo es de 2 minutos</li> <li>el reestablecimiento de cuentas despu\u00e9s del bloqueo a un minuto. \u00bfQu\u00e9 ocurre si este valor es superior al del punto anterior?</li> <li>Comprueba que las configuraciones son correctas haciendo intentos de inicio de sesi\u00f3n incorrectos.</li> </ol> </li> <li> <p>Utilizando el comando chage en ServidorUbuntu, crea las cuentas de los usuarios que pertenecen a cada departamento (m\u00ednimo una por departamento) que tengan estas limitaciones:</p> <ol> <li>el usuario debe cambiar su contrase\u00f1a en el siguiente inicio de sesi\u00f3n</li> <li>que las cuentas de estos usuarios caducan a los 180 d\u00edas</li> <li>el usuario no podr\u00e1 cambiar la contrase\u00f1a hasta que no transcurran 7 d\u00edas desde la \u00faltima vez que la modific\u00f3</li> <li>cualquier usuario debe cambiar su contrase\u00f1a transcurridos 30 d\u00edas</li> <li>el sistema avisar\u00e1 con una semana de antelaci\u00f3n del cambio de contrase\u00f1a</li> </ol> </li> <li> <p>Configura un perfil m\u00f3vil para los responsables de departamento creados con anterioridad. Usa la carpeta denominada Perfiles en ServidorWindows que contendr\u00e1 los perfiles m\u00f3viles de los usuarios. Deber\u00e1s crear esa carpeta y asignar los permisos adecuados seg\u00fan se ha explicado en clase.</p> </li> <li>Configura el perfil m\u00f3vil para los responsables de departamento en ServidorUbuntu. Usa la carpeta Perfiles de igual modo que en ServidorWindows. Comprueba que la configuraci\u00f3n es correcta y documenta el proceso.</li> <li>Los usuarios que no sean responsables de departamento, deben disponer de un lugar seguro para almacenar sus documentos. Configura una carpeta personal para cada uno de ellos. Para ello ser\u00e1 necesario modificar las plantillas de usuario creadas con anterioridad. Esta carpeta ser\u00e1 tendr\u00e1 la unidad de red X:\\ conectada en cada inicio de sesi\u00f3n. Crea la carpeta Datos en el servidor para contener estos directorios.</li> <li>Crea para cada uno de los usuarios una carpeta personal en<code>/home/tu_dominio_empresa/%USER%/Datos</code>. Esta carpeta ser\u00e1 montada al inicio del sistema en el directorio Datos situado en el escritorio del usuario actual (modifica el fichero <code>/etc/fstab</code>).</li> </ol>"},{"location":"UD6/Actividades/#actividad-3-refuerzo","title":"Actividad 3. Refuerzo","text":"<ol> <li>Accede a la herramienta de pol\u00edticas de grupo a trav\u00e9s de Herramientas \u2192 Pol\u00edticas de grupo. Desde all\u00ed Default Domain Policy \u2192 Edit... \u2192 Configuraci\u00f3n del equipo \u2192 Directivas \u2192 Configuraci\u00f3n de Windows \u2192 Configuraci\u00f3n de seguridad. Sigue estos pasos para configurar las directivas de contrase\u00f1as:</li> <li>En Exigir historial de contrase\u00f1as cambia el valor a tres. \u00bfQu\u00e9 quiere decir esta configuraci\u00f3n?</li> <li>En Vigencia m\u00e1xima de la contrase\u00f1a introduce diez d\u00edas</li> <li>En Vigencia m\u00ednima de la contrase\u00f1a introduce tres d\u00edas</li> <li>\u00bfQu\u00e9 pasar\u00e1 al cuarto d\u00eda seg\u00fan la configuraci\u00f3n que acabas de poner?. \u00bfQue quieren decir estos dos umbrales?.</li> <li>En Longitud m\u00ednima de la contrase\u00f1a pon tres caracteres.Deshabilita Las contrase\u00f1as deben cumplir los requerimientos de complejidad. Ten en cuenta que habilitar esta directiva ser\u00eda contradictorio con el paso anterior. \u00bfCu\u00e1les son esos requisitos de complejidad?. \u00bfSe pueden cambiar?.</li> <li>Almacenar contrase\u00f1as usando cifrado reversible d\u00e9jalo deshabilitado. \u00bfQu\u00e9 quiere decir esta configuraci\u00f3n?. \u00bfEs compatible con la Ley Org\u00e1nica de Protecci\u00f3n de Datos y porqu\u00e9?.       Haz pruebas para cambiar contrase\u00f1as a usuarios del dominio con las nuevas restricciones para comprobar que funcionan.</li> <li>Se necesita configurar los perfiles m\u00f3viles a los miembros del departamento de Ventas, ya que no disponen de ordenador fijo y es conveniente que tengan acceso a todo su perfil desde cualquier equipo del dominio. Para ello, y desde Herramientas \u2192 Usuarios y equipos de Active Directory, accede a las propiedades de los usuarios y configura las opciones de los miembros del departamento Ventas de la siguiente manera:<ol> <li>en ServidorWindows crea una carpeta con el nombre Perfiles (en la ra\u00edz de C:), aqu\u00ed colocaremos las carpetas de los perfiles m\u00f3viles de cada usuario.</li> <li>comparte la carpeta y aseg\u00farate que el grupo Todos tenga permisos de lectura y modificaci\u00f3n en esta carpeta, tanto en la pesta\u00f1a Compartir como en la de Seguridad</li> <li>abre las propiedades de un usuario del departamento de Ventas y en la ficha perfiles introduce la siguiente ruta del perfil: <code>\\\\NombredelControladorDominio\\perfiles\\%UserName%</code></li> <li>inicia sesi\u00f3n en un equipo cliente con estos usuarios y comprueba que la configuraci\u00f3n funciona</li> <li>\u00bfQu\u00e9 es un perfil local?. \u00bfEs una buena configuraci\u00f3n para un dominio?. \u00bfQu\u00e9 es un perfil m\u00f3vil?. \u00bfPresenta alguna ventaja o inconveniente con respecto a los perfiles locales?. \u00bfCu\u00e1les?.</li> </ol> </li> </ol>"},{"location":"UD6/Actividades/#actividad-4-ampliacion","title":"Actividad 4. Ampliaci\u00f3n","text":"<ol> <li>Desde un cliente con el sistema operativo Microsoft Windows, instala el programa RSAT y administra el servidor UbuntuServer para crear tres usuarios en ese controlador. Estos usuarios estar\u00e1n en un nuevo departamento denominado Programaci\u00f3n que depender\u00e1 de TIC. Crea la estructura que estimes oportuna para a\u00f1adir esta configuraci\u00f3n.</li> <li>Elabora un documento con una introducci\u00f3n al sistema de inicio de sesi\u00f3n PAM para sistemas operativos GNU/Linux. Activa los m\u00f3dulos PAM en UbuntuServer para que:<ol> <li>s\u00f3lo los grupos creados en del dominio puedan iniciar sesi\u00f3n (a trav\u00e9s de sus gid)</li> <li>establece que las contrase\u00f1a de usuario deben tener una longitud de diez caracteres y tendr\u00e1n tres reintentos de inicio de sesi\u00f3n. Al cuarto se bloquear\u00e1 la sesi\u00f3n.</li> <li>si cambian la contrase\u00f1a, esta deber\u00e1 tener, al menos, cinco caracteres deferentes a la anterior</li> </ol> </li> <li>Configura un perfil obligatorio para de ServidorWindows. Comprueba que la configuraci\u00f3n es correcta creando un nuevo usuario y documenta el proceso como de costumbre.</li> </ol> <p>Manera de entrega de las actividades</p> <p>Redacta una gu\u00eda de los pasos a seguir para realizar esta actividad y s\u00fabela al Moodle del m\u00f3dulo.   De tal forma que en cada uno de los pasos incluya una imagen que verifique que se ha realizado aquello que se pide en cada uno de los ejercicios. Como en las anteriores actividades</p> <p>Warning</p> <p>SOLO LAS ACTIVIDADES 1,2 SON OBLIGATORIAS.</p>"},{"location":"UD6/adminUsers/","title":"Administraci\u00f3n de usuarios","text":"<p>Los objetos son el contenido de un directorio. Componen la estructura organizativa del dominio y la relaci\u00f3n entre ellos dictar\u00e1 su funcionamiento. Los objetos de los que dispone Active Directory son multitud, pero este apartado tan solo har\u00e1 referencia los usuarios y cuentas.</p> <p>Cada usuario que tenga acceso al dominio requerir\u00e1 una cuenta de usuario. Esta cuenta lo identifica como miembro del dominio y le otorga una serie de privilegios para poder interactuar con el resto de objetos del dominio. Posibilita tres acciones b\u00e1sicas:</p> <ul> <li>autentificar la identidad de la persona que se conecta al directorio.</li> <li>controlar el acceso a los recursos del dominio.</li> <li>auditar las acciones realizadas.</li> </ul> <p>Todos estos objetos se gestionan desde la herramienta Administrador del servidor \u2192 Herramientas \u2192 Usuarios y equipos de Active Directory. Esta utilidad incluye una barra de herramientas especializada que proporciona acceso instant\u00e1neo a las funciones m\u00e1s com\u00fanmente utilizadas y una barra de descripci\u00f3n que proporciona informaci\u00f3n sobre de estado del objeto. Tambi\u00e9n muestra las acciones que se pueden realizar sobre cada objeto en el men\u00fa Acci\u00f3n una vez que se ha seleccionado el objeto.</p> <p></p> <p>Los objetos m\u00e1s representativos de un directorio son los siguientes:</p> <ul> <li>dominio, objeto ra\u00edz que identifica el dominio que est\u00e1 administrando actualmente.</li> <li>unidad organizativa, contenedor utilizado para crear agrupaciones l\u00f3gicas de objetos de equipo, de usuario y de grupo.</li> <li>usuario, representa un usuario de la red, tanto f\u00edsico como l\u00f3gico, y funciona como un almac\u00e9n de informaci\u00f3n de identificaci\u00f3n y de autenticaci\u00f3n.</li> <li>grupo, objeto contenedor que a\u00fana a varios objetos de usuario. Un objeto grupo tan s\u00f3lo puede estar formado por objetos usuario y de grupo. Supone uno de los pilares b\u00e1sicos para la administraci\u00f3n de los permisos, como se tratar\u00e1 en lo sucesivo.</li> <li>equipo, cada uno de los equipos de la red que proporciona la cuenta de m\u00e1quina necesaria para que el sistema inicie sesi\u00f3n en el dominio.</li> <li>contacto, representa un usuario externo al dominio para prop\u00f3sitos espec\u00edficos. No proporciona las credenciales necesarias para iniciar sesi\u00f3n en el dominio, es decir, no es posible autentificarse con un contacto en el dominio.</li> <li>unidad organizativa, objeto contenedor que representa una agrupaci\u00f3n l\u00f3gica de usuarios, equipos u otros grupos, incluso los tres a la vez.</li> </ul> <p>Se puede utilizar el complemento Usuarios y equipos de Active Directory para administrar cualquier dominio de la red. Para cambiar el dominio que se muestra en el administrador, hay que resaltar la ra\u00edz o el objeto dominio en el \u00e1rbol de la consola y escoger Cambiar dominio... con el dominio en el men\u00fa Acci\u00f3n. Esto muestra el cuadro de di\u00e1logo donde se puede introducir el nombre del dominio o buscar. </p>"},{"location":"UD6/carpetasUsers/","title":"Carpetas personales. Redireccionamiento de las carpetas de usuario","text":"<p>Los directorios o carpetas personales son almacenes que proporciona un servidor para los documentos de los usuarios. Situar las carpetas personales de este modo tiene varias ventajas:</p> <ul> <li>la copia de seguridad de los documentos de usuario est\u00e1 centralizada.</li> <li>los usuarios pueden acceder a sus directorios principales desde cualquier equipo cliente.</li> <li>se puede acceder a los directorios principales desde clientes que ejecuten cualquier sistema operativo.</li> <li>los contenidos no son parte de los perfiles de usuario, por lo que no afectan al tr\u00e1fico de la red durante el inicio de sesi\u00f3n.</li> </ul> <p>Para realizar esta tarea es necesario compartir una carpeta y asignar esa carpeta a cada usuario. </p> <p>En Microsoft Windows Server se accede a trav\u00e9s de la ficha de usuario y se introduce la ruta de la carpeta seg\u00fan el espacio de nombres del servidor. Un aspecto a tener en cuenta es que, si queremos que una carpeta compartida no se muestre cuando cualquier otro usuario del sistema obtenga la lista de carpetas compartidas por el servidor, deberemos a\u00f1adir el car\u00e1cter '$' al final.</p> <p>En sistemas de la familia de Microsoft, existe un sistema de nomenclatura de recursos de red basado en un espacio de nombres com\u00fan. Su formato es el siguiente:</p> <p><code>\\\\equipo\\carpeta_contenedora\\carpeta_compartida</code></p> <p>En donde:</p> <ul> <li>equipo es el nombre del ordenador que contiene la carpeta.</li> <li>carpeta_contenedora representa el nombre del recurso de red compartido, no de la carpeta. Si durante el proceso de compartir la carpeta no se ha modificado, ser\u00e1 el mismo, pero es posible que tenga un nombre diferente.</li> <li>carpeta_compartida es el nombre que se le asigna a la carpeta del usuario. La carpeta que realmente contendr\u00e1 sus datos y que estar\u00e1 dentro del recurso compartido que act\u00faa como contenedor.</li> </ul> <p>Una vez asignada una letra de unidad de red, cuando el usuario inicie sesi\u00f3n aparecer\u00e1 un nuevo volumen en su sistema de archivos con la mencionada letra y apuntando a la carpeta compartida del servidor.</p> <p>Toda esta configuraci\u00f3n tambi\u00e9n es posible realizarla a trav\u00e9s de una directiva de grupo que desv\u00ede el almacenamiento desde las carpetas predeterminadas hasta la carpeta de red adecuada. Pero esta opci\u00f3n se abordar\u00e1 en unidades posteriores.</p> <p>En sistemas operativos basados en GNU/Linux ser\u00e1 necesario el uso del sistema de ficheros nfs, como ya se ha abordado en el punto anterior.</p>"},{"location":"UD6/direcSegLocal/","title":"Directivas de seguridad locales","text":"<pre><code>     7.5  Directivas de seguridad locales\n</code></pre> <p>Las directivas de seguridad son reglas que los administradores pueden configurar en un equipo con el objetivo de proteger sus recursos. Estas directivas forman parte las configuraciones de seguridad de las GPO (Group Policy Objetc) o pol\u00edticas de grupo, que ser\u00e1n analizadas en detalle en lo sucesivo. La configuraci\u00f3n de directivas de seguridad puede controlar:</p> <ul> <li>autenticaci\u00f3n de usuario para una red o dispositivo.</li> <li>los recursos a los que los usuarios pueden tener acceso.</li> <li>la opci\u00f3n de registrar las acciones de un usuario o grupo en el registro de eventos.</li> <li>la pertenencia a un grupo.</li> </ul> <p>Para administrar las directivas de seguridad se usar\u00e1 la herramienta Inicio \u2192 Herramientas administrativas  \u2192 Directiva de seguridad local la cual permitir\u00e1 modificar numerosas opciones de seguridad tales como:</p> <ul> <li> <p>directivas de cuenta, se definen en el mismo equipo y afectan a la forma en que las cuentas de usuario pueden interactuar con \u00e9l. Incluyen los siguientes tipos de directivas:</p> <ul> <li>directiva de contrase\u00f1as, determinan la configuraci\u00f3n de contrase\u00f1as, como la duraci\u00f3n y la aplicaci\u00f3n.</li> <li>directiva de bloqueo de la cuenta, especifican las condiciones y el tiempo que se bloquear\u00e1 una cuenta del sistema.</li> <li>directiva Kerberos, se usan para delimitar la configuraci\u00f3n relacionada con Kerberos, como la duraci\u00f3n y aplicaci\u00f3n de un ticket de acceso.</li> </ul> </li> <li> <p>directivas locales, incluyen los siguientes tipos de configuraci\u00f3n de directiva:</p> <ul> <li>directiva de auditor\u00eda, detalla la configuraci\u00f3n de seguridad que controla el registro de eventos de seguridad y especifica qu\u00e9 tipos de eventos de seguridad se registran.</li> <li>asignaci\u00f3n de derechos de usuario, enumera los usuarios o grupos que tienen derechos de inicio de sesi\u00f3n o privilegios sobre un dispositivo.</li> <li>opciones de seguridad, establece la configuraci\u00f3n de seguridad para el equipo, como los nombres de administrador y de cuenta de invitado, el acceso a unidades de almacenamiento, la instalaci\u00f3n de controladores, el inicio de sesi\u00f3n, etc\u00e9tera.</li> </ul> </li> <li> <p>firewall de Windows con seguridad avanzada, utilizado para proteger el dispositivo de la red mediante el uso de un cortafuegos.</p> </li> <li>directivas de restricci\u00f3n de software, usada para identificar el software y controlar su capacidad para ejecutarse.</li> <li>directivas de control de aplicaciones, controla qu\u00e9 usuarios o grupos pueden ejecutar determinadas aplicaciones.</li> <li>directivas de seguridad IP en el equipo local, garantiza las comunicaciones privadas, seguras, a trav\u00e9s de redes IP mediante el uso de servicios criptogr\u00e1ficos de seguridad (Ipsec).</li> </ul> <p>En cualquier caso, estas pol\u00edticas se aplican a un equipo en concreto y son \u00fatiles para \u00e9l, pero es necesario recordar que estos equipos se encuentran ubicados en un entorno de directorio y, que las pol\u00edticas de seguridad generales para \u00e9l no solo se realizan a trav\u00e9s de estas directivas, sino a trav\u00e9s de la GPO (Group Policy Objetc). Estas GPO se configuran en el controlador del dominio y, si alguna de estas directivas de seguridad locales contradice a una pol\u00edtica de grupo del servidor, ser\u00e1 \u00e9sta \u00faltima la que prevalezca en aras de aplicar una seguridad com\u00fan al directorio.</p> <p>Este es el causante por el cual, en un controlador de dominio, no se puedan modificar directamente las directivas de seguridad locales, sino que se debe realizar a trav\u00e9s de las GPO, ya que de este modo afectar\u00e1n a todo el dominio y no tan solo a un equipo. </p> <p>Para configurar las directivas de seguridad locales en Microsoft Windows Server se realiza a trav\u00e9s de Administrador del servidor \u2192 Herramientas \u2192 Administraci\u00f3n de directivas de grupo. Una vez abierta, dentro del dominio y de la carpeta Objetos de directiva de grupo, se podr\u00e1n configurar las directivas locales bien para los controladores de dominio o bien para todo el dominio.</p> <p></p> <p>En sistema operativos basados en GNU/Linux estas directivas se encuentran repartidas en varios ficheros que el administrador deber\u00e1 conocer, aunque el m\u00e1s importante de ellos es /etc/login.defs el cual establece el conjunto de normas de seguridad que se han de cumplir cuando se crea un usuario. Toda la informaci\u00f3n referida al usuario de sistemas locales se encuentra contenida entre los siguientes archivos:</p> <ul> <li><code>/etc/passwd</code>, que ofrece informaci\u00f3n sobre usuarios.</li> <li><code>/etc/group</code>, que contiene informaci\u00f3n sobre grupos y los usuarios que los forman.</li> <li><code>/etc/shadow</code>, que dispone de las contrase\u00f1as cifradas de los usuarios.</li> <li><code>/etc/gshadow</code>, en el que se encuentran las contrase\u00f1as cifradas de los grupos, aunque en realidad este fichero no suele utilizarse.</li> <li><code>/etc/login.defs</code>, contiene las normas que todo usuario cumplir\u00e1 al crear su cuenta en este equipo.</li> </ul> <p>No es recomendable la modificaci\u00f3n de estos archivos de forma manual ya que poseen una estructura muy r\u00edgida y cualquier fallo en su edici\u00f3n dar\u00eda como resultado que el usuario no se reconociera en el sistema. La mejor opci\u00f3n para modificar estos archivos son los comandos <code>useradd, usermod, userdel, groupadd, groupmod, groupdel, adduser, deluser y passwd</code>.</p> <p>La excepci\u00f3n a la norma es el fichero <code>/etc/login.defs</code> el cual contiene todas las caracter\u00edsticas que se le dan a un usuario en la hora de su creaci\u00f3n. Entre otras, es conveniente familiarizarse con:</p> <ul> <li><code>CREATE_HOME</code>, indica si es necesario crear el directorio /home del usuario. En determinados escenarios puede ser interesante que algunos usuarios no tengan esta carpeta</li> <li><code>DEFAULT_HOME</code>, especifica el lugar en donde se crear\u00e1 la carpeta /home de ese usuario. Es posible que se encuentre en un recurso compartido en la red o en otra ubicaci\u00f3n.</li> <li><code>LOGIN_RETRIES</code>, determina el n\u00famero m\u00e1ximo de reintentos tras una contrase\u00f1a fallida. Cuando se supere este n\u00famero, la cuenta se bloquear\u00e1.</li> <li><code>MAX_MEMBERS_PER_GROUP</code>, m\u00e1ximo n\u00famero de usuarios por grupo</li> <li><code>PASS_MAX_DAYS</code>, n\u00famero m\u00e1ximo en el que se puede utilizar la contrase\u00f1a. Pasado este tiempo se solicitar\u00e1 la creaci\u00f3n de una nueva.</li> <li><code>PASS_MIN_DAYS</code>, n\u00famero m\u00ednimo de d\u00edas permitidos entre los cambios de contrase\u00f1a. Cualquier cambio de contrase\u00f1a intentado antes de transcurrir este tiempo, ser\u00e1 rechazado</li> <li><code>PASS_WARN_AGE</code>, n\u00famero de d\u00edas de aviso dado antes de que expire una contrase\u00f1a. Un cero significa advertencia se da s\u00f3lo al d\u00eda que expira la contrase\u00f1a, un valor negativo significa que no se da ninguna advertencia. Si no se especifica, no se proporcionar\u00e1 ninguna advertencia.</li> </ul> <p>Todas las configuraciones contenidas en este fichero ser\u00e1n aplicadas al momento de creaci\u00f3n del usuario. Una vez creado, es posible modificar estos valores a trav\u00e9s del comando chage. De este modo se podr\u00e1n crear configuraciones personalizadas por cada usuario.</p> <p>El uso general de este comando es</p> <pre><code>chage &lt;opciones&gt; &lt;valores&gt; &lt;usuarios&gt;\n</code></pre> <p>Consultando la ayuda de chage se obtienen algunas opciones interesantes:</p> <ul> <li><code>-d</code>, <code>--lastday</code> \u00daLTIMO_D\u00cdA establece el d\u00eda del \u00faltimo cambio de la contrase\u00f1a a \u00daLTIMO_D\u00cdA. Si este valor es cero, el usuario deber\u00e1 cambiar su contrase\u00f1a al inicio de la siguiente sesi\u00f3n.</li> <li><code>-E, --expiredate</code> FECHA_CAD, establece la fecha de caducidad a FECHA_CAD.</li> <li><code>-I, --inactive</code> D\u00cdAS, deshabilita la cuenta despu\u00e9s de los d\u00edas de la fecha de caducidad.</li> <li><code>-l, --list</code> muestra la informaci\u00f3n de la cuenta.</li> <li><code>-m, --mindays D\u00cdAS_MIN</code>, establece el n\u00famero m\u00ednimo de d\u00edas antes de cambiar la contrase\u00f1a.</li> <li><code>-M, --maxdays D\u00cdAS_MAX</code>, establece el n\u00famero m\u00e1ximo de d\u00edas antes de cambiar la contrase\u00f1a.</li> <li><code>-W, --warndays</code> D\u00cdAS_AVISO establece los d\u00edas de aviso de expiraci\u00f3n.</li> </ul> <p>De este modo es posible modificar los datos del usuario referidos a las directivas de contrase\u00f1a como por ejemplo</p> <pre><code>chage -d 0 usuarioFeo\n</code></pre> <p>comando que obliga a usuarioFeo a cambiar su contrase\u00f1a al inicio de la siguiente sesi\u00f3n, para comprobarlo se usa el modificador <code>-l</code>,</p> <pre><code>chage -l usuarioFeo\n</code></pre> <p>Tambi\u00e9n se pueden obligar a que un usuario cambie su contrase\u00f1a cada 7 d\u00edas con</p> <pre><code>chage -M 7 usuarioFeo\n</code></pre> <p>Hay que recordar que todas estas modificaciones y restricciones locales se perder\u00e1n si se trabaja en un entorno de red. Eso s\u00ed, si estas modificaciones se realizan en un sistema que act\u00fae como controlador de dominio afectar\u00e1n a todo los elementos del dominio.</p>"},{"location":"UD6/objActive/","title":"Objetos predeterminados de Active Directory","text":"<p>Un dominio contiene objetos que se crean de forma predeterminada tras su instalaci\u00f3n. Estos objetos proporcionan acceso al sistema a varios niveles e incluyen grupos que permiten a los administradores delegar tareas espec\u00edficas de mantenimiento de la red a otros usuarios. Incluso si no se espera usar esos objetos en el futuro, hay que utilizarlos para crear otros objetos derivados con los permisos apropiados para la red. Por ejemplo, a\u00fan si no se desea tener ning\u00fan usuario \u00fanico con el control completo concedido a la cuenta de administrador, hay que iniciar sesi\u00f3n como administrador para poder crear los nuevos objetos usuario con los derechos y permisos deseados. Es posible dejar partes de la estructura del directorio desatendidas si se modifica, borra o desactiva la cuenta de administrador sin haber creado primero otros objetos usuario o haberles concedido permisos equivalentes para las distintas partes del directorio. Los contenedores con los que arranca un dominio en Microsoft Windows Server son:</p> <ul> <li>builtin, contenedor predeterminado para los grupos que proporcionan acceso a las funciones de administraci\u00f3n del servidor.</li> <li>computers, contenedor predeterminado para las cuentas de equipos.</li> <li>users, contenedor predeterminado para cuentas de usuario.</li> <li>domain cotrollers, contenedor para los nuevos controladores de dominio.</li> <li>foreign security principals, contenedor para entidades de seguridad de dominios de confianza externos. Es recomendable que los administradores no deben modificar manualmente el contenido de este contenedor ya que estas pol\u00edticas se generan de forma autom\u00e1tica al crear relaciones de confianza entre dominios.</li> <li>managed service accounts , contenedor para objetos que permiten la administraci\u00f3n de servicios ajenos a Active Directory.</li> </ul> <p>Realaci\u00f3n de confianza</p> <p>Una relaci\u00f3n de confianza es una relaci\u00f3n establecida  entre dos dominios de forma que permite a los usuarios de uno ser reconocidos por los controladores de dominio del otro. Estas relaciones permiten administrar desde un solo punto de la red a todos los usuarios y recursos de los que dispone el directorio.</p> <p>Todos estos contenedores est\u00e1n destinados a asegurar el funcionamiento de los servicios de directorio y su configuraci\u00f3n depender\u00e1 de la relaci\u00f3n entre ellos. En cuanto a los usuarios creados por defecto, todo sistema de directorio debe contener al menos estos tres:</p> <ul> <li>administrador, cuenta integrada para la administraci\u00f3n del dominio.</li> <li>invitado, cuenta integrada para el acceso como invitado al dominio.</li> <li>default account, cuenta de usuario administrada por el sistema.</li> </ul> <p>Tambi\u00e9n en Ubuntu Server se generan usuarios por defecto. Para poder acceder a ellos es necesario usar la aplicaci\u00f3n <code>samba-tool user</code> en la l\u00ednea de comandos. Las opciones que facilita esta herramienta son similares a las que podemos encontrar en el men\u00fa Acci\u00f3n de la Utilidad Usuarios y Active Directory:</p> <pre><code>samba-tool user \u2013help\nUsage: samba-tool user &lt;subcommand&gt;\n\nUser management.\n\nOptions:\n-h, --help show this help message and exit\n\nAvailable subcommands:\nadd - Create a new user.\ncreate - Create a new user.\ndelete - Delete a user.\ndisable - Disable an user.\nenable - Enable an user.\nlist - List all users.\npassword - Change password for a user account.\nsetexpiry - Set the expiration of a user account.\nsetpassword - Set or reset the password of a user account.\n\nFor more help on a specific subcommand, please type: samba-tool user &lt;subcommand&gt; (-h|--help)\n</code></pre> <p>Son tres los usuarios que Samba crea en su estructura de dominio y que se pueden consultar a trav\u00e9s del siguiente comando: samba-tool user list</p> <ul> <li>Administrator, cuenta de usuario del administrador del dominio. Atenci\u00f3n que el nombre de este usuario est\u00e1 escrito en ingl\u00e9s, no en castellano.</li> <li>krbtgt, cuenta de usuario del servicio Kerberos.</li> <li>Guest, cuenta limitada para acceso temporal al directorio.</li> </ul> <p>Utilizando <code>samba-tool user</code> se administran los usuarios de un directorio bajo Ubuntu Server</p> <pre><code>  samba-tool user add UsuarioFeo Passw0rdFeo\n</code></pre> <p>El comando anterior crear\u00e1 un usuario con el nombre UsuarioFeo y contrase\u00f1a Passw0rdFeo aplicando de forma autom\u00e1tica todas las opciones obligatorias del usuario y dejando en blanco las opcionales. Algunas de estas opciones de usuario son:</p> <ul> <li>--given-name, nombre del usuario, no el de inicio de sesi\u00f3n, sino el que aparecer\u00e1 en la descripci\u00f3n del usuario.</li> <li>--surname, apellido.</li> <li>--mail-address, direcci\u00f3n de correo electr\u00f3nico.</li> <li>--uid-number, n\u00famero identificativo del usuario en formato RFC2307. Si no se especifica el sistema otorgar\u00e1 uno por defecto.</li> <li>--gid-number, n\u00famero identificativo del grupo primario al que pertenece. Por defecto, todos los usuarios pertenecen al grupo Users como m\u00ednimo.</li> <li>--login-shell, especifica el bash que el usuario debe utilizar.</li> <li>--home-directory, directorio de usuario en el sistema.</li> </ul> <p>Si es necesario cambiar la contrase\u00f1a del usuario</p> <pre><code>samba-tool user setpassword UsuarioFeo\n</code></pre> <p>El comando para eliminar el usuario creado anteriormente es</p> <pre><code>samba-tool user delete UsuarioFeo\n</code></pre> <p>Existen numerosas opciones y modificadores de esta utilidad. Todas ellas se pueden consultar a trav\u00e9s del comando</p> <pre><code>samba-tool user add --help\n</code></pre> <p>Ambos sistemas ofrecen numerosas posibilidades para la gesti\u00f3n de usuarios a trav\u00e9s de diferentes tipos de interfaces. En este manual utilizaremos la interfaz GUI con Microsoft Windows Server y la interfaz CLI con Ubuntu Server, como viene siendo habitual.</p>"},{"location":"UD6/perUsers/","title":"Perfiles de usuario, m\u00f3viles y obligatorios","text":"<p>Un perfil de usuario es un entorno personalizado espec\u00edficamente dise\u00f1ado para un usuario en concreto. Cada usuario tiene uno, ya que se crea un perfil autom\u00e1ticamente cuando inicia sesi\u00f3n en un equipo. Por defecto, los perfiles que se crean son locales, es decir, si el mismo usuario del dominio accede a dos equipos distintos, crear\u00e1 dos perfiles independientes. Habitualmente los usuarios trabajan con la misma m\u00e1quina, pero hay ocasiones en las que es necesario que cambien su ubicaci\u00f3n de trabajo. Es buena idea entonces que el perfil de ese usuario viaje con \u00e9l, ya que \u00e9ste contiene gran parte de la informaci\u00f3n de trabajo.</p> <p>Todos los perfiles se generan a partir de una copia del perfil Default User. La informaci\u00f3n del registro para Default User se encuentra en el archivo <code>ntuser.dat</code> en sistemas operativos de Microsoft.</p> <p>En sistemas basados el GNU/Linux, ocurre de forma similar. El fichero <code>/etc/profile</code> contiene la estructura de los perfiles. Adem\u00e1s, durante el proceso de creaci\u00f3n de perfiles, consulta los scripts ubicados en la carpeta <code>/etc/profile.d</code> que tambi\u00e9n ejecutar\u00e1 durante la creaci\u00f3n de un usuario.</p> <p>Dentro de cada perfil es posible encontrar la siguiente informaci\u00f3n:</p> <ul> <li>configuraci\u00f3n local, que contiene datos de programa, historial y archivos temporales.</li> <li>datos de programa, configuraciones especificas de software de cada usuario, archivos, carpetas, accesos directos, escritorio documentos y plantillas de usuario.</li> <li>configuraci\u00f3n de inicio, elementos del men\u00fa Inicio del usuario as\u00ed como aplicaciones.</li> </ul> <p>Adem\u00e1s de toda esta informaci\u00f3n, los sistemas operativos de Microsoft tambi\u00e9n guardan en el perfil de usuario informaci\u00f3n referida a impresoras, conexiones de red, listado de archivos recientes, o las cookies del navegador entre otra informaci\u00f3n.</p> <p>No es de extra\u00f1ar que si un usuario cambia de equipo y crea un nuevo perfil, eche de menos toda esta informaci\u00f3n y, a\u00fan peor, no pueda desempe\u00f1ar su trabajo con normalidad.</p> <p>Los perfiles ofrecen varias ventajas:</p> <ul> <li>varios usuarios pueden utilizar el mismo equipo, cada uno con su configuraci\u00f3n personalizada al iniciar la sesi\u00f3n.</li> <li>los cambios realizados por un usuario en el escritorio no afectan a otro.</li> <li>si los perfiles de usuario se almacenan en un servidor, es decir se usan perfiles m\u00f3viles, \u00e9stos pueden seguir a los usuarios a cualquier equipo de la red.</li> </ul> <p>Desde el punto de vista de un administrador, la informaci\u00f3n del perfil puede ser una valiosa herramienta para configurar perfiles de usuario predeterminados universales o para personalizar los perfiles para diferentes departamentos o \u00e1reas del trabajo.</p> <p>Existen diferentes tipos de perfiles:</p> <ul> <li>perfiles locales, creados en un equipo cuando un usuario inicia sesi\u00f3n. El perfil es espec\u00edfico de un usuario y se almacena en el disco duro del equipo local.</li> <li>perfiles m\u00f3viles, creados por un administrador y almacenados en un servidor. Estos perfiles siguen al usuario a cualquier m\u00e1quina donde \u00e9ste inicie sesi\u00f3n.</li> <li>perfiles obligatorios, son perfiles m\u00f3viles que s\u00f3lo pueden ser modificados por un administrador. \u00c9ste podr\u00e1 definir configuraciones para usuarios o grupos, que no podr\u00e1n personalizar sus perfiles.</li> <li>perfil temporal, cuando se produce un error que impide cargar un perfil m\u00f3vil o un perfil obligatorio, se crea un perfil temporal para facilitar el inicio de sesi\u00f3n del usuario. Una vez finalizada se sesi\u00f3n, el perfil temporal se elimina.</li> <li>perfil super-obligatorio, se incorpora a partir de Microsoft Windows Server 2008 y su objetivo es similar al de los perfiles obligatorios, con la diferencia de que, si se produce un error que impida cargar el perfil, el usuario no podr\u00e1 iniciar sesi\u00f3n.</li> </ul>"},{"location":"UD6/perUsers/#perfiles-locales","title":"Perfiles locales","text":"<p>Los perfiles locales se crean en los equipos cuando los usuarios inician sesi\u00f3n. En funci\u00f3n del sistema operativo as\u00ed como de su versi\u00f3n, estos perfiles se almacenar\u00e1n en lugares distintos del cliente:</p> <ul> <li>en Microsoft Windows 10, y desde Microsoft Windows Vista, se ubica en<code>%systemroot%/Usuarios/%username%</code></li> <li>en Microsoft Windows XP, <code>%systemroot%/Documents and Settings/%username%</code></li> <li>en GNU/Linux, los perfiles de usuario se crean en la carpeta <code>/home/$USER</code>, con la excepci\u00f3n del usuario root, que por motivos de seguridad posee su propio perfil en la ruta /root.</li> </ul> <p>La primera vez que un usuario inicia sesi\u00f3n en un equipo, se genera una carpeta de perfil para el usuario, y los contenidos de la carpeta Default User se copian en ella. Cualquier cambio realizado por el usuario al escritorio se almacena en ese perfil reci\u00e9n creado. Si un usuario tiene una cuenta local en el equipo adem\u00e1s de una cuenta de dominio e inicia sesi\u00f3n utilizando ambas cuentas, \u00e9ste dispondr\u00e1 de dos carpetas de perfil en el equipo local; una para cuando el usuario inicie sesi\u00f3n en el dominio utilizando la cuenta de usuario del dominio y otra para cuando el usuario inicie sesi\u00f3n de forma local en el equipo. El perfil local se mostrar\u00e1 con el nombre de inicio de sesi\u00f3n. El perfil de dominio tambi\u00e9n se mostrara con el nombre de inicio de sesi\u00f3n, pero llevara a\u00f1adido el nombre del dominio.</p> <p>En sistemas basados en GNU/Linux, toda la informaci\u00f3n referida al usuario se encuentra en el directorio <code>/home/$USER</code>. Cuando se accede con usuarios distintos, tanto el usuario local como el usuario de red dispondr\u00e1n de diferentes perfiles.</p>"},{"location":"UD6/perUsers/#perfiles-moviles","title":"Perfiles m\u00f3viles","text":"<p>Un perfil m\u00f3vil se almacena en un servidor y, despu\u00e9s de que el inicio de sesi\u00f3n del usuario sea autentificado en el servicio de directorio, se copia al equipo local. Esto permite al usuario tener el mismo escritorio, la configuraci\u00f3n de las aplicaciones y la configuraci\u00f3n local en cualquier m\u00e1quina.</p> <p>Cuando el usuario inicie sesi\u00f3n en un equipo, el perfil del servidor se descarga al equipo local. Al cerrar la sesi\u00f3n, el perfil se almacena tanto localmente como en la ubicaci\u00f3n de la ruta de acceso al perfil del usuario. Cuando el usuario inicia sesi\u00f3n de nuevo, el perfil del servidor se compara con la copia en el equipo local y se carga la versi\u00f3n m\u00e1s reciente. Si el servidor no esta disponible, se utiliza la copia local. Si el servidor no esta disponible y es la primera vez que el usuario ha iniciado sesi\u00f3n en el equipo, se crea un perfil de usuario localmente utilizando el perfil Default User.</p> <p>Para configurar un perfil m\u00f3vil simplemente hay que completar las siguientes acciones:</p> <ul> <li>crear una carpeta compartida en el servidor para los perfiles.</li> <li>asignar en la cuenta de usuario una ruta de acceso a la carpeta compartida.</li> </ul> <p>Una vez realizadas estas acciones, el perfil de usuario se copia en el servidor y estar\u00e1 disponible para el usuario desde cualquier equipo.</p> <p>Pero no todo son ventajas en esta configuraci\u00f3n de perfiles. Cuando el usuario cierre sesi\u00f3n, todo el contenido de su perfil se copiar\u00e1 al servidor a trav\u00e9s de la red y, cuando el mismo usuario vuelva a conectarse al dominio, el perfil volver\u00e1 a ser descargado en el equipo cliente. Esta transferencia de datos continua entre el servidor y el cliente no s\u00f3lo ser\u00e1 percibida por el usuario como una p\u00e9rdida de tiempo, sino que sobrecargar\u00e1 el tr\u00e1fico de la red, lo que podr\u00e1 repercutir sobre el rendimiento del resto de los usuarios.</p> <p>Otro problema que puede surgir es de la incompatibilidad de perfiles en los sistemas operativos de la familia Microsoft. A partir de Microsoft Windows XP el esquema de los perfiles fue modificado. Esto quiere decir que si un usuario inicia sesi\u00f3n en un equipo con Microsoft Windows XP en un equipo, generar\u00e1 un perfil diferente a si lo inicia en Microsoft Windows 7 o 10. Adem\u00e1s de consumir espacio en el servidor y de ancho de banda, los perfiles que se cargan en distintos equipos no son los mismos, depender\u00e1n de la versi\u00f3n del sistema operativo.</p> <p>La soluci\u00f3n puede pasar por utilizar la carpeta personal para cada usuario en el servidor. De este modo tan s\u00f3lo los documentos necesarios ser\u00e1n guardados en al servidor y ser\u00e1n transferidos bajo demanda.</p> <p>En los sistemas operativos GNU/Linux se act\u00faa de la misma forma, primero se crea una carpeta compartida que contendr\u00e1 los ficheros y despu\u00e9s se indica al usuario cual es la ruta de su perfil. Esta tarea engloba compartir carpetas y el servicio <code>samba</code> que se abordar\u00e1 en la siguiente unidad, pero realizaremos los pasos necesarios para preparar el acceso a estas carpetas compartidas.</p> <p></p> <p>Para poder acceder desde un equipo a una carpeta compartida por nfs en un servidor, ser\u00e1 necesario instalar los paquetes portmap y nfs-common en el cliente</p> <pre><code>sudo apt-get install portmap nfs-common\nsudo /etc/init.d/portmap restart\n</code></pre> <p>Cuando finalice la instalaci\u00f3n ser\u00e1 posible utilizar el sistema nfs como un nuevo sistema de ficheros de red, lo que permitir\u00e1 gestionar carpetas remotas como si fuesen propias del sistema local. Algo muy parecido a lo que realiza el comando <code>netuse</code> o la conexi\u00f3n de unidades de red de los clientes de Microsoft Windows.</p> <p>Ahora es posible montar la carpeta compartida en nuestro sistema de archivos. De esta manera, el acceso es exactamente igual que a cualquier otra carpeta del disco duro local.</p> <p>En el servidor existe la carpeta compartida /datos/usuarios/usuarioFeo con los datos del usuario Feo. Es posible montar esa carpeta como si fuera una m\u00e1s del sistema de ficheros local</p> <pre><code>sudo mount -t nfs ip-del-servidor:/home/MIEMPRESAFEA.LOCAL/usuarioFeo/datos\n</code></pre> <p>A partir de este momento la carpeta datos contiene la informaci\u00f3n de la carpeta /datos/usuarios/usuarioFeo del servidor.</p> <p>Como ya se ha estudiado, es posible que el sistema monte de forma autom\u00e1tica una carpeta compartida por nfs al iniciar sesi\u00f3n a trav\u00e9s del archivo <code>/etc/fstab</code></p> <pre><code>ip-del-servidor:/home/MIEMPRESAFEA.LOCAL/usuarioFeo/datos nfs\n</code></pre>"},{"location":"UD6/perUsers/#perfiles-obligatorios","title":"Perfiles obligatorios","text":"<p>Un perfil m\u00f3vil permite que un usuario pueda iniciar una sesi\u00f3n desde diferentes clientes, manteniendo su escritorio de trabajo. Sin embargo, en muchas ocasiones esto no es suficiente y necesitamos tambi\u00e9n que el usuario no pueda realizar cambios en ese perfil. Para ello se dispone de los perfiles obligatorios.</p> <p>En sistemas operativos de Microsoft, s\u00f3lo hay que modificar el nombre del un archivo oculto, que inicialmente se llama NTUSER.DAT por el de NTUSER.MAN.</p> <p>Hay que acceder a la carpeta del perfil, mostrar todos los archivos ocultos o de sistema y cambiar el nombre del archivo. Sin embargo, el usuario administrador no posee los permisos suficientes para realizar esta acci\u00f3n, ya que solo el propio usuario y el grupo SYSTEM tienen permisos. A pesar de ello se est\u00e1 trabajando con la cuenta Administrador, y la ventana que nos muestra el error incluye tambi\u00e9n un bot\u00f3n que nos permite tomar posesi\u00f3n de la carpeta. No es buena pr\u00e1ctica tomar posesi\u00f3n de un recurso que no pertenece al administrador y tan s\u00f3lo debe ser utilizada en situaciones extremas.</p> <p>Aunque parezca un contrasentido, debe ser el propietario de la carpeta el que deba asignar los permisos al usuario administrador. As\u00ed que se iniciar\u00e1 la sesi\u00f3n con el usuario en cuesti\u00f3n y se a\u00f1adir\u00e1n los permisos al administrador. Una vez asignados podr\u00e1 entrar, mostrar los ficheros ocultos y de sistema y renombrar el fichero.</p>"},{"location":"UD6/polContra/","title":"Pol\u00edtica de contrase\u00f1as","text":"<p>Todos las cuentas de usuario deben tener contrase\u00f1as robustas y ser cambiadas de forma peri\u00f3dica ya que, si \u00e9sta se actualiza cada poco tiempo, las cuentas de usuario permanecer\u00e1n seguras contra cualquier tipo de ataque. Una contrase\u00f1a robusta tiene las siguientes caracter\u00edsticas:</p> <ul> <li>contiene caracteres alfab\u00e9ticos y no alfab\u00e9ticos.</li> <li>tiene una longitud de al menos ocho caracteres.</li> <li>no contiene informaci\u00f3n personal conocida como la fecha de nacimiento, el n\u00famero de tel\u00e9fono o el n\u00famero de matr\u00edcula del veh\u00edculo habitual.</li> <li>contiene alg\u00fan car\u00e1cter especial, como la arroba, almohadilla o d\u00f3lar.</li> </ul> <p>Conviene educar a los usuarios sobre las contrase\u00f1as y su privacidad, pero sobre todo, merece la pena hacer caso de los propios consejos. Hay que asegurarse de que la contrase\u00f1a seleccionada para administraci\u00f3n es robusta y cambiarla frecuentemente. Hacer esto ayudara a evitar intrusiones no deseadas en el sistema.</p> <p>Es buena pr\u00e1ctica que los administradores dispongan de dos cuentas en el sistema: una cuenta administrativa y una cuenta de usuario normal. Se deber\u00eda utilizar la cuenta de usuario normal a menos que se est\u00e9n realizando tareas administrativas. A causa de los privilegios asociados a las cuentas administrativas, son un objetivo primario para los intrusos.</p> <p>Otra medida de seguridad interesante es que las cuentas deben establecerse de forma que se bloquearan cuando se introdujeran contrase\u00f1as incorrectas. Se pueden permitir varios intentos, para dejar margen a errores tipogr\u00e1ficos. Esta configuraci\u00f3n pertenece a la configuraci\u00f3n de pol\u00edticas de grupo, tema que se tratar\u00e1 en otra unidad.</p> <p>Durante la creaci\u00f3n de un usuario, el sistema ofrece varias posibilidades en lo referente a la contrase\u00f1as y que hay que tener muy en cuenta:</p> <ul> <li>El usuario debe cambiar la contrase\u00f1a en el siguiente inicio de sesi\u00f3n, de esta forma tan solo el usuario conoce la contrase\u00f1a. Ni el administrador del domino puede acceder a ella.</li> <li>El usuario no puede cambiar la contrase\u00f1a, requerido cuando por necesidades de seguridad la contrase\u00f1a debe ser controlada por el administrador.</li> <li>La contrase\u00f1a nunca expira, no se aplicar\u00e1n las restricciones de caducidad de contrase\u00f1a a esta cuenta.</li> <li>Cuenta deshabilitada, deshabilita cuentas que moment\u00e1neamente no se necesitan en la red. Tambi\u00e9n es posible que se active autom\u00e1ticamente debido a las restricciones de seguridad impuestas por el Administrador.</li> </ul> <p></p> <p>En Microsoft Windows Server aplicar estas opciones se realiza a trav\u00e9s del asistente de creaci\u00f3n de usuarios o consultando las propiedades de la cuenta de usuario. Estas configuraci\u00f3n en GNU/Linux y Samba se realizan a trav\u00e9s de opciones del comando samba-tool:</p> <ul> <li><code>--must-change-at-next-login</code>, usado durante el proceso de creaci\u00f3n del usuario, el usuario debe cambiar la contrase\u00f1a en su pr\u00f3ximo inicio de sesi\u00f3n.</li> <li><code>samba-tool user enable/disable</code> para habilitar/deshabilitar la cuenta de usuario especificada.</li> <li><code>samba-tool user password</code>, para cambiar la contrase\u00f1a a una cuenta de usuario.</li> <li><code>samba-tool user setexpiry</code> nombre_de_la_cuenta -\u2013noexpiry, para indicar que esa cuenta nunca caduca o <code>--days=30</code> para indicar que la contrase\u00f1a caduca a los 30 d\u00edas.</li> </ul>"},{"location":"UD6/scriptsInicio/","title":"Scripts de inicio de sesi\u00f3n","text":"<p>A veces es necesario realizar una serie de tareas al inicio de cada sesi\u00f3n. Es posible que alg\u00fan programa requiera una configuraci\u00f3n especial, o es necesario la ejecuci\u00f3n de algunos comandos del sistema o incluso programar una tarea antes de que el usuario tome el control del equipo. Todas estas tareas pueden asignarse a un script y ejecutarse al inicio de la sesi\u00f3n. Los scripts, tanto en sistemas operativos Microsoft Windows como GNU/Linux, se analizar\u00e1n de forma pormenorizada en unidades sucesivas.</p> <p>Para asignar una secuencia de comandos a un perfil, es necesario crear el script en una carpeta compartida y hacer referencia a \u00e9l en la configuraci\u00f3n de usuario del servidor. Microsoft Windows Server siempre busca las secuencia de comandos de inicio de sesi\u00f3n en la ruta</p> title<pre><code>%systemroot%\\SYSVOL\\sysvol\\%userdomain%\n</code></pre> <p>por lo que ser\u00e1 en esta carpeta donde colocaremos los scripts a ejecutar. Las secuencias de comandos de esta carpeta se pueden referenciar s\u00f3lo a trav\u00e9s de su nombre. Si se opta por colocar la secuencias de comando en otra ubicaci\u00f3n, habr\u00e1 que incluir la extensi\u00f3n del fichero tambi\u00e9n.</p> <p>En Microsoft Windows Server , desde Administrador del servidor \u2192 Herramientas \u2192 Usuarios y equipos de Active Directory, se accede a la pesta\u00f1a de Perfil en las propiedades del usuario y se especifica el nombre del script de inicio de sesi\u00f3n en el recuadro que tiene el mismo nombre.</p> <p></p> <p>En sistemas operativos basados en GNU/Linux existen varias formas de configurar esta acci\u00f3n:</p> <ul> <li>a trav\u00e9s de la opci\u00f3n <code>--script-path=ruta_absoluta</code> durante la creaci\u00f3n o modificaci\u00f3n del usuario. Esta opci\u00f3n especifica la ruta en donde el usuario encontrar\u00e1 los scripts de inicio de sesi\u00f3n.</li> <li>modificando del fichero <code>/home/$USER/.bashrc</code>, el cual contiene los comandos que se ejecutar\u00e1n al inicio de cada sesi\u00f3n de usuario.</li> <li>incluso existe la posibilidad de ejecutar comandos a la salida de la sesi\u00f3n ubic\u00e1ndolos en el fichero <code>/home/$USER/.bash_logout</code>.</li> </ul>"},{"location":"UD6/varEntorno/","title":"Variables de entorno","text":"<p>En cualquier sistema operativo, las variables de entorno son un conjunto de valores que obtienen su valor de forma din\u00e1mica durante la sesi\u00f3n del usuario. De esta forma cualquier proceso, programa o incluso usuario puede hacer referencia a estas variables de entorno y ellas contener un valor distinto en cada sesi\u00f3n.</p> <p>Verbigracia, la variable de entorno %USERNAME% contendr\u00e1 el nombre de usuario que ha iniciado la sesi\u00f3n actual. Al finalizar esta sesi\u00f3n y ser iniciada por otro usuario, el valor de esta variable cambiar\u00e1 por el nombre del nuevo usuario, pero su denominaci\u00f3n seguir\u00e1 intacta. De esta forma se puede acceder a informaci\u00f3n que va cambiando a lo largo del tiempo de ejecuci\u00f3n a trav\u00e9s de una sola variable.</p> <p>Este tipo de variables se usar\u00e1n profusamente en la unidad destinada a procesos por lotes y shellscript, pero que tambi\u00e9n son importantes en el apartado actual. Un ejemplo de ello es la configuraci\u00f3n de la carpeta personal. Si en lugar de utilizar el nombre de un usuario en concreto para crear su carpeta personal se usa la variable de entorno que lo contiene, %USERNAME% en este caso, en cada inicio de sesi\u00f3n cambiar\u00e1 esta variable por el nombre del usuario <code>\\\\servidor\\nombre_carpeta_compartida\\%USERNAME%</code> Se dispone de numerosas variables de entorno, de entre las que destacan, para los sistemas operativos Microsoft Windows:</p> <ul> <li><code>%homedrive%</code> , letra de la unidad de disco que contiene el directorio principal del sistema operativo. Normalmente C:.</li> <li><code>%homepath%</code> ruta de acceso absoluta al directorio principal del usuario.</li> <li><code>%os%</code> nombre del sistema operativo del usuario.</li> <li><code>%processor_architecture%</code> tipo de arquitectura del equipo del usuario.</li> <li><code>%userdomain%</code> nombre del dominio donde existe la cuenta del usuario.</li> <li><code>%username%</code> nombre del usuario de la cuenta.</li> <li><code>%path%</code> rutas de los ficheros ejecutables.</li> </ul> <p>Para los sistemas operativos basados en GNU/Linux se dispone de , entre otras:</p> <ul> <li><code>$SHELL</code>, el tipo de shell en uso actualmente.</li> <li><code>$TERM</code>, el tipo de terminal.</li> <li><code>$USER</code>, el nombre de usuario.</li> <li><code>$PWD</code>, la ruta absoluta actual del usuario en el sistema de archivos.</li> <li><code>$LANG</code>, el juego de caracteres de idioma que emplea el usuario.</li> <li><code>$DESKTOP_SESSION</code>, el tipo de entorno de escritorio.</li> <li><code>$PATH</code>, las rutas de los ficheros ejecutables.</li> </ul> <p>Es posible comprobar el valor de estas variables de entorno. Abriendo un terminal y escribiendo la palabra echo seguida del nombre de la variable a continuaci\u00f3n</p> <pre><code>echo %path%\necho $PATH\n</code></pre> <p>Este tipo de variables se pueden crear en funci\u00f3n de las necesidades del sistema ya que alguno programas pueden usar estas variables para personalizar la experiencia que ofrecen al usuario. Esta tarea se puede realizar tanto en sistemas operativos de Microsoft Windows como los basados en GNU/Linux, no obstante es una cuesti\u00f3n que excede de las pretensiones de este manual.</p>"},{"location":"UD7/Actividades/","title":"Actividades de la UD7","text":""},{"location":"UD7/Actividades/#actividad-1","title":"Actividad 1","text":"<ol> <li> <p>Es hora de retomar la estructura de la empresa que creaste con anterioridad. Planifica por escrito o mediante un gr\u00e1fico, la creaci\u00f3n de grupos y unidades organizativas para la correcta gesti\u00f3n de tu empresa. Utiliza las estrategias de anidamiento vistas en clase. Puedes seguir estas pautas para ayudarte en tu planificaci\u00f3n:</p> </li> <li> <p>es conveniente que cada departamento o \u00e1rea espec\u00edfica disponga de un grupo y una unidad organizativa</p> </li> <li>ten en cuenta la creaci\u00f3n de grupos transversales como responsables o encargados</li> <li>suele ser muy \u00fatil la creaci\u00f3n de grupos funcionales (seg\u00fan la actividad o escalaf\u00f3n en la empresa) adem\u00e1s de los anteriores</li> <li>en la medida de lo posible, trata de evitar usar grupos incorporados (built-in) en esta planificaci\u00f3n</li> </ol>"},{"location":"UD7/Actividades/#actividad-2","title":"Actividad 2","text":"<ol> <li>Crea los grupos nacidos de tu organizaci\u00f3n en ServidorWindows a trav\u00e9s de GUI e introduce a los usuarios que correspondan en cada grupo. Deber\u00e1s crear una breve descripci\u00f3n de las funciones de este grupo. Documenta el proceso y crea un documento con los pasos que sigues.</li> <li>Crea los grupos ServidorUbuntu a trav\u00e9s de CLI e introduce a los usuarios que correspondan en cada grupo, del mismo modo que lo has realizado en ServidorWindows. Tambi\u00e9n deber\u00e1s especificar sus funciones en su descripci\u00f3n. Documenta el proceso, incluyendo los comandos que usas, y crea un documento con los pasos que sigues.</li> <li>Turno para las unidades organizativas. Crea las unidades organizativas necesarias en ServidorWindows a trav\u00e9s de CLI e introduce a los grupos y/o usuarios necesarios seg\u00fan tu planificaci\u00f3n.</li> <li>En el ServidorUbuntu, crea las unidades organizativas necesarias y distribuye los objetos de forma adecuada para el correcto funcionamiento de tu empresa.</li> <li>Desinstala el navegador web instalado con anterioridad en el cliente CW1001 desde ServidorWindows utilizando para ello la Cuenta de Equipo de este cliente.</li> <li> <p>En ServidorWindows, a trav\u00e9s de la utilidad de Administraci\u00f3n de pol\u00edticas de grupo modifica las siguientes directivas de Default Domain Policy y comprueba que los cambios introducidos surten efecto.</p> <ul> <li>habilita Active Desktop, esto nos permitir\u00e1 realizar cambios en el escritorio de los usuarios</li> <li>Como papel tapiz de todos los usuarios descarga y configura este (http://tuxlink.files.wordpress.com/2007/10/leopard-server-wallpaper.jpg). La posici\u00f3n debe ser Centrada</li> <li>quita el men\u00fa ayuda del men\u00fa de Inicio</li> <li>los usuarios no deben cambiar ninguno de las configuraciones de escritorio. Esta norma afectar\u00e1 a varias directivas situadas, eso s\u00ed, en el mismo contenedor</li> </ul> </li> <li> <p>Crea una nueva pol\u00edtica de grupo que afecte a todos los objetos del dominio controlados por ServidorWindows denominada \u201cNormas Empresa\u201d. Esta nueva pol\u00edtica tendr\u00e1 las siguientes configuraciones:</p> <ul> <li>los usuarios del dominio no podr\u00e1n acceder a las herramientas para cambiar el registro. Cuando se inicie la sesi\u00f3n de un usuario del dominio, ser\u00e1 necesario el inicio de los programas bloc de notas (notepad.exe) y Explorador de Windows (explorer.exe). Ambos se encuentran ubicados en el directorio C:\\Windows</li> <li>deshabilita el protector de pantalla y como medida de seguridad adicional, que la pesta\u00f1a de Protector de Pantalla no sea visible</li> <li>limitar el idioma de los usuarios a Espa\u00f1ol evitando que se puedan agregar nuevos</li> <li>no queremos que los usuarios agregan ninguna impresora. Tampoco queremos que eliminen ninguna impresora</li> <li>no queremos que los usuarios puedan Agregar o quitar ning\u00fan programa</li> <li>queremos deshabilitar cualquier acceso a la configuraci\u00f3n de red para evitar que puedan cambiar ni ver ninguna configuraci\u00f3n</li> <li>impediremos que los equipos busquen actualizaciones autom\u00e1ticas durante las sesiones de los usuarios del dominio</li> </ul> </li> <li> <p>En todos los equipos de la empresa debe existir una alternativa de navegador. Realiza las configuraciones necesarias en ServidorWindows para instalar el navegador Mozilla Firefox en todos los equipos al inicio de la pr\u00f3xima sesi\u00f3n.</p> </li> <li>Es muy com\u00fan que los usuarios dejen su sesi\u00f3n abierta mientras se ausentan de su puesto de trabajo, esto permitir\u00eda que un usuario malintencionado acceda a informaci\u00f3n o a aplicaciones sin autorizaci\u00f3n. Configura una directiva para que se bloquee la sesi\u00f3n pasados cinco minutos y sea necesario volver a introducir la contrase\u00f1a de usuario para reiniciar la sesi\u00f3n. Ser\u00e1n necesarias la activaci\u00f3n de tres directivas para realizar esta tarea.</li> <li>Como has observado, la configuraci\u00f3n de las pol\u00edticas de grupo es un trabajo arduo. Realiza una copia de seguridad de las pol\u00edticas de seguridad copiando los archivos que la conforman a un lugar seguro. Utiliza un comando para ello y programa esta copia. Realiza esta configuraci\u00f3n en ServidorWindows</li> </ol>"},{"location":"UD7/Actividades/#actividad-3-refuerzo","title":"Actividad 3. REFUERZO","text":"<ol> <li>Crea un grupo denominado Ayudantes Administradores e introduce a dos usuarios del departamento TIC en \u00e9l. Para hacer esto sigue los siguientes pasos:<ol> <li>accede a Herramientas \u2192 Usuarios y equipos de Active Directory, bot\u00f3n derecho Nuevo \u2192 Grupo y crea el nuevo grupo con \u00e1mbito Dominio local y tipo Seguridad. \u00bfQu\u00e9 significan estas caracter\u00edsticas?. \u00bfEs buena idea hacer un grupo Universal?. \u00bfPor qu\u00e9?</li> <li>introduce a dos usuarios del departamento TIC. Prueba a abrir sesi\u00f3n con uno de ellos en ServidorWindows. \u00bfQu\u00e9 ocurre?. Vuelve a iniciar sesi\u00f3n con el usuario Administrador</li> <li>incluye a ese usuario en el grupo Administradores e intenta ahora iniciar sesi\u00f3n en ServidorWindows. \u00bfQu\u00e9 ocurre?. Vuelve a iniciar sesi\u00f3n con el usuario Administrador. \u00bfEs buena idea incluir a usuarios en este grupo?</li> <li>accede a la carpeta Builtin. \u00bfHas creado t\u00fa estos grupos?, \u00bfpara qu\u00e9 sirven?. Describe alguno de los grupos que existen a modo de ejemplo</li> </ol> </li> <li>Vamos a crear una pol\u00edtica espec\u00edfica para el servidor Servidor Windows. Para ello sigue los siguientes pasos:<ol> <li>Accede a Herramientas \u2192 Administraci\u00f3n de directivas de grupo y crea una nueva pol\u00edtica con el nombre Pol\u00edtica Departamento TIC (bot\u00f3n derecho sobre el nombre del dominio). \u00bfPara qu\u00e9 se usan las cinco pesta\u00f1as que aparecen si pulsamos en la pol\u00edtica que acabamos de crear? Explica cada una de ellas (\u00c1mbito, Detalles, Configuraci\u00f3n, Delegaci\u00f3n y Estado).</li> <li>Edita la GPO reci\u00e9n creada y accede a Configuraci\u00f3n de Usuario \u2192 Preferencias \u2192 Configuraci\u00f3n de Panel de control \u2192 Opciones de carpeta. Pulsamos bot\u00f3n derecho sobre ella \u2192 Nuevo y nos permitir\u00e1 crear configuraciones est\u00e1ndar para cada equipo. Elige Opciones de carpeta (como m\u00ednimo, Windows Vista) y selecciona la opci\u00f3n Mostrar archivos y carpetas ocultos. \u00bfQu\u00e9 efecto tendr\u00e1 esto en los usuario?. Comprueba que funciona.</li> <li>Cierra el editor de pol\u00edticas de grupo. Ahora accede a la pesta\u00f1a detalles y en Estado de GPO selecciona Configuraci\u00f3n de Usuario Deshabilitada. \u00bfQu\u00e9 efectos tendr\u00e1 esta configuraci\u00f3n en la GPO?. \u00bfC\u00f3mo podemos forzar la actualizaci\u00f3n de una Pol\u00edtica de grupo reci\u00e9n creada?.</li> </ol> </li> </ol>"},{"location":"UD7/Actividades/#actividad-4-ampliacion","title":"Actividad 4. AMPLIACI\u00d3N","text":"<ol> <li> <p>Crea dos grupos locales de dominio en ServidorWindows que dispondr\u00e1n de los siguientes privilegios:</p> <ol> <li> <p>grupo denominado \u201cAyudante TIC\u201d con los siguientes privilegios:</p> <ul> <li>Agregar estaciones al dominio</li> <li>Cambiar la hora del sistema</li> <li>Cambiar la zona horaria</li> <li>Cargar y descargar controladores de dispositivo</li> <li>Tener acceso a este equipo desde la red</li> </ul> </li> <li> <p>grupo denominado \u201cGestor de datos\u201d con los siguientes privilegios:</p> <ul> <li>Crear objetos compartido permanentes</li> <li>Hacer copias de seguridad de archivos y directorios</li> <li>Permitir inicio de sesi\u00f3n local</li> <li>Realizar tareas de mantenimiento del volumen</li> <li>Restaurar archivos y directorios</li> <li>Tomar posesi\u00f3n de archivos y otros objetos</li> </ul> </li> </ol> </li> </ol> <p>Crea dos usuarios en tu empresa pertenecientes al departamento TIC y as\u00edgnales uno de estos grupos. Comprueba que el nuevo usuario puede realizar las tareas descritas.</p> <ol> <li>Instala en CW1001 un nuevo disco duro SATA con 100 GB de capacidad y expansi\u00f3n din\u00e1mica. Arranca el equipo sin iniciar sesi\u00f3n. Desde ServidorWindows y con un usuario perteneciente al grupo Gestor de datos, configura el nuevo disco duro como un volumen din\u00e1mico que contendr\u00e1 los documentos personales de los usuarios de ese equipo (recuerda que los documentos personales se encuentran en C:\\Usuarios).</li> <li>Retoma el esquema de tu empresa y dise\u00f1a una pol\u00edtica de directivas de grupo adecuada a los requerimientos que se detallan a continuaci\u00f3n. Deber\u00e1s realizar esta configuraci\u00f3n en ServidorWindows Antes de lanzarte a configurar directivas, haz una planificaci\u00f3n de las GPO que deber\u00e1s crear, nuevas unidades organizativas y grupos de seguridad si fuesen necesarios. Una vez tengas la planificaci\u00f3n plasmada en papel, realiza los cambios necesarios para que la empresa se adapte a estas condiciones:</li> <li>los miembros de los departamentos relacionados con la contabilidad, comercial, compras, ventas o finanzas de la empresa deber\u00e1n tener estas limitaciones: se les ocultar\u00e1 la unidad C:\\ de sus equipos, se ocultar\u00e1 el men\u00fa de opciones de carpeta para que no puedan ver los ficheros ocultos ni cambiar ninguna configuraci\u00f3n y , por \u00faltimo, denegar el acceso (ni lectura ni escritura) a cualquier dispositivo extra\u00edble.</li> <li>en la empresa habr\u00e1 una serie de empleados denominados \u201cAyudantes TIC\u201d que tendr\u00e1n una serie de privilegios para poder ayudar a los encargados del directorio. \u00c9stos usuarios podr\u00e1n realizar las siguientes configuraciones: modificar la configuraci\u00f3n de red, el registro, instalar y desinstalar programas y modificar la apariencia del Escritorio.</li> <li>algunos de los usuario del departamento Comercial requerir\u00e1n salir de las oficinas con sus equipos port\u00e1tiles, por lo que deber\u00e1n disponer de ciertos privilegios: cambiar la configuraci\u00f3n de red y tendr\u00e1n acceso de lectura y de escritura a las unidades extra\u00edbles.</li> <li>se establecer\u00e1 un tama\u00f1o m\u00e1ximo de 500 MB para la papelera de reciclaje a todos los usuarios, excepto a los miembros de TIC y Gerencia que no tendr\u00e1n esta pol\u00edtica establecida.</li> </ol> <p>Manera de entrega de las actividades</p> <p>Redacta una gu\u00eda de los pasos a seguir para realizar esta actividad y s\u00fabela al Moodle del m\u00f3dulo.   De tal forma que en cada uno de los pasos incluya una imagen que verifique que se ha realizado aquello que se pide en cada uno de los ejercicios. Como en las anteriores actividades</p> <p>Warning</p> <p>SOLO LAS ACTIVIDADES 1,2 SON OBLIGATORIAS.</p>"},{"location":"UD7/adminDirecGrupo/","title":"Administraci\u00f3n de directivas de grupo","text":"<p>La administraci\u00f3n de las directivas de grupo en Microsoft Windows Server se realiza a trav\u00e9s del Editor de administraci\u00f3n de directivas de grupo al cual se accede a trav\u00e9s de Administraci\u00f3n del servidor \u2192 Herramientas \u2192 Administraci\u00f3n de directivas de grupo \u2192 Editar... , haciendo clic sobre el objeto de directiva que se desea editar. El uso de esta herramienta es intuitivo y autoexplicativo.</p> <p>En Ubuntu Server estas configuraciones se realizan a trav\u00e9s del subcomando samba-tool gpo, el cual ofrece las siguientes opciones:</p> <pre><code>$ samba-tool gpo\n\nUsage: samba-tool gpo &lt;subcommand&gt;\nGroup Policy Object (GPO) management.\nOptions:\n-h, --help show this help message and exit\nAvailable subcommands:\naclcheck - Check all GPOs have matching LDAP and DS ACLs.\ncreate - Create an empty GPO.\ndel - Delete a GPO.\ndellink - Delete GPO link from a container.\nfetch - Download a GPO.\ngetinheritance - Get inheritance flag for a container.\ngetlink - List GPO Links for a container.\nlist - List GPOs for an account.\nlistall - List all GPOs.\nlistcontainers - List all linked containers for a GPO.\nsetinheritance - Set inheritance flag on a container.\nsetlink - Add or update a GPO link to a container.\nshow - Show information for a GPO.\nFor more help on a specific subcommand, please type:\nsamba-tool gpo &lt;subcommand&gt; (-h|--help)\n</code></pre>"},{"location":"UD7/adminDirecGrupo/#creacion-y-edicion-de-una-directiva-de-grupo","title":"Creaci\u00f3n y edici\u00f3n de una directiva de grupo","text":"<p>Con la herramienta Administraci\u00f3n de directivas de grupo de Microsoft Windows Server tan s\u00f3lo ser\u00e1 necesario situar el cursor en el apartado Objetos de directiva de grupo e ir al men\u00fa Acci\u00f3n \u2192 Nuevo y crear un nuevo objeto asign\u00e1ndole un nombre.</p> <p>Una vez creado, se usar\u00e1 el Editor de administraci\u00f3n de directivas de grupo para aplicar la configuraci\u00f3n necesaria a la nueva directiva. Para buscar la directiva adecuada, si no se conoce su paradero, es conveniente usar el filtro de b\u00fasqueda.</p> <p></p> <p></p> <p>Si es necesario encontrar una directiva relacionada con el registro del sistema operativo, verbigracia, desde el men\u00fa Acci\u00f3n \u2192 Opciones de filtro\u2026 es posible aplicar un filtro relacionado con la tem\u00e1tica de la directiva. Lo m\u00e1s eficaz es usar la opci\u00f3n Habilitar filtros de palabra clave y buscar alguna coincidencia en el t\u00edtulo de la directiva o en el texto de ayuda.</p> <p>Localizada la directiva se editar\u00e1 pulsando doble clic sobre ella. Esto abrir\u00e1 la ventana de edici\u00f3n que constar\u00e1 de la informaci\u00f3n sobre la directiva:</p> <ul> <li>comentario, es conveniente indicar los motivos por los que se ha configurado esta directiva para el resto de administradores o para uno con mala memoria.</li> <li>compatible con, identifica los sistemas operativos con los que es compatible esa directiva. Aplicar una directiva para un sistema operativo que no figura en la lista, no tendr\u00e1 ning\u00fan efecto sobre el cliente.</li> <li>opciones, algunas directivas poseen opciones de configuraci\u00f3n, las cuales se especifican en este apartado.</li> <li>ayuda, una detallada descripci\u00f3n de los efectos de la directiva en sus diferentes configuraciones.</li> </ul> <p>Al margen de estos elementos, cada directiva dispone de varios valores de configuraci\u00f3n. La mayor\u00eda de directivas ofrecen tres opciones:</p> <ul> <li>no configurada, la directiva no tiene efecto alguno.</li> <li>habilitada, la directiva ejerce su efecto sobre los objetos del directorio donde haya sido vinculada.</li> <li>deshabilitada, la directivo no ejerce su efecto.</li> </ul> <p></p> <p>Aunque pueda parecer una contradicci\u00f3n, no configurada y deshabilitada poseen efectos diferentes en algunas pol\u00edticas, sobre todo en las que niegan aluna acci\u00f3n. En cualquier caso, una pol\u00edtica no configurada no formar\u00e1 parte de la plantilla administrativa que genera el dominio con la configuraci\u00f3n de la directiva de grupo, una deshabilitada s\u00ed lo hace.</p> <p>En GNU/Linux se dispone del comando <code>samba-tool gpo</code> pero la administraci\u00f3n de las GPO a trav\u00e9s de este comando resulta algo tediosa y muy limitada. Este comando est\u00e1 destinado a la creaci\u00f3n y consulta r\u00e1pida de los ficheros que componen una directiva de grupo. Una opci\u00f3n m\u00e1s interesante es el uso de aplicaciones con GUI, ya que, para esta tarea resulta altamente recomendable su uso.</p> <p>Existen varias opciones para realizar esta tarea entre ellas SWAT (Samba Web Admin Tool) y RSAT (Remote Server Administration Tool) de Microsoft. Es preferible el uso de RSAT para la gesti\u00f3n de las GPO ya que el uso de una GUI es de vital importancia para poder administrar de forma eficaz la cantidad de directivas con las que cuenta Active Directory.</p> <p>La instalaci\u00f3n de estas herramientas as\u00ed como su uso se ver\u00e1n en unidades sucesivas.</p>"},{"location":"UD7/adminDirecGrupo/#vinculacion-de-una-directiva-de-grupo","title":"Vinculaci\u00f3n de una directiva de grupo","text":"<p>Tras la configuraci\u00f3n de la directiva, es necesario indicar a qu\u00e9 objetos va a afectar. La vinculaci\u00f3n se realiza a trav\u00e9s de la herramienta Administraci\u00f3n del servidor \u2192 Herramientas \u2192 Administraci\u00f3n de directivas de grupo. Se selecciona el objeto continente al que se debe aplicar la directiva creada y en con el men\u00fa Acci\u00f3n \u2192 Vincular un GPO existente\u2026 se podr\u00e1 realizar el v\u00ednculo.</p> <p></p> <p>Una vez realizado, todos los elementos que est\u00e9n contenidos del objeto vinculado heredar\u00e1n de forma autom\u00e1tica esta pol\u00edtica. A veces es necesario que uno de los objetos contenidos no herede esa pol\u00edtica ya que necesita otra configuraci\u00f3n distinta al resto. En el ejemplo mostrado en la imagen, es posible que los empleados del Departamento de Administraci\u00f3n requieran de otras necesidades y ser\u00e1 preciso bloquear la herencia para poder aplicar una directiva menos restrictiva.</p> <p></p> <p>Para comprobar que todo ha resultado como debiera, se puede consultar la pesta\u00f1a Herencia de directivas de grupo en donde todas las unidades organizativas de miepresaFea heredan las pol\u00edticas de Default Domain Policy y de EmpleadosFeos. La \u00fanica que no tiene herencia es la unidad organizativa que ha sido bloqueada. Por supuesto, este proceso es reversible y si el bloqueo desaparece, el objeto estar\u00e1 afectado de nuevo por las directivas superiores.</p>"},{"location":"UD7/adminDirecGrupo/#actualizacion-de-clientes","title":"Actualizaci\u00f3n de clientes","text":"<p>La directiva de grupo se aplica a la configuraci\u00f3n del equipo cuando se inicia el sistema operativo, y del usuario una vez que \u00e9ste inicia sesi\u00f3n en el equipo. Adem\u00e1s, tambi\u00e9n se actualizan de forma regular durante la sesi\u00f3n de trabajo, y se asegura de aplicar las nuevas directivas y cambiados sin esperar a que el equipo se reinicie o el usuario cierre sesi\u00f3n. El periodo de tiempo entre estas actualizaciones se llama intervalo de actualizaci\u00f3n de la directiva de grupo y el valor predeterminado es de noventa minutos, m\u00e1s un intervalo de tiempo al azar para evitar que todos los equipos se actualicen al mismo tiempo. Si se modifica una directiva en mitad de la sesi\u00f3n de trabajo, \u00e9sta aplicar\u00e1 los cambios en noventa minutos. No es necesario esperar al cierre de sesi\u00f3n o el reinicio del equipo.</p> <p>No obstante, si la actualizaci\u00f3n ha de ser inmediata, existe la opci\u00f3n de realizarla de forma manual a trav\u00e9s del comando <code>gpupdate</code>. Si adem\u00e1s se usa el modificador <code>/force</code> se forzar\u00e1 a actualizar todas las directivas de grupo y no s\u00f3lo aquellas que hayan cambiado. En ninguno de los dos casos se actualizan las directivas configuradas como no configurada.</p> <pre><code>gpupdate\nActualizando directiva\u2026\n\nLa actualizaci\u00f3n de la directiva de equipo se complet\u00f3 correctamente.\nSe complet\u00f3 correctamente la Actualizaci\u00f3n de directiva de usuario.\n</code></pre> <p>En los sistemas operativos con Samba como gestor de directorio, para actualizar las pol\u00edticas ser\u00e1 necesario reiniciar el servicio de la siguiente manera</p> <pre><code>sudo /etc/init.d/samba/stop\nsudo /etc/init.d/samba/restart\n</code></pre> <p>Adem\u00e1s se puede utilizar las opciones que ofrece el comando para descargar los ficheros de directiva, y despu\u00e9s proceder a su comprobaci\u00f3n</p> <pre><code>sudo samba-tool gpo fetch\nsudo samba-tool gpo aclcheck\n</code></pre> <p>A pesar de existir estas opciones a trav\u00e9s del terminal, en sistemas basados en GNU/Linux, es preferible usar las herramientas GUI para realizar estas acciones.</p>"},{"location":"UD7/adminDirecGrupo/#copia-de-seguridad-y-restauracion-de-una-directiva-de-grupo","title":"Copia de seguridad y restauraci\u00f3n de una directiva de grupo","text":"<p>Crear diferentes directivas de grupo es una tarea costosa que bien podr\u00eda ser uno de los c\u00edrculos del infierno de Dante Alighieri. Es extremadamente recomendable realizar una copia de seguridad de las plantillas administrativas. En la herramienta Administraci\u00f3n de directiva de grupo, situando el curso sobre Objetos de directiva de grupo y yendo al men\u00fa Acci\u00f3n \u2192  da acceso a un sencillo asistente que permitir\u00e1 realizar las copias de seguridad.</p> <p>Para proceder con la restauraci\u00f3n de una directiva de grupo en concreto, existe otro asistente al que se accede de id\u00e9ntica forma que el anterior, salvo que esta ver se accede dese el men\u00fa Acci\u00f3n \u2192 Administrar copias de seguridad\u2026 . El control de las directivas de grupo puede suponer una tarea tediosa, pero los resultados en cuanto a seguridad son una gran recompensa por el tiempo empleado. Una buena gesti\u00f3n de pol\u00edticas de grupo pasa por, al igual que con los permisos a recursos, permitir al usuario realizar las tareas que debe hacer, ninguna m\u00e1s.</p>"},{"location":"UD7/directivasGrupo/","title":"Directivas de grupo","text":"<p>Las directivas de grupo o GPO (Group Policy Object) son un conjunto de configuraciones espec\u00edficas para usuarios y equipos de un dominio. Cuando una directiva de grupo es aplicada en un controlador de dominio, todos los objetos del que es responsable han de cumplir esa regla. Adem\u00e1s, su utilizaci\u00f3n es sencilla y centralizada. Bastar\u00e1 habilitar o deshabilitar la opci\u00f3n necesitada en el gestor de GPO.</p> <p>Los requisitos para usar GPO:</p> <ul> <li>la red debe basarse en una estructura de directorio y existir un controlador de dominio al menos.</li> <li>los equipos y usuarios a administrar deben estar unidos al dominio, y deben usar credenciales de dominio para iniciar sesi\u00f3n en sus equipos. Es decir, ser un objeto del directorio.</li> </ul> <p>Tambi\u00e9n es posible configurar GPO de forma local en cada equipo. Esta capacidad es interesante en escenarios excepcionales o equipos de grupo de trabajo, pero no se recomienda el uso de la directiva de grupo local en redes de empresa. El motivo es simple, la directiva de grupo basada en dominio centraliza la administraci\u00f3n. La directiva de grupo local requiere configuraci\u00f3n para cada equipo, lo que no es un escenario ideal en un entorno de una red empresarial.</p> <p>Es importante resaltar que las GPO tienen prioridad sobre las opciones de configuraci\u00f3n del perfil del usuario en caso de que se cree un conflicto entre ambas configuraciones. Se trata del nivel m\u00e1s alto en las restricciones de seguridad del dominio.</p> <p>Diferentes Herramientas</p> <p>Para la configuraci\u00f3n de GPO que s\u00f3lo afecten a un usuario o equipo local se puede utilizar el editor de directivas locales <code>gpedit.msc</code>. En nuestro caso accederemos en el entorno de Servicios de Dominio de Active Directory, con la consola de administraci\u00f3n <code>gpmc.msc</code></p> <p>Curiosamente, y pese a su nombre, las Directivas de Grupo no pueden ser asociadas a un grupo de usuarios o grupos de equipos, pues tan s\u00f3lo son aplicables a Sitios, Dominios o Unidades Organizativas, y el resultado de su aplicaci\u00f3n afecta a los objetos que contienen.</p>"},{"location":"UD7/directivasGrupo/#ambito-de-las-directivas","title":"\u00c1mbito de las directivas","text":"<p>La configuraci\u00f3n de GPO est\u00e1 contenida en un objeto de directiva de grupo, de modo que se asocia dicha directiva a los Sitios, Dominios o Unidades Organizativas del directorio. Es posible asignar una GPO a un objeto determinado del dominio y afectar\u00e1 al resto de objetos que contiene. Si es necesario aplicar una serie de reglas a un conjunto de equipos, es preferible introducir esos equipos en una unidad organizativa y aplicar una GPO a dicha unidad, que asignar esa pol\u00edtica equipo por equipo. Tambi\u00e9n es posible aplicar diferentes GPO a un mismo objeto. En ese caso ser\u00e1 necesario indicar, adem\u00e1s, el orden en el que aplicar\u00e1n esas directivas en el objeto.</p> <p></p> <p>Cuando se habilita una GPO, el orden en que la misma es aplicada es el siguiente:</p> <ul> <li>en primer lugar se aplica el objeto de directiva de grupo local \u00fanico de cada equipo.</li> <li>en segundo lugar se aplican los objetos de directiva de grupo del sitio, en el orden especificado administrativamente.</li> <li>en tercer lugar los objetos de directiva de grupo del dominio, en el orden especificado administrativamente.</li> <li>en cuarto lugar los objetos de directiva de grupo de las unidades organizativas, de unidad organizativa principal a secundaria, y en el orden especificado administrativamente en el nivel de cada unidad.</li> </ul> <p>De forma predeterminada, cuando las directivas son incoherentes las aplicadas en \u00faltimo lugar sobrescriben las directivas aplicadas con anterioridad. Sin embargo, si no hay incoherencias de configuraci\u00f3n, tanto las directivas anteriores como las posteriores contribuyen a la directiva efectiva, es decir, se suman las configuraciones de las distintas directivas asociadas al objeto en cuesti\u00f3n.</p> <p>Hay que tener en cuenta que existe herencia entre los objetos a los que se le aplican las GPO. Si se asigna una directiva de grupo a una unidad organizativa, los objetos contenidos en ella, heredan esa pol\u00edtica. Algo muy similar a lo que ocurre con los permisos de acceso. La herencia puede ser bloqueada. Si un administrador bloquea una GPO a un objeto de nivel superior, autom\u00e1ticamente dejar\u00e1 de afectar al objeto bloqueado. Si ese objeto contiene otros objetos, \u00e9stos tambi\u00e9n tendr\u00e1n la herencia bloqueada.</p> <p></p> <p>Bloquear la herencia implica que no heredar\u00e1 directivas del dominio, ni tampoco sus directivas descendientes. Sin embargo, s\u00ed se producir\u00e1 herencia a partir de la directiva hacia abajo.</p>"},{"location":"UD7/directivasGrupo/#directivas-de-grupo-por-defecto","title":"Directivas de grupo por defecto","text":"<p>Al crearse el domino, tambi\u00e9n se crean las dos directivas que le afectan por defecto:</p> <ul> <li>Default Domain Policy, la cual se sit\u00faa en la ra\u00edz del dominio y afecta al conjunto de unidades organizativas. Los par\u00e1metros que contiene son de configuraci\u00f3n b\u00e1sica, entre ellos los de contrase\u00f1a y de bloqueo.</li> <li> <p>Default Domain Controller Policy, se sit\u00faa y afecta a la unidad organizativa Domain Controllers. Los par\u00e1metros de la directiva se reservan a los controladores de dominio y se pueden configurar los siguientes tipos de par\u00e1metros:</p> <ul> <li>directivas de asignaciones de derechos, permiten atribuir permisos adicionales a un usuario.</li> <li>directiva de opciones de seguridad, permite la configuraci\u00f3n de los par\u00e1metros de auditor\u00eda.</li> </ul> </li> </ul> <p>Es rese\u00f1able que estas GPO no tienen una profusa configuraci\u00f3n y se centran en aspectos fundamentalmente de seguridad. Estas dos pol\u00edticas podr\u00edan ser editadas para incluir todas las configuraciones que sean necesarias, pero es buena pr\u00e1ctica crear diferentes objetos de GPO en funci\u00f3n de la configuraci\u00f3n que contengan.</p> <p></p>"},{"location":"UD7/directivasGrupo/#contenido-del-objeto-de-directiva-de-grupos","title":"Contenido del objeto de directiva de grupos","text":"<p>Los objetos que contienen las directivas de grupo poseen una estructura jerarquizada destinada a organizar la ingente cantidad de opciones que son configurables en GPO. En cada directiva aparecen dos ramas que agrupan las opciones dependiendo si lo son para configurar el equipo o a los usuarios. Dentro de cada una de ellas se encuentran las mismas ramas aunque con directivas distintas:</p> <ul> <li>configuraci\u00f3n de software, listado de software que el equipo debe tener instalado. Si no es as\u00ed, se instalar\u00e1 desde el repositorio especificado en la directiva.</li> <li>configuraci\u00f3n de Windows, directivas basadas en la configuraci\u00f3n sistema operativo que debe tener para poder pertenecer al dominio y la configuraci\u00f3n de seguridad m\u00ednima. Desde esta rama se configuran los scripts de inicio y apagado, las impresoras de red que el equipo debe tener y la configuraci\u00f3n de seguridad, entre otras muchas opciones.</li> <li>plantillas administrativas, listado de todas las directivas que hacen referencia a la configuraci\u00f3n del sistema operativo. \u00c9ste es el grueso de los contenidos de directiva y son archivos de configuraci\u00f3n en formato ADMX que se sit\u00faan en la carpeta SYSVOL del controlador de dominio que las exige. Desde all\u00ed, estas plantillas se distribuyen entre los equipos cliente y el resto de controladores.</li> </ul> <p>Para facilitar la aplicaci\u00f3n de estas directivas, es posible filtrar qu\u00e9 rama debe aplicarse. Si , por ejemplo, una directiva s\u00f3lo hace referencia a modificaciones en la rama de equipo, es posible desactivar la de usuario para que el equipo receptor no compruebe estas configuraciones, ahorrando as\u00ed un tiempo de c\u00f3mputo valioso.</p> <p></p>"},{"location":"UD7/directivasGrupo/#plantillas-administrativas","title":"Plantillas administrativas","text":"<p>Los archivos de plantilla administrativa contienen la configuraci\u00f3n de las directiva de grupo configuradas en el dominio. Son archivos basados en XML con funcionalidad multiling\u00fce y se almacenan en la carpeta <code>%SystemRoot%\\PolicyDefinitions</code>.</p> <p>Una plantilla administrativa est\u00e1 compuesta por dos tipos de archivo: ADMX (Administrative Template XML-Based) y ADML (Administrative Template Language Package). El primero contiene la informaci\u00f3n independientemente de la estructura y determina la configuraci\u00f3n de la directiva o directivas configuradas. Los archivos ADML proporcionan la estructura que necesitan los archivos ADMX para mostrar la configuraci\u00f3n en el idioma o estructura correcta.</p> <p>Adem\u00e1s del contenido y su estructura, estos archivos tambi\u00e9n contienen la informaci\u00f3n sobre ubicaciones en el registro, opciones o restricciones en los valores asociados, valores predeterminados para opciones no definidas y explicaciones de texto acerca del prop\u00f3sito de cada configuraci\u00f3n.</p> <p>Cuando se genera un directorio con Active Directory, se crea un almac\u00e9n central, una carpeta para contener estas plantillas. Esta carpeta es gestionada por el administrador y creada en el recurso SYSVOL. Se trata de la ubicaci\u00f3n de almacenamiento predeterminada y centralizada para todos los archivos de plantilla administrativa del dominio.</p> <p>Las herramientas de la directiva de grupo usan solamente los archivos situados en el controlador de dominio e ignoran las versiones almacenadas localmente. La carpeta ra\u00edz para el almac\u00e9n central se debe denominar policies y debe situarse en <code>%SystemRoot%\\SYSVOL\\domain\\policies</code>. En ella se encontrar\u00e1n los archivos de configuraci\u00f3n de cada uno de los objetos de directiva identificada por su GUID (Globaly User Identifier).</p> <p>De igual forma ocurre en Ubuntu Server. Samba ubica las pol\u00edticas de grupo en la ruta <code>\\\\nombre_del_dominio\\sysvol\\nombre_del_dominio\\Policies</code>, y de igual manera se identifican con su GUID.</p> <p>El comando para comprobar las dos directivas de grupos creadas de forma predeterminada es:</p> <pre><code>samba-tool gpo listall\nGPO : {31B2F340-016D-11D2-945F-00C04FB984F9}\ndisplay name : Default Domain Policy\npath : \\\\miempresafea.local\\sysvol\\miempresafea.local\\Policies\\{31B2F340-016D-11D2-945F-00C04FB984F9}\ndn : CN={31B2F340-016D-11D2-945F-00C04FB984F9},CN=Policies,CN=System,DC=miempresafea,DC=local\nversion : 0\nflags : NONE\n\nGPO : {6AC1786C-016F-11D2-945F-00C04FB984F9}\ndisplay name : Default Domain Controllers Policy\npath : \\\\miempresafea.local\\sysvol\\miempresafea.local\\Policies\\{6AC1786C-016F-11D2-945F-00C04FB984F9}\ndn : CN={6AC1786C-016F-11D2-945F-00C04FB984F9},CN=Policies,CN=System,DC=miempresafea,DC=local\nversion : 0\nflags : NONE\n</code></pre>"},{"location":"UD7/directivasGrupo/#directivas-de-auditoria","title":"Directivas de auditoria","text":"<p>La auditor\u00eda permite almacenar una entrada en un registro de eventos cuando un usuario realiza alguna acci\u00f3n en el sistema, registrando al usuario y que acci\u00f3n ha realizado. Esta informaci\u00f3n es extremadamente \u00fatil para ayudar a identificar problemas en el sistema o para comprobar en cada momento las actividades de los usuarios. Entre otros, es posible auditar varios tipos de eventos:</p> <ul> <li>eventos de inicio de sesi\u00f3n de cuenta, que audita cada conexi\u00f3n y desconexi\u00f3n de un usuario o equipo.</li> <li>administraci\u00f3n de cuentas, al registrar este evento resulta muy sencillo conocer qui\u00e9n ha creado, modificado o eliminado una cuenta.</li> <li>acceso del servicio de directorio, determina que usuarios y grupos acceden a los objetos del dominio.</li> </ul> <p>Configurar las auditor\u00edas es \u00fatil cuando se debe seguir el rastro de alg\u00fan problema de rendimiento o de seguridad. En directorios de un considerable tama\u00f1o no es recomendable auditar cada uno de los objetos de dominio ya que el consumo de recursos puede mermar tareas m\u00e1s perentorias del sistema. Como es habitual, se debe encontrar un compromiso entre seguridad y rendimiento, auditando tan solo los puntos cr\u00edticos del sistema. Aunque este tema ser\u00e1 tratado ampliamente con posterioridad.</p>"},{"location":"UD7/equiposDominio/","title":"Equipos del dominio","text":"<p>Las cuentas de equipo en un dominio representan los equipos que se introducen en el directorio y, Igual que sucede con las cuentas de usuario, deben ser \u00fanicas en todo el dominio. Las cuentas de equipos se crean con dos objetivos fundamentales:</p> <ul> <li>autenticar la identidad de un equipo ya que s\u00f3lo podr\u00e1n iniciar una sesi\u00f3n desde aquellos equipos que pertenezcan al dominio, aunque esto es decisi\u00f3n del administrador.</li> <li>autorizar o denegar el acceso a los recursos del dominio.</li> </ul> <p>Cuando un equipo se une al dominio, de forma autom\u00e1tica se crea la cuenta de ese equipo, aunque se puede crear de forma manual. Esta cuenta posee informaci\u00f3n sobre el equipo del dominio y permite hacer referencia a ese equipo.</p> <p></p> <p>En Microsoft Windows Server, se dispone de la herramienta Administrador del servidor \u2192 Herramientas \u2192 Usuarios y equipos de Active Directory que permite a gesti\u00f3n de cuentas de equipo. Por defecto, las cuentas creadas de forma autom\u00e1tica se almacenan en la unidad organizativa Computers si trabajan como estaciones de trabajo o en Domain Controllers si lo hacen como controladores de dominio. Es posible crear nuevas unidades organizativas y mover las cuentas de equipo seg\u00fan las necesidades del proyecto; organizar los equipos por sistema operativo instalado, por ubicaci\u00f3n o por el color de la caja, todo depender\u00e1 de las necesidades de administraci\u00f3n.</p> <p>Samba no dispone de esta gesti\u00f3n por el momento y las cuentas de equipo se generan siempre de forma autom\u00e1tica. En futuras versiones se incluir\u00e1 un subcomando para la gesti\u00f3n de estos elementos.</p>"},{"location":"UD7/estrategiaAnidamiento/","title":"Estrategias de anidamiento","text":"<p>Un grupo es un conjunto de cuentas de usuario, equipos, contactos y otros grupos que se pueden administrar como una sola unidad. Los usuarios y los equipos que pertenecen a un grupo determinado se denominan miembros del grupo. Cada grupo creado dentro de un dominio tiene un identificador num\u00e9rico para que el sistema lo gestione, con la excepci\u00f3n de un determinado tipo de grupo denominado de distribuci\u00f3n que no lo posee. Los grupos de dominio se usan para:</p> <ul> <li>simplificar la administraci\u00f3n, si se asignan permisos para un recurso compartido a un grupo, se concede el mismo acceso al recurso a todos los miembros de dicho grupo.</li> <li>delegar la administraci\u00f3n, a un grupo le puede agregar miembros que desee que tengan los mismos derechos o permisos de los que disponga el grupo.</li> <li>crear listas de distribuci\u00f3n de correo electr\u00f3nico.</li> </ul> <p>Se caracterizan por su \u00e1mbito y su tipo. El \u00e1mbito determina el alcance del grupo dentro de un dominio, bosque o directorio. El tipo determina el uso que se la va a dar al grupo. Existen diferentes tipos de grupo en un directorio:</p> <ul> <li>grupos de distribuci\u00f3n, se utilizan para crear listas de distribuci\u00f3n de correo electr\u00f3nico. Estos grupos no disponen de caracter\u00edsticas de seguridad ni identificador de grupo, por lo que no pueden aparecer en las listas de control de acceso discrecional DACL (Discretionary Access Control Lists). Esto quiere decir que no se le pueden asignar permisos a ning\u00fan recurso del sistema.</li> <li>grupos integrados o builtin, creados durante la instalaci\u00f3n de los servicios de directorio y son fundamentales para simplificar la asignaci\u00f3n de funciones de administraci\u00f3n del sistema.</li> <li>grupos de seguridad, los cuales permiten asignar permisos sobre los recursos compartidos.</li> </ul> <p>Para ilustrar la utilidad de los los objetos descritos en este tema, se va a crear una empresa ficticia basada en el siguiente organigrama:</p> <p> Como se aprecia en gr\u00e1fico, la empresa est\u00e1 formada por cuatro grandes departamentos relacionados entre s\u00ed; Gerencia, Administraci\u00f3n, Comercial y Mantenimiemto. Algo m\u00e1s peque\u00f1os y dependientes de departamentos mayores existen los de Comerciales, Distribuidores, dependientes de del departamento comercial, y Desarrolladores y T\u00e9cnicos, dependientes del departamento Mantenimiento. No es de extra\u00f1ar esta agrupaci\u00f3n, ya los empleados adscritos a cada departamento van a disponer de unas tareas, habilidades, conocimientos y necesidades distintas a los otros.</p> <p>En este tema se dispondr\u00e1 de varios objetos para trasladar esa estructura de la vida real al directorio. Bien es cierto que no existe una \u00fanica soluci\u00f3n v\u00e1lida, pero hay algunas van que funcionan mejor que otras.</p>"},{"location":"UD7/gruposSeguridad/","title":"Grupos de seguridad","text":"<p>Estos grupos son creados en el dominio, por los administradores, para adaptar a \u00e9ste al funcionamiento de la empresa o actividad que se necesite gestionar. Es posible crear un n\u00famero infinito de grupos para dar servida cuenta a las necesidades de la empresa. A estos grupos se les asigna derechos y permisos sobre recursos de manera directa, de este modo aparecen en las listas de control de acceso discrecional DACL (Discretionary Access Control Lists) y eso los faculta para acceder a los recursos compartidos.</p> <p>Es usual que muchos de estos grupos representen parte de la realidad de la empresa. As\u00ed como las cuentas de usuario representan a los empleados, los grupos representan a partes funcionales de la misma. Por ejemplo, en una empresa de desarrollo de software existen empleados encargados de escribir c\u00f3digo y otros de comprobarlo. Resulta evidente que cada usuario necesita unos permisos diferentes de acceso al recurso (en este caso el c\u00f3digo fuente del programa). En esta situaci\u00f3n es conveniente crear dos grupos de seguridad y asignar los permisos de escritura a uno de ellos y de lectura a otro. Despu\u00e9s, asignar a los desarrolladores al grupo con permiso de escritura y a los probadores al grupo de lectura.</p> <p>SID (Security Identifier) es un identificador</p> <p>Se asigna a cada objeto. Estos identificadores han de ser \u00fanicos en todo el \u00e1mbito del directorio. No importa que dos objetos tengan el mismo nombre si pertenecen al dominios distintos, aunque en realidad no es cierto ya que existen el FQDN. Por ejemplo dos grupos de nombre \u201cAdministradores\u201d en dominios distintos. Cada uno de esos grupos tendr\u00e1 un SID distinto y el sistema operativo se referir\u00e1 a \u00e9l a trav\u00e9s de este SID. Este identificador est\u00e1 formado por el identificador del dominio al que pertenece y el identificador propio del objeto.</p> <p>Aunque muy simple, este es un buen ejemplo para entender las estrategias de divisi\u00f3n y anidamiento de los grupos y su fortaleza. Que duda cabe que una buena estrategia a la hora de crear grupos facilita enormemente la gesti\u00f3n de acceso a los recursos del directorio.</p> <p>Los grupos de seguridad poseen otra caracter\u00edstica que no hay que descuidar, el \u00e1mbito del grupo. Se entiende por \u00e1mbito como el \u00e1rea de acci\u00f3n a la que los miembros del grupo tendr\u00e1n acceso. Un directorio puede estar dividido en varios bosques, estos bosques en dominios y estos \u00faltimos en subdominios. Cada una de estas secciones del directorio es un \u00e1mbito de actuaci\u00f3n al que poder limitar las acciones de un grupo. Si se limita el \u00e1mbito de acci\u00f3n de un grupo a un determinado dominio, este grupo no podr\u00e1 ejercer sus derechos fuera de \u00e9l.</p> <p>Estas limitaciones son muy \u00fatiles cuando la estructura del dominio es muy grande y segmentada, ya que enclaustra a los usuarios en una determinada zona de acci\u00f3n y limita el acceso a otras \u00e1reas. Una buena planificaci\u00f3n de grupos pasa por permitir hacer a los usuarios tan s\u00f3lo lo que est\u00e9n destinados a hacer.</p> <p>Para ilustrar un ejemplo de grupos se dispone de un directorio dividido en tres subdominios. Cada uno de estos subdominios posee un controlador de dominio regional (CDR) encargado de gestionar sus propios objetos. Estos tres CDR se encuentran conectados a su vez a un controlador de dominio principal, el cual gestiona todos los objetos del sistema y contiene el cat\u00e1logo global (CG). Por supuesto, \u00e9ste posee un controlador de dominio secundario (CDS) que tomar\u00e1 el control si el CDP deja de funcionar.</p> <p>Se dispone de varias opciones de \u00e1mbito:</p> <ul> <li>grupos de seguridad locales de dominio, cuentan con un identificador SID (Security IDentified) que es reconocido dentro del dominio en el que se crean, de modo que estos grupos no ser\u00e1n visibles fuera del dominio. Dentro del \u00e1mbito en el que fue creado, todos los controladores de dominio y todos los clientes ser\u00e1n capaces de reconocerlos.</li> </ul> <p>Los grupos locales de dominio pueden contener como miembros a usuarios de cualquier dominio, a grupos globales de cualquier dominio, a grupos universales de cualquier dominio, y a otros grupos locales, pero \u00e9stos \u00faltimos creados dentro del propio dominio.   </p> <ul> <li>grupos de seguridad globales de dominio, su SID (Security IDentified) es reconocido fuera de su propio dominio, por lo que puede ser visto y usado en dominios que no son el propio donde se crearon. Estos grupos pueden contener como miembros \u00fanicamente cuentas de usuario y grupos globales de su propio dominio. </li> <li>grupos de seguridad universales, no tienen ning\u00fan tipo de limitaci\u00f3n y su SID es reconocido en todo el directorio. Pueden ser vistos en cualquier dominio del \u00e1rbol, y pueden contener cualquier tipo de usuario o grupo de cualquier dominio. Se recomienda no utilizarlos, ya que es posible llegar a crear situaciones de inseguridad para algunos recursos.   </li> </ul> <p>En Microsoft Windows Server, la administraci\u00f3n de los grupos se realiza a trav\u00e9s de la herramienta  Administrador del servidor \u2192 Herramientas \u2192 Usuarios y equipos de Active Directory. Desde la opci\u00f3n Acci\u00f3n del men\u00fa es posible acceder a la gesti\u00f3n de los grupos de una manera f\u00e1cil y eficaz.</p> <p>Como siempre, la gesti\u00f3n de elementos del directorio en Ubuntu Server se realiza a trav\u00e9s de la interfaz CLI. Para ello se usa el comando <code>samba-tool group</code> que ofrece las siguientes opciones:</p> <pre><code>samba-tool group\nUsage: samba-tool group &lt;subcommand&gt;\n\nGroup management.\n\nOptions:\n-h, --help show this help message and exit\n\nAvailable subcommands:\nadd - Creates a new AD group.\naddmembers - Add members to an AD group.\ndelete - Deletes an AD group.\nlist - List all groups.\nlistmembers - List all members of an AD group.\nremovemembers - Remove members from an AD group.\n\nFor more help on a specific subcommand, please type: samba-tool group &lt;subcommand&gt; (-h|--help)\n</code></pre> <p>Se utilizar\u00e1 el siguiente comando para crea un grupo</p> <pre><code>samba-tool group add grupoFeo --group-scope=Domain --group-type=Security --description=\"Grupo del departamento Feos\" --gruopou=\"Departamentos\"\n</code></pre> <p>Estas son las opciones m\u00e1s importantes de este subcomando:</p> <ul> <li><code>--groupou=GROUPOU</code>, unidad organizativa donde se crear\u00e1 el grupo. Si no se especifica se crear\u00e1 en la ubicaci\u00f3n por defecto.</li> <li><code>--group-scope=GROUP_SCOPE</code>, \u00e1mbito del grupo que puede contener tres valores; Domain, Global o Universal.</li> <li><code>--group-type=GROUP_TYPE</code>, tipo de grupo Security o Distribution.</li> <li><code>--description=DESCRIPTION</code>, descripci\u00f3n del grupo entre comillas dobles.</li> <li><code>--gid-number=GID_NUMBER</code>, n\u00famero de identificaci\u00f3n del grupo.</li> </ul> <p>Este identificador debe crearse bajo las normas del documento de estandarizaci\u00f3n RFC2307 GID number. Si no se especifica, ser\u00e1 el controlador de dominio el que lo crear\u00e1 de forma autom\u00e1tica. Siempre es una buena opci\u00f3n dejar esta tarea al controlador de dominio.</p> <p>Si se necesita a\u00f1adir usuario al grupo</p> <pre><code>samba-tool group addmembers grupoFeo usuarioFeo1,usuarioFeo2,usuarioFeo3\n</code></pre> <p>El comando anterior a\u00f1adir\u00e1 a los tres usuario dentro del grupo grupoFeo reci\u00e9n creado. Para comprobarlo, es necesario usar el siguiente comando</p> <pre><code>samba-tool group listmembers grupoFeo\n</code></pre> <p>Aunque este m\u00e9todo de gesti\u00f3n parezca un anacronismo, en realidad es el que usa el sistema operativo debajo de la capa de abstracci\u00f3n que supone la GUI y, adem\u00e1s, permite la automatizaci\u00f3n de esta tareas mediante la creaci\u00f3n de scripts, tema que se abordar\u00e1 en lo sucesivo.</p>"},{"location":"UD7/gruposSeguridad/#grupos-predeterminados-incorporados-o-built-in","title":"Grupos predeterminados, incorporados o built-in","text":"<p>Cuando se instala un directorio se incluyen varios grupos predeterminados que se crean y se configuran autom\u00e1ticamente. \u00c9stos permiten agregar o eliminar usuarios si es necesario, pero no la eliminaci\u00f3n de los grupos en s\u00ed mismos. Por defecto, los grupos integrados carecen de derechos de acceso a recursos, es decir, no se pueden dar permiso de acceso a una carpeta a un grupo integrado de forma directa. A\u00fan as\u00ed, es posible asignar estos derechos agregando los grupos incorporados a grupos de seguridad creado por el administrador.</p> <p></p> <p>En Microsoft Windows Server se incluyen, entre otros, los siguientes grupos incorporados:</p> <ul> <li>Administradores, permite a los miembros del grupo realizar tareas administrativas.</li> <li>Invitados, conjunto de todos los invitados del dominio.</li> <li>Usuarios, realizan tareas para las que les hayamos concedido derecho a recursos. Todos los usuarios del dominio se agrupan aqu\u00ed.</li> <li>Opers. de cuentas, pueden crear, eliminar y modificar cuentas de usuario y otros grupos, a excepci\u00f3n del grupo Administradores.</li> <li>Operadores de servidores: pueden administrar los servidores de la red, apagarlos, instalar o cambiar la configuraci\u00f3n de hardware, servicios etc\u00e9tera.</li> <li>Operadores de copia de seguridad, tienen permiso para realizar copias de seguridad y restaurar todos los controladores de dominio.</li> <li>Operadores de impresi\u00f3n, son capaces de configurar y administrar impresoras de red que existan en los controladores de dominio.</li> </ul> <p>Tambi\u00e9n existen objetos cuya pertenencia a grupos no se pueden ver ni modificar. Estos grupos se conocen con el nombre de identidades especiales. Representan a distintos usuarios en distintas ocasiones, en funci\u00f3n de las circunstancias. Por ejemplo, el grupo Todos es una identidad especial que representa a todos los usuarios actuales de la red, incluidos invitados y usuarios de otros dominios.</p> <p>En GNU/Linux, y m\u00e1s concretamente en los servicios de directorio de Samba, existen multitud de estos grupos, alrededor de treinta y cinco grupos, que se pueden consultar mediante el comando</p> <pre><code>samba-tool group list\n</code></pre> <p>La mayor\u00eda de ellos poseen un nombre autoexplicativo, otros coinciden con los descritos en el caso de Microsoft Windows Server. En cualquier caso, no es necesario conocer los entresijos de todos y cada uno de estos grupos, pero s\u00ed saber que es posible contar con ellos para asignar tareas de administraci\u00f3n.</p> <p>A principio de este tema se ilustr\u00f3 un ejemplo de una empresa peque\u00f1a con diferentes departamentos. \u00bfCu\u00e1l ser\u00eda la distribuci\u00f3n en grupos de es estructura departamental?. La respuesta resulta casi instant\u00e1nea; es necesaria la creaci\u00f3n de un grupo por cada departamento y situar en ellos a las cuentas de usuario que trabajen en ellos.</p> <p>\u00bfY si un usuario trabaja en los departamentos de Gerencia y Administraci\u00f3n?. Nada obliga a una cuenta de usuario a pertenecer tan s\u00f3lo a un grupo, por lo que esa cuenta se encontrar\u00e1 ubicado en dos grupos.</p> <p>Con toda seguridad, existir\u00e1 un empleado que se encargar\u00e1 de coordinar cada departamento y que \u00e9stos van a requerir acceso a unos recursos diferentes para llevar a cabo esta tarea. Es posible crear un grupo con todos los coordinadores de cada departamento. A esto se le conoce como grupo transversal.</p> <p>Una buena planificaci\u00f3n de los grupos de seguridad y aplicar una l\u00f3gica estructura de anidamiento redunda en facilitar la administraci\u00f3n de los usuarios y sus permiso. Puede parecer una tarea tediosa para directorios peque\u00f1os, pero a medida que \u00e9stos crecen se empieza a observar los beneficios de esta organizaci\u00f3n de grupos.</p>"},{"location":"UD7/unidadesOrganiza/","title":"Unidades organizativas","text":"<p>Las unidades organizativas son objetos de directorio que contienen a otros objetos, pero que cuentan con la particularidad de que se pueden subordinar unas a otras. Adem\u00e1s, el n\u00famero de unidades organizativas que se pueden crear en el dominio Active Directory es ilimitado. Una vez que se ha creado una es posible poblarla con otros objetos, como usuarios, equipos, grupos y otras unidades organizativas.</p> <p>Cuando se traslada un objeto contenedor a una nueva ubicaci\u00f3n, se trasladan autom\u00e1ticamente todos los objetos incluidos en el contenedor al mismo tiempo y tambi\u00e9n se modifican las referencias a esos objetos en el resto de objetos del directorio. Cuando se elimina un objeto contenedor, todos los objetos incluidos en el contenedor se eliminan tambi\u00e9n. Algo a tener en cuenta es que las pol\u00edticas de grupo, concepto que se tratar\u00e1 en lo sucesivo, permisos y atributos ser\u00e1n propagados al contenido de la unidad organizativa que los ostenta. Es decir, si se aplica cierto conjunto de restricciones a una unidad organizativa, esas restricciones afectar\u00e1 a todos los objetos que contiene.</p> <p>Volviendo al ejemplo anterior de la peque\u00f1a empresa. La organizaci\u00f3n de los recursos de la empresa no tiene por que coincidir con los del dominio, aunque si as\u00ed fuese, todo funcionar\u00eda de una forma m\u00e1s org\u00e1nica. Cada departamento est\u00e1 compuesto por una serie de objetos de dominio; cuentas de usuario, equipos, grupos y recursos compartidos. Una buena organizaci\u00f3n ser\u00eda crear una unidad organizativa para cada departamento y que \u00e9sta contenga todos los objetos que le pertenezcan. Tras dicha organizaci\u00f3n ser\u00e1 mucho m\u00e1s sencillo dotar de permisos a los recursos de un departamento.</p> <p>Al contrario que ocurre con las cuentas de usuario y los grupos, un objeto de domino s\u00f3lo puede estar contenida en una \u00fanica unidad organizativa. Recuerda que cada objeto es \u00fanico en todo el directorio, no se pueden duplicar.</p> <p>Se puede utilizar la herramienta Usuarios y equipos de Active Directory para remodelar el \u00e1rbol en cualquier momento trasladando objetos a diferentes contenedores, cambi\u00e1ndoles el nombre y elimin\u00e1ndolos.</p> <p>Adem\u00e1s de suponer una interesante herramienta para la organizaci\u00f3n de los objetos del dominio, las unidades organizativas cuentan con la ventaja de poder ostentar conjuntos de directivas de grupo de forma personalizada. Las directivas de grupo son una potente herramienta de administraci\u00f3n que ser\u00e1 tratada en lo sucesivo. Si se aplica un conjunto de estas directivas, afectar\u00e1n a todos los objetos que contiene.</p> <p>En Ubuntu Server estas operaciones se realizan a trav\u00e9s de los comandos propios de cada objeto. No existe un subcomando para organizar estos contenedores como el de usuarios o grupos. La gesti\u00f3n de las unidades organizativas se realiza a trav\u00e9s de ficheros LDIF. Es un m\u00e9todo poco intuitivo, pero se est\u00e1 trabajando para que en nuevas versiones Samba introduzca la administraci\u00f3n de estos objetos a trav\u00e9s de <code>samba-tool ou</code> de igual modo que los usuarios y grupos.</p>"},{"location":"UD8/Actividades/","title":"Actividades de la UD8","text":""},{"location":"UD8/Actividades/#actividad-1","title":"Actividad 1","text":"<ol> <li> <p>Crea la estructura de directorios usando el script que encontrar\u00e1s en el Moodle del m\u00f3dulo. Para ello utiliza la carpeta Datos creada con anterioridad (recuerda que esta carpeta est\u00e1 montada en una de las particiones del segundo disco duro del servidor). Realiza esta tarea en los servidores ServidorWindows y en ServidorUbuntu.     Retoma el esquema de tu empresa y a\u00f1ade ahora la planificaci\u00f3n de los permisos y privilegios de acceso a los recursos compartidos. Es conveniente que antes de lanzarse a implementar un sistema de permisos, \u00e9stos sean planificados con calma. Para ello sigue estas premisas:</p> <ul> <li>debe denegar todos los permisos de forma predeterminada, de esta forma ning\u00fan usuario tendr\u00e1 acceso a nada hasta que no pase por una adecuada planificaci\u00f3n</li> <li>debe permitir a cada usuario lo que est\u00e9 destinado a hacer. Es buena idea que tan s\u00f3lo tengan permiso a hacer lo que deben hacer</li> <li>utiliza, si es posible, un s\u00f3lo sistema de permisos. En sistemas de Windows existen dos sistemas, como ya veremos, a la hora de implantarlo, utiliza s\u00f3lo uno de ellos para evitar contradicciones</li> <li>crea grupos y unidades organizativas nuevas si es necesario para la correcta consecuci\u00f3n de tus objetivos.</li> </ul> </li> </ol> <p>2.Una vez creada la estructura de carpetas, comparte y da permisos de escritura a la carpeta Pruebas a todos los empleados de la empresa, tanto en ServidorWindows a trav\u00e9s de GUI como en ServidorUbuntu a trav\u00e9s de CLI con <code>samba-tool</code>. Comprueba que los permisos funcionan de forma correcta usando este recurso desde un cliente del dominio.</p>"},{"location":"UD8/Actividades/#actividad-2","title":"Actividad 2","text":"<ol> <li>Implanta el modelo de permisos que has planificado en ServidorWindows a trav\u00e9s de GUI. Debes probar cada configuraci\u00f3n para verificar que su funcionamiento es correcto. Elabora una gu\u00eda con los pasos que sigues para instaurar tu pol\u00edtica de permisos, accesos y privilegios de usuario.</li> <li> <p>Aplica ahora la siguiente configuraci\u00f3n de permisos del resto de carpetas en ServidorWindows siguiendo estas premisas (si alguna de estas configuraciones coincide con tu planificaci\u00f3n, no ser\u00e1 necesario realizarla): - si no se especifica lo contrario, ning\u00fan usuario podr\u00e1 acceder a ning\u00fan directorio de esta estructura (es la configuraci\u00f3n inicial).</p> <ul> <li>los miembros de un departamento tendr\u00e1n acceso de lectura a la carpeta que tiene el nombre de ese departamento.</li> <li>los responsables de cada departamento tendr\u00e1n tambi\u00e9n permiso de escritura a su departamento.</li> <li>los gerentes podr\u00e1n leer en toda la estructura de carpetas y editar las carpetas Proceso de selecci\u00f3n e Informe empleados de la carpeta Recursos Humanos.</li> <li>cualquier empleado de la empresa podr\u00e1 ver los documentos de la carpeta Asistencia dentro del directorio Servicio T\u00e9cnico. El resto de carpetas dentro de Servicio T\u00e9cnico no ser\u00e1n visibles para ellos.</li> <li>los empleados que trabajen en el departamento de Administraci\u00f3n pueden editar los ficheros contenidos en Campa\u00f1as del directorio Comercial, pero no eliminar ni crear nuevos.</li> <li>s\u00f3lo los administradores y los miembros del Servicio T\u00e9cnico tendr\u00e1n permiso para modificar los ficheros de la carpeta Software (podr\u00e1n eliminar, crear y ejecutar estos programas).</li> </ul> <p>Comprueba que la configuraci\u00f3n es correcta accediendo desde diferentes clientes. Redacta una gu\u00eda con los pasos que sigues para realizar esta tarea.</p> </li> <li> <p>Usa la misma estructura de directorios en ServidorUbuntu (creada con el shellscript que encontraste en el Moodle del m\u00f3dulo), en la carpeta Datos y asigna los siguientes permisos a trav\u00e9s de CLI con la herramienta samba-tool:</p> <ul> <li>cada departamento puede ver y leer los archivos de las carpetas que le correspondan, es decir, el departamento de RRHH s\u00f3lo podr\u00e1 ver y leer la carpeta RRHH</li> <li>los responsables de cada departamento podr\u00e1n escribir tambi\u00e9n en estas carpetas</li> <li>las carpetas de Software y Documentaci\u00f3n deben permanecer ocultas a los trabajadores que no pertenezcan al departamento de Servicio T\u00e9cnico.</li> </ul> </li> <li>En ServidorWindows crea una cuota de 500 MB al volumen Perfiles. Adem\u00e1s se crear\u00e1n varios umbrales de notificaci\u00f3n; el primero al 80% de la capacidad el cual enviar\u00e1 un correo electr\u00f3nico al administrador, y el segundo cuando la cuota alcance el 100% enviar\u00e1 un correo electr\u00f3nico al usuario de la cuota. Las cuotas no se pueden superar en ning\u00fan caso. Escribe una gu\u00eda detallada con los pasos que sigues para realizar esta configuraci\u00f3n.</li> <li>A trav\u00e9s de CLI en ServidorUbuntu, aplica una cuota a la carpeta Perfiles de 500 MB con un l\u00edmite flexible de 700 MB durante dos semanas. Comprueba que las cuotas funcionan de forma adecuada. Redacta un documento con las configuraciones y comandos que utilizas para realizar esta tarea.</li> <li>En la carpeta Datos en ServidorWindows configura un filtro de ficheros para evitar que se guarden ficheros de audio o v\u00eddeo. De este modo evitaremos que los usuarios almacenen este tipo de ficheros en el servidor. Documenta el proceso con una peque\u00f1a gu\u00eda.</li> </ol> <p>Manera de entrega de las actividades</p> <p>Redacta una gu\u00eda de los pasos a seguir para realizar esta actividad y s\u00fabela al Moodle del m\u00f3dulo.   De tal forma que en cada uno de los pasos incluya una imagen que verifique que se ha realizado aquello que se pide en cada uno de los ejercicios. Como en las anteriores actividades</p> <p>Warning</p> <p>SOLO LAS ACTIVIDADES 1,2 SON OBLIGATORIAS.</p>"},{"location":"UD8/controlAcceso/","title":"Control de acceso a recursos","text":"<p>El controlador del dominio debe proteger archivos, aplicaciones y otros recursos de un uso no autorizado. Para ello utiliza un proceso que compara las cuentas de usuario y la pertenencia a grupos con los derechos, privilegios y permisos asociados con esas cuentas. El control de acceso es, por tanto, el proceso de autorizar a usuarios, grupos y equipos el uso a los objetos ofrecidos en todo el directorio. Existen varias formas de limitar o autorizar el acceso y muchas de ellas se realizan de forma simult\u00e1nea. Ser\u00e1 el controlador de dominio el que aplique y combine los diferentes controles de acceso en funci\u00f3n de su prioridad.</p> <p>Cuando un usuario inicia sesi\u00f3n en un dominio, recibe un token de acceso que determina el nivel de uso a los objetos del directorio. Antes de permitir la utilizaci\u00f3n de un objeto a un usuario, se comprueba que el token de acceso y si est\u00e1 autorizado a realizar la tarea. Para ello compara la informaci\u00f3n del token de acceso con las ACE (Access Control Entry) del objeto. Este proceso busca el permiso que permita la acci\u00f3n requerida por el usuario sobre el objeto en este token, si no encuentra ninguno que lo permita expresamente, lo deniega y el usuario no podr\u00e1 realizar la acci\u00f3n sobre el objeto.</p> <p></p>"},{"location":"UD8/controlAcceso/#listas-de-control-de-acceso","title":"Listas de control de acceso","text":"<p>Las ACL (Access Control List) son el resultado de la combinaci\u00f3n de todos los permisos, derechos y privilegios que el usuario posee. Al iniciar sesi\u00f3n esta ACL se asigna al usuario contenida en el token de acceso que ser\u00e1 comparado con la ACE de cada objeto con el que se pretenda interactuar, como se ha mencionado con anterioridad. Para la creaci\u00f3n de la ACL se combinan diferentes tipos de autorizaci\u00f3n de uso en funci\u00f3n de su prioridad siguiendo un orden preestablecido:</p> <ul> <li>derechos de inicio de sesi\u00f3n y privilegios de usuario, se aplican a cuentas de usuario y permiten realizar acciones espec\u00edficas como administrar ciertos servicios. Normalmente se usan los grupos incorporados para asignar derechos y privilegios introduciendo la cuenta del usuario en un grupo con un derecho concreto.</li> <li>propietario del objeto, de forma predeterminada el propietario del objeto es el su creador, sean cuales sean los permisos de un objeto, el propietario podr\u00e1 cambiarlos. Es una buena pr\u00e1ctica que los objetos compartidos los cree siempre un usuario administrador y no dejar en manos de los usuarios su creaci\u00f3n.</li> <li>permisos, definen el tipo de acceso a un objeto o propiedad de ese objeto. A diferencia de los derechos y privilegios, los permisos se asignan a objetos. Existen varios tipos de permisos que se combinar\u00e1n entre s\u00ed creando una lista de control de acceso o ACE al objeto.</li> </ul> <p>Estos son los permisos que se comprueban cuando un usuario trate acceder a un objeto. Por ejemplo, si usuarioFeo, que es un usuario incluido en el grupo Operadores de copia de seguridad, trata de acceder a los archivos incluidos en la copia de seguridad pero los permisos efectivos del fichero en cuesti\u00f3n no se lo permite, usuarioFeo tiene el derecho de acceso que prevalece sobre los permisos.</p> <p>De igual forma, si usuarioFeo es propietario de un objeto del dominio, bien por que es su creador bien por que le han transferido su propiedad, es capaz de acceder a \u00e9l a pesar de que los permisos no se lo permitan. Para realizar el cambio de propietario en Microsoft Windows Server 2016 es necesario acceder, clicando con el bot\u00f3n derecho sobre el objeto, Propiedades \u2192 Seguridad \u2192 Opciones Avanzadas \u2192 Cambiar. Aparecer\u00e1 el buscador de usuarios del dominio en el que se indicar\u00e1 a qu\u00e9 usuario pertenece ahora el objeto.</p> <p></p> <p>En los sistemas operativos basados en GNU/Linux se dispone de dos comandos en el terminal para realizar esta tarea; <code>chown</code> y <code>chgrp</code>.</p> <p>El uso del primero permite el cambio del propietario. Hay que recordad que cuando se crea un recurso (fichero, carpeta, dispositivo hardware, etc\u00e9tera), \u00e9ste debe tener un creador. En GNU/Linux, adem\u00e1s, debe pertenecer a un grupo del sistema que suele ser al que pertenece al usuario. Si en alg\u00fan momento es necesario el cambio de estos valores, es posible hacerlo gracias a estos comandos.</p> <p>El uso de chown es muy simple</p> <pre><code>chown &lt;opciones&gt; &lt;usuario&gt;[:&lt;grupo&gt;] &lt;recurso&gt;\n</code></pre> <p>En este ejemplo se pasa el control al usuario administrador del recurso carpetaFea, que originalmente pertenece a usuarioFeo. Adem\u00e1s se usa la opci\u00f3n -R para que afecte tambi\u00e9n a todo su contenido</p> <pre><code>chown -R administrador carpetaFea\n</code></pre> <p>Pero esto no cambia el grupo al que pertenece el recurso, para ello ser\u00e1 necesario indicarlo en el comando</p> <pre><code>chown -R administrador:sudoers carpetaFea\n</code></pre> <p>En el ejemplo anterior, tras los dos puntos se especifica el grupo al que va a pertenecer el recurso. Tambi\u00e9n es posible utilizar el car\u00e1cter punto en lugar de los dos puntos. Este cambio tambi\u00e9n se puede realizar a trav\u00e9s del comando chgrp. Su uso es muy intuitivo</p> <pre><code>chgrp &lt;opciones&gt; &lt;grupo_de_destino&gt; &lt;recurso&gt;\n</code></pre> <p>De esta manera, el cambio de grupo del ejemplo anterior es posible hacerlo de la siguiente manera</p> <pre><code>chgrp sudoers carpetaFea\n</code></pre> <p>El uso de estos comando no reviste dificultad alguna.</p> <p>La combinaci\u00f3n de todos estos permisos puede conducir a un verdadero dolor de cabeza. Es interesante el uso de una estrategia que limita los accesos y usar tan solo uno de estos elementos para su gesti\u00f3n. Se recomienda no usar los privilegios de usuario salvo en casos muy especiales, as\u00ed como la creaci\u00f3n de los objetos del dominio desde la misma cuenta de usuario, preferiblemente la de administraci\u00f3n. Tambi\u00e9n es buena idea limitar la creaci\u00f3n de objetos a los usuarios que no sean administradores. De esta forma, la responsabilidad de acceso de los recursos recaer\u00e1 sobre los permisos.</p>"},{"location":"UD8/cuotasDisco/","title":"Cuotas de disco","text":"<p>Las cuotas de disco permiten controlar la cantidad de ficheros que se introducen en un recurso compartido. El espacio de almacenamiento de un servidor es finito y, aunque no lo parezca, si se estrangula uno de los vol\u00famenes, es un tarea costosa asignar nuevo espacio o simplemente no es posible. Adem\u00e1s es buena pr\u00e1ctica economizar el espacio de almacenamiento, sobre todo el del servidor. Con esto se consiguen dos objetivos: </p> <p></p> <pre><code>- **formar al usuario** y obligar a filtrar qu\u00e9 informaci\u00f3n es sensible y cual no.\n- evitar el **SDD** (S\u00edndrome de Di\u00f3genes Digital), seg\u00fan el cual se guarda cualquier archivo ante la posibilidad de volver a necesitarlo en un futuro pr\u00f3ximo. Futuro que nunca llega.\n</code></pre> <p>Con la herramienta Administraci\u00f3n de cuotas, se pueden realizar las siguientes tareas:</p> <ul> <li>crear cuotas para limitar el espacio asignado a un volumen o carpeta y generar notificaciones cuando se est\u00e9 a punto de alcanzar o superar el l\u00edmite de dichas cuotas.</li> <li>generar cuotas autom\u00e1ticas aplicables a todas las carpetas existentes en un volumen o una carpeta y a todas las subcarpetas que se creen.</li> <li>definir plantillas de cuota que puedan aplicarse f\u00e1cilmente a nuevos vol\u00famenes o carpetas y que puedan utilizarse en toda una organizaci\u00f3n.</li> </ul> <p>Algunas de las tareas que se puede realizar con esta herramienta es establecer un l\u00edmite de, por ejemplo, 2 GB en las carpetas personales de los usuarios, configurando una notificaci\u00f3n para el administrador y otra para el usuario cuando se superen los 1,8 GB de almacenamiento.</p> <p>Microsoft Windows Server dispone de un complemento que realiza esta tarea, el Administrador de recursos del servidor de archivos. Se trata de un rol que ser\u00e1 necesario instalar y para ello es necesario acceder a Administrador del servidor \u2192 Instalar nuevo rol \u2192 Servicios de archivos y almacenamiento \u2192 Servicios de iSCSI y archivo \u2192 Administrador de recursos del servidor de archivos.</p> <p>Tras la instalaci\u00f3n del componente, hay que dirigirse al Inicio \u2192 Herramientas administrativas \u2192 Administraci\u00f3n de recursos del servidor de archivos, y una vez abierta la herramienta a Administraci\u00f3n de cuotas \u2192 Cuotas. Se crear\u00e1 una nueva cuota y como ruta se elegir\u00e1 la del recurso compartido que se necesita limitar.</p> <p>Desde la misma aplicaci\u00f3n es posible administrar la cuota de la carpeta, editarla o eliminarla. Huelga decir que tan s\u00f3lo se puede asignar una cuota a un mismo recurso compartido, aunque cada recurso compartido puede tener una cuota diferente.</p> <p>Existe la posibilidad de asignar una cuota a un volumen directamente, lo que se traducir\u00e1 en que cada carpeta en creada en ese volumen tendr\u00e1 la limitaci\u00f3n de capacidad exigida por la cuota. Hay que tener cuidado con esta asignaci\u00f3n y evitarla, y utilizar las cuotas asignadas a recursos compartidos.</p> <p>En los sistemas operativos basados en GNU/Linux tambi\u00e9n es posible establecer l\u00edmites de almacenamiento por usuario e incluso por grupo de usuarios. Es factible establecer cuotas con dos enfoques diferentes:</p> <ul> <li>es posible limitar el n\u00famero de bloques de disco, con lo que se limita el tama\u00f1o en disco del que el usuario dispone, tal y como ocurr\u00eda en Microsoft Windows Server,</li> <li>o bien limitar el n\u00famero de nodos-i, lo que establece un l\u00edmite de ficheros por usuario, independientemente del espacio que ocupen.</li> </ul> <p>Adem\u00e1s, de igual modo que en el caso anterior, se pueden fijar dos tipos de l\u00edmites, el r\u00edgido o hard que impide que el l\u00edmite sea sobrepasado, y el flexible o soft que no limita el espacio en disco pero s\u00ed avisa al administrador que se han excedido ciertos l\u00edmites.</p> <p>Desde la versi\u00f3n 14.04 de Ubuntu Server el kernel viene preparado para soportar cuotas de disco, por lo que tan s\u00f3lo ser\u00e1 necesario la instalaci\u00f3n del paquete que permite gestionar las cuotas: <code>quota y quotatool</code>.</p> <pre><code>sudo apt-get install quota quotatool\n</code></pre> <p>Al igual que ocurr\u00eda en el caso anterior, las cuotas han de ser activadas para cada uno de los vol\u00famenes del sistema. Para ello es necesario especificarlo en las opciones del fichero <code>/etc/fstab.</code></p> <pre><code>/dev/sdb1 /media/Datos ext4 defaults,usrquota,grpquota 0 0\n</code></pre> <p>En las opciones de montaje se han a\u00f1adido las opciones de <code>usrquota y grpquota</code>, que permitir\u00e1n la asignaci\u00f3n de cuotas de disco tanto a usuarios como a grupos respectivamente.</p> <p>Para que los cambios tengan efecto, se monta y desmonta el volumen aplicando la nueva configuraci\u00f3n especificada en el fichero <code>/etc/fstab</code></p> <pre><code>sudo mount -o remount,rw /media/Datos\n</code></pre> <p>La unidad ya est\u00e1 preparada para contener cuotas de disco, por lo que ser\u00e1 preciso crearlas a trav\u00e9s de los comandos que se han instalado: <code>quotacheck, edquota y repquota</code>.</p> <pre><code>sudo quotacheck -cgu /media/Datos\n</code></pre> <p>El comando anterior activa las cuotas para el volumen. La opci\u00f3n <code>-c</code> crea los ficheros de configuraci\u00f3n necesarios para guardar la informaci\u00f3n de las cuotas, mientras que las opciones <code>-u y -g</code> activan las cuotas de usuario y grupo respectivamente. Si todo ha ido bien, en la carpeta ra\u00edz del volumen montado aparecer\u00e1n dos ficheros <code>aquota.group y aquota.user</code> que contendr\u00e1n la configuraci\u00f3n de las cuotas para los usuarios y grupos. No se trata de archivos de texto plano como es habitual, sino que estar\u00e1n cifrados.</p> <p>Para a\u00f1adir una cuota a un usuario se utiliza el comando</p> <pre><code>edquota -u administrador\n</code></pre> <p>Aparecer\u00e1 en pantalla el editor de texto predeterminado junto con la configuraci\u00f3n del usuario especificado</p> <pre><code>Disk quotas dor user administrador (uid 1000):\nFilesystem blocks soft hard inodes soft hard\n/dev/sdb1 0 0 0 0 0 0\n</code></pre> <p>El significado de cada columna es</p> <ul> <li><code>Filesystem</code>, indica el volumen en el que se activan las cuotas</li> <li><code>blocks</code>, se\u00f1ala el n\u00famero de bloques que el usuario o grupo est\u00e1 utilizando</li> <li><code>inodes</code>, apunta el n\u00famero de nodos-i que el usuario o grupo est\u00e1 usando</li> <li><code>soft</code>, representa un valor de bloques o nodos-i que permite sobrepasar durante un determinado tiempo</li> <li><code>hard</code>, es el l\u00edmite de bloques o nodos-i que no es posible superar</li> </ul> <p>Modificando estos valores y guardando el fichero se establecer\u00e1n las cuotas del usuario administrador. Configurar un valor de cuota a cero significa que no existe l\u00edmite alguno de almacenamiento para ese usuario. La cuotas para grupos se realizan exactamente igual que con los usuarios. Si es necesario su edici\u00f3n, se volver\u00e1 a ejecutar el mismo comando y se modificar\u00e1n los valores oportunos.</p> <p>En la descripci\u00f3n de la columna soft se hizo referencia a que ese valor es posible rebasarlo durante un tiempo determinado. A ese tiempo se le conoce como periodo de gracia, y una vez superado el l\u00edmite flexible soft se convierte en l\u00edmite r\u00edgido no pudiendo superarlo. Para modificar esta configuraci\u00f3n se utiliza el comando</p> <pre><code>  sudo edquota -t\n</code></pre> <p>Establecer\u00e1 un valor para el volumen que afectar\u00e1 a todos los usuarios y grupos que tengan una cuota configurada en dicho volumen. Para consultar todas las cuotas disponibles se utilizar\u00e1 el comando</p> <pre><code>sudo repquota /dev/sdb1\n</code></pre> <p>el cual ofrecer\u00e1 informaci\u00f3n detallada sobre los usuarios y grupos que disponen de cuota en dicho volumen.</p> <pre><code>\\*\\*\\* Report for user quotas on device /dev/sdb1\nBlock grace time: 7days; Inode grace time: 7days\nBlock limits File limits\nUser used soft hard grace used soft hard grace\n\n---\n\nroot -- 20 0 0 2 0 0\nusuario +- 351 300 0 15 0 0\n</code></pre> <p>El formato de salida del informe es autoexplicativo, a excepci\u00f3n de la segunda columna. Los guiones que aparecen a la derecha del nombre de usuario, representan si se ha excedido o no el l\u00edmite flexible tanto de bloques como de nodos-i. Si se excede este l\u00edmite el - ser\u00e1 modificado por +. De esta forma es relativamente sencillo buscar aquellos usuarios que han superado el l\u00edmite flexible a trav\u00e9s del comando</p> <pre><code>sudo repqutota /dev/sdb1 | grep \u201c\\+\u201d\n</code></pre> <p>Para calcular el tama\u00f1o de la cuota a trav\u00e9s de bloques ser\u00e1 necesario conocer el tama\u00f1o del bloque del volumen al que se han aplicado las cuotas. Para ello se puede usar el comando <code>tune2fs</code> que ofrece amplia informaci\u00f3n sobre las caracter\u00edsticas de un volumen, entre toda ella, el n\u00famero de bloques:</p> <pre><code>tune2fs -l /dev/sdb1 | grep \u201cBlock size\u201d\n</code></pre> <p>Ahora tan s\u00f3lo queda multiplicar este tama\u00f1o por el n\u00famero de bloques asignado a la cuota. Es posible desactivar las cuotas de forma temporal para, por ejemplo, realizar ciertas tareas de mantenimiento o administraci\u00f3n,</p> <pre><code>quotaoff /dev/sdb1\n</code></pre> <p>y volverlas a activar</p> <pre><code>quotaon /dev/sdb1\n</code></pre> <p>Recuerda que esta desactivaci\u00f3n es temporal. Si se desactivan las cuotas con este comando y se reinicia el sistema, volver\u00e1n a estar activas ya que se inicializan a trav\u00e9s del fichero /etc/fstab. Si es necesario desactivarlas de forma permanente se deben configurar con un valor de cero en el archivo de cuotas.</p>"},{"location":"UD8/cuotasDisco/#filtrado-de-ficheros-en-recursos-compartidos","title":"Filtrado de ficheros en recursos compartidos","text":"<p>Otra tarea interesante para el administrador es, adem\u00e1s del espacio, poder controlar el tipo de ficheros que se guarda en estas carpetas. Existe la posibilidad de controlar qu\u00e9 ficheros se pueden guardar en el recurso y cuales no. Si por ejemplo se dispone de una carpeta para documentos de trabajo, es posible que no tenga ning\u00fan sentido almacenar en ella videos, fotograf\u00edas, ejecutables o archivos de audio.</p> <p></p> <p>Esta limitaci\u00f3n se puede realizar de forma sencilla a trav\u00e9s de la herramienta instalada en el apartado anterior, tan s\u00f3lo hay que dirigirse esta vez a Administraci\u00f3n del filtrado de archivos. De igual manera que en caso previo, hay que especificar la ruta de la carpeta a la que se necesita filtrar el contenido y elegir una de las plantillas de filtrado.</p> <p>Si ninguna de estas plantillas satisface las necesidades de filtrado, es posible crear una personalizada con los tipos de archivos que no deben estar en este recurso.</p> <p>La aplicaci\u00f3n de estos filtros se realiza a nivel de extensi\u00f3n. Un usuario avanzado podr\u00eda cambiar la extensi\u00f3n de un fichero de audio y hacerlo pasar por uno de texto para introducirlo en la carpeta. Existen otras medidas accesorias para evitar este tipo de acciones, pero que no se resuelven desde esta utilidad.</p>"},{"location":"UD8/derechosInicio/","title":"Derechos de inicio de sesi\u00f3n y privilegios de usuario","text":"<p>Los derechos de conexi\u00f3n, o derechos de inicio de sesi\u00f3n, permiten definir el modo en el que iniciar\u00e1 sesi\u00f3n el usuario en el sistema, es decir, si lo har\u00e1 en modo local, a trav\u00e9s de la red o desde una red externa.</p> <p>Los privilegios definen lo que el usuario podr\u00e1 hacer en el sistema una vez iniciada su sesi\u00f3n. Ya se ha hablado que durante el proceso de inicio de sesi\u00f3n, el usuario recibe el token de acceso que dictar\u00e1 que acciones puede y no puede realizar. Parte de ese listado de accesos, conocido como ACL (Access Control List) ser\u00e1 generado a trav\u00e9s de los privilegios que el usuario posea.</p> <p>Los administradores pueden asignar derechos espec\u00edficos a las cuentas de grupo o a cuentas de usuario individuales. Estos derechos autorizan a los usuarios a realizar acciones espec\u00edficas, como iniciar una sesi\u00f3n en un sistema de forma interactiva o realizar copias de seguridad de archivos y directorios, entre otros muchos.</p> <p>Estos derechos de usuario se diferencian de los permisos en que se aplican a las cuentas de usuario, mientras que los permisos se asignan a los objetos. Aunque se pueden aplicar a cuentas de usuario individuales, se administran mejor en una cuenta de grupo. Existen dos formas de asignar privilegios a los usuario o grupos:</p> <ul> <li>usando grupos predeterminados, la unidad organizativa Builtin contiene todos los grupos de seguridad que incorpora de forma predeterminada el dominio. Estos grupos ya disponen de una serie de privilegios asociados en funci\u00f3n de la tarea para la que fueron dise\u00f1ados. Al agregarle a cualquiera de estos grupos un nuevo miembro, autom\u00e1ticamente, dicho miembro heredar\u00e1 todos los privilegios del grupo.</li> <li>a trav\u00e9s de las pol\u00edticas de grupo, para ello ser\u00e1 necesario el uso de la herramienta Administraci\u00f3n de directivas de grupo a la que se accede a trav\u00e9s de Administraci\u00f3n del servidor \u2192 Herramientas \u2192 Administraci\u00f3n de directivas de grupo. No se entrar\u00e1 en detalle con esta utilidad ya que existe una unidad dedicado a ella. A\u00fan as\u00ed, se localizar\u00e1 la Default Domain Controllers Policy y se proceder\u00e1 a su edici\u00f3n.   </li> </ul> <p>En la pantalla de edici\u00f3n, la pol\u00edtica a editar ser\u00e1 Configuraci\u00f3n de equipo \u2192 Directivas \u2192 Configuraci\u00f3n de Windows \u2192 Configuraci\u00f3n de seguridad \u2192 Directivas locales \u2192 Asignaci\u00f3n de derechos a usuario. Esta opci\u00f3n mostrar\u00e1 todos los privilegios que se pueden asignar a un usuario. Tan s\u00f3lo habr\u00e1 que editar la directiva y a\u00f1adir al usuario o grupo determinado.   </p> <p>De esta forma tambi\u00e9n es posible la modificaci\u00f3n o creaci\u00f3n de grupos de seguridad para seg\u00fan las necesidades de la empresa. Si bien es cierto que los grupos Builtin satisfacen la mayor\u00eda de las necesidades de asignaci\u00f3n de privilegios, es posible crear nuevos a trav\u00e9s de esta herramienta.</p> <p>En sistemas operativos basados en GNU/Linux la gesti\u00f3n de los grupos y privilegios se hace a trav\u00e9s del comando <code>samba-tool group</code>, como ya se ha visto con anterioridad, aunque no llega a los niveles de especificaci\u00f3n de Microsoft Windows. Recuerda que Samba est\u00e1 en continuo desarrollo y todas estas caracter\u00edsticas estar\u00e1n implementadas.</p>"},{"location":"UD8/herencia/","title":"Herencia","text":"<p>Cada objeto del directorio tiene asignada informaci\u00f3n de control de acceso. Esta informaci\u00f3n se denomina descriptor de seguridad y controla el tipo de acceso permitido a usuarios y grupos. Existen dos formas de asignar permisos a los objetos:</p> <ul> <li>permisos expl\u00edcitos, son aquellos que asigna el usuario o son el resultado de la creaci\u00f3n del objeto y son los que se han estudiado hasta ahora.</li> <li>permisos heredados, son los que se propagan a un objeto desde un objeto primario.</li> </ul> <p></p> <p>De forma predeterminada, los objetos heredan los permisos de su contenedor cuando se crean. Verbigracia, cuando se crea la carpeta carpetaFea, todas las subcarpetas y archivos creados en su interior heredan de forma autom\u00e1tica sus permisos. La herencia facilita la tarea de administrar permisos y aseguran su coherencia entre todos los objetos de un contenedor. De esta manera, la carpeta carpetaFea tiene permisos expl\u00edcitos, mientras que las subcarpetas y los archivos heredan los permisos.</p> <p>Es posible bloquear esta herencia si es necesario para poder asignar permisos expl\u00edcitos a un objeto contenido en otro. En Microsoft Windwos Server es posible accediendo a propiedades del objeto, Propiedades \u2192 Seguridad \u2192 Opciones Avanzadas \u2192 Deshabilitar Herencia. Una vez bloqueada la herencia, se deber\u00e1 especificar si los permisos que tiene ese objeto de le asignan de forma expl\u00edcita o si se eliminan, decisi\u00f3n tomada en funci\u00f3n de las necesidades del proyecto.</p>"},{"location":"UD8/permisosRed/","title":"Permisos de red y locales","text":"<p>En un servidor de archivos, el acceso a una carpeta puede estar determinado por dos conjuntos de entradas de permisos:</p> <ul> <li>los permisos de recurso compartido definidos tan s\u00f3lo a carpetas.</li> <li>los permisos NTFS (New Technology File System) definidos tato en carpetas como en archivos.</li> </ul> <p>Los permisos de recurso compartido suelen utilizarse para administrar equipos con sistemas de archivos FAT32 (File Allocation Table) o posterior.</p> <p>Con la aparici\u00f3n del sistema de archivos NTFS (New Technology File System), se incluyeron nuevos tipos de permisos asignables, adem\u00e1s, tambi\u00e9n a ficheros. Ambos sistemas de permisos conviven en entornos de Microsoft pero son independientes, ninguno modifica al otro. Los permisos de acceso final en una carpeta compartida se determinan teniendo en cuenta las entradas de permiso de recurso compartido y de permiso NTFS. En caso de contradicci\u00f3n entre ellos, se aplicar\u00e1n siempre los permisos m\u00e1s restrictivos.</p> <p>En la siguiente tabla se enumeran las acciones que son posibles de realizar en funci\u00f3n de los permisos asignados.</p> Permisos especiales Control total Modificar Leer y ejecutar Mostrar el contenido de la carpeta Lectura Escritura Recorrer carpeta / Ejecutar Archivo Listar carpeta / Leer datos Atributos de lectura Atributos extendidos de lectura Crear archivos / Escribir datos Crear carpetas / Anexar datos Atributos de escritura Atributos extendidos de escritura Eliminar subcarpetas y archivos Eliminar Permisos de lectura Cambiar permisos Tomar posesi\u00f3n Sincronizar <p>Hay que tener muy en cuenta las siguientes estrategias cuando se trabaje con estos permisos:</p> <ul> <li>Conceder a un usuario el permiso NTFS Control total en una carpeta permite a ese usuario tomar posesi\u00f3n de la carpeta a menos que est\u00e9 restringido de alguna forma. Nunca, salvo causa justificada, se debe dar este tipo de acceso.</li> <li>Es buena pr\u00e1ctica administrar el acceso a carpetas exclusivamente mediante permisos NTFS. Para ello se deben establecer los permisos de recurso compartido en Control total para el grupo Todos.</li> <li>Los permisos NTFS influyen sobre el acceso tanto local como remoto. Por el contrario, los permisos de recurso compartido s\u00f3lo se aplican a recursos compartidos de red.No restringen el acceso a ning\u00fan usuario local, por lo que no ofrecen privacidad entre usuarios de un equipo.</li> <li>De forma predeterminada, el grupo Todos no incluye el grupo An\u00f3nimo, por lo que los permisos que se aplican al grupo Todos no afectan al grupo An\u00f3nimo.</li> </ul> <p>La administraci\u00f3n de los permisos en Microsoft Windows Server se realiza a trav\u00e9s de las propiedades de cada recurso. Accediendo a Propiedades se pueden especificar los permisos a trav\u00e9s de las pesta\u00f1as Compartir y Seguridad. En la primera pesta\u00f1a es necesario iniciar el proceso de compartici\u00f3n con el bot\u00f3n Compartir.... A partir de aqu\u00ed tan solo hay que establecer el binomio permiso-usuario.</p> <p>Estas tareas en Ubuntu Server se realizan a trav\u00e9s del conjunto de herramientas de <code>samba-tool</code>, en concreto <code>dsacl y ntacl</code>. A pesar de la existencia de estas herramientas, la gesti\u00f3n de los permisos de carpetas se realizar\u00e1 con RSAT instalado con anterioridad. Esta tarea es m\u00e1s efectiva y concisa desde el GUI ya que no ser\u00e1 necesario recordar todos los usuarios ni grupos creados en el directorio mientras se configuran los permisos. En efecto, el uso de GUI para la asignaci\u00f3n de permisos facilita esta tarea que, en CLI, puede llegar a complicarse en demas\u00eda. Por este motivo se utilizar\u00e1 la administraci\u00f3n remota que funciona de igual modo que en sistemas operativos de Microsoft. Eso s\u00ed, hay que tener en cuenta varias cosas antes de usar los permisos NTFS en Ubuntu Server:</p> <ul> <li>el volumen que contenga el recurso compartido debe disponer de las opciones <code>acl</code> durante su montaje. Estas opciones ser\u00e1n indicadas en el fichero <code>/etc/fstab</code> para automatizar el proceso.</li> <li>si el sistema de ficheros del volumen no es ext4, ser\u00e1 necesario la instalaci\u00f3n de esta caracter\u00edstica . En ext4 viene integrada por defecto.</li> <li>los permisos que se apliquen a un recurso a trav\u00e9s de Samba s\u00f3lo ser\u00e1n v\u00e1lidos a trav\u00e9s de este servicio, por lo que se desaconseja el acceso en local al controlador de Active Directory.</li> </ul> <p>Ser\u00e1 necesario ahora ampliar los permisos que GNU/Linux establece a los ficheros para que sean compatibles con los de NTFS de Microsoft Windows. Ya que se quiere integrar este servidor en una estructura de Active Directory ser\u00e1 necesario que los permisos asignados a los ficheros sean entendibles por los clientes Microsoft Windows que accedan a este servidor.</p> <p>Para ello se necesita instalar dos paquetes el <code>attr</code> y el <code>acl</code> que juntos compatibilizan las listas de control de acceso entre ambos sistemas. La parte interesante de estos paquetes es que esta ampliaci\u00f3n de permisos se le puede asignar a tan un medio determinado o a todo el sistema, por lo que ambos permisos de acceso pueden convivir sin conflicto alguno.</p> <p>Para ello, se va a instalar un segundo disco duro en el servidor. Se convertir\u00e1 este disco duro en un volumen y se destinar\u00e1 a almacenar los ficheros compartidos del servidor, por lo tanto, ser\u00e1 a este volumen al que se le asignar\u00e1 la nueva configuraci\u00f3n de permisos. Para realizar esta tarea, seguiremos estos pasos:</p> <ul> <li>se a\u00f1adir\u00e1 un disco duro SATA a la m\u00e1quina virtual de 400 GB de capacidad.</li> <li>se asignar\u00e1 una partici\u00f3n primaria que ocupe el disco entero.   <code>sudo fisk /dev/sdb</code></li> <li>es necesario asigna un sistema de ficheros, en este caso ext4   <code>sudo mkfs -t ext4 /dev/sdb1</code></li> <li>debe crearse un punto de montaje en /media/datos.   <code>sudo mount /dev/sdb1 /media/datos</code></li> </ul> <p>Otra acci\u00f3n a llevar a cabo es hacer el montaje del nuevo volumen de forma autom\u00e1tica al iniciar el sistema. Pare ello ser\u00e1 necesario incluir esta informaci\u00f3n en el fichero <code>/etc/fstab</code>:</p> <p><code>/dev/sdb1 /media/datos ext4 defaults 0 0</code></p> <p>Ahora se instalar\u00e1n los paquetes necesarios para la asignaci\u00f3n de los nuevos permisos:</p> <p><code>sudo apt-get install acl attr</code></p> <p>Una vez terminada la instalaci\u00f3n, se asignar\u00e1 la ampliaci\u00f3n de permisos a este nuevo volumen a\u00f1adiendo <code>user_xattr,acl,barrier=1</code> al fichero <code>/etc/fstab</code>. Debe quedar de la siguiente manera: /dev/sdb1 /media/datos ext4 user_xattr,acl,barrier=1,defaults 0 0</p> <p>Se comprueba que todo ha ido bien reiniciando el equipo y accediendo a la carpeta <code>/media/datos</code>.</p> <p>Antes de administrar los permisos de un recurso compartido en un servicio Active Directory con Samba, ser\u00e1 necesario su creaci\u00f3n y compartici\u00f3n. Esta tarea se realiza a\u00f1adiendo el recurso al fichero <code>/etc/samba/smb.conf</code>. El aspecto que tiene este fichero es el siguiente:</p> Par\u00e1metros de smb.cnf<pre><code># Global parameters\n\n[global]\ndns forwarder = 8.8.8.8\nnetbios name = SERVIDORUBUNTU\nrealm = MIEMPRESAFEA.LOCAL\nserver role = active directory domain controller\nworkgroup = MIEMPRESAFEA\nidmap_ldb:use rfc2307 = yes\n\n[netlogon]\npath = /var/lib/samba/sysvol/miempresafea.local/scripts\nread only = No\n\n[sysvol]\npath = /var/lib/samba/sysvol\nread only = No\n</code></pre> <p>Tanto <code>netlogon</code> como <code>sysvol</code> son recursos compartidos que han sido creados durante el proceso de instalaci\u00f3n del directorio, y por tanto, son necesarios para el correcto funcionamiento del sistema. Ser\u00e1 aqu\u00ed d\u00f3nde se crear\u00e1n los nuevos recursos</p> <pre><code>[compartido]\npath = /media/datos\nread only = No\n</code></pre> <p>Una vez guardado el fichero de configuraci\u00f3n, se reinicia el servicio Samba para que los cambios tengan efecto</p> <pre><code>service smbd stop\nservice smbd start\n</code></pre> <p>A partir de este momento, el recurso <code>/media/datos</code> est\u00e1 accesible desde Samba, aunque sin ning\u00fan tipo de restricci\u00f3n. Ser\u00e1 necesario ahora el acceso a esta carpeta desde RSAT con una cuenta de administraci\u00f3n para modificar los permisos de acceso, de igual forma como se realiza en una carpeta compartido en un controlador de domino con Microsoft Windows.</p> <p>A medida que se vayan cambiado los permisos de este recurso a trav\u00e9s de RSAT, ser\u00e1 posible consultarlos desde el terminal con el subcomando <code>ntacl</code> o directamente con el comando <code>getfacl</code></p> <pre><code>samba-tool ntacl get /media/datos\n</code></pre> <p>el cual ofrece informaci\u00f3n detallada de los permisos o</p> <pre><code>getfacl /media/datos\n</code></pre> <p>que ofrecer\u00e1 informaci\u00f3n de los permisos a modo de resumen.</p>"},{"location":"UD8/permisosRed/#permisos-efectivos","title":"Permisos efectivos","text":"<p>Cada objeto tiene un conjunto de permisos efectivos asociados. Es muy probable que se pase por alto alguna de las combinaciones de permisos, propiedad o derechos de usuario y su combinaci\u00f3n no obtenga el resultado esperado. Se pueden consultar los permisos efectivos que un objeto tiene en un momento dado con respecto a una cuenta de usuario o grupo.</p> <p>Los siguientes factores se usan para determinar el conjunto de permisos efectivos de un objeto:</p> <ul> <li>Pertenencia al grupo global</li> <li>Pertenencia al grupo local</li> <li>Permisos locales y de red</li> <li>Privilegios locales</li> <li>Pertenencia a grupos universales</li> </ul> <p>En Microsoft Windows Server esta consulta se realiza pulsando el bot\u00f3n derecho sobre el recurso compartido Propiedades \u2192 Seguridad (pesta\u00f1a) \u2192 Opciones Avanzadas \u2192 Acceso Efectivo. En esta ventana se especifica un usuario o grupo sobre el que se quiera realizar la consulta y se pulsa el bot\u00f3n sobre Acceso Efectivo.</p> <p></p> <p>Cuando se usa la herramienta Permisos efectivos puede que los resultados que se muestran no sean coherentes con los permisos reales. Este problema ocurre cuando se da una de estas condiciones:</p> <p></p> <ul> <li>se ejecutan las herramientas administrativas de forma remota.</li> <li>la cuenta de usuario que se usa no se encuentra en el mismo dominio que el recurso.</li> </ul> <p>Para evitar este problema hay que asegurarse que la cuenta de usuario administrativa usada para ejecutar la herramienta se encuentra en el mismo dominio que el objeto consultado.</p> <p>En sistemas operativos basados en GNU/Linux, es posible utilizar los comandos</p> <pre><code>samba-tool ntacl get /srv/samba/Usuarios\ngetfacl /srv/samba/Usuarios\n</code></pre> <p>para obtener un resumen de los permisos efectivos sobre del recurso, como ya se ha mencionado con anterioridad.</p>"},{"location":"UD9/Actividades/","title":"Actividades de la UD9","text":""},{"location":"UD9/Actividades/#introduccion","title":"Introducci\u00f3n","text":"<ol> <li>Cree un directorio <code>bin</code> en el directorio de inicio. En <code>bin</code>, cree o recupere el programa corto siguiente (script shell que muestra una frase en la pantalla):</li> </ol> <pre><code>pwd\n/home/ubuntu/bin\n$ vi  micomando\necho \"Ejecuci\u00f3n de micomando\"\n$ chmod u+x micomando\n</code></pre> <p>Modifique la variable PATH de forma que este comando funcione:</p> <pre><code>micomando\nEjecuci\u00f3n de micomando\n</code></pre> <ol> <li>Programa que muestre por pantalla \u201cBienvenido, introduce tus nombres y apellidos\u201d. Acto seguido podremos introducir nuestro nombre y el script devolver\u00e1 \u201cQue tengas un buen d\u00eda    XXXXXXXX\u201d. Guarda el fichero como <code>Script1_1.sh</code>.</li> </ol> <pre><code>$ ./Script1_1.sh\nBienvenido, introduce tu nobre y apellidos:\nJulio Martinez\nQue tengas un prospero dia Julio Martinez\n</code></pre> <p>A continuaci\u00f3n crea el script <code>\u201cScript1_1_2.sh\u201d</code> en el cual por un lado de pida el nombre y por otro el apellido, para finalmente usar ambas variables en una misma frase.</p> <pre><code>Inserta un nombre: Julio\nInserta un apellido: Martinez\nBienvenido Julio, tu apellido es Martinez\n</code></pre> <ol> <li>Crea un script que solicite un nombre de usuario, una ruta del home a crear y un int\u00e9rprete. Finalmente debe mostrar un mensaje indicando que el usuario se ha creado (<code>useradd o adduser</code>  ).</li> </ol> <p>Es importante usar la opci\u00f3n que efectivamente genere la carpeta home al crear el usuario. Guarda el script como <code>\u201cScript1_2.sh\u201d</code></p> <pre><code>Inserta un nombre de usuario: Lorenzo\nInserta una ruta de directorio home: /home/lamas\nElige un shell de comandos: /bin/bash\nUsuario creado correctamente.\n</code></pre> <ol> <li> <p>Cree los f1, f2,f3 en un directorio y metase dentro de el. Ejecute y explique que hace cada uno de los siguientes comandos.</p> </li> <li> <p><code>echo \\*</code></p> </li> <li><code>echo \\*</code></li> <li><code>echo \"\\*\"</code></li> <li><code>echo \u2019\\*\u2019</code></li> <li><code>edad=20</code></li> <li><code>echo $edad</code></li> <li><code>echo \\$edad</code></li> <li><code>echo \"$edad\"</code></li> <li><code>echo \u2019$edad\u2019</code></li> <li><code>echo \"T\u00fa eres $(logname) y tienes -&gt; $edad a\u00f1os\"</code></li> <li> <p><code>echo T\u00fa eres $(logname) y tienes -&gt; $edad a\u00f1os</code></p> </li> <li> <p>Definir las siguientes variables:</p> </li> </ol> <pre><code>s1=si\ns2=no\nvacia=\"\"\narch1=informe.pdf\n</code></pre> <ol> <li>pruebe si $s1 es igual a $s2.</li> <li>Pruebe si $s1 es diferente de $s2.</li> <li>Pruebe si $vacia est\u00e1 vac\u00eda.</li> <li> <p>Pruebe si $vacia no est\u00e1 vac\u00eda.</p> </li> <li> <p>tests num\u00e9ricos.Definir las variables num1 y num2 con los valores siguientes:</p> </li> </ol> <pre><code>    num1=2\n    num2=100\n</code></pre> <p>Verifique si $num1 es mayor que $num2 empleando los comandos [ ], [[]] y (( )).</p> <ol> <li>Operadores l\u00f3gicos de los comandos [ ], [[]] y operadores l\u00f3gicos del shell    Ejecute los comandos siguientes:</li> </ol> <pre><code>$ &gt; arch\n$ chmod 444 arch\n$ ls -l arch\n-r--r--r-- 1 ubuntu ubuntu  0  2 feb  17:23 arch\n</code></pre> <ol> <li>Si el archivo $arch no es ejecutable, muestre \u201dPermiso x no indicado\u201d.</li> <li>Si el archivo $arch no es ni ejecutable ni accesible para escritura, muestre \u201dPermisos wx no indicados\u201d.</li> </ol>"},{"location":"UD9/Actividades/#if","title":"IF","text":"<ol> <li> <p>Crea un script (<code>Script_IF_1.sh</code>) que solicite un n\u00famero por pantalla al usuario. El script debe indicar si el n\u00famero pasado es par o impar. PISTA: El s\u00edmbolo \u201c%\u201d dentro de una ecuaci\u00f3n matem\u00e1tica te devuelve el resto de una divisi\u00f3n.</p> </li> <li> <p>Crea un (<code>Script_IF_2.sh</code>) que solicite al usuario que introduzca 2 n\u00fameros y un s\u00edmbolo matem\u00e1tico (+,-,* o /). El script debe devolver el resultado.</p> </li> <li> <p>Copia el script anterior y a esta nueva copia ll\u00e1mala (<code>Script_IF_3.sh</code>). Modif\u00edcala para que una vez introducido los dos n\u00fameros y el s\u00edmbolo el programa te pregunte si deseas que el resultado salga con decimales: \u201cDeseas el resultado con decimales (s/n)\u201d. En caso de que el usuario responda \u201cs\u201d debe mostrarlo con decimales, en caso de que diga \u201cn\u201d sin decimales y en cualquier otro caso debe mostrar el siguiente error \u201cNo has seleccionado ninguna opci\u00f3n\u201d y termine el programa.</p> </li> </ol> <pre><code>Introduce un n\u00famero: 3\nIntroduce un n\u00famero: 4\nIntroduce un signo(+,-,/,*):*\nQuieres decimales (s/n)?s\n12\n\n Introduce un n\u00famero: 3\nIntroduce un n\u00famero: 4\nIntroduce un signo(+,-,/,*):-\nQuieres decimales (s/n)?v\nno has seleccionado ninguna opci\u00f3n\n\n Introduce un n\u00famero: 120\nIntroduce un n\u00famero: 7\nIntroduce un signo(+,-,/,*):*\nQuieres decimales (s/n)? s\n17.142857\n</code></pre> <ol> <li>Haz un script (<code>Script_IF_4.sh</code>) que solicite al usuario una IP por pantalla. Acto seguido se mostrar\u00e1 un men\u00fa, dependiendo de lo que seleccione el usuario, el script har\u00e1 una cosa u otra. En caso de no seleccionar ninguna de las opciones el script devolver\u00e1 el siguiente error \u201cNo has seleccionado ninguna opci\u00f3n v\u00e1lida\u201d y terminar\u00e1.</li> </ol> <p>A continuaci\u00f3n se indican las opciones:</p> <ol> <li>Realizar un ping.</li> <li>Ejemplo de uso: ping 8.8.8.8</li> <li>Realizar traceroute.</li> <li>Ejemplo de uso: traceroute 8.8.8.8</li> <li>Realizar comando whois.</li> <li>Ejemplo de uso: whois 8.8.8.8</li> </ol> <p>Ejemplo:</p> <pre><code>Introduzca un IP: 8.8.8.8\nseleccione una opci\u00f3n:\n1.ping\n2.traceroute\n3. whois\n</code></pre> <ol> <li> <p>Crea el script <code>Script_IF_5.sh</code>, el cual pregunte al usuario que introduzca la ruta absoluta de un directorio o de un fichero. El script debe:</p> </li> <li> <p>Indicarte si la ruta absoluta se trata de un directorio, fichero o si no existe.</p> </li> <li>En caso de tratarse de un fichero debe indicarte si tienes permisos de escritura/lectura/ejecuci\u00f3n. En caso de no tener permisos no mostrar\u00e1 nada por pantalla.</li> </ol> <p>PISTA: Se pueden anidar (meter uno dentro de otro) varias estructuras IF.</p> <pre><code>IF [ CONDICI\u00d3N ]\n\nThen\n\n    IF [ CONDICI\u00d3N ]\n\n    THEN\n\n        ACCIONES\n\n    FI\n\nFI\n</code></pre> <p>Ejemplo:</p> <pre><code>Introduzca una ruta absoluta:/home/ubuntu/prueba.txt\ninformaci\u00f3n sobre /home/ubuntu/prueba.txt\n1.Es un fichero\n2.Tiene permisos de escritura\n3. Tiene permisos de lectura\n\n\nIntroduzca una ruta absoluta:/home/ubuntu/p\ninformaci\u00f3n sobre /home/ubuntu/p\n1. no existe\n</code></pre>"},{"location":"UD9/Actividades/#argumentos","title":"Argumentos","text":"<ol> <li>Crea un script que espere un fichero como argumento. El script debe devolver quien es su usuario propietario y que permisos tienen el resto de usuarios (\u00fanicamente el resto de usuarios).</li> </ol> <p>En caso de no recibir exactamente un argumento se debe devolver \u201cERROR N\u00daMERO DE    ARGUMENTOS INCORRECTO\u201d.</p> <p>En caso de que el argumento proporcionado no sea un fichero o directorio se debe devolver    un error de \u201cEL ARGUMENTO DEBE SER UN FICHERO\u201d.</p> <pre><code>./scriptArgs_2.sh scriptArgs_2.sh\nEl propietario de scriptArgs_2 es ubuntu y los permisos para el resto de los usuarios son ---\n\n ./scriptArgs_2.sh\n ERROR N\u00daMERO DE\nARGUMENTOS INCORRECTO\n\n./scriptArgs_2.sh /home\nEL ARGUMENTO DEBE SER UN FICHERO\n</code></pre> <ol> <li>Genera un script que pasado un nombre de usuario como argumento te devuelve su UID y el int\u00e9rprete shell que tiene configurado.</li> </ol> <p>En caso de no recibir exactamente un argumento, el programa debe devolver \u201cERROR, N\u00daMERO DE ARGUMENTOS INCORRECTOS\u201d y terminar.</p> <pre><code>./scriptArgs_3.sh ubuntu\nel uid de ubuntu es :1000 y tiene el shell /bin/bash\n\n./scriptArgs_3.sh\nERROR, N\u00daMERO DE ARGUMENTOS INCORRECTOS\n</code></pre> <ol> <li>Crea un script (<code>blacklist.sh</code>) que espera como argumento el nombre de un usuario. Si no    se pasa ning\u00fan argumento o si se pasa m\u00e1s de uno, el script devolver\u00e1 el siguiente error \u201cDebes pasar un nombre de usuario como argumento\u201d y terminar\u00e1.</li> </ol> <p>Una vez comprobado que efectivamente se ha pasado un \u00fanico argumento el script mostrar\u00e1 un men\u00fa tal que as\u00ed:</p> <pre><code>      seleccione una opci\u00f3n\n      1.Agregar usuario a blacklist\n      2.Eliminar usuario de blacklist.\n</code></pre> <p>Si seleccionamos la opci\u00f3n \u201c1\u201d el usuario se agregar\u00e1 al fichero \u201cblacklist.txt\u201d, es importante que dicho fichero no se debe eliminar/sobrescribir tras cada ejecuci\u00f3n, es decir, debe almacenar todos los usuarios que vamos agregando cada vez que ejecutemos el script. Una vez a\u00f1adido al fichero el usuario debe ser bloqueado (no eliminado) y mostrar el mensaje \u201cUsuario XXXX bloqueado\u201d siendo XXXX el nombre del usuario.</p> <p>Si se intenta bloquear un usuario que ya se encontraba en la lista se debe devolver el error \u201cUsuario ya bloqueado con anterioridad\u201d y finalizar la ejecuci\u00f3n.</p> <p>Si seleccionamos la opci\u00f3n \u201c2\u201d se debe desbloquear el usuario, eliminar de la lista \u201cblacklist.txt\u201d y mostrar el mensaje \u201cUsuario XXXXX desbloqueado\u201d.</p>"},{"location":"UD9/Actividades/#case-while","title":"Case &amp; While","text":"<ol> <li> <p>Genera un script que recoja una direcci\u00f3n IP como argumento, se debe comprobar que se ha     introducido un \u00fanico argumento y si no se debe mostrar un mensaje de error. Acto seguido se mostrar\u00e1 al usuario 5 opciones (p<code>ing, tracepath, nslookup, whois y salir</code>). Si el usuario escoge un comando, dicho comando ha de ejecutarse y se debe mostrar el men\u00fa de nuevo. El programa no debe terminar a menos que el usuario pulse el n\u00famero 5. En caso de tocar una opci\u00f3n inexistente el programa debe devolver un     error \u201cOPCI\u00d3N DESCONOCIDA\u201d. Para terminar un programa puedes hacer uso del comando \u201cexit\u201d.</p> </li> <li> <p>Dado un fichero <code>usuarios.log</code> que tenga separados por tabuladores los usuarios y las contrase\u00f1as, el script debe solicitar un usuario y una contrase\u00f1a: 1. En caso de que el usuario o contrase\u00f1a sean incorrectos se debe volver a permitir al usuario introducir las credenciales, hasta un total de 3 veces. 2. Si el usuario ha fallado 3 veces con su usuario/contrase\u00f1a el programa debe finalizar indicando \u201cUsuario Incorrecto\u201d. 3. En caso de que el usuario y contrase\u00f1a sean correctos indicar\u00e1 \u201cBienvenido XXX\u201d y finalizar\u00e1.</p> <p>Info</p> <p>Recuerda el uso del comando \u201ctr\u201d para sustituir los tabuladores por otro separador.</p> </li> <li> <p>Realiza un script \u201c<code>CrearUsuarios.sh</code>\u201d que muestre el siguiente men\u00fa y permita seleccionar una opci\u00f3n:</p> <pre><code>      a. Log in.\n      b. Registrarse.\n      c. Salir.\n</code></pre> <p>En caso de elegir \u201cb\u201d se solicitar\u00e1 un nombre de usuario y posteriormente una contrase\u00f1a, la cual deber\u00e1 repetir y el script comprobar\u00e1 que efectivamente se ha introducido la misma contrase\u00f1a 2 veces.</p> <p>En caso de que las contrase\u00f1as no coincidan se mostrar\u00e1 el mensaje \u201cContrase\u00f1as no coinciden\u201d y volver\u00e1 a mostrar el men\u00fa. En caso de que las contrase\u00f1as coincidan se a\u00f1adir\u00e1 al fichero <code>\u201ccuentas.log\u201d</code> el usuario y su contrase\u00f1a, separado por un espacio en blanco y finalmente mostrar\u00e1 el men\u00fa de nuevo:</p> <pre><code>salva miContrase\u00f1a\npepe 1234Password\njose 81237594\n</code></pre> <p>En caso de seleccionar la opci\u00f3n \u201ca\u201d el usuario debe introducir su nombre de usuario y posteriormente su contrase\u00f1a. El script debe indicar si el usuario y contrase\u00f1a son v\u00e1lidos. En caso de serlo mostrar\u00e1 el mensaje de \u201cBienvenido XXXX\u201d y el programa finalizar\u00e1. En caso de no ser correcto se mostrar\u00e1 el mensaje \u201cLogin Incorrecto\u201d y se volver\u00e1 a mostrar el men\u00fa inicial. Adem\u00e1s permita hasta 3 intentos en caso de insertar un usuario/contrase\u00f1a incorrectos (usando bucle while o until).</p> <p>En caso de que no se seleccione \u201ca\u201d, \u201cb\u201d o \u201cc\u201d se debe mostrar un mensaje \u201cOPCI\u00d3N INCORRECTA\u201d y volver a mostrar el men\u00fa.</p> </li> </ol>"},{"location":"UD9/Actividades/#for","title":"For","text":"<ol> <li>Dado el siguiente c\u00f3digo, realiza una traza, completando la siguiente tabla (a\u00f1ade filas si necesario), como si el usuario hubiera ejecutado en el terminal: <code>bash ./ejemploContinue.sh</code></li> </ol> Iteraci\u00f3n $i $resto Acci\u00f3n <pre><code>#!/bin/bash\necho \" A continuaci\u00f3n solo mostraremos los n\u00fameros divisibles (del 1 al 10)de \" $1\nfor (( i=1; i&lt;= 10;i++ ))\ndo\n   let \"resto=\"$i% $1\"\n   if [ $resto -ne 0]\n   then\n      #los n\u00fameros no divisibles no deben salir por pantalla\n      #Al hacer continue no ejecutamos el echo $i\n      continue\n   fi\n   echo $i\n   done\n</code></pre> <ol> <li> <p>Dado un fichero llamado <code>expira.log</code> que contenga en cada fila un nombre de usuario, se debe realizar un script que espere como argumento un n\u00famero, dicho n\u00famero ser\u00e1 el n\u00famero de d\u00edas tras los cuales expirar\u00e1 la contrase\u00f1a (comando <code>chage</code>).</p> </li> <li> <p>Usando OBLIGATORIAMENTE el for (( \u2026 )). Genera un script que pasados dos argumentos num\u00e9ricos, que ser\u00e1 el n\u00famero de filas y el n\u00famero de columnas respectivamente, rellene con un \u201c*\u201d cada elemento de la tabla creada.</p> </li> </ol> <p>El script debe recorrer todos los usuarios del fichero mediante un bucle for (( \u2026 )) y debe configurarlos para que su contrase\u00f1a expire despu\u00e9s de los d\u00edas pasados como argumento.</p>"},{"location":"UD9/Actividades/#forin","title":"ForIn","text":"<ol> <li>Crea un programa que a\u00f1ada \u00fanicamente a los ficheros (no a los directorios) permisos de ejecuci\u00f3n a los grupos del usuario (nada m\u00e1s al grupo del usuario, no al usuario propietario ni al resto). El script debe hacer un ls \u2013l al final sobre el directorio trabajado para ver los cambios.</li> <li> <p>Realiza un script que reciba 3 argumentos, una extensi\u00f3n de fichero y dos nombres de directorios. El script deber\u00e1:</p> <ol> <li>Comprobar que ha recibido 3 argumentos, en caso contrario mostrar\u00e1 un error.</li> <li>Comprobar que el segundo y tercer argumento son directorios, en caso contrario mostrar\u00e1 un error.</li> <li>Posteriormente dar\u00e1 al usuario la opci\u00f3n de \u201cmover\u201d o \u201ccopiar\u201d:</li> <li>En caso de seleccionar \u201cmover\u201d, se mover\u00e1n todos los ficheros con dicha extensi\u00f3n (argumento n\u00famero 1) del primer directorio (argumento n\u00famero 2) al segundo directorio (argumento n\u00famero 3).</li> <li>En caso de seleccionar \u201ccopiar\u201d realizar\u00e1 lo mismo pero copiando en vez de moviendo.</li> </ol> </li> <li> <p>A partir de un fichero de texto llamado <code>equipos.txt</code> con los siguientes campos separados por espacios en blanco:</p> <ol> <li>IP.</li> <li>Nombre del Equipo.</li> <li>Memoria en disco libre en GBytes.</li> <li>Memoria RAM total en GBytes.</li> </ol> <p>El script esperar\u00e1 recibir un argumento que representar\u00e1 la capacidad de memoria en disco m\u00ednima que deba tener un equipo. Acto seguido el script mostrar\u00e1 una alerta de todos aquellos equipos que tienen menos de dicha capacidad disponible. Se debe de comprobar que efectivamente se ha introducido uno y solo un argumento al script.</p> </li> <li> <p>Antes de nada instala el paquete: openssh-server.A continuaci\u00f3n, sigue las siguientes indicaciones:</p> <ol> <li>Instala los paquetes <code>\u201cssh\u201d, \u201csshpass\u201d y \u201copenssh-server\u201d</code>. En una m\u00e1quina</li> <li> <p>Arranca el servicio ssh:</p> <ol> <li><code>service ssh start</code></li> </ol> </li> <li> <p>Accede a la configuraci\u00f3n del servicio<code>/etc/ssh/sshd_config</code>:</p> <ol> <li>Descomenta y cambia la l\u00ednea\u201c<code>PermitRootLogin yes</code>\u201d.</li> <li>Esta medida est\u00e1 desaconsejada de cara a la seguridad inform\u00e1tica, la hacemos \u00fanicamente para facilitar la resoluci\u00f3n de este ejercicio.</li> </ol> </li> <li>Reinicia el servicio ssh para que surjan efectos los cambios.<ol> <li><code>service ssh restart</code></li> </ol> </li> <li>Crea una contrase\u00f1a para root:<ol> <li><code>sudo su</code></li> <li><code>passwd</code> (con esta contrase\u00f1a se la tenemos que pasar a todos <code>sshpass</code>)</li> </ol> </li> <li>Crea tres clones enlazados a partir de la anterior con distinta ip y mac.</li> <li>Abre las tres m\u00e1quinas en terminales por separado, revisa su IP (<code>ip \u2013a</code>) y comprueba que tienen conectividad. Posteriormente prueba a entrar al contenedor con ssh (<code>ssh IP</code>)</li> </ol> <p>Crea un script llamado creaUsuarios.sh que se encontrar\u00e1 en la m\u00e1quina original. Dicho script leer\u00e1 de dos ficheros. El primero es una lista de hosts (hosts.txt) y el segundo es una lista de usuarios (usuarios.txt). El script debe acceder a cada equipo, borrar dicho usuario junto con su contenido si exist\u00eda y crearlos de nuevo.</p> </li> </ol> <p>Warning</p> <p>TODAS LAS ACTIVIDADES SON OBLIGATORIAS. Adem\u00e1s, cuando os pidan en el ejercicio que gener\u00e9is un fichero script , es el que me ten\u00e9is que subir, y cuando no lo pida ten\u00e9is que subir un fichero pdf con las capturas como siempre. Aunque haya un solo fichero es conveniente que lo sub\u00e1is comprimido.</p>"},{"location":"UD9/Argumentos/","title":"Argumentos","text":"<p>Un argumento es un par\u00e1metros que se le pasa a una funci\u00f3n o a un programa. Es decir, son variables de entrada. Puede haber m\u00e1s de uno o ninguno.</p> <p>Script con argumentos</p> <p>./script.sh arg1 arg2 arg3 \u2026 argN</p>"},{"location":"UD9/Argumentos/#ejemplo","title":"Ejemplo:","text":"<p>Ejecutamos el mismo script con diferentes argumentos, dando salidas distintas.</p> <p></p> <ul> <li> <p>Se puede acceder al contenido de cada uno de los argumentos usando $X donde \u201cX\u201d es la posici\u00f3n del argumento (primero, segundo, tercero, ...).</p> </li> <li> <p><code>$0</code>: Es el nombre del script \u2192 soyUnScript.sh.</p> </li> </ul> <p>-<code>$\\*</code>: Una lista con todos los argumentos \u2192 salva 1010 \"Salva Serrano\" /home/Salva /bin/bash.</p> <p>-<code>$#</code>: N\u00famero de argumentos \u2192 5.</p> <ul> <li><code>shift</code>: Elimina el argumento uno ($1) y promueve una posici\u00f3n al resto de argumentos, es decir, lo que antes era $2 ahora ser\u00e1 $1.</li> </ul>"},{"location":"UD9/Argumentos/#ejemplo-1","title":"Ejemplo 1.","text":"<p>Script con argumentos</p> <p><code>./soyUnScript.sh</code> salva 1010 \"Salva Serrano\" /home/Salva /bin/bash</p> Variable Contenido <code>$0</code> soyUnScript.sh <code>$1</code> salva <code>$2</code> 1010 <code>$3</code> Salva Serrano <code>$4</code> /home/Salva <code>$5</code> /bin/bash <code>$*</code> salva 1010 \"Salva Serrano\" /home/Salva /bin/bash <code>$#</code> 5 <ul> <li>Los argumentos van separados por espacios y en caso de insertar un metacaracter, como por ejemplo asterisco (*), es necesario escaparlo con :</li> </ul> <p>Escapar car\u00e1cteres especiales</p> <p>./soyUnScript.sh 5 \\* 10</p>"},{"location":"UD9/Argumentos/#ejemplo-de","title":"Ejemplo de $","text":"<pre><code>if [ $# -eq 3 ]\nthen\n        echo \"Se han insertado 3 argumentos.\"\nelse\n        echo \"Por favor, inserte 3 argumentos.\"\nfi\n</code></pre>"},{"location":"UD9/Argumentos/#ejemplo-shift","title":"Ejemplo Shift.","text":"<p>Se puede observar como $1 va a ir valiendo cada uno de los argumentos.</p> <pre><code>echo \"El primer argumento es: $1\"\nshift\necho \"Ahora el primer argumento es: $1\"\nshift\necho \"Ahora el primer argumento es: $1\"\n</code></pre> <p></p>"},{"location":"UD9/Argumentos/#videos-de-ejemplo","title":"V\u00eddeos de Ejemplo.","text":"<ol> <li>Ejemplos de Argumentos.</li> </ol>"},{"location":"UD9/Aritmetica/","title":"Operaciones Matem\u00e1ticas.","text":""},{"location":"UD9/Aritmetica/#operaciones","title":"Operaciones","text":"| S\u00edmbolo |  Significado  | | :-----: | :----------------------------- | |   `*`   | Multiplicaci\u00f3n                 | |   `/`   | Divisi\u00f3n                       | |   `-`   | Resta                          | |   `+`   | Suma                           | |   `%`   | Resto. Ej. 5%2 = 1             |"},{"location":"UD9/Aritmetica/#comandos-aritmeticos","title":"Comandos Aritm\u00e9ticos.","text":"<p>Existen varias posibilidades para realizar operaciones matem\u00e1ticas.</p>"},{"location":"UD9/Aritmetica/#1-usando-doble-parentesis","title":"1. Usando doble par\u00e9ntesis:","text":"<pre><code>suma=$(( $x + $y ))\n</code></pre>"},{"location":"UD9/Aritmetica/#2-usando-el-comando-let","title":"2. Usando el comando \u201clet\u201d:","text":"<pre><code>#Ejemplo de Multiplicaci\u00f3n:\nlet \"mult = $x * $y\"\n\n#Ejemplo de triplicar un valor:\nlet \u201cmult = $mult * 3\u201d\n\n\n#Ejemplo de incrementar un valor o decrementar:\nlet mult++\nlet mult--\n</code></pre>"},{"location":"UD9/Aritmetica/#3-usar-el-comando-expr","title":"3. Usar el comando \u201cexpr\u201d:","text":"<ul> <li>Este comando es m\u00e1s antiguo y tiene el inconveniente de tener que escaparse (a\u00f1adir ) delanta de cada car\u00e1cter especial como *,&lt;,&gt;,(,), etc.</li> </ul> <pre><code>#Ejemplo del uso de * y () escapado (\\)\nexpr 2 \\* 3\nexpr \\( 2 + 2 \\) \\* 3\n</code></pre> <ul> <li>Por contra, expr es \u00fatil para comprobar longitud de cadena de caracteres y sustraer subcadenas.</li> </ul> <pre><code>#Este comando devuelve 10, que es la longitud de la cadena pasada como par\u00e1metro.\n#Tened en cuenta que se contabiliza cada espacio en blanco como una letra.\nexpr length \u201cHola Mundo\u201d\n\n#Desde el car\u00e1cter n.\u00ba 4 (a) devuelve los siguientes 4 caracteres \u2192 \u201ca Mu\u201d\nexpr substr \u201cHola Mundo\u201d 4 4\n\n#. Desde el car\u00e1cter n\u00famero 6, devuelve los siguientes 5 caracteres \u2192 \u201cMundo\u201d\nexpr substr \u201cHola Mundo\u201d 6 5\n</code></pre>"},{"location":"UD9/Aritmetica/#4-comando-bc-para-decimales","title":"4. Comando \"bc\" para decimales.","text":"<p>Para trabajar con decimales debemos usar el comando \u201cbc\u201d:</p> <pre><code>    operacion=`echo \u201c7.5 * 12.5\u201d | bc `\n</code></pre> <p>Las comillas invertidas devuelven el valor de la operaci\u00f3n o del comando.</p> <p>Para sacar todos los posibles decimales usamos la opci\u00f3n \u201c-l\u201d</p> <pre><code>    operacion=`echo \u201c7.5 * 12.5\u201d | bc  -l`\n</code></pre> <p>Si queremos cierto n\u00famero de decimales usamos la opci\u00f3n scale:</p> <pre><code>    operacion=`echo \u201cscale=3;7.5 * 12.5\u201d | bc `\n</code></pre>"},{"location":"UD9/Break/","title":"Exit, Break y Continue","text":""},{"location":"UD9/Break/#exit","title":"Exit.","text":"!!! danger \"EXIT\"          El comando **exit** finaliza el script."},{"location":"UD9/Break/#break","title":"Break","text":"!!! danger \"BREAK\"          El comando \"break\" nos saca de un bucle.   <ul> <li> <p>Nos permite dar por finalizado un bucle (while, until o for).</p> </li> <li> <p>En caso de tener un bucle anidado, podemos usar break X para romper y salir de X bucles.</p> </li> <li> <p>No hay que confundirlo con exit, el comando exit termina el programa, mientras que break finaliza el bucle en el que est\u00e1 pero continua el programa.</p> </li> </ul>"},{"location":"UD9/Break/#ejemplo-break","title":"Ejemplo Break.","text":"<pre><code>#En el siguiente ejemplo hay un bucle que va desde 0 a 100 incrementando de 1 en 1.\n#No obstante, cuando llega al n\u00famero indicado por el usuario se sale del bucle for y contin\u00faa.\nread -p \"Escribe un numero del 1 al 100: \" num\n\nfor x in `seq 1 $num`\ndo\n        echo $x\n        if [ $x -eq $num ]\n        then\n                echo \"Ya he llegado al numero $num\"\n                break\n        fi\ndone\necho\necho \"El programa no ha terminado.\"\necho \"Simplemente se ha salido del bucle mediante el break.\"\n</code></pre>"},{"location":"UD9/Break/#continue","title":"Continue","text":"!!! danger \"CONTINUE\"         El comando \"continue\" manda el programa directamente a la siguiente iteraci\u00f3n."},{"location":"UD9/Break/#ejemplo-continue","title":"Ejemplo Continue","text":"<pre><code>#En este ejemplo se recorre del 1 al 10 y no se muestra nada para el valor de 5.\nfor x in `seq 1 10`\ndo\n        if [ $x -eq 5 ]\n        then\n                continue\n        fi\n\n        echo \"Vamos a mostrar todos los numeros menos el 5: $x\"\ndone\n</code></pre>"},{"location":"UD9/Case/","title":"Estructura CASE","text":"<p>Estructura parecida al \ud83d\udd00 IF.</p> <pre><code>    case VARIABLE in\n      OPCION_A)\n              ACCIONES;;\n      OPCION_B)\n              ACCIONES;;\n      *)\n              ACCIONES;;\n    esac\n</code></pre> <p>Va realizando comprobaciones y cuando una coincida, realiza una serie de acciones programadas y finaliza la condici\u00f3n.</p> <ul> <li> <p>Cada opci\u00f3n debe ir finalizada de par\u00e9ntesis \u201c)\u201d.</p> </li> <li> <p>Cada acci\u00f3n debajo de cada condici\u00f3n debe ir finalizada de doble punto y coma \u201c;;\u201d</p> </li> <li> <p>Con el metacaracter \u201c*\u201d conseguimos que coincida cualquier cosa, por lo que siempre se cumplir\u00e1 la condici\u00f3n. Es equivalente al \u201celse\u201d.</p> </li> <li> <p>Se puede hacer uso de expresiones regulares.</p> </li> <li> <p>Se debe usar \u201cesac\u201d para finalizar la estructura.</p> </li> </ul>"},{"location":"UD9/Case/#ejemplo-1-ejemplo-de-un-menu","title":"Ejemplo 1. Ejemplo de un Men\u00fa.","text":"<pre><code>echo \"1. Agregar Usuario.\"\necho \"2. Eliminar Usuario.\"\necho \"3. Bloquear Usuario.\"\necho \"4. Salir.\"\n\nread -p \"Elige una opcion: \" opcion\n\ncase $opcion in\n        \"1\")\n                echo \"Has elegido la opcion 1\"\n                echo \"Ahora creariamos el usuario\";;\n        \"2\")\n                echo \"Has elegido la opcion 2, vamos a eliminar al usuario\";;\n        \"3\")\n                echo \"Has elegido la opcion 3 ...\";;\n        \"4\")\n                exit;;\n        *)\n                echo \"El usuario ha insertado cualquier otra cosa.\"\nesac\n</code></pre>"},{"location":"UD9/Case/#ejemplo-2-multiples-lineas-de-ejecucion-por-opcion","title":"Ejemplo 2. M\u00faltiples l\u00edneas de ejecuci\u00f3n por opci\u00f3n","text":"<p>Es importante que quede claro que podemos a\u00f1adir varios comandos/acciones por cada opci\u00f3n, como se puede ver en el siguiente ejemplo en las opciones 0) y *).</p> <p></p>"},{"location":"UD9/Case/#ejemplo-3-el-uso-de-operadores-binarios-en-el-case","title":"Ejemplo 3. El uso de operadores binarios en el case","text":"<p>Tambi\u00e9n podemos hacer uso de la | para integrar dos opciones posibles, es decir, que tanto si se cumple una u otra se ejecutar\u00e1n los comandos asociadas a esa comprobaci\u00f3n:</p> <p>Por ejemplo en el siguiente ejemplo, la primera comprobaci\u00f3n ser\u00e1 verdadera si nombre vale \u201c\u00e1lvaro\u201d o \u201cpepe\u201d</p> <p></p> <p></p>"},{"location":"UD9/Case/#ejemplo-4-el-uso-de","title":"Ejemplo 4. El uso de ;;&amp;","text":"!!! danger           \"Con \ud83d\udd00 ;;&amp; \ud83d\udd00 podemos ejecutar m\u00faltiples condiciones\"  <ul> <li> <p>Con \u201c;;\u201d le decimos al script que si se cumple esa condici\u00f3n termine la estructura y salga del \u201ccase\u201d (una l\u00ednea despu\u00e9s del esac).</p> </li> <li> <p>Usando \u201c;;&amp;\u201d estamos indicando que en caso de ser cierta esa comprobaci\u00f3n, ejecute las instrucciones asociadas, pero que siga comprobando el resto de opciones y si hay alguna cierta ejecute tambi\u00e9n las acciones asociadas a ella.</p> </li> </ul> <p>En el siguiente ejemplo la primera cl\u00e1usula tiene un \u201c;;&amp;\u201d, por lo que por ejemplo si el usuario selecciona \u201cViernes\u201d se mostrar\u00e1 por pantalla \u201cA estudiar\u201d y posteriormente se mostrar\u00e1 tambi\u00e9n \u201cA descansar\u201d, puesto que seguir\u00e1 comprobando el resto de condiciones de la estructura case.</p> <p></p>"},{"location":"UD9/Comparadores/","title":"Comparadores.","text":""},{"location":"UD9/Comparadores/#comparadores-aritmeticos","title":"Comparadores Aritm\u00e9ticos.","text":"| Comparador |  Significado    | | :--------: | :------------------------------- | |   `-eq`    | Igual a (Equeal to)              | |   `-ne`    | No Igual (Not Equal)             | |   `-gt`    | Mayor que (Greater Than)         | |   `-ge`    | Mayor o igual (Greater or Equal) | |   `-lt`    | Menor que (Lower Than)           | |   `-le`    | Menor o igual (Lower or Equal)   |"},{"location":"UD9/Comparadores/#ejemplo-1","title":"Ejemplo 1","text":"<pre><code>if [ $edad -gt 25 ]\nthen\n    echo \"Tienes m\u00e1s de 25 a\u00f1os.\"\nelse\n    echo \"Tienes 25 o menos a\u00f1os.\"\nfi\n</code></pre>"},{"location":"UD9/Comparadores/#ejemplo-2","title":"Ejemplo 2","text":"<pre><code>if [ $examenes -ne 20 ]\nthen\n    echo \"No tenemos exactamente 20 ex\u00e1menes entregados, algo ha ido mal\"\nelse\n    echo \"Han entregado 20 ex\u00e1menes.\"\nfi\n</code></pre>"},{"location":"UD9/Comparadores/#ejemplo-3","title":"Ejemplo 3","text":"<pre><code>if [ $memoria -le 100000 ]\nthen\n    echo \"Quedan 100MB o menos en el sistema.\"\nfi\n</code></pre>"},{"location":"UD9/Comparadores/#comparadores-de-archivos","title":"Comparadores de Archivos.","text":"| Comparador |  Significado                | | :--------: | :------------------------------------------- | |    `-f`    | Verdadero si es un fichero                   | |    `-e`    | Verdadero si existe                          | |    `-d`    | Verdadero si es un directorio                | |    `-r`    | Verdadero si tengo permisos de lectura       | |    `-w`    | Verdadero si tengo permisos de escritura     | |    `-x`    | Verdadero si tengo permisos de ejecuci\u00f3n     | |    `-O`    | Verdadero si soy el usuario propietario      | |    `-G`    | Verdadero si pertenezco al grupo propietario | |    `-s`    | Verdadero si el fichero NO est\u00e1 vac\u00edo        | |    `-L`    | Verdadero si se trata de un enlace simb\u00f3lico |"},{"location":"UD9/Comparadores/#ejemplo-1_1","title":"Ejemplo 1","text":"<pre><code>if [ -e $carpeta ]\nthen\n    echo \"La carpeta existe, aunque quiz\u00e1 se trate de un fichero.\"\nelse\n    echo \"La carpeta no existe\"\nfi\n</code></pre>"},{"location":"UD9/Comparadores/#ejemplo-2_1","title":"Ejemplo 2","text":"<pre><code>if [ -d $carpeta ]\nthen\n    echo \"La carpeta existe y se trata seguro de una carpeta.\"\nelse\n    echo \"La carpeta no existe\"\nfi\n</code></pre>"},{"location":"UD9/Comparadores/#ejemplo-3_1","title":"Ejemplo 3","text":"<pre><code>if [ -s $fichero ]\nthen\n    echo \"El fichero contiene informaci\u00f3n.\"\nelse\n    echo \"El fichero est\u00e1 vaci\u00f3 y lo voy a borrar.\"\n    rm -f $fichero\nfi\n</code></pre>"},{"location":"UD9/Comparadores/#comparadores-de-cadenas-variables","title":"Comparadores de cadenas / variables.","text":"| Comparador |  Significado            | | :--------: | :--------------------------------------- | |    `=`     | Verdadero si es igual                    | |    `!=`    | Verdadero si es diferente                | |    `-n`    | Verdadero si la variable tiene contenido | |    `-z`    | Verdadero si la variable est\u00e1 vac\u00eda      |"},{"location":"UD9/Comparadores/#ejemplo-1_2","title":"Ejemplo 1","text":"<pre><code>if [ $usuario = \"ajc\" ]\nthen\n    echo \"Bienvenido Alejandro!\"\nelse\n    echo \"\u00bfQui\u00e9n eres?\"\n    read -p \"Introduce tu nombre: \" nombre\nfi\n</code></pre>"},{"location":"UD9/Comparadores/#ejemplo-2_2","title":"Ejemplo 2","text":"<pre><code>if [ $salir != \"s\" ]\nthen\n    echo \"El usuario quiere seguir jugando.\"\nelse\n    echo \"El usuario quiere continuar jugando.\"\nfi\n</code></pre>"},{"location":"UD9/Comparadores/#ejemplo-3_2","title":"Ejemplo 3","text":"<pre><code>if [ -z $respuesta]\nthen\n    echo \"Hubo alg\u00fan error y se ha recibido una respuesta vac\u00eda\"\nfi\n</code></pre>"},{"location":"UD9/Comparadores/#los-operadores","title":"Los operadores.","text":"Operador del comando test (por orden de prioridad decreciente) Significado ! Negaci\u00f3n -a Y -o O"},{"location":"UD9/Comparadores/#ejemplo-1_3","title":"Ejemplo 1","text":"<p>El comando test( []) devuelve verdadero si $dir es un directorio y si el usuario tiene el permiso de recorrerlo:</p> <pre><code>$ dir=/tmp\n$ echo $dir\n/tmp\n$ [ -d $dir -a -x $dir ]\n$ echo $?\n0\n</code></pre>"},{"location":"UD9/Comparadores/#el-comando","title":"El comando [[]]","text":"<p>El comando [[]] es una versi\u00f3n enriquecida del comando test([]). Consideraciones:</p> <ul> <li>Los operadores l\u00f3gicos -a y -o han sido reemplazados por <code>&amp;&amp; y ||</code>.</li> <li>Funcionalidades suplementarias en referencia al comando test</li> <li>Verificaciones sobre cadenas</li> <li>Las comillas dobles alrededor de los nombres de variables ya no son obligatorias.</li> </ul>"},{"location":"UD9/Comparadores/#ejemplo","title":"Ejemplo","text":"<p>Sintaxis correctas para verificar si una cadena est\u00e1 vac\u00eda:</p> <pre><code>$ echo $vacia\n\n$ [ -z \"$vacia\" ]\n$ echo $?\n0\n$\n$ [[ -z $vacia ]]\n$ echo $?\n0\n$ [[ -z \"$vacia\" ]]\n$ echo $?\n0\n$ [[ $vacia = \"\" ]]\n$ echo $?\n0\n</code></pre> <p>Warning</p> <p><code>$?</code> es un par\u00e1metro que pregunta al comando que se ha ejecutado con anterioridad , si se ha realizado correctamente. Cuando sale 0 es afirmativo. Este par\u00e1metro es \u00fatil cuando se trata de comparaciones. En el supuesto de una suma la sumaria y te saldr\u00eda correcto pero si no lo suma te saldr\u00eda &gt;0.</p>"},{"location":"UD9/For/","title":"Estructura FOR IN","text":""},{"location":"UD9/For/#for-in","title":"FOR IN","text":"FOR IN<pre><code>for VARIABLE in LISTA\n        do\n                ACCIONES\n        done\n</code></pre> <ul> <li> <p>Permite recorrer una lista.</p> </li> <li> <p>Importante el espacio entre los corchetes y el uso de \u201cdo\u201d y \u201cdone\u201d para crear la estructura.</p> </li> <li> <p>Por defecto se interpreta como un objeto de la lista todo aquello que va separado por un espacio en blanco.</p> </li> <li> <p>Usaremos una variable y en cada iteraci\u00f3n dicha variable tendr\u00e1 un valor de la lista.</p> </li> </ul> <p>Iteraci\u00f3n</p> <pre><code>Se refiere a cada vez que se va ejecutando el bucle. La primera ejecuci\u00f3n con el primer objeto de la lista es la primera iteraci\u00f3n, la segunda vez ser\u00e1 la segunda iteraci\u00f3n, y as\u00ed sucesivamente.\n</code></pre>"},{"location":"UD9/For/#ejemplos-de-listas","title":"Ejemplos de listas","text":""},{"location":"UD9/For/#ejemplo-de-lista-usando-literales","title":"Ejemplo de lista usando literales","text":"<pre><code>iteracion=1\nfor nombres in Salva Pepe Juan Domingo\ndo\n        echo \"En la iteracion $iteracion la variable vale $nombres\"\n        let iteracion=$iteracion+1\ndone\n</code></pre>"},{"location":"UD9/For/#ejemplo-de-lista-usando-variables","title":"Ejemplo de lista usando variables.","text":"<pre><code>directorios=`ls`\niteracion=1\nfor nombres in $directorios\ndo\n        echo \"El directorio en la iteracion $iteracion es $nombres\"\n        let iteracion=iteracion+1\ndone\n</code></pre>"},{"location":"UD9/For/#ejemplo-de-lista-usando-comandos","title":"Ejemplo de lista usando comandos.","text":"<pre><code>iteracion=1\nfor nombres in `ls`\ndo\n        echo \"El directorio en la iteracion $iteracion es $nombres\"\n        let iteracion=iteracion+1\ndone\n</code></pre>"},{"location":"UD9/For/#ejemplos-genericos","title":"Ejemplos gen\u00e9ricos.","text":""},{"location":"UD9/For/#ejemplos-usando-el-comando-seq","title":"Ejemplos usando el comando seq.","text":"<pre><code>for numero in `seq 1 10`\ndo\n        echo \"Ahora la variable numero vale $numero\ndone\n</code></pre>"},{"location":"UD9/For/#ejemplos-con-un-for-anidado","title":"Ejemplos con un for anidado.","text":"<pre><code>filas=5\ncolumnas=5\nfor fila in `seq 1 $filas`\ndo\n        for col in `seq 1 $columnas`\n        do\n                echo -n \"*\"\n        done\n        #Para saltar de linea.\n        echo\ndone\n</code></pre>"},{"location":"UD9/For/#ejemplo-recorriendo-un-fichero-sin-espacios-en-blanco","title":"Ejemplo recorriendo un fichero SIN espacios en blanco.","text":"<pre><code>#Solo nos quedamos con los primeros 3 campos porque el 4 de informacion personal\n#puede contener espacios\nfor linea in `cat /etc/passwd | cut -d':' -f1-3`\ndo\n        #Nos quedamos con el nombre de usuario y su uid.\n        userID=`echo $linea | cut -d':' -f3`\n        usuario=`echo $linea | cut -d':' -f1`\n        #Si su UID es mayor de 1000 y menor de 65534 es un usuario normal.\n        if [[ $userID -ge 1000 &amp;&amp; $userID -lt 65534 ]]\n        then\n                echo \"$usuario es un usuario normal\"\n        fi\ndone\n</code></pre>"},{"location":"UD9/For/#ejemplo-recorriendo-un-fichero-con-espacios-en-blanco-usando-ifs","title":"Ejemplo recorriendo un fichero CON espacios en blanco usando IFS.","text":"!!! danger \"Cambiar el IFS\"         IFS=$'{\\n}'  <ul> <li> <p>El IFS es el separador por defecto del sistema.</p> </li> <li> <p>Existe la variable de entorno $IFS que nos indica cu\u00e1l es.</p> </li> <li> <p>Podemos modificarla dentro de nuestro script como cualquier variable \ud83d\udd00 IFS=$'{\\n}'</p> </li> <li> <p>Por defecto el IFS es el espacio en blanco, por esa raz\u00f3n cada objeto de una lista est\u00e1 separado por un espacio en blanco.</p> </li> </ul> <p>En el siguiente ejemplo cambiamos el IFS al salto de l\u00ednea, de esta forma cada iteraci\u00f3n coge una linea entera.</p> <pre><code>IFS=$'{\\n}'\n\nfor linea in `ls -l | tr -s ' '`\ndo\n        echo $linea\ndone\n</code></pre>"},{"location":"UD9/For/#video-de-ejemplo","title":"V\u00eddeo de Ejemplo.","text":"<ol> <li>V\u00eddeo Ejemplo Estructura For in</li> </ol>"},{"location":"UD9/IF/","title":"Estructura IF.","text":"<p>Una estructura de programaci\u00f3n IF sirve para generar condiciones:</p> <ul> <li>Si se cumple cierta condici\u00f3n realizaremos una acci\u00f3n, si no, realizaremos otra:</li> </ul> <p>Estructura IF simple</p> <p><code>bash     if [ CONDICI\u00d3N ]     then         ACCIONES     fi</code></p> <p>Cosas que se deben tener en cuenta:</p> <ul> <li>Hay que dejar un espacio en blanco entre los corchetes.</li> <li>Podemos hacer condiciones usando variables, haciendo uso del $, puesto que queremos comparar su contenido.</li> <li>Es recomendable tabular (indentar) las acciones para que quede m\u00e1s limpio el c\u00f3digo.</li> <li>Siempre debe terminar la estructura con \u201cfi\u201d</li> </ul> <p>Podemos crear condiciones con alternativas, donde si no se cumple una condici\u00f3n se realiza otra lista de acciones:</p> <p>Estructura IF ELSE</p> <p><code>bash     if [ condici\u00f3n ]     then         ACCIONES     else         ACCIONES     fi</code></p> <p>Se pueden anidar muchas condiciones diferentes con el elemento \u201celif\u201d:</p> <p>Estructura IF ELSE</p> <p><code>bash     if [ condici\u00f3n ]     then         ACCIONES     elif [ condici\u00f3n ]     then         ACCIONES     elif [ condici\u00f3n ]     then         ACCIONES     else         ACCIONES     fi</code></p>"},{"location":"UD9/IF/#ejemplos","title":"Ejemplos.","text":""},{"location":"UD9/IF/#ejemplo-1","title":"Ejemplo 1.","text":"<pre><code>read -p  \"Cual es tu nombre? \" nombre\n\nif [ $nombre = \"Salva\" ]\nthen\n        echo \"Bienvenido Salva\"\nfi\n</code></pre>"},{"location":"UD9/IF/#ejemplo-2","title":"Ejemplo 2.","text":"<pre><code>read -p  \"Cual es tu nombre? \" nombre\n\nif [ $nombre = \"Salva\" ]\nthen\n        echo \"Bienvenido Salva\"\n        touch fichero.txt\nelse\n        echo \"No eres Bienvenido\"\n        echo \"AutoDestruccion\"\n        rm -f fichero.txt\nfi\n</code></pre>"},{"location":"UD9/IF/#ejemplo-3","title":"Ejemplo 3.","text":"<pre><code>read -p  \"Cual es tu nombre? \" nombre\n\nif [ $nombre = \"Salva\" ]\nthen\n        echo \"Bienvenido Salva\"\n        touch fichero.txt\nelif [ $nombre = \"Pepe\" ]\nthen\n        echo \"Que tal Pepe?\"\nelse\n        echo \"No eres Bienvenido\"\n        echo \"AutoDestruccion\"\n        rm -f fichero.txt\nfi\n</code></pre>"},{"location":"UD9/IF/#ejemplo-4","title":"Ejemplo 4.","text":"<pre><code>read -p \"Cual es tu edad? \" edad\n\nif [ $edad -ge 33 ]\nthen\n        echo \"Tienes la edad de Cristo o mas\"\nelse\n        echo \"Tienes menos que la edad de Cristo\"\nfi\n</code></pre>"},{"location":"UD9/IF/#ejemplo-5","title":"Ejemplo 5.","text":"<pre><code>read -p \"Inserta un nombre de archivo: \" fic\n\nif [ -f $fic ]\nthen\n        echo \"$fic es un fichero\"\nelse\n        echo \"$fic no es un fichero\"\nfi\n</code></pre>"},{"location":"UD9/IF/#ejemplo-6","title":"Ejemplo 6.","text":"<pre><code>read -p \"Inserta un directorio: \" dir\n\nif [ -e $dir ]\nthen\n        echo \"$dir existe, pero no se si es un directorio.\"\nelse\n        echo \"$dir no existe.\"\nfi\n</code></pre>"},{"location":"UD9/IF/#ejemplo-7","title":"Ejemplo 7.","text":"<pre><code>read -p  \"Indica un ficher o directorio: \" recurso\n\nif [ -f $recurso ]\nthen\n        echo \"$recurso es un fichero\"\nelif [ -d $recurso ]\nthen\n        echo \"$recurso es un directorio\"\nelif [ -e $recurso ]\nthen\n        echo \"$recurso existe pero no es ni un directorio ni un fichero\"\nelse\n        echo \"El $recurso ni si quiera existe\"\nfi\n</code></pre>"},{"location":"UD9/IF/#ejemplo-8-operador","title":"Ejemplo 8. Operador [[]]","text":"<p>Con el comando test:</p> <pre><code>if [ -w $arch1 -a \\( -e $dir1 -o -e $dir2 \\) ]\nthen\n...\n</code></pre> <p>Con el comando [[]]:</p> <pre><code>if [[-w $arch1 &amp;&amp; ( -e $dir1 || -e $dir2 )]]\nthen\n...\n</code></pre>"},{"location":"UD9/IF/#videos-de-ejemplo","title":"V\u00eddeos de Ejemplo.","text":"<ol> <li>Ejemplos de la Estructura IF.</li> </ol>"},{"location":"UD9/Operadores_Binarios/","title":"Operadores Binarios.","text":""},{"location":"UD9/Operadores_Binarios/#and","title":"AND.","text":"<ul> <li>Devuelve verdadero cuando las dos expresiones son verdaderas, en otros casos devuelve falso.</li> <li>Se aplica mediante el uso de \u201c&amp;&amp;\u201d.</li> </ul>"},{"location":"UD9/Operadores_Binarios/#ejemplo-1","title":"Ejemplo 1","text":"<pre><code># El directorio /tmp/svg no existe;\n$[[ -d /tmp/svg ]] &amp;&amp; cd /tmp/svg\n\n$ echo $?        # C\u00f3digo del comando [[ ]]\n1\n$ pwd\n/export/home/ubuntu\n</code></pre>"},{"location":"UD9/Operadores_Binarios/#ejemplo-2","title":"Ejemplo 2","text":"<p>El programa compara dos argumentos, y dir\u00e1 si son diferentes de a y b o no.</p> <pre><code>read -p \"Introduce el numero de vidas \" vidas\nread -p \"Introduce el numero de continues \" continues\n\nif [[ $vidas -le 0 &amp;&amp; $continues -le 0 ]]\nthen\n        echo \"Game Over!\"\nelse\n        echo \"Continue?\"\nfi\n</code></pre> <p></p>"},{"location":"UD9/Operadores_Binarios/#or","title":"OR.","text":"<ul> <li>El comando OR devuelve verdadero cuando al menos una de sus expresiones se cumple.</li> <li>Se representa usando \u201c||\u201d doble barra vertical.</li> </ul>"},{"location":"UD9/Operadores_Binarios/#ejemplo-1_1","title":"Ejemplo 1","text":"<pre><code>#El directorio /tmp/svg no existe;\n$ pwd\n/export/home/ubuntu\n$ [[ -d /tmp/svg ]] || echo \"El directorio /tmp/svg no existe\"\nEl directorio /tmp/svg no existe\nEl directorio /tmp/svg existe; por tanto, el comando echo no se ejecuta.\n</code></pre>"},{"location":"UD9/Operadores_Binarios/#ejemplo-2_1","title":"Ejemplo 2","text":"<pre><code>read -p \"Indica tu nombre \" nombre\n\nif [[ $nombre == \"Salva\" || $nombre == \"Admin\" ]]\nthen\n        echo \"Bienvenido!\"\nelse\n        echo \"Usuario Incorrecto\"\nfi\n</code></pre>"},{"location":"UD9/Operadores_Binarios/#uso-de-multiples-operadores-binarios","title":"Uso de m\u00faltiples operadores binarios.","text":"<ul> <li>Si quisi\u00e9ramos agregar m\u00e1s de dos operadores binarios, ser\u00eda el mismo proceso:</li> </ul> <pre><code>read -p \"Introduce el numero de vidas \" vidas\nread -p \"Introduce el numero de continues \" continues\nread -p \"Quieres activar las trampas? (s/n)\" trampas\n\nif [[ $vidas -le 0 &amp;&amp; $continues -le 0 &amp;&amp; $trampas = \"s\" ]]\nthen\n        echo \"Game Over!\"\nelse\n        echo \"Continue?\"\nfi\n</code></pre> <ul> <li>Si vamos a agrupar diferentes opciones usando varios operadores binarios rodeamos, igual que en las ecuaciones matem\u00e1ticas, con par\u00e9ntesis \u201c(\u201c y \u201c)\u201d.</li> </ul> <pre><code>read -p \"Introduce tu nombre de usuario \" usuario\nread -p \"Introduce tu contrasenya \" pass\n\nif [[ ($usuario = \"Salva\" &amp;&amp; $pass = \"abc1234\") || ($usuario = \"Pepe\" &amp;&amp; $pass=\"4231abc\") ]]\nthen\n        echo \"Solo Salva y Pepe pueden acceder con su contrasenya\"\nelse\n        echo \"O no eres ni Salva, ni Pepe o la contrasenya es incorrecta\"\nfi\n</code></pre>"},{"location":"UD9/Scripts/","title":"Scripts en Linux","text":""},{"location":"UD9/Scripts/#creacion-de-scripts","title":"Creaci\u00f3n de Scripts","text":"<ul> <li>\u00bfD\u00f3nde creo mis scripts?</li> </ul> <p>Lo primero que debemos preguntarnos es d\u00f3nde vamos a crear el script.   Si empezamos a crear el script en un directorio donde no tenemos permisos de escritura no nos dejar\u00e1 guardar los cambios y nuestro trabajo ser\u00e1 en vano.</p> <ul> <li>\u00bfCon qu\u00e9 creo mis scripts?</li> </ul> <p>Para la creaci\u00f3n de scripts usaremos el editor de texto vim o con editor nano.</p> <p>El editor Vim es mas completo y cuando lo controlas es mucho mas r\u00e1pido pero el editor nano tambi\u00e9n es muy valido para empezar . Aqu\u00ed tienes comandos b\u00e1sicos:</p> Controles Funcionamiento <code>nano \u201cNombreFichero\u201d.sh</code> Genera o Abre el fichero para su edici\u00f3n. <code>Control + o</code> Guardar Cambios. <code>Control + x</code> Salir. <code>Control + _</code> Ir a una l\u00ednea. <code>Alt + U</code> Deshacer. <code>Alt + E</code> Rehacer. <p>En la leyenda \u201c^\u201d equivale a \u201cControl\u201d y \u201cM-\u201c equivale a \u201cAlt\u201d.</p> <ul> <li>\u00bfC\u00f3mo empiezo mis scripts?</li> </ul> <p>Lo primero ser\u00e1 crear el \u201cshebang\u201d \ud83d\udd00 #!/bin/bash.</p> <p>La funci\u00f3n del shebang es decirle al sistema operativo que cuando le digamos de ejecutar este fichero use el SHELL bash, cuya ubicaci\u00f3n dentro del sistema es /bin/bash. Si vamos a la ruta /bin, veremos que existe un ejecutable llamado \u201cbash\u201d.</p> <ul> <li>\u00bfC\u00f3mo ejecuto mis scripts?</li> </ul> <p>Una vez guardados los cambios debemos darle permisos de ejecuci\u00f3n al fichero, en caso de que estemos trabajando con un script. Es importante solo dar permiso de ejecuci\u00f3n al usuario propietario, si no se puede producir una brecha de seguridad, pues los scripts suelen almacenar/manipular datos/servicios importantes de nuestro servidor.</p> <pre><code>chmod 750 \u201cNombreFichero\u201d.sh\n</code></pre> <p>Una vez hecho, ya podemos ejecutar nuestro script de una de las siguientes formas:</p> <pre><code>./\u201dNombreFichero\u201d.sh\nbash \u201cNombreFIchero\u201d.sh\n</code></pre> <p>Warning</p> <p>No us\u00e9is el comando \u201csh script.sh\u201d donde script.sh es el nombre de vuestro script. Esto fuerza al terminal a usar el shell SHELL, y nosotros vamos a usar BASH. Por lo que en ciertos comandos nos dar\u00e1 error al usar SHELL.</p>"},{"location":"UD9/Scripts/#comentarios","title":"Comentarios","text":"<p>Importante el uso de comentarios para poder describir que hace cada parte del c\u00f3digo, tanto de cara a vosotros como de cara a compa\u00f1eros de trabajo que vayan a modificar tu c\u00f3digo.</p> <p>Para ello se usa \ud83d\udd00 \u201c#\u201d:</p>"},{"location":"UD9/Variables/","title":"Variables en BASH","text":""},{"location":"UD9/Variables/#como-creo-una-variable","title":"\u00bfC\u00f3mo creo una variable?","text":"<p>Siempre que creemos una variable debemos hacer uso del \u201c=\u201d sin espacios en blanco.</p> <ul> <li>Los textos \ud83d\udd00 comillas dobles.</li> <li>Los n\u00fameros \ud83d\udd00 sin comillas dobles.</li> </ul> <p></p> <p>Variables de cadenas de texto \ud83d\udd00 Con comillas dobles.</p> <p></p> <p>Variables que contienen el valor de un comando \ud83d\udd00 Usando comillas abiertas.</p> <p></p> <p>Variables compuestas de otras variables.</p> <p></p>"},{"location":"UD9/Variables/#como-muestro-por-pantalla-una-variable","title":"\u00bfC\u00f3mo muestro por pantalla una variable?","text":"<p>Haciendo uso del s\u00edmbolo del dolar \ud83d\udd00 \u201c$\u201d.</p> <p></p> <p>Podemos hacer uso de la opci\u00f3n \u201cecho \u2013n\u201d para mostrar varias salidas en la misma l\u00ednea.   Con la opci\u00f3n \u201cecho \u2013e\u201d puedo hacer uso de caracteres especiales con la contrabarra:</p> <p>\ud83d\udd00 \\n Salto de l\u00ednea.</p> <p>\ud83d\udd00 \\t Tabulador.</p> <p></p> <p></p>"},{"location":"UD9/Variables/#como-recojo-informacion-del-usuario","title":"\u00bfC\u00f3mo recojo informaci\u00f3n del usuario?","text":"<p>Con el comando \u201cread\u201d podemos recoger lo que escriba el usuario por terminal y guardarlo en una variable.   Podemos hacerlo todo en la misma l\u00ednea con read \u2013p:</p> <p> </p>"},{"location":"UD9/Variables/#videos-de-repaso","title":"V\u00eddeos de repaso.","text":"<p>V\u00eddeos de repaso sobre scripts y variables:</p> <ol> <li> <p>Repaso de Scripts y Variables.</p> </li> <li> <p>Ejemplos de uso de Variables..</p> </li> </ol>"},{"location":"UD9/While_Until/","title":"Estructuras WHILE y UNTIL","text":""},{"location":"UD9/While_Until/#while","title":"While","text":"<pre><code>        while [ CONDICI\u00d3N ]\n        do\n                ACCIONES\n        done\n</code></pre> <ul> <li> <p>El bucle while se repite mientras la condici\u00f3n sea verdadera.</p> </li> <li> <p>Es posible realizar bucles infinitos que est\u00e1n siempre ejecut\u00e1ndose, por ejemplo haciendo uso de la sentencia \u201ctrue\u201d, la cual siempre hace que la comprobaci\u00f3n sea verdadera.</p> </li> </ul> Bucle infinito<pre><code>while [ true ]\n                do\n                echo \"BUCLE INFINITO\"\n                done\n</code></pre> <ul> <li>Importante el espacio entre los corchetes y el uso de \u201cdo\u201d y \u201cdone\u201d para crear la estructura.</li> </ul>"},{"location":"UD9/While_Until/#ejemplo-1-repite-hasta-que-el-usuario-meta-un-numero-entre-1-y-10","title":"Ejemplo 1. Repite hasta que el usuario meta un numero entre 1 y 10","text":"<pre><code>read -p \"Elige un numero entre 1 y 10\" numero\n\n\nwhile [ $num -lt 1 &amp;&amp; $num -gt 10 ]\ndo\n        read -p \"Elige un numero entre 1 y 10\" numero\ndone\n</code></pre>"},{"location":"UD9/While_Until/#ejemplo-2-repite-hasta-que-introduzca-un-usuario-valido-en-el-sistema","title":"Ejemplo 2. Repite hasta que introduzca un usuario v\u00e1lido en el sistema.","text":"<pre><code>read -p \"Introduce un usuario: \" usuario\n\ngrep -qw $usuario /etc/passwd\n\nwhile [ $? -ne 0 ]\ndo\n        read -p \"Introduce un usuario: \" usuario\n        grep -qw $usuario /etc/passwd\ndone\n</code></pre>"},{"location":"UD9/While_Until/#until","title":"Until","text":"<ul> <li> <p>Muy parecido a la estructura while.</p> </li> <li> <p>Se ejecuta mientras la condici\u00f3n sea falsa.</p> </li> <li> <p>Ser\u00eda equivalente a \u201cHasta que no sea cierto XXXX sigue realizando las tareas del bucle\u201d.</p> </li> </ul>"},{"location":"UD9/While_Until/#ejemplo-no-termina-hasta-que-a-tenga-el-valor-de-10","title":"Ejemplo. No termina hasta que a tenga el valor de 10","text":"<pre><code>a=0\nuntil [ $a -eq 10 ]\ndo\n        let \"a=$a+1\"\n        echo $a\ndone\n</code></pre>"}]}